{"version":3,"sources":["bootstrap.min.js","siravel.js","forms.js","typeahead.bundle.js","bootstrap-tagsinput.min.js","dropzone.js","moment.js","bootstrap-datetimepicker.min.js","redactor.js","filemanager.js","fontcolor.js","fontfamily.js","fontsize.js","imagemanager.js","stockimagemanager.js","specialchar.js","table.js","video.js","modules.js","dropzone-custom.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACl5EA;AACA;AACA;AACA;AACA;AACA;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChsDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1nGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACj9QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"all.js","sourcesContent":["/*!\n * Bootstrap v3.3.5 (http://getbootstrap.com)\n * Copyright 2011-2015 Twitter, Inc.\n * Licensed under the MIT license\n */\nif(\"undefined\"==typeof jQuery)throw new Error(\"Bootstrap's JavaScript requires jQuery\");+function(a){\"use strict\";var b=a.fn.jquery.split(\" \")[0].split(\".\");if(b[0]<2&&b[1]<9||1==b[0]&&9==b[1]&&b[2]<1)throw new Error(\"Bootstrap's JavaScript requires jQuery version 1.9.1 or higher\")}(jQuery),+function(a){\"use strict\";function b(){var a=document.createElement(\"bootstrap\"),b={WebkitTransition:\"webkitTransitionEnd\",MozTransition:\"transitionend\",OTransition:\"oTransitionEnd otransitionend\",transition:\"transitionend\"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]};return!1}a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one(\"bsTransitionEnd\",function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=b(),a.support.transition&&(a.event.special.bsTransitionEnd={bindType:a.support.transition.end,delegateType:a.support.transition.end,handle:function(b){return a(b.target).is(this)?b.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),+function(a){\"use strict\";function b(b){return this.each(function(){var c=a(this),e=c.data(\"bs.alert\");e||c.data(\"bs.alert\",e=new d(this)),\"string\"==typeof b&&e[b].call(c)})}var c='[data-dismiss=\"alert\"]',d=function(b){a(b).on(\"click\",c,this.close)};d.VERSION=\"3.3.5\",d.TRANSITION_DURATION=150,d.prototype.close=function(b){function c(){g.detach().trigger(\"closed.bs.alert\").remove()}var e=a(this),f=e.attr(\"data-target\");f||(f=e.attr(\"href\"),f=f&&f.replace(/.*(?=#[^\\s]*$)/,\"\"));var g=a(f);b&&b.preventDefault(),g.length||(g=e.closest(\".alert\")),g.trigger(b=a.Event(\"close.bs.alert\")),b.isDefaultPrevented()||(g.removeClass(\"in\"),a.support.transition&&g.hasClass(\"fade\")?g.one(\"bsTransitionEnd\",c).emulateTransitionEnd(d.TRANSITION_DURATION):c())};var e=a.fn.alert;a.fn.alert=b,a.fn.alert.Constructor=d,a.fn.alert.noConflict=function(){return a.fn.alert=e,this},a(document).on(\"click.bs.alert.data-api\",c,d.prototype.close)}(jQuery),+function(a){\"use strict\";function b(b){return this.each(function(){var d=a(this),e=d.data(\"bs.button\"),f=\"object\"==typeof b&&b;e||d.data(\"bs.button\",e=new c(this,f)),\"toggle\"==b?e.toggle():b&&e.setState(b)})}var c=function(b,d){this.$element=a(b),this.options=a.extend({},c.DEFAULTS,d),this.isLoading=!1};c.VERSION=\"3.3.5\",c.DEFAULTS={loadingText:\"loading...\"},c.prototype.setState=function(b){var c=\"disabled\",d=this.$element,e=d.is(\"input\")?\"val\":\"html\",f=d.data();b+=\"Text\",null==f.resetText&&d.data(\"resetText\",d[e]()),setTimeout(a.proxy(function(){d[e](null==f[b]?this.options[b]:f[b]),\"loadingText\"==b?(this.isLoading=!0,d.addClass(c).attr(c,c)):this.isLoading&&(this.isLoading=!1,d.removeClass(c).removeAttr(c))},this),0)},c.prototype.toggle=function(){var a=!0,b=this.$element.closest('[data-toggle=\"buttons\"]');if(b.length){var c=this.$element.find(\"input\");\"radio\"==c.prop(\"type\")?(c.prop(\"checked\")&&(a=!1),b.find(\".active\").removeClass(\"active\"),this.$element.addClass(\"active\")):\"checkbox\"==c.prop(\"type\")&&(c.prop(\"checked\")!==this.$element.hasClass(\"active\")&&(a=!1),this.$element.toggleClass(\"active\")),c.prop(\"checked\",this.$element.hasClass(\"active\")),a&&c.trigger(\"change\")}else this.$element.attr(\"aria-pressed\",!this.$element.hasClass(\"active\")),this.$element.toggleClass(\"active\")};var d=a.fn.button;a.fn.button=b,a.fn.button.Constructor=c,a.fn.button.noConflict=function(){return a.fn.button=d,this},a(document).on(\"click.bs.button.data-api\",'[data-toggle^=\"button\"]',function(c){var d=a(c.target);d.hasClass(\"btn\")||(d=d.closest(\".btn\")),b.call(d,\"toggle\"),a(c.target).is('input[type=\"radio\"]')||a(c.target).is('input[type=\"checkbox\"]')||c.preventDefault()}).on(\"focus.bs.button.data-api blur.bs.button.data-api\",'[data-toggle^=\"button\"]',function(b){a(b.target).closest(\".btn\").toggleClass(\"focus\",/^focus(in)?$/.test(b.type))})}(jQuery),+function(a){\"use strict\";function b(b){return this.each(function(){var d=a(this),e=d.data(\"bs.carousel\"),f=a.extend({},c.DEFAULTS,d.data(),\"object\"==typeof b&&b),g=\"string\"==typeof b?b:f.slide;e||d.data(\"bs.carousel\",e=new c(this,f)),\"number\"==typeof b?e.to(b):g?e[g]():f.interval&&e.pause().cycle()})}var c=function(b,c){this.$element=a(b),this.$indicators=this.$element.find(\".carousel-indicators\"),this.options=c,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on(\"keydown.bs.carousel\",a.proxy(this.keydown,this)),\"hover\"==this.options.pause&&!(\"ontouchstart\"in document.documentElement)&&this.$element.on(\"mouseenter.bs.carousel\",a.proxy(this.pause,this)).on(\"mouseleave.bs.carousel\",a.proxy(this.cycle,this))};c.VERSION=\"3.3.5\",c.TRANSITION_DURATION=600,c.DEFAULTS={interval:5e3,pause:\"hover\",wrap:!0,keyboard:!0},c.prototype.keydown=function(a){if(!/input|textarea/i.test(a.target.tagName)){switch(a.which){case 37:this.prev();break;case 39:this.next();break;default:return}a.preventDefault()}},c.prototype.cycle=function(b){return b||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},c.prototype.getItemIndex=function(a){return this.$items=a.parent().children(\".item\"),this.$items.index(a||this.$active)},c.prototype.getItemForDirection=function(a,b){var c=this.getItemIndex(b),d=\"prev\"==a&&0===c||\"next\"==a&&c==this.$items.length-1;if(d&&!this.options.wrap)return b;var e=\"prev\"==a?-1:1,f=(c+e)%this.$items.length;return this.$items.eq(f)},c.prototype.to=function(a){var b=this,c=this.getItemIndex(this.$active=this.$element.find(\".item.active\"));return a>this.$items.length-1||0>a?void 0:this.sliding?this.$element.one(\"slid.bs.carousel\",function(){b.to(a)}):c==a?this.pause().cycle():this.slide(a>c?\"next\":\"prev\",this.$items.eq(a))},c.prototype.pause=function(b){return b||(this.paused=!0),this.$element.find(\".next, .prev\").length&&a.support.transition&&(this.$element.trigger(a.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},c.prototype.next=function(){return this.sliding?void 0:this.slide(\"next\")},c.prototype.prev=function(){return this.sliding?void 0:this.slide(\"prev\")},c.prototype.slide=function(b,d){var e=this.$element.find(\".item.active\"),f=d||this.getItemForDirection(b,e),g=this.interval,h=\"next\"==b?\"left\":\"right\",i=this;if(f.hasClass(\"active\"))return this.sliding=!1;var j=f[0],k=a.Event(\"slide.bs.carousel\",{relatedTarget:j,direction:h});if(this.$element.trigger(k),!k.isDefaultPrevented()){if(this.sliding=!0,g&&this.pause(),this.$indicators.length){this.$indicators.find(\".active\").removeClass(\"active\");var l=a(this.$indicators.children()[this.getItemIndex(f)]);l&&l.addClass(\"active\")}var m=a.Event(\"slid.bs.carousel\",{relatedTarget:j,direction:h});return a.support.transition&&this.$element.hasClass(\"slide\")?(f.addClass(b),f[0].offsetWidth,e.addClass(h),f.addClass(h),e.one(\"bsTransitionEnd\",function(){f.removeClass([b,h].join(\" \")).addClass(\"active\"),e.removeClass([\"active\",h].join(\" \")),i.sliding=!1,setTimeout(function(){i.$element.trigger(m)},0)}).emulateTransitionEnd(c.TRANSITION_DURATION)):(e.removeClass(\"active\"),f.addClass(\"active\"),this.sliding=!1,this.$element.trigger(m)),g&&this.cycle(),this}};var d=a.fn.carousel;a.fn.carousel=b,a.fn.carousel.Constructor=c,a.fn.carousel.noConflict=function(){return a.fn.carousel=d,this};var e=function(c){var d,e=a(this),f=a(e.attr(\"data-target\")||(d=e.attr(\"href\"))&&d.replace(/.*(?=#[^\\s]+$)/,\"\"));if(f.hasClass(\"carousel\")){var g=a.extend({},f.data(),e.data()),h=e.attr(\"data-slide-to\");h&&(g.interval=!1),b.call(f,g),h&&f.data(\"bs.carousel\").to(h),c.preventDefault()}};a(document).on(\"click.bs.carousel.data-api\",\"[data-slide]\",e).on(\"click.bs.carousel.data-api\",\"[data-slide-to]\",e),a(window).on(\"load\",function(){a('[data-ride=\"carousel\"]').each(function(){var c=a(this);b.call(c,c.data())})})}(jQuery),+function(a){\"use strict\";function b(b){var c,d=b.attr(\"data-target\")||(c=b.attr(\"href\"))&&c.replace(/.*(?=#[^\\s]+$)/,\"\");return a(d)}function c(b){return this.each(function(){var c=a(this),e=c.data(\"bs.collapse\"),f=a.extend({},d.DEFAULTS,c.data(),\"object\"==typeof b&&b);!e&&f.toggle&&/show|hide/.test(b)&&(f.toggle=!1),e||c.data(\"bs.collapse\",e=new d(this,f)),\"string\"==typeof b&&e[b]()})}var d=function(b,c){this.$element=a(b),this.options=a.extend({},d.DEFAULTS,c),this.$trigger=a('[data-toggle=\"collapse\"][href=\"#'+b.id+'\"],[data-toggle=\"collapse\"][data-target=\"#'+b.id+'\"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};d.VERSION=\"3.3.5\",d.TRANSITION_DURATION=350,d.DEFAULTS={toggle:!0},d.prototype.dimension=function(){var a=this.$element.hasClass(\"width\");return a?\"width\":\"height\"},d.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass(\"in\")){var b,e=this.$parent&&this.$parent.children(\".panel\").children(\".in, .collapsing\");if(!(e&&e.length&&(b=e.data(\"bs.collapse\"),b&&b.transitioning))){var f=a.Event(\"show.bs.collapse\");if(this.$element.trigger(f),!f.isDefaultPrevented()){e&&e.length&&(c.call(e,\"hide\"),b||e.data(\"bs.collapse\",null));var g=this.dimension();this.$element.removeClass(\"collapse\").addClass(\"collapsing\")[g](0).attr(\"aria-expanded\",!0),this.$trigger.removeClass(\"collapsed\").attr(\"aria-expanded\",!0),this.transitioning=1;var h=function(){this.$element.removeClass(\"collapsing\").addClass(\"collapse in\")[g](\"\"),this.transitioning=0,this.$element.trigger(\"shown.bs.collapse\")};if(!a.support.transition)return h.call(this);var i=a.camelCase([\"scroll\",g].join(\"-\"));this.$element.one(\"bsTransitionEnd\",a.proxy(h,this)).emulateTransitionEnd(d.TRANSITION_DURATION)[g](this.$element[0][i])}}}},d.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass(\"in\")){var b=a.Event(\"hide.bs.collapse\");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.dimension();this.$element[c](this.$element[c]())[0].offsetHeight,this.$element.addClass(\"collapsing\").removeClass(\"collapse in\").attr(\"aria-expanded\",!1),this.$trigger.addClass(\"collapsed\").attr(\"aria-expanded\",!1),this.transitioning=1;var e=function(){this.transitioning=0,this.$element.removeClass(\"collapsing\").addClass(\"collapse\").trigger(\"hidden.bs.collapse\")};return a.support.transition?void this.$element[c](0).one(\"bsTransitionEnd\",a.proxy(e,this)).emulateTransitionEnd(d.TRANSITION_DURATION):e.call(this)}}},d.prototype.toggle=function(){this[this.$element.hasClass(\"in\")?\"hide\":\"show\"]()},d.prototype.getParent=function(){return a(this.options.parent).find('[data-toggle=\"collapse\"][data-parent=\"'+this.options.parent+'\"]').each(a.proxy(function(c,d){var e=a(d);this.addAriaAndCollapsedClass(b(e),e)},this)).end()},d.prototype.addAriaAndCollapsedClass=function(a,b){var c=a.hasClass(\"in\");a.attr(\"aria-expanded\",c),b.toggleClass(\"collapsed\",!c).attr(\"aria-expanded\",c)};var e=a.fn.collapse;a.fn.collapse=c,a.fn.collapse.Constructor=d,a.fn.collapse.noConflict=function(){return a.fn.collapse=e,this},a(document).on(\"click.bs.collapse.data-api\",'[data-toggle=\"collapse\"]',function(d){var e=a(this);e.attr(\"data-target\")||d.preventDefault();var f=b(e),g=f.data(\"bs.collapse\"),h=g?\"toggle\":e.data();c.call(f,h)})}(jQuery),+function(a){\"use strict\";function b(b){var c=b.attr(\"data-target\");c||(c=b.attr(\"href\"),c=c&&/#[A-Za-z]/.test(c)&&c.replace(/.*(?=#[^\\s]*$)/,\"\"));var d=c&&a(c);return d&&d.length?d:b.parent()}function c(c){c&&3===c.which||(a(e).remove(),a(f).each(function(){var d=a(this),e=b(d),f={relatedTarget:this};e.hasClass(\"open\")&&(c&&\"click\"==c.type&&/input|textarea/i.test(c.target.tagName)&&a.contains(e[0],c.target)||(e.trigger(c=a.Event(\"hide.bs.dropdown\",f)),c.isDefaultPrevented()||(d.attr(\"aria-expanded\",\"false\"),e.removeClass(\"open\").trigger(\"hidden.bs.dropdown\",f))))}))}function d(b){return this.each(function(){var c=a(this),d=c.data(\"bs.dropdown\");d||c.data(\"bs.dropdown\",d=new g(this)),\"string\"==typeof b&&d[b].call(c)})}var e=\".dropdown-backdrop\",f='[data-toggle=\"dropdown\"]',g=function(b){a(b).on(\"click.bs.dropdown\",this.toggle)};g.VERSION=\"3.3.5\",g.prototype.toggle=function(d){var e=a(this);if(!e.is(\".disabled, :disabled\")){var f=b(e),g=f.hasClass(\"open\");if(c(),!g){\"ontouchstart\"in document.documentElement&&!f.closest(\".navbar-nav\").length&&a(document.createElement(\"div\")).addClass(\"dropdown-backdrop\").insertAfter(a(this)).on(\"click\",c);var h={relatedTarget:this};if(f.trigger(d=a.Event(\"show.bs.dropdown\",h)),d.isDefaultPrevented())return;e.trigger(\"focus\").attr(\"aria-expanded\",\"true\"),f.toggleClass(\"open\").trigger(\"shown.bs.dropdown\",h)}return!1}},g.prototype.keydown=function(c){if(/(38|40|27|32)/.test(c.which)&&!/input|textarea/i.test(c.target.tagName)){var d=a(this);if(c.preventDefault(),c.stopPropagation(),!d.is(\".disabled, :disabled\")){var e=b(d),g=e.hasClass(\"open\");if(!g&&27!=c.which||g&&27==c.which)return 27==c.which&&e.find(f).trigger(\"focus\"),d.trigger(\"click\");var h=\" li:not(.disabled):visible a\",i=e.find(\".dropdown-menu\"+h);if(i.length){var j=i.index(c.target);38==c.which&&j>0&&j--,40==c.which&&j<i.length-1&&j++,~j||(j=0),i.eq(j).trigger(\"focus\")}}}};var h=a.fn.dropdown;a.fn.dropdown=d,a.fn.dropdown.Constructor=g,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=h,this},a(document).on(\"click.bs.dropdown.data-api\",c).on(\"click.bs.dropdown.data-api\",\".dropdown form\",function(a){a.stopPropagation()}).on(\"click.bs.dropdown.data-api\",f,g.prototype.toggle).on(\"keydown.bs.dropdown.data-api\",f,g.prototype.keydown).on(\"keydown.bs.dropdown.data-api\",\".dropdown-menu\",g.prototype.keydown)}(jQuery),+function(a){\"use strict\";function b(b,d){return this.each(function(){var e=a(this),f=e.data(\"bs.modal\"),g=a.extend({},c.DEFAULTS,e.data(),\"object\"==typeof b&&b);f||e.data(\"bs.modal\",f=new c(this,g)),\"string\"==typeof b?f[b](d):g.show&&f.show(d)})}var c=function(b,c){this.options=c,this.$body=a(document.body),this.$element=a(b),this.$dialog=this.$element.find(\".modal-dialog\"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(\".modal-content\").load(this.options.remote,a.proxy(function(){this.$element.trigger(\"loaded.bs.modal\")},this))};c.VERSION=\"3.3.5\",c.TRANSITION_DURATION=300,c.BACKDROP_TRANSITION_DURATION=150,c.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},c.prototype.toggle=function(a){return this.isShown?this.hide():this.show(a)},c.prototype.show=function(b){var d=this,e=a.Event(\"show.bs.modal\",{relatedTarget:b});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass(\"modal-open\"),this.escape(),this.resize(),this.$element.on(\"click.dismiss.bs.modal\",'[data-dismiss=\"modal\"]',a.proxy(this.hide,this)),this.$dialog.on(\"mousedown.dismiss.bs.modal\",function(){d.$element.one(\"mouseup.dismiss.bs.modal\",function(b){a(b.target).is(d.$element)&&(d.ignoreBackdropClick=!0)})}),this.backdrop(function(){var e=a.support.transition&&d.$element.hasClass(\"fade\");d.$element.parent().length||d.$element.appendTo(d.$body),d.$element.show().scrollTop(0),d.adjustDialog(),e&&d.$element[0].offsetWidth,d.$element.addClass(\"in\"),d.enforceFocus();var f=a.Event(\"shown.bs.modal\",{relatedTarget:b});e?d.$dialog.one(\"bsTransitionEnd\",function(){d.$element.trigger(\"focus\").trigger(f)}).emulateTransitionEnd(c.TRANSITION_DURATION):d.$element.trigger(\"focus\").trigger(f)}))},c.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event(\"hide.bs.modal\"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),a(document).off(\"focusin.bs.modal\"),this.$element.removeClass(\"in\").off(\"click.dismiss.bs.modal\").off(\"mouseup.dismiss.bs.modal\"),this.$dialog.off(\"mousedown.dismiss.bs.modal\"),a.support.transition&&this.$element.hasClass(\"fade\")?this.$element.one(\"bsTransitionEnd\",a.proxy(this.hideModal,this)).emulateTransitionEnd(c.TRANSITION_DURATION):this.hideModal())},c.prototype.enforceFocus=function(){a(document).off(\"focusin.bs.modal\").on(\"focusin.bs.modal\",a.proxy(function(a){this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.trigger(\"focus\")},this))},c.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on(\"keydown.dismiss.bs.modal\",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off(\"keydown.dismiss.bs.modal\")},c.prototype.resize=function(){this.isShown?a(window).on(\"resize.bs.modal\",a.proxy(this.handleUpdate,this)):a(window).off(\"resize.bs.modal\")},c.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.$body.removeClass(\"modal-open\"),a.resetAdjustments(),a.resetScrollbar(),a.$element.trigger(\"hidden.bs.modal\")})},c.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},c.prototype.backdrop=function(b){var d=this,e=this.$element.hasClass(\"fade\")?\"fade\":\"\";if(this.isShown&&this.options.backdrop){var f=a.support.transition&&e;if(this.$backdrop=a(document.createElement(\"div\")).addClass(\"modal-backdrop \"+e).appendTo(this.$body),this.$element.on(\"click.dismiss.bs.modal\",a.proxy(function(a){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(a.target===a.currentTarget&&(\"static\"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),f&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass(\"in\"),!b)return;f?this.$backdrop.one(\"bsTransitionEnd\",b).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):b()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass(\"in\");var g=function(){d.removeBackdrop(),b&&b()};a.support.transition&&this.$element.hasClass(\"fade\")?this.$backdrop.one(\"bsTransitionEnd\",g).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):g()}else b&&b()},c.prototype.handleUpdate=function(){this.adjustDialog()},c.prototype.adjustDialog=function(){var a=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&a?this.scrollbarWidth:\"\",paddingRight:this.bodyIsOverflowing&&!a?this.scrollbarWidth:\"\"})},c.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:\"\",paddingRight:\"\"})},c.prototype.checkScrollbar=function(){var a=window.innerWidth;if(!a){var b=document.documentElement.getBoundingClientRect();a=b.right-Math.abs(b.left)}this.bodyIsOverflowing=document.body.clientWidth<a,this.scrollbarWidth=this.measureScrollbar()},c.prototype.setScrollbar=function(){var a=parseInt(this.$body.css(\"padding-right\")||0,10);this.originalBodyPad=document.body.style.paddingRight||\"\",this.bodyIsOverflowing&&this.$body.css(\"padding-right\",a+this.scrollbarWidth)},c.prototype.resetScrollbar=function(){this.$body.css(\"padding-right\",this.originalBodyPad)},c.prototype.measureScrollbar=function(){var a=document.createElement(\"div\");a.className=\"modal-scrollbar-measure\",this.$body.append(a);var b=a.offsetWidth-a.clientWidth;return this.$body[0].removeChild(a),b};var d=a.fn.modal;a.fn.modal=b,a.fn.modal.Constructor=c,a.fn.modal.noConflict=function(){return a.fn.modal=d,this},a(document).on(\"click.bs.modal.data-api\",'[data-toggle=\"modal\"]',function(c){var d=a(this),e=d.attr(\"href\"),f=a(d.attr(\"data-target\")||e&&e.replace(/.*(?=#[^\\s]+$)/,\"\")),g=f.data(\"bs.modal\")?\"toggle\":a.extend({remote:!/#/.test(e)&&e},f.data(),d.data());d.is(\"a\")&&c.preventDefault(),f.one(\"show.bs.modal\",function(a){a.isDefaultPrevented()||f.one(\"hidden.bs.modal\",function(){d.is(\":visible\")&&d.trigger(\"focus\")})}),b.call(f,g,this)})}(jQuery),+function(a){\"use strict\";function b(b){return this.each(function(){var d=a(this),e=d.data(\"bs.tooltip\"),f=\"object\"==typeof b&&b;(e||!/destroy|hide/.test(b))&&(e||d.data(\"bs.tooltip\",e=new c(this,f)),\"string\"==typeof b&&e[b]())})}var c=function(a,b){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init(\"tooltip\",a,b)};c.VERSION=\"3.3.5\",c.TRANSITION_DURATION=150,c.DEFAULTS={animation:!0,placement:\"top\",selector:!1,template:'<div class=\"tooltip\" role=\"tooltip\"><div class=\"tooltip-arrow\"></div><div class=\"tooltip-inner\"></div></div>',trigger:\"hover focus\",title:\"\",delay:0,html:!1,container:!1,viewport:{selector:\"body\",padding:0}},c.prototype.init=function(b,c,d){if(this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.$viewport=this.options.viewport&&a(a.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error(\"`selector` option must be specified when initializing \"+this.type+\" on the window.document object!\");for(var e=this.options.trigger.split(\" \"),f=e.length;f--;){var g=e[f];if(\"click\"==g)this.$element.on(\"click.\"+this.type,this.options.selector,a.proxy(this.toggle,this));else if(\"manual\"!=g){var h=\"hover\"==g?\"mouseenter\":\"focusin\",i=\"hover\"==g?\"mouseleave\":\"focusout\";this.$element.on(h+\".\"+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+\".\"+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:\"manual\",selector:\"\"}):this.fixTitle()},c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&\"number\"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},c.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},c.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data(\"bs.\"+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data(\"bs.\"+this.type,c)),b instanceof a.Event&&(c.inState[\"focusin\"==b.type?\"focus\":\"hover\"]=!0),c.tip().hasClass(\"in\")||\"in\"==c.hoverState?void(c.hoverState=\"in\"):(clearTimeout(c.timeout),c.hoverState=\"in\",c.options.delay&&c.options.delay.show?void(c.timeout=setTimeout(function(){\"in\"==c.hoverState&&c.show()},c.options.delay.show)):c.show())},c.prototype.isInStateTrue=function(){for(var a in this.inState)if(this.inState[a])return!0;return!1},c.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data(\"bs.\"+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data(\"bs.\"+this.type,c)),b instanceof a.Event&&(c.inState[\"focusout\"==b.type?\"focus\":\"hover\"]=!1),c.isInStateTrue()?void 0:(clearTimeout(c.timeout),c.hoverState=\"out\",c.options.delay&&c.options.delay.hide?void(c.timeout=setTimeout(function(){\"out\"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide())},c.prototype.show=function(){var b=a.Event(\"show.bs.\"+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(b);var d=a.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(b.isDefaultPrevented()||!d)return;var e=this,f=this.tip(),g=this.getUID(this.type);this.setContent(),f.attr(\"id\",g),this.$element.attr(\"aria-describedby\",g),this.options.animation&&f.addClass(\"fade\");var h=\"function\"==typeof this.options.placement?this.options.placement.call(this,f[0],this.$element[0]):this.options.placement,i=/\\s?auto?\\s?/i,j=i.test(h);j&&(h=h.replace(i,\"\")||\"top\"),f.detach().css({top:0,left:0,display:\"block\"}).addClass(h).data(\"bs.\"+this.type,this),this.options.container?f.appendTo(this.options.container):f.insertAfter(this.$element),this.$element.trigger(\"inserted.bs.\"+this.type);var k=this.getPosition(),l=f[0].offsetWidth,m=f[0].offsetHeight;if(j){var n=h,o=this.getPosition(this.$viewport);h=\"bottom\"==h&&k.bottom+m>o.bottom?\"top\":\"top\"==h&&k.top-m<o.top?\"bottom\":\"right\"==h&&k.right+l>o.width?\"left\":\"left\"==h&&k.left-l<o.left?\"right\":h,f.removeClass(n).addClass(h)}var p=this.getCalculatedOffset(h,k,l,m);this.applyPlacement(p,h);var q=function(){var a=e.hoverState;e.$element.trigger(\"shown.bs.\"+e.type),e.hoverState=null,\"out\"==a&&e.leave(e)};a.support.transition&&this.$tip.hasClass(\"fade\")?f.one(\"bsTransitionEnd\",q).emulateTransitionEnd(c.TRANSITION_DURATION):q()}},c.prototype.applyPlacement=function(b,c){var d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css(\"margin-top\"),10),h=parseInt(d.css(\"margin-left\"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),b.top+=g,b.left+=h,a.offset.setOffset(d[0],a.extend({using:function(a){d.css({top:Math.round(a.top),left:Math.round(a.left)})}},b),0),d.addClass(\"in\");var i=d[0].offsetWidth,j=d[0].offsetHeight;\"top\"==c&&j!=f&&(b.top=b.top+f-j);var k=this.getViewportAdjustedDelta(c,b,i,j);k.left?b.left+=k.left:b.top+=k.top;var l=/top|bottom/.test(c),m=l?2*k.left-e+i:2*k.top-f+j,n=l?\"offsetWidth\":\"offsetHeight\";d.offset(b),this.replaceArrow(m,d[0][n],l)},c.prototype.replaceArrow=function(a,b,c){this.arrow().css(c?\"left\":\"top\",50*(1-a/b)+\"%\").css(c?\"top\":\"left\",\"\")},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(\".tooltip-inner\")[this.options.html?\"html\":\"text\"](b),a.removeClass(\"fade in top bottom left right\")},c.prototype.hide=function(b){function d(){\"in\"!=e.hoverState&&f.detach(),e.$element.removeAttr(\"aria-describedby\").trigger(\"hidden.bs.\"+e.type),b&&b()}var e=this,f=a(this.$tip),g=a.Event(\"hide.bs.\"+this.type);return this.$element.trigger(g),g.isDefaultPrevented()?void 0:(f.removeClass(\"in\"),a.support.transition&&f.hasClass(\"fade\")?f.one(\"bsTransitionEnd\",d).emulateTransitionEnd(c.TRANSITION_DURATION):d(),this.hoverState=null,this)},c.prototype.fixTitle=function(){var a=this.$element;(a.attr(\"title\")||\"string\"!=typeof a.attr(\"data-original-title\"))&&a.attr(\"data-original-title\",a.attr(\"title\")||\"\").attr(\"title\",\"\")},c.prototype.hasContent=function(){return this.getTitle()},c.prototype.getPosition=function(b){b=b||this.$element;var c=b[0],d=\"BODY\"==c.tagName,e=c.getBoundingClientRect();null==e.width&&(e=a.extend({},e,{width:e.right-e.left,height:e.bottom-e.top}));var f=d?{top:0,left:0}:b.offset(),g={scroll:d?document.documentElement.scrollTop||document.body.scrollTop:b.scrollTop()},h=d?{width:a(window).width(),height:a(window).height()}:null;return a.extend({},e,g,h,f)},c.prototype.getCalculatedOffset=function(a,b,c,d){return\"bottom\"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:\"top\"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:\"left\"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},c.prototype.getViewportAdjustedDelta=function(a,b,c,d){var e={top:0,left:0};if(!this.$viewport)return e;var f=this.options.viewport&&this.options.viewport.padding||0,g=this.getPosition(this.$viewport);if(/right|left/.test(a)){var h=b.top-f-g.scroll,i=b.top+f-g.scroll+d;h<g.top?e.top=g.top-h:i>g.top+g.height&&(e.top=g.top+g.height-i)}else{var j=b.left-f,k=b.left+f+c;j<g.left?e.left=g.left-j:k>g.right&&(e.left=g.left+g.width-k)}return e},c.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr(\"data-original-title\")||(\"function\"==typeof c.title?c.title.call(b[0]):c.title)},c.prototype.getUID=function(a){do a+=~~(1e6*Math.random());while(document.getElementById(a));return a},c.prototype.tip=function(){if(!this.$tip&&(this.$tip=a(this.options.template),1!=this.$tip.length))throw new Error(this.type+\" `template` option must consist of exactly 1 top-level element!\");return this.$tip},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(\".tooltip-arrow\")},c.prototype.enable=function(){this.enabled=!0},c.prototype.disable=function(){this.enabled=!1},c.prototype.toggleEnabled=function(){this.enabled=!this.enabled},c.prototype.toggle=function(b){var c=this;b&&(c=a(b.currentTarget).data(\"bs.\"+this.type),c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data(\"bs.\"+this.type,c))),b?(c.inState.click=!c.inState.click,c.isInStateTrue()?c.enter(c):c.leave(c)):c.tip().hasClass(\"in\")?c.leave(c):c.enter(c)},c.prototype.destroy=function(){var a=this;clearTimeout(this.timeout),this.hide(function(){a.$element.off(\".\"+a.type).removeData(\"bs.\"+a.type),a.$tip&&a.$tip.detach(),a.$tip=null,a.$arrow=null,a.$viewport=null})};var d=a.fn.tooltip;a.fn.tooltip=b,a.fn.tooltip.Constructor=c,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=d,this}}(jQuery),+function(a){\"use strict\";function b(b){return this.each(function(){var d=a(this),e=d.data(\"bs.popover\"),f=\"object\"==typeof b&&b;(e||!/destroy|hide/.test(b))&&(e||d.data(\"bs.popover\",e=new c(this,f)),\"string\"==typeof b&&e[b]())})}var c=function(a,b){this.init(\"popover\",a,b)};if(!a.fn.tooltip)throw new Error(\"Popover requires tooltip.js\");c.VERSION=\"3.3.5\",c.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:\"right\",trigger:\"click\",content:\"\",template:'<div class=\"popover\" role=\"tooltip\"><div class=\"arrow\"></div><h3 class=\"popover-title\"></h3><div class=\"popover-content\"></div></div>'}),c.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),c.prototype.constructor=c,c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(\".popover-title\")[this.options.html?\"html\":\"text\"](b),a.find(\".popover-content\").children().detach().end()[this.options.html?\"string\"==typeof c?\"html\":\"append\":\"text\"](c),a.removeClass(\"fade top bottom left right in\"),a.find(\".popover-title\").html()||a.find(\".popover-title\").hide()},c.prototype.hasContent=function(){return this.getTitle()||this.getContent()},c.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr(\"data-content\")||(\"function\"==typeof b.content?b.content.call(a[0]):b.content)},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(\".arrow\")};var d=a.fn.popover;a.fn.popover=b,a.fn.popover.Constructor=c,a.fn.popover.noConflict=function(){return a.fn.popover=d,this}}(jQuery),+function(a){\"use strict\";function b(c,d){this.$body=a(document.body),this.$scrollElement=a(a(c).is(document.body)?window:c),this.options=a.extend({},b.DEFAULTS,d),this.selector=(this.options.target||\"\")+\" .nav li > a\",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on(\"scroll.bs.scrollspy\",a.proxy(this.process,this)),this.refresh(),this.process()}function c(c){return this.each(function(){var d=a(this),e=d.data(\"bs.scrollspy\"),f=\"object\"==typeof c&&c;e||d.data(\"bs.scrollspy\",e=new b(this,f)),\"string\"==typeof c&&e[c]()})}b.VERSION=\"3.3.5\",b.DEFAULTS={offset:10},b.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},b.prototype.refresh=function(){var b=this,c=\"offset\",d=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),a.isWindow(this.$scrollElement[0])||(c=\"position\",d=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var b=a(this),e=b.data(\"target\")||b.attr(\"href\"),f=/^#./.test(e)&&a(e);return f&&f.length&&f.is(\":visible\")&&[[f[c]().top+d,e]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){b.offsets.push(this[0]),b.targets.push(this[1])})},b.prototype.process=function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.getScrollHeight(),d=this.options.offset+c-this.$scrollElement.height(),e=this.offsets,f=this.targets,g=this.activeTarget;if(this.scrollHeight!=c&&this.refresh(),b>=d)return g!=(a=f[f.length-1])&&this.activate(a);if(g&&b<e[0])return this.activeTarget=null,this.clear();for(a=e.length;a--;)g!=f[a]&&b>=e[a]&&(void 0===e[a+1]||b<e[a+1])&&this.activate(f[a])},b.prototype.activate=function(b){this.activeTarget=b,this.clear();var c=this.selector+'[data-target=\"'+b+'\"],'+this.selector+'[href=\"'+b+'\"]',d=a(c).parents(\"li\").addClass(\"active\");d.parent(\".dropdown-menu\").length&&(d=d.closest(\"li.dropdown\").addClass(\"active\")),\nd.trigger(\"activate.bs.scrollspy\")},b.prototype.clear=function(){a(this.selector).parentsUntil(this.options.target,\".active\").removeClass(\"active\")};var d=a.fn.scrollspy;a.fn.scrollspy=c,a.fn.scrollspy.Constructor=b,a.fn.scrollspy.noConflict=function(){return a.fn.scrollspy=d,this},a(window).on(\"load.bs.scrollspy.data-api\",function(){a('[data-spy=\"scroll\"]').each(function(){var b=a(this);c.call(b,b.data())})})}(jQuery),+function(a){\"use strict\";function b(b){return this.each(function(){var d=a(this),e=d.data(\"bs.tab\");e||d.data(\"bs.tab\",e=new c(this)),\"string\"==typeof b&&e[b]()})}var c=function(b){this.element=a(b)};c.VERSION=\"3.3.5\",c.TRANSITION_DURATION=150,c.prototype.show=function(){var b=this.element,c=b.closest(\"ul:not(.dropdown-menu)\"),d=b.data(\"target\");if(d||(d=b.attr(\"href\"),d=d&&d.replace(/.*(?=#[^\\s]*$)/,\"\")),!b.parent(\"li\").hasClass(\"active\")){var e=c.find(\".active:last a\"),f=a.Event(\"hide.bs.tab\",{relatedTarget:b[0]}),g=a.Event(\"show.bs.tab\",{relatedTarget:e[0]});if(e.trigger(f),b.trigger(g),!g.isDefaultPrevented()&&!f.isDefaultPrevented()){var h=a(d);this.activate(b.closest(\"li\"),c),this.activate(h,h.parent(),function(){e.trigger({type:\"hidden.bs.tab\",relatedTarget:b[0]}),b.trigger({type:\"shown.bs.tab\",relatedTarget:e[0]})})}}},c.prototype.activate=function(b,d,e){function f(){g.removeClass(\"active\").find(\"> .dropdown-menu > .active\").removeClass(\"active\").end().find('[data-toggle=\"tab\"]').attr(\"aria-expanded\",!1),b.addClass(\"active\").find('[data-toggle=\"tab\"]').attr(\"aria-expanded\",!0),h?(b[0].offsetWidth,b.addClass(\"in\")):b.removeClass(\"fade\"),b.parent(\".dropdown-menu\").length&&b.closest(\"li.dropdown\").addClass(\"active\").end().find('[data-toggle=\"tab\"]').attr(\"aria-expanded\",!0),e&&e()}var g=d.find(\"> .active\"),h=e&&a.support.transition&&(g.length&&g.hasClass(\"fade\")||!!d.find(\"> .fade\").length);g.length&&h?g.one(\"bsTransitionEnd\",f).emulateTransitionEnd(c.TRANSITION_DURATION):f(),g.removeClass(\"in\")};var d=a.fn.tab;a.fn.tab=b,a.fn.tab.Constructor=c,a.fn.tab.noConflict=function(){return a.fn.tab=d,this};var e=function(c){c.preventDefault(),b.call(a(this),\"show\")};a(document).on(\"click.bs.tab.data-api\",'[data-toggle=\"tab\"]',e).on(\"click.bs.tab.data-api\",'[data-toggle=\"pill\"]',e)}(jQuery),+function(a){\"use strict\";function b(b){return this.each(function(){var d=a(this),e=d.data(\"bs.affix\"),f=\"object\"==typeof b&&b;e||d.data(\"bs.affix\",e=new c(this,f)),\"string\"==typeof b&&e[b]()})}var c=function(b,d){this.options=a.extend({},c.DEFAULTS,d),this.$target=a(this.options.target).on(\"scroll.bs.affix.data-api\",a.proxy(this.checkPosition,this)).on(\"click.bs.affix.data-api\",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(b),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};c.VERSION=\"3.3.5\",c.RESET=\"affix affix-top affix-bottom\",c.DEFAULTS={offset:0,target:window},c.prototype.getState=function(a,b,c,d){var e=this.$target.scrollTop(),f=this.$element.offset(),g=this.$target.height();if(null!=c&&\"top\"==this.affixed)return c>e?\"top\":!1;if(\"bottom\"==this.affixed)return null!=c?e+this.unpin<=f.top?!1:\"bottom\":a-d>=e+g?!1:\"bottom\";var h=null==this.affixed,i=h?e:f.top,j=h?g:b;return null!=c&&c>=e?\"top\":null!=d&&i+j>=a-d?\"bottom\":!1},c.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(c.RESET).addClass(\"affix\");var a=this.$target.scrollTop(),b=this.$element.offset();return this.pinnedOffset=b.top-a},c.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},c.prototype.checkPosition=function(){if(this.$element.is(\":visible\")){var b=this.$element.height(),d=this.options.offset,e=d.top,f=d.bottom,g=Math.max(a(document).height(),a(document.body).height());\"object\"!=typeof d&&(f=e=d),\"function\"==typeof e&&(e=d.top(this.$element)),\"function\"==typeof f&&(f=d.bottom(this.$element));var h=this.getState(g,b,e,f);if(this.affixed!=h){null!=this.unpin&&this.$element.css(\"top\",\"\");var i=\"affix\"+(h?\"-\"+h:\"\"),j=a.Event(i+\".bs.affix\");if(this.$element.trigger(j),j.isDefaultPrevented())return;this.affixed=h,this.unpin=\"bottom\"==h?this.getPinnedOffset():null,this.$element.removeClass(c.RESET).addClass(i).trigger(i.replace(\"affix\",\"affixed\")+\".bs.affix\")}\"bottom\"==h&&this.$element.offset({top:g-b-f})}};var d=a.fn.affix;a.fn.affix=b,a.fn.affix.Constructor=c,a.fn.affix.noConflict=function(){return a.fn.affix=d,this},a(window).on(\"load\",function(){a('[data-spy=\"affix\"]').each(function(){var c=a(this),d=c.data();d.offset=d.offset||{},null!=d.offsetBottom&&(d.offset.bottom=d.offsetBottom),null!=d.offsetTop&&(d.offset.top=d.offsetTop),b.call(c,d)})})}(jQuery);","\n/*\n|--------------------------------------------------------------------------\n| Generals\n|--------------------------------------------------------------------------\n*/\n\n$(function() {\n    $(\".non-form-btn\").bind(\"click\", function(e){\n        e.preventDefault();\n    });\n\n    $(\".delete-btn\").bind(\"click\", function(e){\n        e.preventDefault();\n        $('#deleteModal').modal('toggle');\n        var _parentForm = $(this).parent('form');\n        $('#deleteBtn').bind('click', function(){\n            _parentForm[0].submit();\n        });\n    });\n\n    $(\".delete-link-btn\").bind(\"click\", function(e){\n        e.preventDefault();\n        $('#deleteLinkModal').modal('toggle');\n        var _parentForm = $(this).parent('form');\n        $('#deleteLinkBtn').bind('click', function(){\n            _parentForm[0].submit();\n        });\n    });\n\n    $(\".delete-btn-confirm\").bind(\"click\", function(e){\n        e.preventDefault();\n    });\n\n    $('form.add, form.edit').submit(function(){\n        $('.loading-overlay').show();\n    });\n\n    $('a.slow-link').click(function(){\n        $('.loading-overlay').show();\n    });\n\n    $(window).resize(function(){\n        _setDashboard();\n    });\n\n    _setDashboard();\n});\n\n/*\n|--------------------------------------------------------------------------\n| Notifications - Growl Style\n|--------------------------------------------------------------------------\n*/\n\nfunction siravelNotify(message, _type) {\n    $(\".siravel-notification\").css(\"display\", \"block\");\n    $(\".siravel-notification\").addClass(_type);\n\n    $(\".siravel-notify-comment\").html(message);\n    $(\".siravel-notification\").animate({\n        right: \"20px\",\n    });\n\n    $(\".siravel-notify-closer-icon\").click(function(){\n        $(\".siravel-notification\").animate({\n            right: \"-300px\"\n        },\"\", function(){\n            $(\".siravel-notification\").css(\"display\", \"none\");\n            $(\".siravel-notify-comment\").html(\"\");\n        });\n    });\n\n    setTimeout(function(){\n        $(\".siravel-notification\").animate({\n            right: \"-300px\"\n        },\"\", function(){\n            $(\".siravel-notification\").css(\"display\", \"none\");\n            $(\".siravel-notify-comment\").html(\"\");\n        });\n    }, 8000);\n}\n\n/*\n|--------------------------------------------------------------------------\n| Twitter Typeahead - Taken straight from Twitter's docs\n|--------------------------------------------------------------------------\n*/\n\nvar typeaheadMatcher = function(strs) {\n    return function findMatches(q, cb) {\n        var matches, substringRegex;\n\n        // an array that will be populated with substring matches\n        matches = [];\n\n        // regex used to determine if a string contains the substring `q`\n        substrRegex = new RegExp(q, 'i');\n\n        // iterate through the pool of strings and for any string that\n        // contains the substring `q`, add it to the `matches` array\n        $.each(strs, function(i, str) {\n            if (substrRegex.test(str)) {\n                matches.push(str);\n            }\n        });\n\n        cb(matches);\n    };\n};\n","/*\n|--------------------------------------------------------------------------\n| Siravel JS\n|--------------------------------------------------------------------------\n*/\n\nvar _redactorConfig = {\n    toolbar: true,\n    visual: true,\n    minHeight: 175,\n    convertVideoLinks: true,\n    imageUpload: true,\n    buttonSource: true,\n    replaceDivs: false,\n    paragraphize: false,\n    pastePlaintext: true,\n    deniedTags: ['script'],\n    imageManagerJson: _url+'/siravel/api/images/list',\n    fileManagerJson: _url+'/siravel/api/files/list',\n    stockImageManagerJson: 'https://pixabay.com/api/',\n    plugins: ['table','video', 'fontcolor', 'imagemanager', 'stockimagemanager', 'filemanager', 'specialchar'],\n    buttons: ['html', 'formatting', 'fontcolor', 'bold', 'italic', 'underline', 'deleted', 'unorderedlist', 'orderedlist',\n          'outdent', 'indent', 'image', 'filemanager', 'stockimagemanager', 'video', 'link', 'alignment', 'horizontalrule'], // + 'underline'\n};\n\n$(window).load(function() {\n\n    $('.pull-down').each(function() {\n        var height = 300 - $(this).siblings('.thumbnail').height() - $(this).height() - 48;\n        $(this).css('margin-top', height);\n    });\n\n    $('textarea.redactor').redactor(_redactorConfig);\n});\n\n$(function(){\n    function _urlPrepare (title) {\n        return title.replace(/[^\\w\\s]/gi, '').replace(/ /g, '-').toLowerCase();\n    }\n\n    $('#Title, #Name').bind('keyup', function() {\n        $('#Url').val(_urlPrepare($(this).val()));\n    });\n\n    $('.timepicker').datetimepicker({ format: 'LT' });\n    $('.datepicker').datetimepicker({\n        format: 'YYYY-MM-DD'\n    });\n\n    $('.datetimepicker').datetimepicker({\n        showTodayButton: true,\n        format: 'YYYY-MM-DD h:m:s'\n    });\n\n    $('.tags').tagsinput();\n});\n","/*!\n * typeahead.js 0.11.1\n * https://github.com/twitter/typeahead.js\n * Copyright 2013-2015 Twitter, Inc. and other contributors; Licensed MIT\n */\n\n(function(root, factory) {\n    if (typeof define === \"function\" && define.amd) {\n        define(\"bloodhound\", [ \"jquery\" ], function(a0) {\n            return root[\"Bloodhound\"] = factory(a0);\n        });\n    } else if (typeof exports === \"object\") {\n        module.exports = factory(require(\"jquery\"));\n    } else {\n        root[\"Bloodhound\"] = factory(jQuery);\n    }\n})(this, function($) {\n    var _ = function() {\n        \"use strict\";\n        return {\n            isMsie: function() {\n                return /(msie|trident)/i.test(navigator.userAgent) ? navigator.userAgent.match(/(msie |rv:)(\\d+(.\\d+)?)/i)[2] : false;\n            },\n            isBlankString: function(str) {\n                return !str || /^\\s*$/.test(str);\n            },\n            escapeRegExChars: function(str) {\n                return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n            },\n            isString: function(obj) {\n                return typeof obj === \"string\";\n            },\n            isNumber: function(obj) {\n                return typeof obj === \"number\";\n            },\n            isArray: $.isArray,\n            isFunction: $.isFunction,\n            isObject: $.isPlainObject,\n            isUndefined: function(obj) {\n                return typeof obj === \"undefined\";\n            },\n            isElement: function(obj) {\n                return !!(obj && obj.nodeType === 1);\n            },\n            isJQuery: function(obj) {\n                return obj instanceof $;\n            },\n            toStr: function toStr(s) {\n                return _.isUndefined(s) || s === null ? \"\" : s + \"\";\n            },\n            bind: $.proxy,\n            each: function(collection, cb) {\n                $.each(collection, reverseArgs);\n                function reverseArgs(index, value) {\n                    return cb(value, index);\n                }\n            },\n            map: $.map,\n            filter: $.grep,\n            every: function(obj, test) {\n                var result = true;\n                if (!obj) {\n                    return result;\n                }\n                $.each(obj, function(key, val) {\n                    if (!(result = test.call(null, val, key, obj))) {\n                        return false;\n                    }\n                });\n                return !!result;\n            },\n            some: function(obj, test) {\n                var result = false;\n                if (!obj) {\n                    return result;\n                }\n                $.each(obj, function(key, val) {\n                    if (result = test.call(null, val, key, obj)) {\n                        return false;\n                    }\n                });\n                return !!result;\n            },\n            mixin: $.extend,\n            identity: function(x) {\n                return x;\n            },\n            clone: function(obj) {\n                return $.extend(true, {}, obj);\n            },\n            getIdGenerator: function() {\n                var counter = 0;\n                return function() {\n                    return counter++;\n                };\n            },\n            templatify: function templatify(obj) {\n                return $.isFunction(obj) ? obj : template;\n                function template() {\n                    return String(obj);\n                }\n            },\n            defer: function(fn) {\n                setTimeout(fn, 0);\n            },\n            debounce: function(func, wait, immediate) {\n                var timeout, result;\n                return function() {\n                    var context = this, args = arguments, later, callNow;\n                    later = function() {\n                        timeout = null;\n                        if (!immediate) {\n                            result = func.apply(context, args);\n                        }\n                    };\n                    callNow = immediate && !timeout;\n                    clearTimeout(timeout);\n                    timeout = setTimeout(later, wait);\n                    if (callNow) {\n                        result = func.apply(context, args);\n                    }\n                    return result;\n                };\n            },\n            throttle: function(func, wait) {\n                var context, args, timeout, result, previous, later;\n                previous = 0;\n                later = function() {\n                    previous = new Date();\n                    timeout = null;\n                    result = func.apply(context, args);\n                };\n                return function() {\n                    var now = new Date(), remaining = wait - (now - previous);\n                    context = this;\n                    args = arguments;\n                    if (remaining <= 0) {\n                        clearTimeout(timeout);\n                        timeout = null;\n                        previous = now;\n                        result = func.apply(context, args);\n                    } else if (!timeout) {\n                        timeout = setTimeout(later, remaining);\n                    }\n                    return result;\n                };\n            },\n            stringify: function(val) {\n                return _.isString(val) ? val : JSON.stringify(val);\n            },\n            noop: function() {}\n        };\n    }();\n    var VERSION = \"0.11.1\";\n    var tokenizers = function() {\n        \"use strict\";\n        return {\n            nonword: nonword,\n            whitespace: whitespace,\n            obj: {\n                nonword: getObjTokenizer(nonword),\n                whitespace: getObjTokenizer(whitespace)\n            }\n        };\n        function whitespace(str) {\n            str = _.toStr(str);\n            return str ? str.split(/\\s+/) : [];\n        }\n        function nonword(str) {\n            str = _.toStr(str);\n            return str ? str.split(/\\W+/) : [];\n        }\n        function getObjTokenizer(tokenizer) {\n            return function setKey(keys) {\n                keys = _.isArray(keys) ? keys : [].slice.call(arguments, 0);\n                return function tokenize(o) {\n                    var tokens = [];\n                    _.each(keys, function(k) {\n                        tokens = tokens.concat(tokenizer(_.toStr(o[k])));\n                    });\n                    return tokens;\n                };\n            };\n        }\n    }();\n    var LruCache = function() {\n        \"use strict\";\n        function LruCache(maxSize) {\n            this.maxSize = _.isNumber(maxSize) ? maxSize : 100;\n            this.reset();\n            if (this.maxSize <= 0) {\n                this.set = this.get = $.noop;\n            }\n        }\n        _.mixin(LruCache.prototype, {\n            set: function set(key, val) {\n                var tailItem = this.list.tail, node;\n                if (this.size >= this.maxSize) {\n                    this.list.remove(tailItem);\n                    delete this.hash[tailItem.key];\n                    this.size--;\n                }\n                if (node = this.hash[key]) {\n                    node.val = val;\n                    this.list.moveToFront(node);\n                } else {\n                    node = new Node(key, val);\n                    this.list.add(node);\n                    this.hash[key] = node;\n                    this.size++;\n                }\n            },\n            get: function get(key) {\n                var node = this.hash[key];\n                if (node) {\n                    this.list.moveToFront(node);\n                    return node.val;\n                }\n            },\n            reset: function reset() {\n                this.size = 0;\n                this.hash = {};\n                this.list = new List();\n            }\n        });\n        function List() {\n            this.head = this.tail = null;\n        }\n        _.mixin(List.prototype, {\n            add: function add(node) {\n                if (this.head) {\n                    node.next = this.head;\n                    this.head.prev = node;\n                }\n                this.head = node;\n                this.tail = this.tail || node;\n            },\n            remove: function remove(node) {\n                node.prev ? node.prev.next = node.next : this.head = node.next;\n                node.next ? node.next.prev = node.prev : this.tail = node.prev;\n            },\n            moveToFront: function(node) {\n                this.remove(node);\n                this.add(node);\n            }\n        });\n        function Node(key, val) {\n            this.key = key;\n            this.val = val;\n            this.prev = this.next = null;\n        }\n        return LruCache;\n    }();\n    var PersistentStorage = function() {\n        \"use strict\";\n        var LOCAL_STORAGE;\n        try {\n            LOCAL_STORAGE = window.localStorage;\n            LOCAL_STORAGE.setItem(\"~~~\", \"!\");\n            LOCAL_STORAGE.removeItem(\"~~~\");\n        } catch (err) {\n            LOCAL_STORAGE = null;\n        }\n        function PersistentStorage(namespace, override) {\n            this.prefix = [ \"__\", namespace, \"__\" ].join(\"\");\n            this.ttlKey = \"__ttl__\";\n            this.keyMatcher = new RegExp(\"^\" + _.escapeRegExChars(this.prefix));\n            this.ls = override || LOCAL_STORAGE;\n            !this.ls && this._noop();\n        }\n        _.mixin(PersistentStorage.prototype, {\n            _prefix: function(key) {\n                return this.prefix + key;\n            },\n            _ttlKey: function(key) {\n                return this._prefix(key) + this.ttlKey;\n            },\n            _noop: function() {\n                this.get = this.set = this.remove = this.clear = this.isExpired = _.noop;\n            },\n            _safeSet: function(key, val) {\n                try {\n                    this.ls.setItem(key, val);\n                } catch (err) {\n                    if (err.name === \"QuotaExceededError\") {\n                        this.clear();\n                        this._noop();\n                    }\n                }\n            },\n            get: function(key) {\n                if (this.isExpired(key)) {\n                    this.remove(key);\n                }\n                return decode(this.ls.getItem(this._prefix(key)));\n            },\n            set: function(key, val, ttl) {\n                if (_.isNumber(ttl)) {\n                    this._safeSet(this._ttlKey(key), encode(now() + ttl));\n                } else {\n                    this.ls.removeItem(this._ttlKey(key));\n                }\n                return this._safeSet(this._prefix(key), encode(val));\n            },\n            remove: function(key) {\n                this.ls.removeItem(this._ttlKey(key));\n                this.ls.removeItem(this._prefix(key));\n                return this;\n            },\n            clear: function() {\n                var i, keys = gatherMatchingKeys(this.keyMatcher);\n                for (i = keys.length; i--; ) {\n                    this.remove(keys[i]);\n                }\n                return this;\n            },\n            isExpired: function(key) {\n                var ttl = decode(this.ls.getItem(this._ttlKey(key)));\n                return _.isNumber(ttl) && now() > ttl ? true : false;\n            }\n        });\n        return PersistentStorage;\n        function now() {\n            return new Date().getTime();\n        }\n        function encode(val) {\n            return JSON.stringify(_.isUndefined(val) ? null : val);\n        }\n        function decode(val) {\n            return $.parseJSON(val);\n        }\n        function gatherMatchingKeys(keyMatcher) {\n            var i, key, keys = [], len = LOCAL_STORAGE.length;\n            for (i = 0; i < len; i++) {\n                if ((key = LOCAL_STORAGE.key(i)).match(keyMatcher)) {\n                    keys.push(key.replace(keyMatcher, \"\"));\n                }\n            }\n            return keys;\n        }\n    }();\n    var Transport = function() {\n        \"use strict\";\n        var pendingRequestsCount = 0, pendingRequests = {}, maxPendingRequests = 6, sharedCache = new LruCache(10);\n        function Transport(o) {\n            o = o || {};\n            this.cancelled = false;\n            this.lastReq = null;\n            this._send = o.transport;\n            this._get = o.limiter ? o.limiter(this._get) : this._get;\n            this._cache = o.cache === false ? new LruCache(0) : sharedCache;\n        }\n        Transport.setMaxPendingRequests = function setMaxPendingRequests(num) {\n            maxPendingRequests = num;\n        };\n        Transport.resetCache = function resetCache() {\n            sharedCache.reset();\n        };\n        _.mixin(Transport.prototype, {\n            _fingerprint: function fingerprint(o) {\n                o = o || {};\n                return o.url + o.type + $.param(o.data || {});\n            },\n            _get: function(o, cb) {\n                var that = this, fingerprint, jqXhr;\n                fingerprint = this._fingerprint(o);\n                if (this.cancelled || fingerprint !== this.lastReq) {\n                    return;\n                }\n                if (jqXhr = pendingRequests[fingerprint]) {\n                    jqXhr.done(done).fail(fail);\n                } else if (pendingRequestsCount < maxPendingRequests) {\n                    pendingRequestsCount++;\n                    pendingRequests[fingerprint] = this._send(o).done(done).fail(fail).always(always);\n                } else {\n                    this.onDeckRequestArgs = [].slice.call(arguments, 0);\n                }\n                function done(resp) {\n                    cb(null, resp);\n                    that._cache.set(fingerprint, resp);\n                }\n                function fail() {\n                    cb(true);\n                }\n                function always() {\n                    pendingRequestsCount--;\n                    delete pendingRequests[fingerprint];\n                    if (that.onDeckRequestArgs) {\n                        that._get.apply(that, that.onDeckRequestArgs);\n                        that.onDeckRequestArgs = null;\n                    }\n                }\n            },\n            get: function(o, cb) {\n                var resp, fingerprint;\n                cb = cb || $.noop;\n                o = _.isString(o) ? {\n                    url: o\n                } : o || {};\n                fingerprint = this._fingerprint(o);\n                this.cancelled = false;\n                this.lastReq = fingerprint;\n                if (resp = this._cache.get(fingerprint)) {\n                    cb(null, resp);\n                } else {\n                    this._get(o, cb);\n                }\n            },\n            cancel: function() {\n                this.cancelled = true;\n            }\n        });\n        return Transport;\n    }();\n    var SearchIndex = window.SearchIndex = function() {\n        \"use strict\";\n        var CHILDREN = \"c\", IDS = \"i\";\n        function SearchIndex(o) {\n            o = o || {};\n            if (!o.datumTokenizer || !o.queryTokenizer) {\n                $.error(\"datumTokenizer and queryTokenizer are both required\");\n            }\n            this.identify = o.identify || _.stringify;\n            this.datumTokenizer = o.datumTokenizer;\n            this.queryTokenizer = o.queryTokenizer;\n            this.reset();\n        }\n        _.mixin(SearchIndex.prototype, {\n            bootstrap: function bootstrap(o) {\n                this.datums = o.datums;\n                this.trie = o.trie;\n            },\n            add: function(data) {\n                var that = this;\n                data = _.isArray(data) ? data : [ data ];\n                _.each(data, function(datum) {\n                    var id, tokens;\n                    that.datums[id = that.identify(datum)] = datum;\n                    tokens = normalizeTokens(that.datumTokenizer(datum));\n                    _.each(tokens, function(token) {\n                        var node, chars, ch;\n                        node = that.trie;\n                        chars = token.split(\"\");\n                        while (ch = chars.shift()) {\n                            node = node[CHILDREN][ch] || (node[CHILDREN][ch] = newNode());\n                            node[IDS].push(id);\n                        }\n                    });\n                });\n            },\n            get: function get(ids) {\n                var that = this;\n                return _.map(ids, function(id) {\n                    return that.datums[id];\n                });\n            },\n            search: function search(query) {\n                var that = this, tokens, matches;\n                tokens = normalizeTokens(this.queryTokenizer(query));\n                _.each(tokens, function(token) {\n                    var node, chars, ch, ids;\n                    if (matches && matches.length === 0) {\n                        return false;\n                    }\n                    node = that.trie;\n                    chars = token.split(\"\");\n                    while (node && (ch = chars.shift())) {\n                        node = node[CHILDREN][ch];\n                    }\n                    if (node && chars.length === 0) {\n                        ids = node[IDS].slice(0);\n                        matches = matches ? getIntersection(matches, ids) : ids;\n                    } else {\n                        matches = [];\n                        return false;\n                    }\n                });\n                return matches ? _.map(unique(matches), function(id) {\n                    return that.datums[id];\n                }) : [];\n            },\n            all: function all() {\n                var values = [];\n                for (var key in this.datums) {\n                    values.push(this.datums[key]);\n                }\n                return values;\n            },\n            reset: function reset() {\n                this.datums = {};\n                this.trie = newNode();\n            },\n            serialize: function serialize() {\n                return {\n                    datums: this.datums,\n                    trie: this.trie\n                };\n            }\n        });\n        return SearchIndex;\n        function normalizeTokens(tokens) {\n            tokens = _.filter(tokens, function(token) {\n                return !!token;\n            });\n            tokens = _.map(tokens, function(token) {\n                return token.toLowerCase();\n            });\n            return tokens;\n        }\n        function newNode() {\n            var node = {};\n            node[IDS] = [];\n            node[CHILDREN] = {};\n            return node;\n        }\n        function unique(array) {\n            var seen = {}, uniques = [];\n            for (var i = 0, len = array.length; i < len; i++) {\n                if (!seen[array[i]]) {\n                    seen[array[i]] = true;\n                    uniques.push(array[i]);\n                }\n            }\n            return uniques;\n        }\n        function getIntersection(arrayA, arrayB) {\n            var ai = 0, bi = 0, intersection = [];\n            arrayA = arrayA.sort();\n            arrayB = arrayB.sort();\n            var lenArrayA = arrayA.length, lenArrayB = arrayB.length;\n            while (ai < lenArrayA && bi < lenArrayB) {\n                if (arrayA[ai] < arrayB[bi]) {\n                    ai++;\n                } else if (arrayA[ai] > arrayB[bi]) {\n                    bi++;\n                } else {\n                    intersection.push(arrayA[ai]);\n                    ai++;\n                    bi++;\n                }\n            }\n            return intersection;\n        }\n    }();\n    var Prefetch = function() {\n        \"use strict\";\n        var keys;\n        keys = {\n            data: \"data\",\n            protocol: \"protocol\",\n            thumbprint: \"thumbprint\"\n        };\n        function Prefetch(o) {\n            this.url = o.url;\n            this.ttl = o.ttl;\n            this.cache = o.cache;\n            this.prepare = o.prepare;\n            this.transform = o.transform;\n            this.transport = o.transport;\n            this.thumbprint = o.thumbprint;\n            this.storage = new PersistentStorage(o.cacheKey);\n        }\n        _.mixin(Prefetch.prototype, {\n            _settings: function settings() {\n                return {\n                    url: this.url,\n                    type: \"GET\",\n                    dataType: \"json\"\n                };\n            },\n            store: function store(data) {\n                if (!this.cache) {\n                    return;\n                }\n                this.storage.set(keys.data, data, this.ttl);\n                this.storage.set(keys.protocol, location.protocol, this.ttl);\n                this.storage.set(keys.thumbprint, this.thumbprint, this.ttl);\n            },\n            fromCache: function fromCache() {\n                var stored = {}, isExpired;\n                if (!this.cache) {\n                    return null;\n                }\n                stored.data = this.storage.get(keys.data);\n                stored.protocol = this.storage.get(keys.protocol);\n                stored.thumbprint = this.storage.get(keys.thumbprint);\n                isExpired = stored.thumbprint !== this.thumbprint || stored.protocol !== location.protocol;\n                return stored.data && !isExpired ? stored.data : null;\n            },\n            fromNetwork: function(cb) {\n                var that = this, settings;\n                if (!cb) {\n                    return;\n                }\n                settings = this.prepare(this._settings());\n                this.transport(settings).fail(onError).done(onResponse);\n                function onError() {\n                    cb(true);\n                }\n                function onResponse(resp) {\n                    cb(null, that.transform(resp));\n                }\n            },\n            clear: function clear() {\n                this.storage.clear();\n                return this;\n            }\n        });\n        return Prefetch;\n    }();\n    var Remote = function() {\n        \"use strict\";\n        function Remote(o) {\n            this.url = o.url;\n            this.prepare = o.prepare;\n            this.transform = o.transform;\n            this.transport = new Transport({\n                cache: o.cache,\n                limiter: o.limiter,\n                transport: o.transport\n            });\n        }\n        _.mixin(Remote.prototype, {\n            _settings: function settings() {\n                return {\n                    url: this.url,\n                    type: \"GET\",\n                    dataType: \"json\"\n                };\n            },\n            get: function get(query, cb) {\n                var that = this, settings;\n                if (!cb) {\n                    return;\n                }\n                query = query || \"\";\n                settings = this.prepare(query, this._settings());\n                return this.transport.get(settings, onResponse);\n                function onResponse(err, resp) {\n                    err ? cb([]) : cb(that.transform(resp));\n                }\n            },\n            cancelLastRequest: function cancelLastRequest() {\n                this.transport.cancel();\n            }\n        });\n        return Remote;\n    }();\n    var oParser = function() {\n        \"use strict\";\n        return function parse(o) {\n            var defaults, sorter;\n            defaults = {\n                initialize: true,\n                identify: _.stringify,\n                datumTokenizer: null,\n                queryTokenizer: null,\n                sufficient: 5,\n                sorter: null,\n                local: [],\n                prefetch: null,\n                remote: null\n            };\n            o = _.mixin(defaults, o || {});\n            !o.datumTokenizer && $.error(\"datumTokenizer is required\");\n            !o.queryTokenizer && $.error(\"queryTokenizer is required\");\n            sorter = o.sorter;\n            o.sorter = sorter ? function(x) {\n                return x.sort(sorter);\n            } : _.identity;\n            o.local = _.isFunction(o.local) ? o.local() : o.local;\n            o.prefetch = parsePrefetch(o.prefetch);\n            o.remote = parseRemote(o.remote);\n            return o;\n        };\n        function parsePrefetch(o) {\n            var defaults;\n            if (!o) {\n                return null;\n            }\n            defaults = {\n                url: null,\n                ttl: 24 * 60 * 60 * 1e3,\n                cache: true,\n                cacheKey: null,\n                thumbprint: \"\",\n                prepare: _.identity,\n                transform: _.identity,\n                transport: null\n            };\n            o = _.isString(o) ? {\n                url: o\n            } : o;\n            o = _.mixin(defaults, o);\n            !o.url && $.error(\"prefetch requires url to be set\");\n            o.transform = o.filter || o.transform;\n            o.cacheKey = o.cacheKey || o.url;\n            o.thumbprint = VERSION + o.thumbprint;\n            o.transport = o.transport ? callbackToDeferred(o.transport) : $.ajax;\n            return o;\n        }\n        function parseRemote(o) {\n            var defaults;\n            if (!o) {\n                return;\n            }\n            defaults = {\n                url: null,\n                cache: true,\n                prepare: null,\n                replace: null,\n                wildcard: null,\n                limiter: null,\n                rateLimitBy: \"debounce\",\n                rateLimitWait: 300,\n                transform: _.identity,\n                transport: null\n            };\n            o = _.isString(o) ? {\n                url: o\n            } : o;\n            o = _.mixin(defaults, o);\n            !o.url && $.error(\"remote requires url to be set\");\n            o.transform = o.filter || o.transform;\n            o.prepare = toRemotePrepare(o);\n            o.limiter = toLimiter(o);\n            o.transport = o.transport ? callbackToDeferred(o.transport) : $.ajax;\n            delete o.replace;\n            delete o.wildcard;\n            delete o.rateLimitBy;\n            delete o.rateLimitWait;\n            return o;\n        }\n        function toRemotePrepare(o) {\n            var prepare, replace, wildcard;\n            prepare = o.prepare;\n            replace = o.replace;\n            wildcard = o.wildcard;\n            if (prepare) {\n                return prepare;\n            }\n            if (replace) {\n                prepare = prepareByReplace;\n            } else if (o.wildcard) {\n                prepare = prepareByWildcard;\n            } else {\n                prepare = idenityPrepare;\n            }\n            return prepare;\n            function prepareByReplace(query, settings) {\n                settings.url = replace(settings.url, query);\n                return settings;\n            }\n            function prepareByWildcard(query, settings) {\n                settings.url = settings.url.replace(wildcard, encodeURIComponent(query));\n                return settings;\n            }\n            function idenityPrepare(query, settings) {\n                return settings;\n            }\n        }\n        function toLimiter(o) {\n            var limiter, method, wait;\n            limiter = o.limiter;\n            method = o.rateLimitBy;\n            wait = o.rateLimitWait;\n            if (!limiter) {\n                limiter = /^throttle$/i.test(method) ? throttle(wait) : debounce(wait);\n            }\n            return limiter;\n            function debounce(wait) {\n                return function debounce(fn) {\n                    return _.debounce(fn, wait);\n                };\n            }\n            function throttle(wait) {\n                return function throttle(fn) {\n                    return _.throttle(fn, wait);\n                };\n            }\n        }\n        function callbackToDeferred(fn) {\n            return function wrapper(o) {\n                var deferred = $.Deferred();\n                fn(o, onSuccess, onError);\n                return deferred;\n                function onSuccess(resp) {\n                    _.defer(function() {\n                        deferred.resolve(resp);\n                    });\n                }\n                function onError(err) {\n                    _.defer(function() {\n                        deferred.reject(err);\n                    });\n                }\n            };\n        }\n    }();\n    var Bloodhound = function() {\n        \"use strict\";\n        var old;\n        old = window && window.Bloodhound;\n        function Bloodhound(o) {\n            o = oParser(o);\n            this.sorter = o.sorter;\n            this.identify = o.identify;\n            this.sufficient = o.sufficient;\n            this.local = o.local;\n            this.remote = o.remote ? new Remote(o.remote) : null;\n            this.prefetch = o.prefetch ? new Prefetch(o.prefetch) : null;\n            this.index = new SearchIndex({\n                identify: this.identify,\n                datumTokenizer: o.datumTokenizer,\n                queryTokenizer: o.queryTokenizer\n            });\n            o.initialize !== false && this.initialize();\n        }\n        Bloodhound.noConflict = function noConflict() {\n            window && (window.Bloodhound = old);\n            return Bloodhound;\n        };\n        Bloodhound.tokenizers = tokenizers;\n        _.mixin(Bloodhound.prototype, {\n            __ttAdapter: function ttAdapter() {\n                var that = this;\n                return this.remote ? withAsync : withoutAsync;\n                function withAsync(query, sync, async) {\n                    return that.search(query, sync, async);\n                }\n                function withoutAsync(query, sync) {\n                    return that.search(query, sync);\n                }\n            },\n            _loadPrefetch: function loadPrefetch() {\n                var that = this, deferred, serialized;\n                deferred = $.Deferred();\n                if (!this.prefetch) {\n                    deferred.resolve();\n                } else if (serialized = this.prefetch.fromCache()) {\n                    this.index.bootstrap(serialized);\n                    deferred.resolve();\n                } else {\n                    this.prefetch.fromNetwork(done);\n                }\n                return deferred.promise();\n                function done(err, data) {\n                    if (err) {\n                        return deferred.reject();\n                    }\n                    that.add(data);\n                    that.prefetch.store(that.index.serialize());\n                    deferred.resolve();\n                }\n            },\n            _initialize: function initialize() {\n                var that = this, deferred;\n                this.clear();\n                (this.initPromise = this._loadPrefetch()).done(addLocalToIndex);\n                return this.initPromise;\n                function addLocalToIndex() {\n                    that.add(that.local);\n                }\n            },\n            initialize: function initialize(force) {\n                return !this.initPromise || force ? this._initialize() : this.initPromise;\n            },\n            add: function add(data) {\n                this.index.add(data);\n                return this;\n            },\n            get: function get(ids) {\n                ids = _.isArray(ids) ? ids : [].slice.call(arguments);\n                return this.index.get(ids);\n            },\n            search: function search(query, sync, async) {\n                var that = this, local;\n                local = this.sorter(this.index.search(query));\n                sync(this.remote ? local.slice() : local);\n                if (this.remote && local.length < this.sufficient) {\n                    this.remote.get(query, processRemote);\n                } else if (this.remote) {\n                    this.remote.cancelLastRequest();\n                }\n                return this;\n                function processRemote(remote) {\n                    var nonDuplicates = [];\n                    _.each(remote, function(r) {\n                        !_.some(local, function(l) {\n                            return that.identify(r) === that.identify(l);\n                        }) && nonDuplicates.push(r);\n                    });\n                    async && async(nonDuplicates);\n                }\n            },\n            all: function all() {\n                return this.index.all();\n            },\n            clear: function clear() {\n                this.index.reset();\n                return this;\n            },\n            clearPrefetchCache: function clearPrefetchCache() {\n                this.prefetch && this.prefetch.clear();\n                return this;\n            },\n            clearRemoteCache: function clearRemoteCache() {\n                Transport.resetCache();\n                return this;\n            },\n            ttAdapter: function ttAdapter() {\n                return this.__ttAdapter();\n            }\n        });\n        return Bloodhound;\n    }();\n    return Bloodhound;\n});\n\n(function(root, factory) {\n    if (typeof define === \"function\" && define.amd) {\n        define(\"typeahead.js\", [ \"jquery\" ], function(a0) {\n            return factory(a0);\n        });\n    } else if (typeof exports === \"object\") {\n        module.exports = factory(require(\"jquery\"));\n    } else {\n        factory(jQuery);\n    }\n})(this, function($) {\n    var _ = function() {\n        \"use strict\";\n        return {\n            isMsie: function() {\n                return /(msie|trident)/i.test(navigator.userAgent) ? navigator.userAgent.match(/(msie |rv:)(\\d+(.\\d+)?)/i)[2] : false;\n            },\n            isBlankString: function(str) {\n                return !str || /^\\s*$/.test(str);\n            },\n            escapeRegExChars: function(str) {\n                return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n            },\n            isString: function(obj) {\n                return typeof obj === \"string\";\n            },\n            isNumber: function(obj) {\n                return typeof obj === \"number\";\n            },\n            isArray: $.isArray,\n            isFunction: $.isFunction,\n            isObject: $.isPlainObject,\n            isUndefined: function(obj) {\n                return typeof obj === \"undefined\";\n            },\n            isElement: function(obj) {\n                return !!(obj && obj.nodeType === 1);\n            },\n            isJQuery: function(obj) {\n                return obj instanceof $;\n            },\n            toStr: function toStr(s) {\n                return _.isUndefined(s) || s === null ? \"\" : s + \"\";\n            },\n            bind: $.proxy,\n            each: function(collection, cb) {\n                $.each(collection, reverseArgs);\n                function reverseArgs(index, value) {\n                    return cb(value, index);\n                }\n            },\n            map: $.map,\n            filter: $.grep,\n            every: function(obj, test) {\n                var result = true;\n                if (!obj) {\n                    return result;\n                }\n                $.each(obj, function(key, val) {\n                    if (!(result = test.call(null, val, key, obj))) {\n                        return false;\n                    }\n                });\n                return !!result;\n            },\n            some: function(obj, test) {\n                var result = false;\n                if (!obj) {\n                    return result;\n                }\n                $.each(obj, function(key, val) {\n                    if (result = test.call(null, val, key, obj)) {\n                        return false;\n                    }\n                });\n                return !!result;\n            },\n            mixin: $.extend,\n            identity: function(x) {\n                return x;\n            },\n            clone: function(obj) {\n                return $.extend(true, {}, obj);\n            },\n            getIdGenerator: function() {\n                var counter = 0;\n                return function() {\n                    return counter++;\n                };\n            },\n            templatify: function templatify(obj) {\n                return $.isFunction(obj) ? obj : template;\n                function template() {\n                    return String(obj);\n                }\n            },\n            defer: function(fn) {\n                setTimeout(fn, 0);\n            },\n            debounce: function(func, wait, immediate) {\n                var timeout, result;\n                return function() {\n                    var context = this, args = arguments, later, callNow;\n                    later = function() {\n                        timeout = null;\n                        if (!immediate) {\n                            result = func.apply(context, args);\n                        }\n                    };\n                    callNow = immediate && !timeout;\n                    clearTimeout(timeout);\n                    timeout = setTimeout(later, wait);\n                    if (callNow) {\n                        result = func.apply(context, args);\n                    }\n                    return result;\n                };\n            },\n            throttle: function(func, wait) {\n                var context, args, timeout, result, previous, later;\n                previous = 0;\n                later = function() {\n                    previous = new Date();\n                    timeout = null;\n                    result = func.apply(context, args);\n                };\n                return function() {\n                    var now = new Date(), remaining = wait - (now - previous);\n                    context = this;\n                    args = arguments;\n                    if (remaining <= 0) {\n                        clearTimeout(timeout);\n                        timeout = null;\n                        previous = now;\n                        result = func.apply(context, args);\n                    } else if (!timeout) {\n                        timeout = setTimeout(later, remaining);\n                    }\n                    return result;\n                };\n            },\n            stringify: function(val) {\n                return _.isString(val) ? val : JSON.stringify(val);\n            },\n            noop: function() {}\n        };\n    }();\n    var WWW = function() {\n        \"use strict\";\n        var defaultClassNames = {\n            wrapper: \"twitter-typeahead\",\n            input: \"tt-input\",\n            hint: \"tt-hint\",\n            menu: \"tt-menu\",\n            dataset: \"tt-dataset\",\n            suggestion: \"tt-suggestion\",\n            selectable: \"tt-selectable\",\n            empty: \"tt-empty\",\n            open: \"tt-open\",\n            cursor: \"tt-cursor\",\n            highlight: \"tt-highlight\"\n        };\n        return build;\n        function build(o) {\n            var www, classes;\n            classes = _.mixin({}, defaultClassNames, o);\n            www = {\n                css: buildCss(),\n                classes: classes,\n                html: buildHtml(classes),\n                selectors: buildSelectors(classes)\n            };\n            return {\n                css: www.css,\n                html: www.html,\n                classes: www.classes,\n                selectors: www.selectors,\n                mixin: function(o) {\n                    _.mixin(o, www);\n                }\n            };\n        }\n        function buildHtml(c) {\n            return {\n                wrapper: '<span class=\"' + c.wrapper + '\"></span>',\n                menu: '<div class=\"' + c.menu + '\"></div>'\n            };\n        }\n        function buildSelectors(classes) {\n            var selectors = {};\n            _.each(classes, function(v, k) {\n                selectors[k] = \".\" + v;\n            });\n            return selectors;\n        }\n        function buildCss() {\n            var css = {\n                wrapper: {\n                    position: \"relative\",\n                    display: \"inline-block\"\n                },\n                hint: {\n                    position: \"absolute\",\n                    top: \"0\",\n                    left: \"0\",\n                    borderColor: \"transparent\",\n                    boxShadow: \"none\",\n                    opacity: \"1\"\n                },\n                input: {\n                    position: \"relative\",\n                    verticalAlign: \"top\",\n                    backgroundColor: \"transparent\"\n                },\n                inputWithNoHint: {\n                    position: \"relative\",\n                    verticalAlign: \"top\"\n                },\n                menu: {\n                    position: \"absolute\",\n                    top: \"100%\",\n                    left: \"0\",\n                    zIndex: \"100\",\n                    display: \"none\"\n                },\n                ltr: {\n                    left: \"0\",\n                    right: \"auto\"\n                },\n                rtl: {\n                    left: \"auto\",\n                    right: \" 0\"\n                }\n            };\n            if (_.isMsie()) {\n                _.mixin(css.input, {\n                    backgroundImage: \"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)\"\n                });\n            }\n            return css;\n        }\n    }();\n    var EventBus = function() {\n        \"use strict\";\n        var namespace, deprecationMap;\n        namespace = \"typeahead:\";\n        deprecationMap = {\n            render: \"rendered\",\n            cursorchange: \"cursorchanged\",\n            select: \"selected\",\n            autocomplete: \"autocompleted\"\n        };\n        function EventBus(o) {\n            if (!o || !o.el) {\n                $.error(\"EventBus initialized without el\");\n            }\n            this.$el = $(o.el);\n        }\n        _.mixin(EventBus.prototype, {\n            _trigger: function(type, args) {\n                var $e;\n                $e = $.Event(namespace + type);\n                (args = args || []).unshift($e);\n                this.$el.trigger.apply(this.$el, args);\n                return $e;\n            },\n            before: function(type) {\n                var args, $e;\n                args = [].slice.call(arguments, 1);\n                $e = this._trigger(\"before\" + type, args);\n                return $e.isDefaultPrevented();\n            },\n            trigger: function(type) {\n                var deprecatedType;\n                this._trigger(type, [].slice.call(arguments, 1));\n                if (deprecatedType = deprecationMap[type]) {\n                    this._trigger(deprecatedType, [].slice.call(arguments, 1));\n                }\n            }\n        });\n        return EventBus;\n    }();\n    var EventEmitter = function() {\n        \"use strict\";\n        var splitter = /\\s+/, nextTick = getNextTick();\n        return {\n            onSync: onSync,\n            onAsync: onAsync,\n            off: off,\n            trigger: trigger\n        };\n        function on(method, types, cb, context) {\n            var type;\n            if (!cb) {\n                return this;\n            }\n            types = types.split(splitter);\n            cb = context ? bindContext(cb, context) : cb;\n            this._callbacks = this._callbacks || {};\n            while (type = types.shift()) {\n                this._callbacks[type] = this._callbacks[type] || {\n                    sync: [],\n                    async: []\n                };\n                this._callbacks[type][method].push(cb);\n            }\n            return this;\n        }\n        function onAsync(types, cb, context) {\n            return on.call(this, \"async\", types, cb, context);\n        }\n        function onSync(types, cb, context) {\n            return on.call(this, \"sync\", types, cb, context);\n        }\n        function off(types) {\n            var type;\n            if (!this._callbacks) {\n                return this;\n            }\n            types = types.split(splitter);\n            while (type = types.shift()) {\n                delete this._callbacks[type];\n            }\n            return this;\n        }\n        function trigger(types) {\n            var type, callbacks, args, syncFlush, asyncFlush;\n            if (!this._callbacks) {\n                return this;\n            }\n            types = types.split(splitter);\n            args = [].slice.call(arguments, 1);\n            while ((type = types.shift()) && (callbacks = this._callbacks[type])) {\n                syncFlush = getFlush(callbacks.sync, this, [ type ].concat(args));\n                asyncFlush = getFlush(callbacks.async, this, [ type ].concat(args));\n                syncFlush() && nextTick(asyncFlush);\n            }\n            return this;\n        }\n        function getFlush(callbacks, context, args) {\n            return flush;\n            function flush() {\n                var cancelled;\n                for (var i = 0, len = callbacks.length; !cancelled && i < len; i += 1) {\n                    cancelled = callbacks[i].apply(context, args) === false;\n                }\n                return !cancelled;\n            }\n        }\n        function getNextTick() {\n            var nextTickFn;\n            if (window.setImmediate) {\n                nextTickFn = function nextTickSetImmediate(fn) {\n                    setImmediate(function() {\n                        fn();\n                    });\n                };\n            } else {\n                nextTickFn = function nextTickSetTimeout(fn) {\n                    setTimeout(function() {\n                        fn();\n                    }, 0);\n                };\n            }\n            return nextTickFn;\n        }\n        function bindContext(fn, context) {\n            return fn.bind ? fn.bind(context) : function() {\n                fn.apply(context, [].slice.call(arguments, 0));\n            };\n        }\n    }();\n    var highlight = function(doc) {\n        \"use strict\";\n        var defaults = {\n            node: null,\n            pattern: null,\n            tagName: \"strong\",\n            className: null,\n            wordsOnly: false,\n            caseSensitive: false\n        };\n        return function hightlight(o) {\n            var regex;\n            o = _.mixin({}, defaults, o);\n            if (!o.node || !o.pattern) {\n                return;\n            }\n            o.pattern = _.isArray(o.pattern) ? o.pattern : [ o.pattern ];\n            regex = getRegex(o.pattern, o.caseSensitive, o.wordsOnly);\n            traverse(o.node, hightlightTextNode);\n            function hightlightTextNode(textNode) {\n                var match, patternNode, wrapperNode;\n                if (match = regex.exec(textNode.data)) {\n                    wrapperNode = doc.createElement(o.tagName);\n                    o.className && (wrapperNode.className = o.className);\n                    patternNode = textNode.splitText(match.index);\n                    patternNode.splitText(match[0].length);\n                    wrapperNode.appendChild(patternNode.cloneNode(true));\n                    textNode.parentNode.replaceChild(wrapperNode, patternNode);\n                }\n                return !!match;\n            }\n            function traverse(el, hightlightTextNode) {\n                var childNode, TEXT_NODE_TYPE = 3;\n                for (var i = 0; i < el.childNodes.length; i++) {\n                    childNode = el.childNodes[i];\n                    if (childNode.nodeType === TEXT_NODE_TYPE) {\n                        i += hightlightTextNode(childNode) ? 1 : 0;\n                    } else {\n                        traverse(childNode, hightlightTextNode);\n                    }\n                }\n            }\n        };\n        function getRegex(patterns, caseSensitive, wordsOnly) {\n            var escapedPatterns = [], regexStr;\n            for (var i = 0, len = patterns.length; i < len; i++) {\n                escapedPatterns.push(_.escapeRegExChars(patterns[i]));\n            }\n            regexStr = wordsOnly ? \"\\\\b(\" + escapedPatterns.join(\"|\") + \")\\\\b\" : \"(\" + escapedPatterns.join(\"|\") + \")\";\n            return caseSensitive ? new RegExp(regexStr) : new RegExp(regexStr, \"i\");\n        }\n    }(window.document);\n    var Input = function() {\n        \"use strict\";\n        var specialKeyCodeMap;\n        specialKeyCodeMap = {\n            9: \"tab\",\n            27: \"esc\",\n            37: \"left\",\n            39: \"right\",\n            13: \"enter\",\n            38: \"up\",\n            40: \"down\"\n        };\n        function Input(o, www) {\n            o = o || {};\n            if (!o.input) {\n                $.error(\"input is missing\");\n            }\n            www.mixin(this);\n            this.$hint = $(o.hint);\n            this.$input = $(o.input);\n            this.query = this.$input.val();\n            this.queryWhenFocused = this.hasFocus() ? this.query : null;\n            this.$overflowHelper = buildOverflowHelper(this.$input);\n            this._checkLanguageDirection();\n            if (this.$hint.length === 0) {\n                this.setHint = this.getHint = this.clearHint = this.clearHintIfInvalid = _.noop;\n            }\n        }\n        Input.normalizeQuery = function(str) {\n            return _.toStr(str).replace(/^\\s*/g, \"\").replace(/\\s{2,}/g, \" \");\n        };\n        _.mixin(Input.prototype, EventEmitter, {\n            _onBlur: function onBlur() {\n                this.resetInputValue();\n                this.trigger(\"blurred\");\n            },\n            _onFocus: function onFocus() {\n                this.queryWhenFocused = this.query;\n                this.trigger(\"focused\");\n            },\n            _onKeydown: function onKeydown($e) {\n                var keyName = specialKeyCodeMap[$e.which || $e.keyCode];\n                this._managePreventDefault(keyName, $e);\n                if (keyName && this._shouldTrigger(keyName, $e)) {\n                    this.trigger(keyName + \"Keyed\", $e);\n                }\n            },\n            _onInput: function onInput() {\n                this._setQuery(this.getInputValue());\n                this.clearHintIfInvalid();\n                this._checkLanguageDirection();\n            },\n            _managePreventDefault: function managePreventDefault(keyName, $e) {\n                var preventDefault;\n                switch (keyName) {\n                  case \"up\":\n                  case \"down\":\n                    preventDefault = !withModifier($e);\n                    break;\n\n                  default:\n                    preventDefault = false;\n                }\n                preventDefault && $e.preventDefault();\n            },\n            _shouldTrigger: function shouldTrigger(keyName, $e) {\n                var trigger;\n                switch (keyName) {\n                  case \"tab\":\n                    trigger = !withModifier($e);\n                    break;\n\n                  default:\n                    trigger = true;\n                }\n                return trigger;\n            },\n            _checkLanguageDirection: function checkLanguageDirection() {\n                var dir = (this.$input.css(\"direction\") || \"ltr\").toLowerCase();\n                if (this.dir !== dir) {\n                    this.dir = dir;\n                    this.$hint.attr(\"dir\", dir);\n                    this.trigger(\"langDirChanged\", dir);\n                }\n            },\n            _setQuery: function setQuery(val, silent) {\n                var areEquivalent, hasDifferentWhitespace;\n                areEquivalent = areQueriesEquivalent(val, this.query);\n                hasDifferentWhitespace = areEquivalent ? this.query.length !== val.length : false;\n                this.query = val;\n                if (!silent && !areEquivalent) {\n                    this.trigger(\"queryChanged\", this.query);\n                } else if (!silent && hasDifferentWhitespace) {\n                    this.trigger(\"whitespaceChanged\", this.query);\n                }\n            },\n            bind: function() {\n                var that = this, onBlur, onFocus, onKeydown, onInput;\n                onBlur = _.bind(this._onBlur, this);\n                onFocus = _.bind(this._onFocus, this);\n                onKeydown = _.bind(this._onKeydown, this);\n                onInput = _.bind(this._onInput, this);\n                this.$input.on(\"blur.tt\", onBlur).on(\"focus.tt\", onFocus).on(\"keydown.tt\", onKeydown);\n                if (!_.isMsie() || _.isMsie() > 9) {\n                    this.$input.on(\"input.tt\", onInput);\n                } else {\n                    this.$input.on(\"keydown.tt keypress.tt cut.tt paste.tt\", function($e) {\n                        if (specialKeyCodeMap[$e.which || $e.keyCode]) {\n                            return;\n                        }\n                        _.defer(_.bind(that._onInput, that, $e));\n                    });\n                }\n                return this;\n            },\n            focus: function focus() {\n                this.$input.focus();\n            },\n            blur: function blur() {\n                this.$input.blur();\n            },\n            getLangDir: function getLangDir() {\n                return this.dir;\n            },\n            getQuery: function getQuery() {\n                return this.query || \"\";\n            },\n            setQuery: function setQuery(val, silent) {\n                this.setInputValue(val);\n                this._setQuery(val, silent);\n            },\n            hasQueryChangedSinceLastFocus: function hasQueryChangedSinceLastFocus() {\n                return this.query !== this.queryWhenFocused;\n            },\n            getInputValue: function getInputValue() {\n                return this.$input.val();\n            },\n            setInputValue: function setInputValue(value) {\n                this.$input.val(value);\n                this.clearHintIfInvalid();\n                this._checkLanguageDirection();\n            },\n            resetInputValue: function resetInputValue() {\n                this.setInputValue(this.query);\n            },\n            getHint: function getHint() {\n                return this.$hint.val();\n            },\n            setHint: function setHint(value) {\n                this.$hint.val(value);\n            },\n            clearHint: function clearHint() {\n                this.setHint(\"\");\n            },\n            clearHintIfInvalid: function clearHintIfInvalid() {\n                var val, hint, valIsPrefixOfHint, isValid;\n                val = this.getInputValue();\n                hint = this.getHint();\n                valIsPrefixOfHint = val !== hint && hint.indexOf(val) === 0;\n                isValid = val !== \"\" && valIsPrefixOfHint && !this.hasOverflow();\n                !isValid && this.clearHint();\n            },\n            hasFocus: function hasFocus() {\n                return this.$input.is(\":focus\");\n            },\n            hasOverflow: function hasOverflow() {\n                var constraint = this.$input.width() - 2;\n                this.$overflowHelper.text(this.getInputValue());\n                return this.$overflowHelper.width() >= constraint;\n            },\n            isCursorAtEnd: function() {\n                var valueLength, selectionStart, range;\n                valueLength = this.$input.val().length;\n                selectionStart = this.$input[0].selectionStart;\n                if (_.isNumber(selectionStart)) {\n                    return selectionStart === valueLength;\n                } else if (document.selection) {\n                    range = document.selection.createRange();\n                    range.moveStart(\"character\", -valueLength);\n                    return valueLength === range.text.length;\n                }\n                return true;\n            },\n            destroy: function destroy() {\n                this.$hint.off(\".tt\");\n                this.$input.off(\".tt\");\n                this.$overflowHelper.remove();\n                this.$hint = this.$input = this.$overflowHelper = $(\"<div>\");\n            }\n        });\n        return Input;\n        function buildOverflowHelper($input) {\n            return $('<pre aria-hidden=\"true\"></pre>').css({\n                position: \"absolute\",\n                visibility: \"hidden\",\n                whiteSpace: \"pre\",\n                fontFamily: $input.css(\"font-family\"),\n                fontSize: $input.css(\"font-size\"),\n                fontStyle: $input.css(\"font-style\"),\n                fontVariant: $input.css(\"font-variant\"),\n                fontWeight: $input.css(\"font-weight\"),\n                wordSpacing: $input.css(\"word-spacing\"),\n                letterSpacing: $input.css(\"letter-spacing\"),\n                textIndent: $input.css(\"text-indent\"),\n                textRendering: $input.css(\"text-rendering\"),\n                textTransform: $input.css(\"text-transform\")\n            }).insertAfter($input);\n        }\n        function areQueriesEquivalent(a, b) {\n            return Input.normalizeQuery(a) === Input.normalizeQuery(b);\n        }\n        function withModifier($e) {\n            return $e.altKey || $e.ctrlKey || $e.metaKey || $e.shiftKey;\n        }\n    }();\n    var Dataset = function() {\n        \"use strict\";\n        var keys, nameGenerator;\n        keys = {\n            val: \"tt-selectable-display\",\n            obj: \"tt-selectable-object\"\n        };\n        nameGenerator = _.getIdGenerator();\n        function Dataset(o, www) {\n            o = o || {};\n            o.templates = o.templates || {};\n            o.templates.notFound = o.templates.notFound || o.templates.empty;\n            if (!o.source) {\n                $.error(\"missing source\");\n            }\n            if (!o.node) {\n                $.error(\"missing node\");\n            }\n            if (o.name && !isValidName(o.name)) {\n                $.error(\"invalid dataset name: \" + o.name);\n            }\n            www.mixin(this);\n            this.highlight = !!o.highlight;\n            this.name = o.name || nameGenerator();\n            this.limit = o.limit || 5;\n            this.displayFn = getDisplayFn(o.display || o.displayKey);\n            this.templates = getTemplates(o.templates, this.displayFn);\n            this.source = o.source.__ttAdapter ? o.source.__ttAdapter() : o.source;\n            this.async = _.isUndefined(o.async) ? this.source.length > 2 : !!o.async;\n            this._resetLastSuggestion();\n            this.$el = $(o.node).addClass(this.classes.dataset).addClass(this.classes.dataset + \"-\" + this.name);\n        }\n        Dataset.extractData = function extractData(el) {\n            var $el = $(el);\n            if ($el.data(keys.obj)) {\n                return {\n                    val: $el.data(keys.val) || \"\",\n                    obj: $el.data(keys.obj) || null\n                };\n            }\n            return null;\n        };\n        _.mixin(Dataset.prototype, EventEmitter, {\n            _overwrite: function overwrite(query, suggestions) {\n                suggestions = suggestions || [];\n                if (suggestions.length) {\n                    this._renderSuggestions(query, suggestions);\n                } else if (this.async && this.templates.pending) {\n                    this._renderPending(query);\n                } else if (!this.async && this.templates.notFound) {\n                    this._renderNotFound(query);\n                } else {\n                    this._empty();\n                }\n                this.trigger(\"rendered\", this.name, suggestions, false);\n            },\n            _append: function append(query, suggestions) {\n                suggestions = suggestions || [];\n                if (suggestions.length && this.$lastSuggestion.length) {\n                    this._appendSuggestions(query, suggestions);\n                } else if (suggestions.length) {\n                    this._renderSuggestions(query, suggestions);\n                } else if (!this.$lastSuggestion.length && this.templates.notFound) {\n                    this._renderNotFound(query);\n                }\n                this.trigger(\"rendered\", this.name, suggestions, true);\n            },\n            _renderSuggestions: function renderSuggestions(query, suggestions) {\n                var $fragment;\n                $fragment = this._getSuggestionsFragment(query, suggestions);\n                this.$lastSuggestion = $fragment.children().last();\n                this.$el.html($fragment).prepend(this._getHeader(query, suggestions)).append(this._getFooter(query, suggestions));\n            },\n            _appendSuggestions: function appendSuggestions(query, suggestions) {\n                var $fragment, $lastSuggestion;\n                $fragment = this._getSuggestionsFragment(query, suggestions);\n                $lastSuggestion = $fragment.children().last();\n                this.$lastSuggestion.after($fragment);\n                this.$lastSuggestion = $lastSuggestion;\n            },\n            _renderPending: function renderPending(query) {\n                var template = this.templates.pending;\n                this._resetLastSuggestion();\n                template && this.$el.html(template({\n                    query: query,\n                    dataset: this.name\n                }));\n            },\n            _renderNotFound: function renderNotFound(query) {\n                var template = this.templates.notFound;\n                this._resetLastSuggestion();\n                template && this.$el.html(template({\n                    query: query,\n                    dataset: this.name\n                }));\n            },\n            _empty: function empty() {\n                this.$el.empty();\n                this._resetLastSuggestion();\n            },\n            _getSuggestionsFragment: function getSuggestionsFragment(query, suggestions) {\n                var that = this, fragment;\n                fragment = document.createDocumentFragment();\n                _.each(suggestions, function getSuggestionNode(suggestion) {\n                    var $el, context;\n                    context = that._injectQuery(query, suggestion);\n                    $el = $(that.templates.suggestion(context)).data(keys.obj, suggestion).data(keys.val, that.displayFn(suggestion)).addClass(that.classes.suggestion + \" \" + that.classes.selectable);\n                    fragment.appendChild($el[0]);\n                });\n                this.highlight && highlight({\n                    className: this.classes.highlight,\n                    node: fragment,\n                    pattern: query\n                });\n                return $(fragment);\n            },\n            _getFooter: function getFooter(query, suggestions) {\n                return this.templates.footer ? this.templates.footer({\n                    query: query,\n                    suggestions: suggestions,\n                    dataset: this.name\n                }) : null;\n            },\n            _getHeader: function getHeader(query, suggestions) {\n                return this.templates.header ? this.templates.header({\n                    query: query,\n                    suggestions: suggestions,\n                    dataset: this.name\n                }) : null;\n            },\n            _resetLastSuggestion: function resetLastSuggestion() {\n                this.$lastSuggestion = $();\n            },\n            _injectQuery: function injectQuery(query, obj) {\n                return _.isObject(obj) ? _.mixin({\n                    _query: query\n                }, obj) : obj;\n            },\n            update: function update(query) {\n                var that = this, canceled = false, syncCalled = false, rendered = 0;\n                this.cancel();\n                this.cancel = function cancel() {\n                    canceled = true;\n                    that.cancel = $.noop;\n                    that.async && that.trigger(\"asyncCanceled\", query);\n                };\n                this.source(query, sync, async);\n                !syncCalled && sync([]);\n                function sync(suggestions) {\n                    if (syncCalled) {\n                        return;\n                    }\n                    syncCalled = true;\n                    suggestions = (suggestions || []).slice(0, that.limit);\n                    rendered = suggestions.length;\n                    that._overwrite(query, suggestions);\n                    if (rendered < that.limit && that.async) {\n                        that.trigger(\"asyncRequested\", query);\n                    }\n                }\n                function async(suggestions) {\n                    suggestions = suggestions || [];\n                    if (!canceled && rendered < that.limit) {\n                        that.cancel = $.noop;\n                        rendered += suggestions.length;\n                        that._append(query, suggestions.slice(0, that.limit - rendered));\n                        that.async && that.trigger(\"asyncReceived\", query);\n                    }\n                }\n            },\n            cancel: $.noop,\n            clear: function clear() {\n                this._empty();\n                this.cancel();\n                this.trigger(\"cleared\");\n            },\n            isEmpty: function isEmpty() {\n                return this.$el.is(\":empty\");\n            },\n            destroy: function destroy() {\n                this.$el = $(\"<div>\");\n            }\n        });\n        return Dataset;\n        function getDisplayFn(display) {\n            display = display || _.stringify;\n            return _.isFunction(display) ? display : displayFn;\n            function displayFn(obj) {\n                return obj[display];\n            }\n        }\n        function getTemplates(templates, displayFn) {\n            return {\n                notFound: templates.notFound && _.templatify(templates.notFound),\n                pending: templates.pending && _.templatify(templates.pending),\n                header: templates.header && _.templatify(templates.header),\n                footer: templates.footer && _.templatify(templates.footer),\n                suggestion: templates.suggestion || suggestionTemplate\n            };\n            function suggestionTemplate(context) {\n                return $(\"<div>\").text(displayFn(context));\n            }\n        }\n        function isValidName(str) {\n            return /^[_a-zA-Z0-9-]+$/.test(str);\n        }\n    }();\n    var Menu = function() {\n        \"use strict\";\n        function Menu(o, www) {\n            var that = this;\n            o = o || {};\n            if (!o.node) {\n                $.error(\"node is required\");\n            }\n            www.mixin(this);\n            this.$node = $(o.node);\n            this.query = null;\n            this.datasets = _.map(o.datasets, initializeDataset);\n            function initializeDataset(oDataset) {\n                var node = that.$node.find(oDataset.node).first();\n                oDataset.node = node.length ? node : $(\"<div>\").appendTo(that.$node);\n                return new Dataset(oDataset, www);\n            }\n        }\n        _.mixin(Menu.prototype, EventEmitter, {\n            _onSelectableClick: function onSelectableClick($e) {\n                this.trigger(\"selectableClicked\", $($e.currentTarget));\n            },\n            _onRendered: function onRendered(type, dataset, suggestions, async) {\n                this.$node.toggleClass(this.classes.empty, this._allDatasetsEmpty());\n                this.trigger(\"datasetRendered\", dataset, suggestions, async);\n            },\n            _onCleared: function onCleared() {\n                this.$node.toggleClass(this.classes.empty, this._allDatasetsEmpty());\n                this.trigger(\"datasetCleared\");\n            },\n            _propagate: function propagate() {\n                this.trigger.apply(this, arguments);\n            },\n            _allDatasetsEmpty: function allDatasetsEmpty() {\n                return _.every(this.datasets, isDatasetEmpty);\n                function isDatasetEmpty(dataset) {\n                    return dataset.isEmpty();\n                }\n            },\n            _getSelectables: function getSelectables() {\n                return this.$node.find(this.selectors.selectable);\n            },\n            _removeCursor: function _removeCursor() {\n                var $selectable = this.getActiveSelectable();\n                $selectable && $selectable.removeClass(this.classes.cursor);\n            },\n            _ensureVisible: function ensureVisible($el) {\n                var elTop, elBottom, nodeScrollTop, nodeHeight;\n                elTop = $el.position().top;\n                elBottom = elTop + $el.outerHeight(true);\n                nodeScrollTop = this.$node.scrollTop();\n                nodeHeight = this.$node.height() + parseInt(this.$node.css(\"paddingTop\"), 10) + parseInt(this.$node.css(\"paddingBottom\"), 10);\n                if (elTop < 0) {\n                    this.$node.scrollTop(nodeScrollTop + elTop);\n                } else if (nodeHeight < elBottom) {\n                    this.$node.scrollTop(nodeScrollTop + (elBottom - nodeHeight));\n                }\n            },\n            bind: function() {\n                var that = this, onSelectableClick;\n                onSelectableClick = _.bind(this._onSelectableClick, this);\n                this.$node.on(\"click.tt\", this.selectors.selectable, onSelectableClick);\n                _.each(this.datasets, function(dataset) {\n                    dataset.onSync(\"asyncRequested\", that._propagate, that).onSync(\"asyncCanceled\", that._propagate, that).onSync(\"asyncReceived\", that._propagate, that).onSync(\"rendered\", that._onRendered, that).onSync(\"cleared\", that._onCleared, that);\n                });\n                return this;\n            },\n            isOpen: function isOpen() {\n                return this.$node.hasClass(this.classes.open);\n            },\n            open: function open() {\n                this.$node.addClass(this.classes.open);\n            },\n            close: function close() {\n                this.$node.removeClass(this.classes.open);\n                this._removeCursor();\n            },\n            setLanguageDirection: function setLanguageDirection(dir) {\n                this.$node.attr(\"dir\", dir);\n            },\n            selectableRelativeToCursor: function selectableRelativeToCursor(delta) {\n                var $selectables, $oldCursor, oldIndex, newIndex;\n                $oldCursor = this.getActiveSelectable();\n                $selectables = this._getSelectables();\n                oldIndex = $oldCursor ? $selectables.index($oldCursor) : -1;\n                newIndex = oldIndex + delta;\n                newIndex = (newIndex + 1) % ($selectables.length + 1) - 1;\n                newIndex = newIndex < -1 ? $selectables.length - 1 : newIndex;\n                return newIndex === -1 ? null : $selectables.eq(newIndex);\n            },\n            setCursor: function setCursor($selectable) {\n                this._removeCursor();\n                if ($selectable = $selectable && $selectable.first()) {\n                    $selectable.addClass(this.classes.cursor);\n                    this._ensureVisible($selectable);\n                }\n            },\n            getSelectableData: function getSelectableData($el) {\n                return $el && $el.length ? Dataset.extractData($el) : null;\n            },\n            getActiveSelectable: function getActiveSelectable() {\n                var $selectable = this._getSelectables().filter(this.selectors.cursor).first();\n                return $selectable.length ? $selectable : null;\n            },\n            getTopSelectable: function getTopSelectable() {\n                var $selectable = this._getSelectables().first();\n                return $selectable.length ? $selectable : null;\n            },\n            update: function update(query) {\n                var isValidUpdate = query !== this.query;\n                if (isValidUpdate) {\n                    this.query = query;\n                    _.each(this.datasets, updateDataset);\n                }\n                return isValidUpdate;\n                function updateDataset(dataset) {\n                    dataset.update(query);\n                }\n            },\n            empty: function empty() {\n                _.each(this.datasets, clearDataset);\n                this.query = null;\n                this.$node.addClass(this.classes.empty);\n                function clearDataset(dataset) {\n                    dataset.clear();\n                }\n            },\n            destroy: function destroy() {\n                this.$node.off(\".tt\");\n                this.$node = $(\"<div>\");\n                _.each(this.datasets, destroyDataset);\n                function destroyDataset(dataset) {\n                    dataset.destroy();\n                }\n            }\n        });\n        return Menu;\n    }();\n    var DefaultMenu = function() {\n        \"use strict\";\n        var s = Menu.prototype;\n        function DefaultMenu() {\n            Menu.apply(this, [].slice.call(arguments, 0));\n        }\n        _.mixin(DefaultMenu.prototype, Menu.prototype, {\n            open: function open() {\n                !this._allDatasetsEmpty() && this._show();\n                return s.open.apply(this, [].slice.call(arguments, 0));\n            },\n            close: function close() {\n                this._hide();\n                return s.close.apply(this, [].slice.call(arguments, 0));\n            },\n            _onRendered: function onRendered() {\n                if (this._allDatasetsEmpty()) {\n                    this._hide();\n                } else {\n                    this.isOpen() && this._show();\n                }\n                return s._onRendered.apply(this, [].slice.call(arguments, 0));\n            },\n            _onCleared: function onCleared() {\n                if (this._allDatasetsEmpty()) {\n                    this._hide();\n                } else {\n                    this.isOpen() && this._show();\n                }\n                return s._onCleared.apply(this, [].slice.call(arguments, 0));\n            },\n            setLanguageDirection: function setLanguageDirection(dir) {\n                this.$node.css(dir === \"ltr\" ? this.css.ltr : this.css.rtl);\n                return s.setLanguageDirection.apply(this, [].slice.call(arguments, 0));\n            },\n            _hide: function hide() {\n                this.$node.hide();\n            },\n            _show: function show() {\n                this.$node.css(\"display\", \"block\");\n            }\n        });\n        return DefaultMenu;\n    }();\n    var Typeahead = function() {\n        \"use strict\";\n        function Typeahead(o, www) {\n            var onFocused, onBlurred, onEnterKeyed, onTabKeyed, onEscKeyed, onUpKeyed, onDownKeyed, onLeftKeyed, onRightKeyed, onQueryChanged, onWhitespaceChanged;\n            o = o || {};\n            if (!o.input) {\n                $.error(\"missing input\");\n            }\n            if (!o.menu) {\n                $.error(\"missing menu\");\n            }\n            if (!o.eventBus) {\n                $.error(\"missing event bus\");\n            }\n            www.mixin(this);\n            this.eventBus = o.eventBus;\n            this.minLength = _.isNumber(o.minLength) ? o.minLength : 1;\n            this.input = o.input;\n            this.menu = o.menu;\n            this.enabled = true;\n            this.active = false;\n            this.input.hasFocus() && this.activate();\n            this.dir = this.input.getLangDir();\n            this._hacks();\n            this.menu.bind().onSync(\"selectableClicked\", this._onSelectableClicked, this).onSync(\"asyncRequested\", this._onAsyncRequested, this).onSync(\"asyncCanceled\", this._onAsyncCanceled, this).onSync(\"asyncReceived\", this._onAsyncReceived, this).onSync(\"datasetRendered\", this._onDatasetRendered, this).onSync(\"datasetCleared\", this._onDatasetCleared, this);\n            onFocused = c(this, \"activate\", \"open\", \"_onFocused\");\n            onBlurred = c(this, \"deactivate\", \"_onBlurred\");\n            onEnterKeyed = c(this, \"isActive\", \"isOpen\", \"_onEnterKeyed\");\n            onTabKeyed = c(this, \"isActive\", \"isOpen\", \"_onTabKeyed\");\n            onEscKeyed = c(this, \"isActive\", \"_onEscKeyed\");\n            onUpKeyed = c(this, \"isActive\", \"open\", \"_onUpKeyed\");\n            onDownKeyed = c(this, \"isActive\", \"open\", \"_onDownKeyed\");\n            onLeftKeyed = c(this, \"isActive\", \"isOpen\", \"_onLeftKeyed\");\n            onRightKeyed = c(this, \"isActive\", \"isOpen\", \"_onRightKeyed\");\n            onQueryChanged = c(this, \"_openIfActive\", \"_onQueryChanged\");\n            onWhitespaceChanged = c(this, \"_openIfActive\", \"_onWhitespaceChanged\");\n            this.input.bind().onSync(\"focused\", onFocused, this).onSync(\"blurred\", onBlurred, this).onSync(\"enterKeyed\", onEnterKeyed, this).onSync(\"tabKeyed\", onTabKeyed, this).onSync(\"escKeyed\", onEscKeyed, this).onSync(\"upKeyed\", onUpKeyed, this).onSync(\"downKeyed\", onDownKeyed, this).onSync(\"leftKeyed\", onLeftKeyed, this).onSync(\"rightKeyed\", onRightKeyed, this).onSync(\"queryChanged\", onQueryChanged, this).onSync(\"whitespaceChanged\", onWhitespaceChanged, this).onSync(\"langDirChanged\", this._onLangDirChanged, this);\n        }\n        _.mixin(Typeahead.prototype, {\n            _hacks: function hacks() {\n                var $input, $menu;\n                $input = this.input.$input || $(\"<div>\");\n                $menu = this.menu.$node || $(\"<div>\");\n                $input.on(\"blur.tt\", function($e) {\n                    var active, isActive, hasActive;\n                    active = document.activeElement;\n                    isActive = $menu.is(active);\n                    hasActive = $menu.has(active).length > 0;\n                    if (_.isMsie() && (isActive || hasActive)) {\n                        $e.preventDefault();\n                        $e.stopImmediatePropagation();\n                        _.defer(function() {\n                            $input.focus();\n                        });\n                    }\n                });\n                $menu.on(\"mousedown.tt\", function($e) {\n                    $e.preventDefault();\n                });\n            },\n            _onSelectableClicked: function onSelectableClicked(type, $el) {\n                this.select($el);\n            },\n            _onDatasetCleared: function onDatasetCleared() {\n                this._updateHint();\n            },\n            _onDatasetRendered: function onDatasetRendered(type, dataset, suggestions, async) {\n                this._updateHint();\n                this.eventBus.trigger(\"render\", suggestions, async, dataset);\n            },\n            _onAsyncRequested: function onAsyncRequested(type, dataset, query) {\n                this.eventBus.trigger(\"asyncrequest\", query, dataset);\n            },\n            _onAsyncCanceled: function onAsyncCanceled(type, dataset, query) {\n                this.eventBus.trigger(\"asynccancel\", query, dataset);\n            },\n            _onAsyncReceived: function onAsyncReceived(type, dataset, query) {\n                this.eventBus.trigger(\"asyncreceive\", query, dataset);\n            },\n            _onFocused: function onFocused() {\n                this._minLengthMet() && this.menu.update(this.input.getQuery());\n            },\n            _onBlurred: function onBlurred() {\n                if (this.input.hasQueryChangedSinceLastFocus()) {\n                    this.eventBus.trigger(\"change\", this.input.getQuery());\n                }\n            },\n            _onEnterKeyed: function onEnterKeyed(type, $e) {\n                var $selectable;\n                if ($selectable = this.menu.getActiveSelectable()) {\n                    this.select($selectable) && $e.preventDefault();\n                }\n            },\n            _onTabKeyed: function onTabKeyed(type, $e) {\n                var $selectable;\n                if ($selectable = this.menu.getActiveSelectable()) {\n                    this.select($selectable) && $e.preventDefault();\n                } else if ($selectable = this.menu.getTopSelectable()) {\n                    this.autocomplete($selectable) && $e.preventDefault();\n                }\n            },\n            _onEscKeyed: function onEscKeyed() {\n                this.close();\n            },\n            _onUpKeyed: function onUpKeyed() {\n                this.moveCursor(-1);\n            },\n            _onDownKeyed: function onDownKeyed() {\n                this.moveCursor(+1);\n            },\n            _onLeftKeyed: function onLeftKeyed() {\n                if (this.dir === \"rtl\" && this.input.isCursorAtEnd()) {\n                    this.autocomplete(this.menu.getTopSelectable());\n                }\n            },\n            _onRightKeyed: function onRightKeyed() {\n                if (this.dir === \"ltr\" && this.input.isCursorAtEnd()) {\n                    this.autocomplete(this.menu.getTopSelectable());\n                }\n            },\n            _onQueryChanged: function onQueryChanged(e, query) {\n                this._minLengthMet(query) ? this.menu.update(query) : this.menu.empty();\n            },\n            _onWhitespaceChanged: function onWhitespaceChanged() {\n                this._updateHint();\n            },\n            _onLangDirChanged: function onLangDirChanged(e, dir) {\n                if (this.dir !== dir) {\n                    this.dir = dir;\n                    this.menu.setLanguageDirection(dir);\n                }\n            },\n            _openIfActive: function openIfActive() {\n                this.isActive() && this.open();\n            },\n            _minLengthMet: function minLengthMet(query) {\n                query = _.isString(query) ? query : this.input.getQuery() || \"\";\n                return query.length >= this.minLength;\n            },\n            _updateHint: function updateHint() {\n                var $selectable, data, val, query, escapedQuery, frontMatchRegEx, match;\n                $selectable = this.menu.getTopSelectable();\n                data = this.menu.getSelectableData($selectable);\n                val = this.input.getInputValue();\n                if (data && !_.isBlankString(val) && !this.input.hasOverflow()) {\n                    query = Input.normalizeQuery(val);\n                    escapedQuery = _.escapeRegExChars(query);\n                    frontMatchRegEx = new RegExp(\"^(?:\" + escapedQuery + \")(.+$)\", \"i\");\n                    match = frontMatchRegEx.exec(data.val);\n                    match && this.input.setHint(val + match[1]);\n                } else {\n                    this.input.clearHint();\n                }\n            },\n            isEnabled: function isEnabled() {\n                return this.enabled;\n            },\n            enable: function enable() {\n                this.enabled = true;\n            },\n            disable: function disable() {\n                this.enabled = false;\n            },\n            isActive: function isActive() {\n                return this.active;\n            },\n            activate: function activate() {\n                if (this.isActive()) {\n                    return true;\n                } else if (!this.isEnabled() || this.eventBus.before(\"active\")) {\n                    return false;\n                } else {\n                    this.active = true;\n                    this.eventBus.trigger(\"active\");\n                    return true;\n                }\n            },\n            deactivate: function deactivate() {\n                if (!this.isActive()) {\n                    return true;\n                } else if (this.eventBus.before(\"idle\")) {\n                    return false;\n                } else {\n                    this.active = false;\n                    this.close();\n                    this.eventBus.trigger(\"idle\");\n                    return true;\n                }\n            },\n            isOpen: function isOpen() {\n                return this.menu.isOpen();\n            },\n            open: function open() {\n                if (!this.isOpen() && !this.eventBus.before(\"open\")) {\n                    this.menu.open();\n                    this._updateHint();\n                    this.eventBus.trigger(\"open\");\n                }\n                return this.isOpen();\n            },\n            close: function close() {\n                if (this.isOpen() && !this.eventBus.before(\"close\")) {\n                    this.menu.close();\n                    this.input.clearHint();\n                    this.input.resetInputValue();\n                    this.eventBus.trigger(\"close\");\n                }\n                return !this.isOpen();\n            },\n            setVal: function setVal(val) {\n                this.input.setQuery(_.toStr(val));\n            },\n            getVal: function getVal() {\n                return this.input.getQuery();\n            },\n            select: function select($selectable) {\n                var data = this.menu.getSelectableData($selectable);\n                if (data && !this.eventBus.before(\"select\", data.obj)) {\n                    this.input.setQuery(data.val, true);\n                    this.eventBus.trigger(\"select\", data.obj);\n                    this.close();\n                    return true;\n                }\n                return false;\n            },\n            autocomplete: function autocomplete($selectable) {\n                var query, data, isValid;\n                query = this.input.getQuery();\n                data = this.menu.getSelectableData($selectable);\n                isValid = data && query !== data.val;\n                if (isValid && !this.eventBus.before(\"autocomplete\", data.obj)) {\n                    this.input.setQuery(data.val);\n                    this.eventBus.trigger(\"autocomplete\", data.obj);\n                    return true;\n                }\n                return false;\n            },\n            moveCursor: function moveCursor(delta) {\n                var query, $candidate, data, payload, cancelMove;\n                query = this.input.getQuery();\n                $candidate = this.menu.selectableRelativeToCursor(delta);\n                data = this.menu.getSelectableData($candidate);\n                payload = data ? data.obj : null;\n                cancelMove = this._minLengthMet() && this.menu.update(query);\n                if (!cancelMove && !this.eventBus.before(\"cursorchange\", payload)) {\n                    this.menu.setCursor($candidate);\n                    if (data) {\n                        this.input.setInputValue(data.val);\n                    } else {\n                        this.input.resetInputValue();\n                        this._updateHint();\n                    }\n                    this.eventBus.trigger(\"cursorchange\", payload);\n                    return true;\n                }\n                return false;\n            },\n            destroy: function destroy() {\n                this.input.destroy();\n                this.menu.destroy();\n            }\n        });\n        return Typeahead;\n        function c(ctx) {\n            var methods = [].slice.call(arguments, 1);\n            return function() {\n                var args = [].slice.call(arguments);\n                _.each(methods, function(method) {\n                    return ctx[method].apply(ctx, args);\n                });\n            };\n        }\n    }();\n    (function() {\n        \"use strict\";\n        var old, keys, methods;\n        old = $.fn.typeahead;\n        keys = {\n            www: \"tt-www\",\n            attrs: \"tt-attrs\",\n            typeahead: \"tt-typeahead\"\n        };\n        methods = {\n            initialize: function initialize(o, datasets) {\n                var www;\n                datasets = _.isArray(datasets) ? datasets : [].slice.call(arguments, 1);\n                o = o || {};\n                www = WWW(o.classNames);\n                return this.each(attach);\n                function attach() {\n                    var $input, $wrapper, $hint, $menu, defaultHint, defaultMenu, eventBus, input, menu, typeahead, MenuConstructor;\n                    _.each(datasets, function(d) {\n                        d.highlight = !!o.highlight;\n                    });\n                    $input = $(this);\n                    $wrapper = $(www.html.wrapper);\n                    $hint = $elOrNull(o.hint);\n                    $menu = $elOrNull(o.menu);\n                    defaultHint = o.hint !== false && !$hint;\n                    defaultMenu = o.menu !== false && !$menu;\n                    defaultHint && ($hint = buildHintFromInput($input, www));\n                    defaultMenu && ($menu = $(www.html.menu).css(www.css.menu));\n                    $hint && $hint.val(\"\");\n                    $input = prepInput($input, www);\n                    if (defaultHint || defaultMenu) {\n                        $wrapper.css(www.css.wrapper);\n                        $input.css(defaultHint ? www.css.input : www.css.inputWithNoHint);\n                        $input.wrap($wrapper).parent().prepend(defaultHint ? $hint : null).append(defaultMenu ? $menu : null);\n                    }\n                    MenuConstructor = defaultMenu ? DefaultMenu : Menu;\n                    eventBus = new EventBus({\n                        el: $input\n                    });\n                    input = new Input({\n                        hint: $hint,\n                        input: $input\n                    }, www);\n                    menu = new MenuConstructor({\n                        node: $menu,\n                        datasets: datasets\n                    }, www);\n                    typeahead = new Typeahead({\n                        input: input,\n                        menu: menu,\n                        eventBus: eventBus,\n                        minLength: o.minLength\n                    }, www);\n                    $input.data(keys.www, www);\n                    $input.data(keys.typeahead, typeahead);\n                }\n            },\n            isEnabled: function isEnabled() {\n                var enabled;\n                ttEach(this.first(), function(t) {\n                    enabled = t.isEnabled();\n                });\n                return enabled;\n            },\n            enable: function enable() {\n                ttEach(this, function(t) {\n                    t.enable();\n                });\n                return this;\n            },\n            disable: function disable() {\n                ttEach(this, function(t) {\n                    t.disable();\n                });\n                return this;\n            },\n            isActive: function isActive() {\n                var active;\n                ttEach(this.first(), function(t) {\n                    active = t.isActive();\n                });\n                return active;\n            },\n            activate: function activate() {\n                ttEach(this, function(t) {\n                    t.activate();\n                });\n                return this;\n            },\n            deactivate: function deactivate() {\n                ttEach(this, function(t) {\n                    t.deactivate();\n                });\n                return this;\n            },\n            isOpen: function isOpen() {\n                var open;\n                ttEach(this.first(), function(t) {\n                    open = t.isOpen();\n                });\n                return open;\n            },\n            open: function open() {\n                ttEach(this, function(t) {\n                    t.open();\n                });\n                return this;\n            },\n            close: function close() {\n                ttEach(this, function(t) {\n                    t.close();\n                });\n                return this;\n            },\n            select: function select(el) {\n                var success = false, $el = $(el);\n                ttEach(this.first(), function(t) {\n                    success = t.select($el);\n                });\n                return success;\n            },\n            autocomplete: function autocomplete(el) {\n                var success = false, $el = $(el);\n                ttEach(this.first(), function(t) {\n                    success = t.autocomplete($el);\n                });\n                return success;\n            },\n            moveCursor: function moveCursoe(delta) {\n                var success = false;\n                ttEach(this.first(), function(t) {\n                    success = t.moveCursor(delta);\n                });\n                return success;\n            },\n            val: function val(newVal) {\n                var query;\n                if (!arguments.length) {\n                    ttEach(this.first(), function(t) {\n                        query = t.getVal();\n                    });\n                    return query;\n                } else {\n                    ttEach(this, function(t) {\n                        t.setVal(newVal);\n                    });\n                    return this;\n                }\n            },\n            destroy: function destroy() {\n                ttEach(this, function(typeahead, $input) {\n                    revert($input);\n                    typeahead.destroy();\n                });\n                return this;\n            }\n        };\n        $.fn.typeahead = function(method) {\n            if (methods[method]) {\n                return methods[method].apply(this, [].slice.call(arguments, 1));\n            } else {\n                return methods.initialize.apply(this, arguments);\n            }\n        };\n        $.fn.typeahead.noConflict = function noConflict() {\n            $.fn.typeahead = old;\n            return this;\n        };\n        function ttEach($els, fn) {\n            $els.each(function() {\n                var $input = $(this), typeahead;\n                (typeahead = $input.data(keys.typeahead)) && fn(typeahead, $input);\n            });\n        }\n        function buildHintFromInput($input, www) {\n            return $input.clone().addClass(www.classes.hint).removeData().css(www.css.hint).css(getBackgroundStyles($input)).prop(\"readonly\", true).removeAttr(\"id name placeholder required\").attr({\n                autocomplete: \"off\",\n                spellcheck: \"false\",\n                tabindex: -1\n            });\n        }\n        function prepInput($input, www) {\n            $input.data(keys.attrs, {\n                dir: $input.attr(\"dir\"),\n                autocomplete: $input.attr(\"autocomplete\"),\n                spellcheck: $input.attr(\"spellcheck\"),\n                style: $input.attr(\"style\")\n            });\n            $input.addClass(www.classes.input).attr({\n                autocomplete: \"off\",\n                spellcheck: false\n            });\n            try {\n                !$input.attr(\"dir\") && $input.attr(\"dir\", \"auto\");\n            } catch (e) {}\n            return $input;\n        }\n        function getBackgroundStyles($el) {\n            return {\n                backgroundAttachment: $el.css(\"background-attachment\"),\n                backgroundClip: $el.css(\"background-clip\"),\n                backgroundColor: $el.css(\"background-color\"),\n                backgroundImage: $el.css(\"background-image\"),\n                backgroundOrigin: $el.css(\"background-origin\"),\n                backgroundPosition: $el.css(\"background-position\"),\n                backgroundRepeat: $el.css(\"background-repeat\"),\n                backgroundSize: $el.css(\"background-size\")\n            };\n        }\n        function revert($input) {\n            var www, $wrapper;\n            www = $input.data(keys.www);\n            $wrapper = $input.parent().filter(www.selectors.wrapper);\n            _.each($input.data(keys.attrs), function(val, key) {\n                _.isUndefined(val) ? $input.removeAttr(key) : $input.attr(key, val);\n            });\n            $input.removeData(keys.typeahead).removeData(keys.www).removeData(keys.attr).removeClass(www.classes.input);\n            if ($wrapper.length) {\n                $input.detach().insertAfter($wrapper);\n                $wrapper.remove();\n            }\n        }\n        function $elOrNull(obj) {\n            var isValid, $el;\n            isValid = _.isJQuery(obj) || _.isElement(obj);\n            $el = isValid ? $(obj).first() : [];\n            return $el.length ? $el : null;\n        }\n    })();\n});","/*\n * bootstrap-tagsinput v0.4.2 by Tim Schlechter\n *\n */\n\n!function(a){\"use strict\";function b(b,c){this.itemsArray=[],this.$element=a(b),this.$element.hide(),this.isSelect=\"SELECT\"===b.tagName,this.multiple=this.isSelect&&b.hasAttribute(\"multiple\"),this.objectItems=c&&c.itemValue,this.placeholderText=b.hasAttribute(\"placeholder\")?this.$element.attr(\"placeholder\"):\"\",this.inputSize=Math.max(1,this.placeholderText.length),this.$container=a('<div class=\"bootstrap-tagsinput\"></div>'),this.$input=a('<input type=\"text\" placeholder=\"'+this.placeholderText+'\"/>').appendTo(this.$container),this.$element.after(this.$container);var d=(this.inputSize<3?3:this.inputSize)+\"em\";this.$input.get(0).style.cssText=\"width: \"+d+\" !important; padding: 8px;\",this.build(c)}function c(a,b){if(\"function\"!=typeof a[b]){var c=a[b];a[b]=function(a){return a[c]}}}function d(a,b){if(\"function\"!=typeof a[b]){var c=a[b];a[b]=function(){return c}}}function e(a){return a?i.text(a).html():\"\"}function f(a){var b=0;if(document.selection){a.focus();var c=document.selection.createRange();c.moveStart(\"character\",-a.value.length),b=c.text.length}else(a.selectionStart||\"0\"==a.selectionStart)&&(b=a.selectionStart);return b}function g(b,c){var d=!1;return a.each(c,function(a,c){if(\"number\"==typeof c&&b.which===c)return d=!0,!1;if(b.which===c.which){var e=!c.hasOwnProperty(\"altKey\")||b.altKey===c.altKey,f=!c.hasOwnProperty(\"shiftKey\")||b.shiftKey===c.shiftKey,g=!c.hasOwnProperty(\"ctrlKey\")||b.ctrlKey===c.ctrlKey;if(e&&f&&g)return d=!0,!1}}),d}var h={tagClass:function(){return\"label label-info\"},itemValue:function(a){return a?a.toString():a},itemText:function(a){return this.itemValue(a)},freeInput:!0,addOnBlur:!0,maxTags:void 0,maxChars:void 0,confirmKeys:[13,44],onTagExists:function(a,b){b.hide().fadeIn()},trimValue:!1,allowDuplicates:!1};b.prototype={constructor:b,add:function(b,c){var d=this;if(!(d.options.maxTags&&d.itemsArray.length>=d.options.maxTags||b!==!1&&!b)){if(\"string\"==typeof b&&d.options.trimValue&&(b=a.trim(b)),\"object\"==typeof b&&!d.objectItems)throw\"Can't add objects when itemValue option is not set\";if(!b.toString().match(/^\\s*$/)){if(d.isSelect&&!d.multiple&&d.itemsArray.length>0&&d.remove(d.itemsArray[0]),\"string\"==typeof b&&\"INPUT\"===this.$element[0].tagName){var f=b.split(\",\");if(f.length>1){for(var g=0;g<f.length;g++)this.add(f[g],!0);return void(c||d.pushVal())}}var h=d.options.itemValue(b),i=d.options.itemText(b),j=d.options.tagClass(b),k=a.grep(d.itemsArray,function(a){return d.options.itemValue(a)===h})[0];if(!k||d.options.allowDuplicates){if(!(d.items().toString().length+b.length+1>d.options.maxInputLength)){var l=a.Event(\"beforeItemAdd\",{item:b,cancel:!1});if(d.$element.trigger(l),!l.cancel){d.itemsArray.push(b);var m=a('<span class=\"tag '+e(j)+'\">'+e(i)+'<span data-role=\"remove\"></span></span>');if(m.data(\"item\",b),d.findInputWrapper().before(m),m.after(\" \"),d.isSelect&&!a('option[value=\"'+encodeURIComponent(h)+'\"]',d.$element)[0]){var n=a(\"<option selected>\"+e(i)+\"</option>\");n.data(\"item\",b),n.attr(\"value\",h),d.$element.append(n)}c||d.pushVal(),(d.options.maxTags===d.itemsArray.length||d.items().toString().length===d.options.maxInputLength)&&d.$container.addClass(\"bootstrap-tagsinput-max\"),d.$element.trigger(a.Event(\"itemAdded\",{item:b}))}}}else if(d.options.onTagExists){var o=a(\".tag\",d.$container).filter(function(){return a(this).data(\"item\")===k});d.options.onTagExists(b,o)}}}},remove:function(b,c){var d=this;if(d.objectItems&&(b=\"object\"==typeof b?a.grep(d.itemsArray,function(a){return d.options.itemValue(a)==d.options.itemValue(b)}):a.grep(d.itemsArray,function(a){return d.options.itemValue(a)==b}),b=b[b.length-1]),b){var e=a.Event(\"beforeItemRemove\",{item:b,cancel:!1});if(d.$element.trigger(e),e.cancel)return;a(\".tag\",d.$container).filter(function(){return a(this).data(\"item\")===b}).remove(),a(\"option\",d.$element).filter(function(){return a(this).data(\"item\")===b}).remove(),-1!==a.inArray(b,d.itemsArray)&&d.itemsArray.splice(a.inArray(b,d.itemsArray),1)}c||d.pushVal(),d.options.maxTags>d.itemsArray.length&&d.$container.removeClass(\"bootstrap-tagsinput-max\"),d.$element.trigger(a.Event(\"itemRemoved\",{item:b}))},removeAll:function(){var b=this;for(a(\".tag\",b.$container).remove(),a(\"option\",b.$element).remove();b.itemsArray.length>0;)b.itemsArray.pop();b.pushVal()},refresh:function(){var b=this;a(\".tag\",b.$container).each(function(){var c=a(this),d=c.data(\"item\"),f=b.options.itemValue(d),g=b.options.itemText(d),h=b.options.tagClass(d);if(c.attr(\"class\",null),c.addClass(\"tag \"+e(h)),c.contents().filter(function(){return 3==this.nodeType})[0].nodeValue=e(g),b.isSelect){var i=a(\"option\",b.$element).filter(function(){return a(this).data(\"item\")===d});i.attr(\"value\",f)}})},items:function(){return this.itemsArray},pushVal:function(){var b=this,c=a.map(b.items(),function(a){return b.options.itemValue(a).toString()});b.$element.val(c,!0).trigger(\"change\")},build:function(b){var e=this;if(e.options=a.extend({},h,b),e.objectItems&&(e.options.freeInput=!1),c(e.options,\"itemValue\"),c(e.options,\"itemText\"),d(e.options,\"tagClass\"),e.options.typeahead){var i=e.options.typeahead||{};d(i,\"source\"),e.$input.typeahead(a.extend({},i,{source:function(b,c){function d(a){for(var b=[],d=0;d<a.length;d++){var g=e.options.itemText(a[d]);f[g]=a[d],b.push(g)}c(b)}this.map={};var f=this.map,g=i.source(b);a.isFunction(g.success)?g.success(d):a.isFunction(g.then)?g.then(d):a.when(g).then(d)},updater:function(a){e.add(this.map[a])},matcher:function(a){return-1!==a.toLowerCase().indexOf(this.query.trim().toLowerCase())},sorter:function(a){return a.sort()},highlighter:function(a){var b=new RegExp(\"(\"+this.query+\")\",\"gi\");return a.replace(b,\"<strong>$1</strong>\")}}))}if(e.options.typeaheadjs){var j=e.options.typeaheadjs||{};e.$input.typeahead(null,j).on(\"typeahead:selected\",a.proxy(function(a,b){e.add(j.valueKey?b[j.valueKey]:b),e.$input.typeahead(\"val\",\"\")},e))}e.$container.on(\"click\",a.proxy(function(){e.$element.attr(\"disabled\")||e.$input.removeAttr(\"disabled\"),e.$input.focus()},e)),e.options.addOnBlur&&e.options.freeInput&&e.$input.on(\"focusout\",a.proxy(function(){0===a(\".typeahead, .twitter-typeahead\",e.$container).length&&(e.add(e.$input.val()),e.$input.val(\"\"))},e)),e.$container.on(\"keydown\",\"input\",a.proxy(function(b){var c=a(b.target),d=e.findInputWrapper();if(e.$element.attr(\"disabled\"))return void e.$input.attr(\"disabled\",\"disabled\");switch(b.which){case 8:if(0===f(c[0])){var g=d.prev();g&&e.remove(g.data(\"item\"))}break;case 46:if(0===f(c[0])){var h=d.next();h&&e.remove(h.data(\"item\"))}break;case 37:var i=d.prev();0===c.val().length&&i[0]&&(i.before(d),c.focus());break;case 39:var j=d.next();0===c.val().length&&j[0]&&(j.after(d),c.focus())}{var k=c.val().length;Math.ceil(k/5)}c.attr(\"size\",Math.max(this.inputSize,c.val().length))},e)),e.$container.on(\"keypress\",\"input\",a.proxy(function(b){var c=a(b.target);if(e.$element.attr(\"disabled\"))return void e.$input.attr(\"disabled\",\"disabled\");var d=c.val(),f=e.options.maxChars&&d.length>=e.options.maxChars;e.options.freeInput&&(g(b,e.options.confirmKeys)||f)&&(e.add(f?d.substr(0,e.options.maxChars):d),c.val(\"\"),b.preventDefault());{var h=c.val().length;Math.ceil(h/5)}c.attr(\"size\",Math.max(this.inputSize,c.val().length))},e)),e.$container.on(\"click\",\"[data-role=remove]\",a.proxy(function(b){e.$element.attr(\"disabled\")||e.remove(a(b.target).closest(\".tag\").data(\"item\"))},e)),e.options.itemValue===h.itemValue&&(\"INPUT\"===e.$element[0].tagName?e.add(e.$element.val()):a(\"option\",e.$element).each(function(){e.add(a(this).attr(\"value\"),!0)}))},destroy:function(){var a=this;a.$container.off(\"keypress\",\"input\"),a.$container.off(\"click\",\"[role=remove]\"),a.$container.remove(),a.$element.removeData(\"tagsinput\"),a.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var b=this.$input[0],c=this.$container[0];b&&b.parentNode!==c;)b=b.parentNode;return a(b)}},a.fn.tagsinput=function(c,d){var e=[];return this.each(function(){var f=a(this).data(\"tagsinput\");if(f)if(c||d){if(void 0!==f[c]){var g=f[c](d);void 0!==g&&e.push(g)}}else e.push(f);else f=new b(this,c),a(this).data(\"tagsinput\",f),e.push(f),\"SELECT\"===this.tagName&&a(\"option\",a(this)).attr(\"selected\",\"selected\"),a(this).val(a(this).val())}),\"string\"==typeof c?e.length>1?e:e[0]:e},a.fn.tagsinput.Constructor=b;var i=a(\"<div />\");a(function(){a(\"input[data-role=tagsinput], select[multiple][data-role=tagsinput]\").tagsinput()})}(window.jQuery);","\n/*\n *\n * More info at [www.dropzonejs.com](http://www.dropzonejs.com)\n *\n * Copyright (c) 2012, Matias Meno\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n *\n */\n\n(function() {\n  var Dropzone, Emitter, camelize, contentLoaded, detectVerticalSquash, drawImageIOSFix, noop, without,\n    __slice = [].slice,\n    __hasProp = {}.hasOwnProperty,\n    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\n  noop = function() {};\n\n  Emitter = (function() {\n    function Emitter() {}\n\n    Emitter.prototype.addEventListener = Emitter.prototype.on;\n\n    Emitter.prototype.on = function(event, fn) {\n      this._callbacks = this._callbacks || {};\n      if (!this._callbacks[event]) {\n        this._callbacks[event] = [];\n      }\n      this._callbacks[event].push(fn);\n      return this;\n    };\n\n    Emitter.prototype.emit = function() {\n      var args, callback, callbacks, event, _i, _len;\n      event = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n      this._callbacks = this._callbacks || {};\n      callbacks = this._callbacks[event];\n      if (callbacks) {\n        for (_i = 0, _len = callbacks.length; _i < _len; _i++) {\n          callback = callbacks[_i];\n          callback.apply(this, args);\n        }\n      }\n      return this;\n    };\n\n    Emitter.prototype.removeListener = Emitter.prototype.off;\n\n    Emitter.prototype.removeAllListeners = Emitter.prototype.off;\n\n    Emitter.prototype.removeEventListener = Emitter.prototype.off;\n\n    Emitter.prototype.off = function(event, fn) {\n      var callback, callbacks, i, _i, _len;\n      if (!this._callbacks || arguments.length === 0) {\n        this._callbacks = {};\n        return this;\n      }\n      callbacks = this._callbacks[event];\n      if (!callbacks) {\n        return this;\n      }\n      if (arguments.length === 1) {\n        delete this._callbacks[event];\n        return this;\n      }\n      for (i = _i = 0, _len = callbacks.length; _i < _len; i = ++_i) {\n        callback = callbacks[i];\n        if (callback === fn) {\n          callbacks.splice(i, 1);\n          break;\n        }\n      }\n      return this;\n    };\n\n    return Emitter;\n\n  })();\n\n  Dropzone = (function(_super) {\n    var extend, resolveOption;\n\n    __extends(Dropzone, _super);\n\n    Dropzone.prototype.Emitter = Emitter;\n\n\n    /*\n    This is a list of all available events you can register on a dropzone object.\n    \n    You can register an event handler like this:\n    \n        dropzone.on(\"dragEnter\", function() { });\n     */\n\n    Dropzone.prototype.events = [\"drop\", \"dragstart\", \"dragend\", \"dragenter\", \"dragover\", \"dragleave\", \"addedfile\", \"removedfile\", \"thumbnail\", \"error\", \"errormultiple\", \"processing\", \"processingmultiple\", \"uploadprogress\", \"totaluploadprogress\", \"sending\", \"sendingmultiple\", \"success\", \"successmultiple\", \"canceled\", \"canceledmultiple\", \"complete\", \"completemultiple\", \"reset\", \"maxfilesexceeded\", \"maxfilesreached\", \"queuecomplete\"];\n\n    Dropzone.prototype.defaultOptions = {\n      url: null,\n      method: \"post\",\n      withCredentials: false,\n      parallelUploads: 2,\n      uploadMultiple: false,\n      maxFilesize: 256,\n      paramName: \"file\",\n      createImageThumbnails: true,\n      maxThumbnailFilesize: 10,\n      thumbnailWidth: 120,\n      thumbnailHeight: 120,\n      filesizeBase: 1000,\n      maxFiles: null,\n      filesizeBase: 1000,\n      params: {},\n      clickable: true,\n      ignoreHiddenFiles: true,\n      acceptedFiles: null,\n      acceptedMimeTypes: null,\n      autoProcessQueue: true,\n      autoQueue: true,\n      addRemoveLinks: false,\n      previewsContainer: null,\n      capture: null,\n      dictDefaultMessage: \"Drop files here to upload\",\n      dictFallbackMessage: \"Your browser does not support drag'n'drop file uploads.\",\n      dictFallbackText: \"Please use the fallback form below to upload your files like in the olden days.\",\n      dictFileTooBig: \"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.\",\n      dictInvalidFileType: \"You can't upload files of this type.\",\n      dictResponseError: \"Server responded with {{statusCode}} code.\",\n      dictCancelUpload: \"Cancel upload\",\n      dictCancelUploadConfirmation: \"Are you sure you want to cancel this upload?\",\n      dictRemoveFile: \"Remove file\",\n      dictRemoveFileConfirmation: null,\n      dictMaxFilesExceeded: \"You can not upload any more files.\",\n      accept: function(file, done) {\n        return done();\n      },\n      init: function() {\n        return noop;\n      },\n      forceFallback: false,\n      fallback: function() {\n        var child, messageElement, span, _i, _len, _ref;\n        this.element.className = \"\" + this.element.className + \" dz-browser-not-supported\";\n        _ref = this.element.getElementsByTagName(\"div\");\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          child = _ref[_i];\n          if (/(^| )dz-message($| )/.test(child.className)) {\n            messageElement = child;\n            child.className = \"dz-message\";\n            continue;\n          }\n        }\n        if (!messageElement) {\n          messageElement = Dropzone.createElement(\"<div class=\\\"dz-message\\\"><span></span></div>\");\n          this.element.appendChild(messageElement);\n        }\n        span = messageElement.getElementsByTagName(\"span\")[0];\n        if (span) {\n          span.textContent = this.options.dictFallbackMessage;\n        }\n        return this.element.appendChild(this.getFallbackForm());\n      },\n      resize: function(file) {\n        var info, srcRatio, trgRatio;\n        info = {\n          srcX: 0,\n          srcY: 0,\n          srcWidth: file.width,\n          srcHeight: file.height\n        };\n        srcRatio = file.width / file.height;\n        info.optWidth = this.options.thumbnailWidth;\n        info.optHeight = this.options.thumbnailHeight;\n        if ((info.optWidth == null) && (info.optHeight == null)) {\n          info.optWidth = info.srcWidth;\n          info.optHeight = info.srcHeight;\n        } else if (info.optWidth == null) {\n          info.optWidth = srcRatio * info.optHeight;\n        } else if (info.optHeight == null) {\n          info.optHeight = (1 / srcRatio) * info.optWidth;\n        }\n        trgRatio = info.optWidth / info.optHeight;\n        if (file.height < info.optHeight || file.width < info.optWidth) {\n          info.trgHeight = info.srcHeight;\n          info.trgWidth = info.srcWidth;\n        } else {\n          if (srcRatio > trgRatio) {\n            info.srcHeight = file.height;\n            info.srcWidth = info.srcHeight * trgRatio;\n          } else {\n            info.srcWidth = file.width;\n            info.srcHeight = info.srcWidth / trgRatio;\n          }\n        }\n        info.srcX = (file.width - info.srcWidth) / 2;\n        info.srcY = (file.height - info.srcHeight) / 2;\n        return info;\n      },\n\n      /*\n      Those functions register themselves to the events on init and handle all\n      the user interface specific stuff. Overwriting them won't break the upload\n      but can break the way it's displayed.\n      You can overwrite them if you don't like the default behavior. If you just\n      want to add an additional event handler, register it on the dropzone object\n      and don't overwrite those options.\n       */\n      drop: function(e) {\n        return this.element.classList.remove(\"dz-drag-hover\");\n      },\n      dragstart: noop,\n      dragend: function(e) {\n        return this.element.classList.remove(\"dz-drag-hover\");\n      },\n      dragenter: function(e) {\n        return this.element.classList.add(\"dz-drag-hover\");\n      },\n      dragover: function(e) {\n        return this.element.classList.add(\"dz-drag-hover\");\n      },\n      dragleave: function(e) {\n        return this.element.classList.remove(\"dz-drag-hover\");\n      },\n      paste: noop,\n      reset: function() {\n        return this.element.classList.remove(\"dz-started\");\n      },\n      addedfile: function(file) {\n        var node, removeFileEvent, removeLink, _i, _j, _k, _len, _len1, _len2, _ref, _ref1, _ref2, _results;\n        if (this.element === this.previewsContainer) {\n          this.element.classList.add(\"dz-started\");\n        }\n        if (this.previewsContainer) {\n          file.previewElement = Dropzone.createElement(this.options.previewTemplate.trim());\n          file.previewTemplate = file.previewElement;\n          this.previewsContainer.appendChild(file.previewElement);\n          _ref = file.previewElement.querySelectorAll(\"[data-dz-name]\");\n          for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n            node = _ref[_i];\n            node.textContent = file.name;\n          }\n          _ref1 = file.previewElement.querySelectorAll(\"[data-dz-size]\");\n          for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {\n            node = _ref1[_j];\n            node.innerHTML = this.filesize(file.size);\n          }\n          if (this.options.addRemoveLinks) {\n            file._removeLink = Dropzone.createElement(\"<a class=\\\"dz-remove\\\" href=\\\"javascript:undefined;\\\" data-dz-remove>\" + this.options.dictRemoveFile + \"</a>\");\n            file.previewElement.appendChild(file._removeLink);\n          }\n          removeFileEvent = (function(_this) {\n            return function(e) {\n              e.preventDefault();\n              e.stopPropagation();\n              if (file.status === Dropzone.UPLOADING) {\n                return Dropzone.confirm(_this.options.dictCancelUploadConfirmation, function() {\n                  return _this.removeFile(file);\n                });\n              } else {\n                if (_this.options.dictRemoveFileConfirmation) {\n                  return Dropzone.confirm(_this.options.dictRemoveFileConfirmation, function() {\n                    return _this.removeFile(file);\n                  });\n                } else {\n                  return _this.removeFile(file);\n                }\n              }\n            };\n          })(this);\n          _ref2 = file.previewElement.querySelectorAll(\"[data-dz-remove]\");\n          _results = [];\n          for (_k = 0, _len2 = _ref2.length; _k < _len2; _k++) {\n            removeLink = _ref2[_k];\n            _results.push(removeLink.addEventListener(\"click\", removeFileEvent));\n          }\n          return _results;\n        }\n      },\n      removedfile: function(file) {\n        var _ref;\n        if (file.previewElement) {\n          if ((_ref = file.previewElement) != null) {\n            _ref.parentNode.removeChild(file.previewElement);\n          }\n        }\n        return this._updateMaxFilesReachedClass();\n      },\n      thumbnail: function(file, dataUrl) {\n        var thumbnailElement, _i, _len, _ref;\n        if (file.previewElement) {\n          file.previewElement.classList.remove(\"dz-file-preview\");\n          _ref = file.previewElement.querySelectorAll(\"[data-dz-thumbnail]\");\n          for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n            thumbnailElement = _ref[_i];\n            thumbnailElement.alt = file.name;\n            thumbnailElement.src = dataUrl;\n          }\n          return setTimeout(((function(_this) {\n            return function() {\n              return file.previewElement.classList.add(\"dz-image-preview\");\n            };\n          })(this)), 1);\n        }\n      },\n      error: function(file, message) {\n        var node, _i, _len, _ref, _results;\n        if (file.previewElement) {\n          file.previewElement.classList.add(\"dz-error\");\n          if (typeof message !== \"String\" && message.error) {\n            message = message.error;\n          }\n          _ref = file.previewElement.querySelectorAll(\"[data-dz-errormessage]\");\n          _results = [];\n          for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n            node = _ref[_i];\n            _results.push(node.textContent = message);\n          }\n          return _results;\n        }\n      },\n      errormultiple: noop,\n      processing: function(file) {\n        if (file.previewElement) {\n          file.previewElement.classList.add(\"dz-processing\");\n          if (file._removeLink) {\n            return file._removeLink.textContent = this.options.dictCancelUpload;\n          }\n        }\n      },\n      processingmultiple: noop,\n      uploadprogress: function(file, progress, bytesSent) {\n        var node, _i, _len, _ref, _results;\n        if (file.previewElement) {\n          _ref = file.previewElement.querySelectorAll(\"[data-dz-uploadprogress]\");\n          _results = [];\n          for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n            node = _ref[_i];\n            if (node.nodeName === 'PROGRESS') {\n              _results.push(node.value = progress);\n            } else {\n              _results.push(node.style.width = \"\" + progress + \"%\");\n            }\n          }\n          return _results;\n        }\n      },\n      totaluploadprogress: noop,\n      sending: noop,\n      sendingmultiple: noop,\n      success: function(file) {\n        if (file.previewElement) {\n          return file.previewElement.classList.add(\"dz-success\");\n        }\n      },\n      successmultiple: noop,\n      canceled: function(file) {\n        return this.emit(\"error\", file, \"Upload canceled.\");\n      },\n      canceledmultiple: noop,\n      complete: function(file) {\n        if (file._removeLink) {\n          file._removeLink.textContent = this.options.dictRemoveFile;\n        }\n        if (file.previewElement) {\n          return file.previewElement.classList.add(\"dz-complete\");\n        }\n      },\n      completemultiple: noop,\n      maxfilesexceeded: noop,\n      maxfilesreached: noop,\n      queuecomplete: noop,\n      previewTemplate: \"<div class=\\\"dz-preview dz-file-preview\\\">\\n  <div class=\\\"dz-image\\\"><img data-dz-thumbnail /></div>\\n  <div class=\\\"dz-details\\\">\\n    <div class=\\\"dz-size\\\"><span data-dz-size></span></div>\\n    <div class=\\\"dz-filename\\\"><span data-dz-name></span></div>\\n  </div>\\n  <div class=\\\"dz-progress\\\"><span class=\\\"dz-upload\\\" data-dz-uploadprogress></span></div>\\n  <div class=\\\"dz-error-message\\\"><span data-dz-errormessage></span></div>\\n  <div class=\\\"dz-success-mark\\\">\\n    <svg width=\\\"54px\\\" height=\\\"54px\\\" viewBox=\\\"0 0 54 54\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" xmlns:sketch=\\\"http://www.bohemiancoding.com/sketch/ns\\\">\\n      <title>Check</title>\\n      <defs></defs>\\n      <g id=\\\"Page-1\\\" stroke=\\\"none\\\" stroke-width=\\\"1\\\" fill=\\\"none\\\" fill-rule=\\\"evenodd\\\" sketch:type=\\\"MSPage\\\">\\n        <path d=\\\"M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z\\\" id=\\\"Oval-2\\\" stroke-opacity=\\\"0.198794158\\\" stroke=\\\"#747474\\\" fill-opacity=\\\"0.816519475\\\" fill=\\\"#FFFFFF\\\" sketch:type=\\\"MSShapeGroup\\\"></path>\\n      </g>\\n    </svg>\\n  </div>\\n  <div class=\\\"dz-error-mark\\\">\\n    <svg width=\\\"54px\\\" height=\\\"54px\\\" viewBox=\\\"0 0 54 54\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" xmlns:sketch=\\\"http://www.bohemiancoding.com/sketch/ns\\\">\\n      <title>Error</title>\\n      <defs></defs>\\n      <g id=\\\"Page-1\\\" stroke=\\\"none\\\" stroke-width=\\\"1\\\" fill=\\\"none\\\" fill-rule=\\\"evenodd\\\" sketch:type=\\\"MSPage\\\">\\n        <g id=\\\"Check-+-Oval-2\\\" sketch:type=\\\"MSLayerGroup\\\" stroke=\\\"#747474\\\" stroke-opacity=\\\"0.198794158\\\" fill=\\\"#FFFFFF\\\" fill-opacity=\\\"0.816519475\\\">\\n          <path d=\\\"M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z\\\" id=\\\"Oval-2\\\" sketch:type=\\\"MSShapeGroup\\\"></path>\\n        </g>\\n      </g>\\n    </svg>\\n  </div>\\n</div>\"\n    };\n\n    extend = function() {\n      var key, object, objects, target, val, _i, _len;\n      target = arguments[0], objects = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n      for (_i = 0, _len = objects.length; _i < _len; _i++) {\n        object = objects[_i];\n        for (key in object) {\n          val = object[key];\n          target[key] = val;\n        }\n      }\n      return target;\n    };\n\n    function Dropzone(element, options) {\n      var elementOptions, fallback, _ref;\n      this.element = element;\n      this.version = Dropzone.version;\n      this.defaultOptions.previewTemplate = this.defaultOptions.previewTemplate.replace(/\\n*/g, \"\");\n      this.clickableElements = [];\n      this.listeners = [];\n      this.files = [];\n      if (typeof this.element === \"string\") {\n        this.element = document.querySelector(this.element);\n      }\n      if (!(this.element && (this.element.nodeType != null))) {\n        throw new Error(\"Invalid dropzone element.\");\n      }\n      if (this.element.dropzone) {\n        throw new Error(\"Dropzone already attached.\");\n      }\n      Dropzone.instances.push(this);\n      this.element.dropzone = this;\n      elementOptions = (_ref = Dropzone.optionsForElement(this.element)) != null ? _ref : {};\n      this.options = extend({}, this.defaultOptions, elementOptions, options != null ? options : {});\n      if (this.options.forceFallback || !Dropzone.isBrowserSupported()) {\n        return this.options.fallback.call(this);\n      }\n      if (this.options.url == null) {\n        this.options.url = this.element.getAttribute(\"action\");\n      }\n      if (!this.options.url) {\n        throw new Error(\"No URL provided.\");\n      }\n      if (this.options.acceptedFiles && this.options.acceptedMimeTypes) {\n        throw new Error(\"You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.\");\n      }\n      if (this.options.acceptedMimeTypes) {\n        this.options.acceptedFiles = this.options.acceptedMimeTypes;\n        delete this.options.acceptedMimeTypes;\n      }\n      this.options.method = this.options.method.toUpperCase();\n      if ((fallback = this.getExistingFallback()) && fallback.parentNode) {\n        fallback.parentNode.removeChild(fallback);\n      }\n      if (this.options.previewsContainer !== false) {\n        if (this.options.previewsContainer) {\n          this.previewsContainer = Dropzone.getElement(this.options.previewsContainer, \"previewsContainer\");\n        } else {\n          this.previewsContainer = this.element;\n        }\n      }\n      if (this.options.clickable) {\n        if (this.options.clickable === true) {\n          this.clickableElements = [this.element];\n        } else {\n          this.clickableElements = Dropzone.getElements(this.options.clickable, \"clickable\");\n        }\n      }\n      this.init();\n    }\n\n    Dropzone.prototype.getAcceptedFiles = function() {\n      var file, _i, _len, _ref, _results;\n      _ref = this.files;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        if (file.accepted) {\n          _results.push(file);\n        }\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.getRejectedFiles = function() {\n      var file, _i, _len, _ref, _results;\n      _ref = this.files;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        if (!file.accepted) {\n          _results.push(file);\n        }\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.getFilesWithStatus = function(status) {\n      var file, _i, _len, _ref, _results;\n      _ref = this.files;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        if (file.status === status) {\n          _results.push(file);\n        }\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.getQueuedFiles = function() {\n      return this.getFilesWithStatus(Dropzone.QUEUED);\n    };\n\n    Dropzone.prototype.getUploadingFiles = function() {\n      return this.getFilesWithStatus(Dropzone.UPLOADING);\n    };\n\n    Dropzone.prototype.getActiveFiles = function() {\n      var file, _i, _len, _ref, _results;\n      _ref = this.files;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        if (file.status === Dropzone.UPLOADING || file.status === Dropzone.QUEUED) {\n          _results.push(file);\n        }\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.init = function() {\n      var eventName, noPropagation, setupHiddenFileInput, _i, _len, _ref, _ref1;\n      if (this.element.tagName === \"form\") {\n        this.element.setAttribute(\"enctype\", \"multipart/form-data\");\n      }\n      if (this.element.classList.contains(\"dropzone\") && !this.element.querySelector(\".dz-message\")) {\n        this.element.appendChild(Dropzone.createElement(\"<div class=\\\"dz-default dz-message\\\"><span>\" + this.options.dictDefaultMessage + \"</span></div>\"));\n      }\n      if (this.clickableElements.length) {\n        setupHiddenFileInput = (function(_this) {\n          return function() {\n            if (_this.hiddenFileInput) {\n              document.body.removeChild(_this.hiddenFileInput);\n            }\n            _this.hiddenFileInput = document.createElement(\"input\");\n            _this.hiddenFileInput.setAttribute(\"type\", \"file\");\n            if ((_this.options.maxFiles == null) || _this.options.maxFiles > 1) {\n              _this.hiddenFileInput.setAttribute(\"multiple\", \"multiple\");\n            }\n            _this.hiddenFileInput.className = \"dz-hidden-input\";\n            if (_this.options.acceptedFiles != null) {\n              _this.hiddenFileInput.setAttribute(\"accept\", _this.options.acceptedFiles);\n            }\n            if (_this.options.capture != null) {\n              _this.hiddenFileInput.setAttribute(\"capture\", _this.options.capture);\n            }\n            _this.hiddenFileInput.style.visibility = \"hidden\";\n            _this.hiddenFileInput.style.position = \"absolute\";\n            _this.hiddenFileInput.style.top = \"0\";\n            _this.hiddenFileInput.style.left = \"0\";\n            _this.hiddenFileInput.style.height = \"0\";\n            _this.hiddenFileInput.style.width = \"0\";\n            document.body.appendChild(_this.hiddenFileInput);\n            return _this.hiddenFileInput.addEventListener(\"change\", function() {\n              var file, files, _i, _len;\n              files = _this.hiddenFileInput.files;\n              if (files.length) {\n                for (_i = 0, _len = files.length; _i < _len; _i++) {\n                  file = files[_i];\n                  _this.addFile(file);\n                }\n              }\n              return setupHiddenFileInput();\n            });\n          };\n        })(this);\n        setupHiddenFileInput();\n      }\n      this.URL = (_ref = window.URL) != null ? _ref : window.webkitURL;\n      _ref1 = this.events;\n      for (_i = 0, _len = _ref1.length; _i < _len; _i++) {\n        eventName = _ref1[_i];\n        this.on(eventName, this.options[eventName]);\n      }\n      this.on(\"uploadprogress\", (function(_this) {\n        return function() {\n          return _this.updateTotalUploadProgress();\n        };\n      })(this));\n      this.on(\"removedfile\", (function(_this) {\n        return function() {\n          return _this.updateTotalUploadProgress();\n        };\n      })(this));\n      this.on(\"canceled\", (function(_this) {\n        return function(file) {\n          return _this.emit(\"complete\", file);\n        };\n      })(this));\n      this.on(\"complete\", (function(_this) {\n        return function(file) {\n          if (_this.getUploadingFiles().length === 0 && _this.getQueuedFiles().length === 0) {\n            return setTimeout((function() {\n              return _this.emit(\"queuecomplete\");\n            }), 0);\n          }\n        };\n      })(this));\n      noPropagation = function(e) {\n        e.stopPropagation();\n        if (e.preventDefault) {\n          return e.preventDefault();\n        } else {\n          return e.returnValue = false;\n        }\n      };\n      this.listeners = [\n        {\n          element: this.element,\n          events: {\n            \"dragstart\": (function(_this) {\n              return function(e) {\n                return _this.emit(\"dragstart\", e);\n              };\n            })(this),\n            \"dragenter\": (function(_this) {\n              return function(e) {\n                noPropagation(e);\n                return _this.emit(\"dragenter\", e);\n              };\n            })(this),\n            \"dragover\": (function(_this) {\n              return function(e) {\n                var efct;\n                try {\n                  efct = e.dataTransfer.effectAllowed;\n                } catch (_error) {}\n                e.dataTransfer.dropEffect = 'move' === efct || 'linkMove' === efct ? 'move' : 'copy';\n                noPropagation(e);\n                return _this.emit(\"dragover\", e);\n              };\n            })(this),\n            \"dragleave\": (function(_this) {\n              return function(e) {\n                return _this.emit(\"dragleave\", e);\n              };\n            })(this),\n            \"drop\": (function(_this) {\n              return function(e) {\n                noPropagation(e);\n                return _this.drop(e);\n              };\n            })(this),\n            \"dragend\": (function(_this) {\n              return function(e) {\n                return _this.emit(\"dragend\", e);\n              };\n            })(this)\n          }\n        }\n      ];\n      this.clickableElements.forEach((function(_this) {\n        return function(clickableElement) {\n          return _this.listeners.push({\n            element: clickableElement,\n            events: {\n              \"click\": function(evt) {\n                if ((clickableElement !== _this.element) || (evt.target === _this.element || Dropzone.elementInside(evt.target, _this.element.querySelector(\".dz-message\")))) {\n                  return _this.hiddenFileInput.click();\n                }\n              }\n            }\n          });\n        };\n      })(this));\n      this.enable();\n      return this.options.init.call(this);\n    };\n\n    Dropzone.prototype.destroy = function() {\n      var _ref;\n      this.disable();\n      this.removeAllFiles(true);\n      if ((_ref = this.hiddenFileInput) != null ? _ref.parentNode : void 0) {\n        this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput);\n        this.hiddenFileInput = null;\n      }\n      delete this.element.dropzone;\n      return Dropzone.instances.splice(Dropzone.instances.indexOf(this), 1);\n    };\n\n    Dropzone.prototype.updateTotalUploadProgress = function() {\n      var activeFiles, file, totalBytes, totalBytesSent, totalUploadProgress, _i, _len, _ref;\n      totalBytesSent = 0;\n      totalBytes = 0;\n      activeFiles = this.getActiveFiles();\n      if (activeFiles.length) {\n        _ref = this.getActiveFiles();\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          file = _ref[_i];\n          totalBytesSent += file.upload.bytesSent;\n          totalBytes += file.upload.total;\n        }\n        totalUploadProgress = 100 * totalBytesSent / totalBytes;\n      } else {\n        totalUploadProgress = 100;\n      }\n      return this.emit(\"totaluploadprogress\", totalUploadProgress, totalBytes, totalBytesSent);\n    };\n\n    Dropzone.prototype._getParamName = function(n) {\n      if (typeof this.options.paramName === \"function\") {\n        return this.options.paramName(n);\n      } else {\n        return \"\" + this.options.paramName + (this.options.uploadMultiple ? \"[\" + n + \"]\" : \"\");\n      }\n    };\n\n    Dropzone.prototype.getFallbackForm = function() {\n      var existingFallback, fields, fieldsString, form;\n      if (existingFallback = this.getExistingFallback()) {\n        return existingFallback;\n      }\n      fieldsString = \"<div class=\\\"dz-fallback\\\">\";\n      if (this.options.dictFallbackText) {\n        fieldsString += \"<p>\" + this.options.dictFallbackText + \"</p>\";\n      }\n      fieldsString += \"<input type=\\\"file\\\" name=\\\"\" + (this._getParamName(0)) + \"\\\" \" + (this.options.uploadMultiple ? 'multiple=\"multiple\"' : void 0) + \" /><input type=\\\"submit\\\" value=\\\"Upload!\\\"></div>\";\n      fields = Dropzone.createElement(fieldsString);\n      if (this.element.tagName !== \"FORM\") {\n        form = Dropzone.createElement(\"<form action=\\\"\" + this.options.url + \"\\\" enctype=\\\"multipart/form-data\\\" method=\\\"\" + this.options.method + \"\\\"></form>\");\n        form.appendChild(fields);\n      } else {\n        this.element.setAttribute(\"enctype\", \"multipart/form-data\");\n        this.element.setAttribute(\"method\", this.options.method);\n      }\n      return form != null ? form : fields;\n    };\n\n    Dropzone.prototype.getExistingFallback = function() {\n      var fallback, getFallback, tagName, _i, _len, _ref;\n      getFallback = function(elements) {\n        var el, _i, _len;\n        for (_i = 0, _len = elements.length; _i < _len; _i++) {\n          el = elements[_i];\n          if (/(^| )fallback($| )/.test(el.className)) {\n            return el;\n          }\n        }\n      };\n      _ref = [\"div\", \"form\"];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        tagName = _ref[_i];\n        if (fallback = getFallback(this.element.getElementsByTagName(tagName))) {\n          return fallback;\n        }\n      }\n    };\n\n    Dropzone.prototype.setupEventListeners = function() {\n      var elementListeners, event, listener, _i, _len, _ref, _results;\n      _ref = this.listeners;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        elementListeners = _ref[_i];\n        _results.push((function() {\n          var _ref1, _results1;\n          _ref1 = elementListeners.events;\n          _results1 = [];\n          for (event in _ref1) {\n            listener = _ref1[event];\n            _results1.push(elementListeners.element.addEventListener(event, listener, false));\n          }\n          return _results1;\n        })());\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.removeEventListeners = function() {\n      var elementListeners, event, listener, _i, _len, _ref, _results;\n      _ref = this.listeners;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        elementListeners = _ref[_i];\n        _results.push((function() {\n          var _ref1, _results1;\n          _ref1 = elementListeners.events;\n          _results1 = [];\n          for (event in _ref1) {\n            listener = _ref1[event];\n            _results1.push(elementListeners.element.removeEventListener(event, listener, false));\n          }\n          return _results1;\n        })());\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.disable = function() {\n      var file, _i, _len, _ref, _results;\n      this.clickableElements.forEach(function(element) {\n        return element.classList.remove(\"dz-clickable\");\n      });\n      this.removeEventListeners();\n      _ref = this.files;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        _results.push(this.cancelUpload(file));\n      }\n      return _results;\n    };\n\n    Dropzone.prototype.enable = function() {\n      this.clickableElements.forEach(function(element) {\n        return element.classList.add(\"dz-clickable\");\n      });\n      return this.setupEventListeners();\n    };\n\n    Dropzone.prototype.filesize = function(size) {\n      var cutoff, i, selectedSize, selectedUnit, unit, units, _i, _len;\n      units = ['TB', 'GB', 'MB', 'KB', 'b'];\n      selectedSize = selectedUnit = null;\n      for (i = _i = 0, _len = units.length; _i < _len; i = ++_i) {\n        unit = units[i];\n        cutoff = Math.pow(this.options.filesizeBase, 4 - i) / 10;\n        if (size >= cutoff) {\n          selectedSize = size / Math.pow(this.options.filesizeBase, 4 - i);\n          selectedUnit = unit;\n          break;\n        }\n      }\n      selectedSize = Math.round(10 * selectedSize) / 10;\n      return \"<strong>\" + selectedSize + \"</strong> \" + selectedUnit;\n    };\n\n    Dropzone.prototype._updateMaxFilesReachedClass = function() {\n      if ((this.options.maxFiles != null) && this.getAcceptedFiles().length >= this.options.maxFiles) {\n        if (this.getAcceptedFiles().length === this.options.maxFiles) {\n          this.emit('maxfilesreached', this.files);\n        }\n        return this.element.classList.add(\"dz-max-files-reached\");\n      } else {\n        return this.element.classList.remove(\"dz-max-files-reached\");\n      }\n    };\n\n    Dropzone.prototype.drop = function(e) {\n      var files, items;\n      if (!e.dataTransfer) {\n        return;\n      }\n      this.emit(\"drop\", e);\n      files = e.dataTransfer.files;\n      if (files.length) {\n        items = e.dataTransfer.items;\n        if (items && items.length && (items[0].webkitGetAsEntry != null)) {\n          this._addFilesFromItems(items);\n        } else {\n          this.handleFiles(files);\n        }\n      }\n    };\n\n    Dropzone.prototype.paste = function(e) {\n      var items, _ref;\n      if ((e != null ? (_ref = e.clipboardData) != null ? _ref.items : void 0 : void 0) == null) {\n        return;\n      }\n      this.emit(\"paste\", e);\n      items = e.clipboardData.items;\n      if (items.length) {\n        return this._addFilesFromItems(items);\n      }\n    };\n\n    Dropzone.prototype.handleFiles = function(files) {\n      var file, _i, _len, _results;\n      _results = [];\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        _results.push(this.addFile(file));\n      }\n      return _results;\n    };\n\n    Dropzone.prototype._addFilesFromItems = function(items) {\n      var entry, item, _i, _len, _results;\n      _results = [];\n      for (_i = 0, _len = items.length; _i < _len; _i++) {\n        item = items[_i];\n        if ((item.webkitGetAsEntry != null) && (entry = item.webkitGetAsEntry())) {\n          if (entry.isFile) {\n            _results.push(this.addFile(item.getAsFile()));\n          } else if (entry.isDirectory) {\n            _results.push(this._addFilesFromDirectory(entry, entry.name));\n          } else {\n            _results.push(void 0);\n          }\n        } else if (item.getAsFile != null) {\n          if ((item.kind == null) || item.kind === \"file\") {\n            _results.push(this.addFile(item.getAsFile()));\n          } else {\n            _results.push(void 0);\n          }\n        } else {\n          _results.push(void 0);\n        }\n      }\n      return _results;\n    };\n\n    Dropzone.prototype._addFilesFromDirectory = function(directory, path) {\n      var dirReader, entriesReader;\n      dirReader = directory.createReader();\n      entriesReader = (function(_this) {\n        return function(entries) {\n          var entry, _i, _len;\n          for (_i = 0, _len = entries.length; _i < _len; _i++) {\n            entry = entries[_i];\n            if (entry.isFile) {\n              entry.file(function(file) {\n                if (_this.options.ignoreHiddenFiles && file.name.substring(0, 1) === '.') {\n                  return;\n                }\n                file.fullPath = \"\" + path + \"/\" + file.name;\n                return _this.addFile(file);\n              });\n            } else if (entry.isDirectory) {\n              _this._addFilesFromDirectory(entry, \"\" + path + \"/\" + entry.name);\n            }\n          }\n        };\n      })(this);\n      return dirReader.readEntries(entriesReader, function(error) {\n        return typeof console !== \"undefined\" && console !== null ? typeof console.log === \"function\" ? console.log(error) : void 0 : void 0;\n      });\n    };\n\n    Dropzone.prototype.accept = function(file, done) {\n      if (file.size > this.options.maxFilesize * 1024 * 1024) {\n        return done(this.options.dictFileTooBig.replace(\"{{filesize}}\", Math.round(file.size / 1024 / 10.24) / 100).replace(\"{{maxFilesize}}\", this.options.maxFilesize));\n      } else if (!Dropzone.isValidFile(file, this.options.acceptedFiles)) {\n        return done(this.options.dictInvalidFileType);\n      } else if ((this.options.maxFiles != null) && this.getAcceptedFiles().length >= this.options.maxFiles) {\n        done(this.options.dictMaxFilesExceeded.replace(\"{{maxFiles}}\", this.options.maxFiles));\n        return this.emit(\"maxfilesexceeded\", file);\n      } else {\n        return this.options.accept.call(this, file, done);\n      }\n    };\n\n    Dropzone.prototype.addFile = function(file) {\n      file.upload = {\n        progress: 0,\n        total: file.size,\n        bytesSent: 0\n      };\n      this.files.push(file);\n      file.status = Dropzone.ADDED;\n      this.emit(\"addedfile\", file);\n      this._enqueueThumbnail(file);\n      return this.accept(file, (function(_this) {\n        return function(error) {\n          if (error) {\n            file.accepted = false;\n            _this._errorProcessing([file], error);\n          } else {\n            file.accepted = true;\n            if (_this.options.autoQueue) {\n              _this.enqueueFile(file);\n            }\n          }\n          return _this._updateMaxFilesReachedClass();\n        };\n      })(this));\n    };\n\n    Dropzone.prototype.enqueueFiles = function(files) {\n      var file, _i, _len;\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        this.enqueueFile(file);\n      }\n      return null;\n    };\n\n    Dropzone.prototype.enqueueFile = function(file) {\n      if (file.status === Dropzone.ADDED && file.accepted === true) {\n        file.status = Dropzone.QUEUED;\n        if (this.options.autoProcessQueue) {\n          return setTimeout(((function(_this) {\n            return function() {\n              return _this.processQueue();\n            };\n          })(this)), 0);\n        }\n      } else {\n        throw new Error(\"This file can't be queued because it has already been processed or was rejected.\");\n      }\n    };\n\n    Dropzone.prototype._thumbnailQueue = [];\n\n    Dropzone.prototype._processingThumbnail = false;\n\n    Dropzone.prototype._enqueueThumbnail = function(file) {\n      if (this.options.createImageThumbnails && file.type.match(/image.*/) && file.size <= this.options.maxThumbnailFilesize * 1024 * 1024) {\n        this._thumbnailQueue.push(file);\n        return setTimeout(((function(_this) {\n          return function() {\n            return _this._processThumbnailQueue();\n          };\n        })(this)), 0);\n      }\n    };\n\n    Dropzone.prototype._processThumbnailQueue = function() {\n      if (this._processingThumbnail || this._thumbnailQueue.length === 0) {\n        return;\n      }\n      this._processingThumbnail = true;\n      return this.createThumbnail(this._thumbnailQueue.shift(), (function(_this) {\n        return function() {\n          _this._processingThumbnail = false;\n          return _this._processThumbnailQueue();\n        };\n      })(this));\n    };\n\n    Dropzone.prototype.removeFile = function(file) {\n      if (file.status === Dropzone.UPLOADING) {\n        this.cancelUpload(file);\n      }\n      this.files = without(this.files, file);\n      this.emit(\"removedfile\", file);\n      if (this.files.length === 0) {\n        return this.emit(\"reset\");\n      }\n    };\n\n    Dropzone.prototype.removeAllFiles = function(cancelIfNecessary) {\n      var file, _i, _len, _ref;\n      if (cancelIfNecessary == null) {\n        cancelIfNecessary = false;\n      }\n      _ref = this.files.slice();\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        file = _ref[_i];\n        if (file.status !== Dropzone.UPLOADING || cancelIfNecessary) {\n          this.removeFile(file);\n        }\n      }\n      return null;\n    };\n\n    Dropzone.prototype.createThumbnail = function(file, callback) {\n      var fileReader;\n      fileReader = new FileReader;\n      fileReader.onload = (function(_this) {\n        return function() {\n          if (file.type === \"image/svg+xml\") {\n            _this.emit(\"thumbnail\", file, fileReader.result);\n            if (callback != null) {\n              callback();\n            }\n            return;\n          }\n          return _this.createThumbnailFromUrl(file, fileReader.result, callback);\n        };\n      })(this);\n      return fileReader.readAsDataURL(file);\n    };\n\n    Dropzone.prototype.createThumbnailFromUrl = function(file, imageUrl, callback) {\n      var img;\n      img = document.createElement(\"img\");\n      img.onload = (function(_this) {\n        return function() {\n          var canvas, ctx, resizeInfo, thumbnail, _ref, _ref1, _ref2, _ref3;\n          file.width = img.width;\n          file.height = img.height;\n          resizeInfo = _this.options.resize.call(_this, file);\n          if (resizeInfo.trgWidth == null) {\n            resizeInfo.trgWidth = resizeInfo.optWidth;\n          }\n          if (resizeInfo.trgHeight == null) {\n            resizeInfo.trgHeight = resizeInfo.optHeight;\n          }\n          canvas = document.createElement(\"canvas\");\n          ctx = canvas.getContext(\"2d\");\n          canvas.width = resizeInfo.trgWidth;\n          canvas.height = resizeInfo.trgHeight;\n          drawImageIOSFix(ctx, img, (_ref = resizeInfo.srcX) != null ? _ref : 0, (_ref1 = resizeInfo.srcY) != null ? _ref1 : 0, resizeInfo.srcWidth, resizeInfo.srcHeight, (_ref2 = resizeInfo.trgX) != null ? _ref2 : 0, (_ref3 = resizeInfo.trgY) != null ? _ref3 : 0, resizeInfo.trgWidth, resizeInfo.trgHeight);\n          thumbnail = canvas.toDataURL(\"image/png\");\n          _this.emit(\"thumbnail\", file, thumbnail);\n          if (callback != null) {\n            return callback();\n          }\n        };\n      })(this);\n      if (callback != null) {\n        img.onerror = callback;\n      }\n      return img.src = imageUrl;\n    };\n\n    Dropzone.prototype.processQueue = function() {\n      var i, parallelUploads, processingLength, queuedFiles;\n      parallelUploads = this.options.parallelUploads;\n      processingLength = this.getUploadingFiles().length;\n      i = processingLength;\n      if (processingLength >= parallelUploads) {\n        return;\n      }\n      queuedFiles = this.getQueuedFiles();\n      if (!(queuedFiles.length > 0)) {\n        return;\n      }\n      if (this.options.uploadMultiple) {\n        return this.processFiles(queuedFiles.slice(0, parallelUploads - processingLength));\n      } else {\n        while (i < parallelUploads) {\n          if (!queuedFiles.length) {\n            return;\n          }\n          this.processFile(queuedFiles.shift());\n          i++;\n        }\n      }\n    };\n\n    Dropzone.prototype.processFile = function(file) {\n      return this.processFiles([file]);\n    };\n\n    Dropzone.prototype.processFiles = function(files) {\n      var file, _i, _len;\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        file.processing = true;\n        file.status = Dropzone.UPLOADING;\n        this.emit(\"processing\", file);\n      }\n      if (this.options.uploadMultiple) {\n        this.emit(\"processingmultiple\", files);\n      }\n      return this.uploadFiles(files);\n    };\n\n    Dropzone.prototype._getFilesWithXhr = function(xhr) {\n      var file, files;\n      return files = (function() {\n        var _i, _len, _ref, _results;\n        _ref = this.files;\n        _results = [];\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          file = _ref[_i];\n          if (file.xhr === xhr) {\n            _results.push(file);\n          }\n        }\n        return _results;\n      }).call(this);\n    };\n\n    Dropzone.prototype.cancelUpload = function(file) {\n      var groupedFile, groupedFiles, _i, _j, _len, _len1, _ref;\n      if (file.status === Dropzone.UPLOADING) {\n        groupedFiles = this._getFilesWithXhr(file.xhr);\n        for (_i = 0, _len = groupedFiles.length; _i < _len; _i++) {\n          groupedFile = groupedFiles[_i];\n          groupedFile.status = Dropzone.CANCELED;\n        }\n        file.xhr.abort();\n        for (_j = 0, _len1 = groupedFiles.length; _j < _len1; _j++) {\n          groupedFile = groupedFiles[_j];\n          this.emit(\"canceled\", groupedFile);\n        }\n        if (this.options.uploadMultiple) {\n          this.emit(\"canceledmultiple\", groupedFiles);\n        }\n      } else if ((_ref = file.status) === Dropzone.ADDED || _ref === Dropzone.QUEUED) {\n        file.status = Dropzone.CANCELED;\n        this.emit(\"canceled\", file);\n        if (this.options.uploadMultiple) {\n          this.emit(\"canceledmultiple\", [file]);\n        }\n      }\n      if (this.options.autoProcessQueue) {\n        return this.processQueue();\n      }\n    };\n\n    resolveOption = function() {\n      var args, option;\n      option = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];\n      if (typeof option === 'function') {\n        return option.apply(this, args);\n      }\n      return option;\n    };\n\n    Dropzone.prototype.uploadFile = function(file) {\n      return this.uploadFiles([file]);\n    };\n\n    Dropzone.prototype.uploadFiles = function(files) {\n      var file, formData, handleError, headerName, headerValue, headers, i, input, inputName, inputType, key, method, option, progressObj, response, updateProgress, url, value, xhr, _i, _j, _k, _l, _len, _len1, _len2, _len3, _m, _ref, _ref1, _ref2, _ref3, _ref4, _ref5;\n      xhr = new XMLHttpRequest();\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        file.xhr = xhr;\n      }\n      method = resolveOption(this.options.method, files);\n      url = resolveOption(this.options.url, files);\n      xhr.open(method, url, true);\n      xhr.withCredentials = !!this.options.withCredentials;\n      response = null;\n      handleError = (function(_this) {\n        return function() {\n          var _j, _len1, _results;\n          _results = [];\n          for (_j = 0, _len1 = files.length; _j < _len1; _j++) {\n            file = files[_j];\n            _results.push(_this._errorProcessing(files, response || _this.options.dictResponseError.replace(\"{{statusCode}}\", xhr.status), xhr));\n          }\n          return _results;\n        };\n      })(this);\n      updateProgress = (function(_this) {\n        return function(e) {\n          var allFilesFinished, progress, _j, _k, _l, _len1, _len2, _len3, _results;\n          if (e != null) {\n            progress = 100 * e.loaded / e.total;\n            for (_j = 0, _len1 = files.length; _j < _len1; _j++) {\n              file = files[_j];\n              file.upload = {\n                progress: progress,\n                total: e.total,\n                bytesSent: e.loaded\n              };\n            }\n          } else {\n            allFilesFinished = true;\n            progress = 100;\n            for (_k = 0, _len2 = files.length; _k < _len2; _k++) {\n              file = files[_k];\n              if (!(file.upload.progress === 100 && file.upload.bytesSent === file.upload.total)) {\n                allFilesFinished = false;\n              }\n              file.upload.progress = progress;\n              file.upload.bytesSent = file.upload.total;\n            }\n            if (allFilesFinished) {\n              return;\n            }\n          }\n          _results = [];\n          for (_l = 0, _len3 = files.length; _l < _len3; _l++) {\n            file = files[_l];\n            _results.push(_this.emit(\"uploadprogress\", file, progress, file.upload.bytesSent));\n          }\n          return _results;\n        };\n      })(this);\n      xhr.onload = (function(_this) {\n        return function(e) {\n          var _ref;\n          if (files[0].status === Dropzone.CANCELED) {\n            return;\n          }\n          if (xhr.readyState !== 4) {\n            return;\n          }\n          response = xhr.responseText;\n          if (xhr.getResponseHeader(\"content-type\") && ~xhr.getResponseHeader(\"content-type\").indexOf(\"application/json\")) {\n            try {\n              response = JSON.parse(response);\n            } catch (_error) {\n              e = _error;\n              response = \"Invalid JSON response from server.\";\n            }\n          }\n          updateProgress();\n          if (!((200 <= (_ref = xhr.status) && _ref < 300))) {\n            return handleError();\n          } else {\n            return _this._finished(files, response, e);\n          }\n        };\n      })(this);\n      xhr.onerror = (function(_this) {\n        return function() {\n          if (files[0].status === Dropzone.CANCELED) {\n            return;\n          }\n          return handleError();\n        };\n      })(this);\n      progressObj = (_ref = xhr.upload) != null ? _ref : xhr;\n      progressObj.onprogress = updateProgress;\n      headers = {\n        \"Accept\": \"application/json\",\n        \"Cache-Control\": \"no-cache\",\n        \"X-Requested-With\": \"XMLHttpRequest\"\n      };\n      if (this.options.headers) {\n        extend(headers, this.options.headers);\n      }\n      for (headerName in headers) {\n        headerValue = headers[headerName];\n        xhr.setRequestHeader(headerName, headerValue);\n      }\n      formData = new FormData();\n      if (this.options.params) {\n        _ref1 = this.options.params;\n        for (key in _ref1) {\n          value = _ref1[key];\n          formData.append(key, value);\n        }\n      }\n      for (_j = 0, _len1 = files.length; _j < _len1; _j++) {\n        file = files[_j];\n        this.emit(\"sending\", file, xhr, formData);\n      }\n      if (this.options.uploadMultiple) {\n        this.emit(\"sendingmultiple\", files, xhr, formData);\n      }\n      if (this.element.tagName === \"FORM\") {\n        _ref2 = this.element.querySelectorAll(\"input, textarea, select, button\");\n        for (_k = 0, _len2 = _ref2.length; _k < _len2; _k++) {\n          input = _ref2[_k];\n          inputName = input.getAttribute(\"name\");\n          inputType = input.getAttribute(\"type\");\n          if (input.tagName === \"SELECT\" && input.hasAttribute(\"multiple\")) {\n            _ref3 = input.options;\n            for (_l = 0, _len3 = _ref3.length; _l < _len3; _l++) {\n              option = _ref3[_l];\n              if (option.selected) {\n                formData.append(inputName, option.value);\n              }\n            }\n          } else if (!inputType || ((_ref4 = inputType.toLowerCase()) !== \"checkbox\" && _ref4 !== \"radio\") || input.checked) {\n            formData.append(inputName, input.value);\n          }\n        }\n      }\n      for (i = _m = 0, _ref5 = files.length - 1; 0 <= _ref5 ? _m <= _ref5 : _m >= _ref5; i = 0 <= _ref5 ? ++_m : --_m) {\n        formData.append(this._getParamName(i), files[i], files[i].name);\n      }\n      return xhr.send(formData);\n    };\n\n    Dropzone.prototype._finished = function(files, responseText, e) {\n      var file, _i, _len;\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        file.status = Dropzone.SUCCESS;\n        this.emit(\"success\", file, responseText, e);\n        this.emit(\"complete\", file);\n      }\n      if (this.options.uploadMultiple) {\n        this.emit(\"successmultiple\", files, responseText, e);\n        this.emit(\"completemultiple\", files);\n      }\n      if (this.options.autoProcessQueue) {\n        return this.processQueue();\n      }\n    };\n\n    Dropzone.prototype._errorProcessing = function(files, message, xhr) {\n      var file, _i, _len;\n      for (_i = 0, _len = files.length; _i < _len; _i++) {\n        file = files[_i];\n        file.status = Dropzone.ERROR;\n        this.emit(\"error\", file, message, xhr);\n        this.emit(\"complete\", file);\n      }\n      if (this.options.uploadMultiple) {\n        this.emit(\"errormultiple\", files, message, xhr);\n        this.emit(\"completemultiple\", files);\n      }\n      if (this.options.autoProcessQueue) {\n        return this.processQueue();\n      }\n    };\n\n    return Dropzone;\n\n  })(Emitter);\n\n  Dropzone.version = \"4.0.1\";\n\n  Dropzone.options = {};\n\n  Dropzone.optionsForElement = function(element) {\n    if (element.getAttribute(\"id\")) {\n      return Dropzone.options[camelize(element.getAttribute(\"id\"))];\n    } else {\n      return void 0;\n    }\n  };\n\n  Dropzone.instances = [];\n\n  Dropzone.forElement = function(element) {\n    if (typeof element === \"string\") {\n      element = document.querySelector(element);\n    }\n    if ((element != null ? element.dropzone : void 0) == null) {\n      throw new Error(\"No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.\");\n    }\n    return element.dropzone;\n  };\n\n  Dropzone.autoDiscover = true;\n\n  Dropzone.discover = function() {\n    var checkElements, dropzone, dropzones, _i, _len, _results;\n    if (document.querySelectorAll) {\n      dropzones = document.querySelectorAll(\".dropzone\");\n    } else {\n      dropzones = [];\n      checkElements = function(elements) {\n        var el, _i, _len, _results;\n        _results = [];\n        for (_i = 0, _len = elements.length; _i < _len; _i++) {\n          el = elements[_i];\n          if (/(^| )dropzone($| )/.test(el.className)) {\n            _results.push(dropzones.push(el));\n          } else {\n            _results.push(void 0);\n          }\n        }\n        return _results;\n      };\n      checkElements(document.getElementsByTagName(\"div\"));\n      checkElements(document.getElementsByTagName(\"form\"));\n    }\n    _results = [];\n    for (_i = 0, _len = dropzones.length; _i < _len; _i++) {\n      dropzone = dropzones[_i];\n      if (Dropzone.optionsForElement(dropzone) !== false) {\n        _results.push(new Dropzone(dropzone));\n      } else {\n        _results.push(void 0);\n      }\n    }\n    return _results;\n  };\n\n  Dropzone.blacklistedBrowsers = [/opera.*Macintosh.*version\\/12/i];\n\n  Dropzone.isBrowserSupported = function() {\n    var capableBrowser, regex, _i, _len, _ref;\n    capableBrowser = true;\n    if (window.File && window.FileReader && window.FileList && window.Blob && window.FormData && document.querySelector) {\n      if (!(\"classList\" in document.createElement(\"a\"))) {\n        capableBrowser = false;\n      } else {\n        _ref = Dropzone.blacklistedBrowsers;\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          regex = _ref[_i];\n          if (regex.test(navigator.userAgent)) {\n            capableBrowser = false;\n            continue;\n          }\n        }\n      }\n    } else {\n      capableBrowser = false;\n    }\n    return capableBrowser;\n  };\n\n  without = function(list, rejectedItem) {\n    var item, _i, _len, _results;\n    _results = [];\n    for (_i = 0, _len = list.length; _i < _len; _i++) {\n      item = list[_i];\n      if (item !== rejectedItem) {\n        _results.push(item);\n      }\n    }\n    return _results;\n  };\n\n  camelize = function(str) {\n    return str.replace(/[\\-_](\\w)/g, function(match) {\n      return match.charAt(1).toUpperCase();\n    });\n  };\n\n  Dropzone.createElement = function(string) {\n    var div;\n    div = document.createElement(\"div\");\n    div.innerHTML = string;\n    return div.childNodes[0];\n  };\n\n  Dropzone.elementInside = function(element, container) {\n    if (element === container) {\n      return true;\n    }\n    while (element = element.parentNode) {\n      if (element === container) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  Dropzone.getElement = function(el, name) {\n    var element;\n    if (typeof el === \"string\") {\n      element = document.querySelector(el);\n    } else if (el.nodeType != null) {\n      element = el;\n    }\n    if (element == null) {\n      throw new Error(\"Invalid `\" + name + \"` option provided. Please provide a CSS selector or a plain HTML element.\");\n    }\n    return element;\n  };\n\n  Dropzone.getElements = function(els, name) {\n    var e, el, elements, _i, _j, _len, _len1, _ref;\n    if (els instanceof Array) {\n      elements = [];\n      try {\n        for (_i = 0, _len = els.length; _i < _len; _i++) {\n          el = els[_i];\n          elements.push(this.getElement(el, name));\n        }\n      } catch (_error) {\n        e = _error;\n        elements = null;\n      }\n    } else if (typeof els === \"string\") {\n      elements = [];\n      _ref = document.querySelectorAll(els);\n      for (_j = 0, _len1 = _ref.length; _j < _len1; _j++) {\n        el = _ref[_j];\n        elements.push(el);\n      }\n    } else if (els.nodeType != null) {\n      elements = [els];\n    }\n    if (!((elements != null) && elements.length)) {\n      throw new Error(\"Invalid `\" + name + \"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.\");\n    }\n    return elements;\n  };\n\n  Dropzone.confirm = function(question, accepted, rejected) {\n    if (window.confirm(question)) {\n      return accepted();\n    } else if (rejected != null) {\n      return rejected();\n    }\n  };\n\n  Dropzone.isValidFile = function(file, acceptedFiles) {\n    var baseMimeType, mimeType, validType, _i, _len;\n    if (!acceptedFiles) {\n      return true;\n    }\n    acceptedFiles = acceptedFiles.split(\",\");\n    mimeType = file.type;\n    baseMimeType = mimeType.replace(/\\/.*$/, \"\");\n    for (_i = 0, _len = acceptedFiles.length; _i < _len; _i++) {\n      validType = acceptedFiles[_i];\n      validType = validType.trim();\n      if (validType.charAt(0) === \".\") {\n        if (file.name.toLowerCase().indexOf(validType.toLowerCase(), file.name.length - validType.length) !== -1) {\n          return true;\n        }\n      } else if (/\\/\\*$/.test(validType)) {\n        if (baseMimeType === validType.replace(/\\/.*$/, \"\")) {\n          return true;\n        }\n      } else {\n        if (mimeType === validType) {\n          return true;\n        }\n      }\n    }\n    return false;\n  };\n\n  if (typeof jQuery !== \"undefined\" && jQuery !== null) {\n    jQuery.fn.dropzone = function(options) {\n      return this.each(function() {\n        return new Dropzone(this, options);\n      });\n    };\n  }\n\n  if (typeof module !== \"undefined\" && module !== null) {\n    module.exports = Dropzone;\n  } else {\n    window.Dropzone = Dropzone;\n  }\n\n  Dropzone.ADDED = \"added\";\n\n  Dropzone.QUEUED = \"queued\";\n\n  Dropzone.ACCEPTED = Dropzone.QUEUED;\n\n  Dropzone.UPLOADING = \"uploading\";\n\n  Dropzone.PROCESSING = Dropzone.UPLOADING;\n\n  Dropzone.CANCELED = \"canceled\";\n\n  Dropzone.ERROR = \"error\";\n\n  Dropzone.SUCCESS = \"success\";\n\n\n  /*\n  \n  Bugfix for iOS 6 and 7\n  Source: http://stackoverflow.com/questions/11929099/html5-canvas-drawimage-ratio-bug-ios\n  based on the work of https://github.com/stomita/ios-imagefile-megapixel\n   */\n\n  detectVerticalSquash = function(img) {\n    var alpha, canvas, ctx, data, ey, ih, iw, py, ratio, sy;\n    iw = img.naturalWidth;\n    ih = img.naturalHeight;\n    canvas = document.createElement(\"canvas\");\n    canvas.width = 1;\n    canvas.height = ih;\n    ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(img, 0, 0);\n    data = ctx.getImageData(0, 0, 1, ih).data;\n    sy = 0;\n    ey = ih;\n    py = ih;\n    while (py > sy) {\n      alpha = data[(py - 1) * 4 + 3];\n      if (alpha === 0) {\n        ey = py;\n      } else {\n        sy = py;\n      }\n      py = (ey + sy) >> 1;\n    }\n    ratio = py / ih;\n    if (ratio === 0) {\n      return 1;\n    } else {\n      return ratio;\n    }\n  };\n\n  drawImageIOSFix = function(ctx, img, sx, sy, sw, sh, dx, dy, dw, dh) {\n    var vertSquashRatio;\n    vertSquashRatio = detectVerticalSquash(img);\n    return ctx.drawImage(img, sx, sy, sw, sh, dx, dy, dw, dh / vertSquashRatio);\n  };\n\n\n  /*\n   * contentloaded.js\n   *\n   * Author: Diego Perini (diego.perini at gmail.com)\n   * Summary: cross-browser wrapper for DOMContentLoaded\n   * Updated: 20101020\n   * License: MIT\n   * Version: 1.2\n   *\n   * URL:\n   * http://javascript.nwbox.com/ContentLoaded/\n   * http://javascript.nwbox.com/ContentLoaded/MIT-LICENSE\n   */\n\n  contentLoaded = function(win, fn) {\n    var add, doc, done, init, poll, pre, rem, root, top;\n    done = false;\n    top = true;\n    doc = win.document;\n    root = doc.documentElement;\n    add = (doc.addEventListener ? \"addEventListener\" : \"attachEvent\");\n    rem = (doc.addEventListener ? \"removeEventListener\" : \"detachEvent\");\n    pre = (doc.addEventListener ? \"\" : \"on\");\n    init = function(e) {\n      if (e.type === \"readystatechange\" && doc.readyState !== \"complete\") {\n        return;\n      }\n      (e.type === \"load\" ? win : doc)[rem](pre + e.type, init, false);\n      if (!done && (done = true)) {\n        return fn.call(win, e.type || e);\n      }\n    };\n    poll = function() {\n      var e;\n      try {\n        root.doScroll(\"left\");\n      } catch (_error) {\n        e = _error;\n        setTimeout(poll, 50);\n        return;\n      }\n      return init(\"poll\");\n    };\n    if (doc.readyState !== \"complete\") {\n      if (doc.createEventObject && root.doScroll) {\n        try {\n          top = !win.frameElement;\n        } catch (_error) {}\n        if (top) {\n          poll();\n        }\n      }\n      doc[add](pre + \"DOMContentLoaded\", init, false);\n      doc[add](pre + \"readystatechange\", init, false);\n      return win[add](pre + \"load\", init, false);\n    }\n  };\n\n  Dropzone._autoDiscoverFunction = function() {\n    if (Dropzone.autoDiscover) {\n      return Dropzone.discover();\n    }\n  };\n\n  contentLoaded(window, Dropzone._autoDiscoverFunction);\n\n}).call(this);\n","//! moment.js\n//! version : 2.10.6\n//! authors : Tim Wood, Iskren Chernev, Moment.js contributors\n//! license : MIT\n//! momentjs.com\n\n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define(factory) :\n    global.moment = factory()\n}(this, function () { 'use strict';\n\n    var hookCallback;\n\n    function utils_hooks__hooks () {\n        return hookCallback.apply(null, arguments);\n    }\n\n    // This is done to register the method called with moment()\n    // without creating circular dependencies.\n    function setHookCallback (callback) {\n        hookCallback = callback;\n    }\n\n    function isArray(input) {\n        return Object.prototype.toString.call(input) === '[object Array]';\n    }\n\n    function isDate(input) {\n        return input instanceof Date || Object.prototype.toString.call(input) === '[object Date]';\n    }\n\n    function map(arr, fn) {\n        var res = [], i;\n        for (i = 0; i < arr.length; ++i) {\n            res.push(fn(arr[i], i));\n        }\n        return res;\n    }\n\n    function hasOwnProp(a, b) {\n        return Object.prototype.hasOwnProperty.call(a, b);\n    }\n\n    function extend(a, b) {\n        for (var i in b) {\n            if (hasOwnProp(b, i)) {\n                a[i] = b[i];\n            }\n        }\n\n        if (hasOwnProp(b, 'toString')) {\n            a.toString = b.toString;\n        }\n\n        if (hasOwnProp(b, 'valueOf')) {\n            a.valueOf = b.valueOf;\n        }\n\n        return a;\n    }\n\n    function create_utc__createUTC (input, format, locale, strict) {\n        return createLocalOrUTC(input, format, locale, strict, true).utc();\n    }\n\n    function defaultParsingFlags() {\n        // We need to deep clone this object.\n        return {\n            empty           : false,\n            unusedTokens    : [],\n            unusedInput     : [],\n            overflow        : -2,\n            charsLeftOver   : 0,\n            nullInput       : false,\n            invalidMonth    : null,\n            invalidFormat   : false,\n            userInvalidated : false,\n            iso             : false\n        };\n    }\n\n    function getParsingFlags(m) {\n        if (m._pf == null) {\n            m._pf = defaultParsingFlags();\n        }\n        return m._pf;\n    }\n\n    function valid__isValid(m) {\n        if (m._isValid == null) {\n            var flags = getParsingFlags(m);\n            m._isValid = !isNaN(m._d.getTime()) &&\n                flags.overflow < 0 &&\n                !flags.empty &&\n                !flags.invalidMonth &&\n                !flags.invalidWeekday &&\n                !flags.nullInput &&\n                !flags.invalidFormat &&\n                !flags.userInvalidated;\n\n            if (m._strict) {\n                m._isValid = m._isValid &&\n                    flags.charsLeftOver === 0 &&\n                    flags.unusedTokens.length === 0 &&\n                    flags.bigHour === undefined;\n            }\n        }\n        return m._isValid;\n    }\n\n    function valid__createInvalid (flags) {\n        var m = create_utc__createUTC(NaN);\n        if (flags != null) {\n            extend(getParsingFlags(m), flags);\n        }\n        else {\n            getParsingFlags(m).userInvalidated = true;\n        }\n\n        return m;\n    }\n\n    var momentProperties = utils_hooks__hooks.momentProperties = [];\n\n    function copyConfig(to, from) {\n        var i, prop, val;\n\n        if (typeof from._isAMomentObject !== 'undefined') {\n            to._isAMomentObject = from._isAMomentObject;\n        }\n        if (typeof from._i !== 'undefined') {\n            to._i = from._i;\n        }\n        if (typeof from._f !== 'undefined') {\n            to._f = from._f;\n        }\n        if (typeof from._l !== 'undefined') {\n            to._l = from._l;\n        }\n        if (typeof from._strict !== 'undefined') {\n            to._strict = from._strict;\n        }\n        if (typeof from._tzm !== 'undefined') {\n            to._tzm = from._tzm;\n        }\n        if (typeof from._isUTC !== 'undefined') {\n            to._isUTC = from._isUTC;\n        }\n        if (typeof from._offset !== 'undefined') {\n            to._offset = from._offset;\n        }\n        if (typeof from._pf !== 'undefined') {\n            to._pf = getParsingFlags(from);\n        }\n        if (typeof from._locale !== 'undefined') {\n            to._locale = from._locale;\n        }\n\n        if (momentProperties.length > 0) {\n            for (i in momentProperties) {\n                prop = momentProperties[i];\n                val = from[prop];\n                if (typeof val !== 'undefined') {\n                    to[prop] = val;\n                }\n            }\n        }\n\n        return to;\n    }\n\n    var updateInProgress = false;\n\n    // Moment prototype object\n    function Moment(config) {\n        copyConfig(this, config);\n        this._d = new Date(config._d != null ? config._d.getTime() : NaN);\n        // Prevent infinite loop in case updateOffset creates new moment\n        // objects.\n        if (updateInProgress === false) {\n            updateInProgress = true;\n            utils_hooks__hooks.updateOffset(this);\n            updateInProgress = false;\n        }\n    }\n\n    function isMoment (obj) {\n        return obj instanceof Moment || (obj != null && obj._isAMomentObject != null);\n    }\n\n    function absFloor (number) {\n        if (number < 0) {\n            return Math.ceil(number);\n        } else {\n            return Math.floor(number);\n        }\n    }\n\n    function toInt(argumentForCoercion) {\n        var coercedNumber = +argumentForCoercion,\n            value = 0;\n\n        if (coercedNumber !== 0 && isFinite(coercedNumber)) {\n            value = absFloor(coercedNumber);\n        }\n\n        return value;\n    }\n\n    function compareArrays(array1, array2, dontConvert) {\n        var len = Math.min(array1.length, array2.length),\n            lengthDiff = Math.abs(array1.length - array2.length),\n            diffs = 0,\n            i;\n        for (i = 0; i < len; i++) {\n            if ((dontConvert && array1[i] !== array2[i]) ||\n                (!dontConvert && toInt(array1[i]) !== toInt(array2[i]))) {\n                diffs++;\n            }\n        }\n        return diffs + lengthDiff;\n    }\n\n    function Locale() {\n    }\n\n    var locales = {};\n    var globalLocale;\n\n    function normalizeLocale(key) {\n        return key ? key.toLowerCase().replace('_', '-') : key;\n    }\n\n    // pick the locale from the array\n    // try ['en-au', 'en-gb'] as 'en-au', 'en-gb', 'en', as in move through the list trying each\n    // substring from most specific to least, but move to the next array item if it's a more specific variant than the current root\n    function chooseLocale(names) {\n        var i = 0, j, next, locale, split;\n\n        while (i < names.length) {\n            split = normalizeLocale(names[i]).split('-');\n            j = split.length;\n            next = normalizeLocale(names[i + 1]);\n            next = next ? next.split('-') : null;\n            while (j > 0) {\n                locale = loadLocale(split.slice(0, j).join('-'));\n                if (locale) {\n                    return locale;\n                }\n                if (next && next.length >= j && compareArrays(split, next, true) >= j - 1) {\n                    //the next array item is better than a shallower substring of this one\n                    break;\n                }\n                j--;\n            }\n            i++;\n        }\n        return null;\n    }\n\n    function loadLocale(name) {\n        var oldLocale = null;\n        // TODO: Find a better way to register and load all the locales in Node\n        if (!locales[name] && typeof module !== 'undefined' &&\n                module && module.exports) {\n            try {\n                oldLocale = globalLocale._abbr;\n                require('./locale/' + name);\n                // because defineLocale currently also sets the global locale, we\n                // want to undo that for lazy loaded locales\n                locale_locales__getSetGlobalLocale(oldLocale);\n            } catch (e) { }\n        }\n        return locales[name];\n    }\n\n    // This function will load locale and then set the global locale.  If\n    // no arguments are passed in, it will simply return the current global\n    // locale key.\n    function locale_locales__getSetGlobalLocale (key, values) {\n        var data;\n        if (key) {\n            if (typeof values === 'undefined') {\n                data = locale_locales__getLocale(key);\n            }\n            else {\n                data = defineLocale(key, values);\n            }\n\n            if (data) {\n                // moment.duration._locale = moment._locale = data;\n                globalLocale = data;\n            }\n        }\n\n        return globalLocale._abbr;\n    }\n\n    function defineLocale (name, values) {\n        if (values !== null) {\n            values.abbr = name;\n            locales[name] = locales[name] || new Locale();\n            locales[name].set(values);\n\n            // backwards compat for now: also set the locale\n            locale_locales__getSetGlobalLocale(name);\n\n            return locales[name];\n        } else {\n            // useful for testing\n            delete locales[name];\n            return null;\n        }\n    }\n\n    // returns locale data\n    function locale_locales__getLocale (key) {\n        var locale;\n\n        if (key && key._locale && key._locale._abbr) {\n            key = key._locale._abbr;\n        }\n\n        if (!key) {\n            return globalLocale;\n        }\n\n        if (!isArray(key)) {\n            //short-circuit everything else\n            locale = loadLocale(key);\n            if (locale) {\n                return locale;\n            }\n            key = [key];\n        }\n\n        return chooseLocale(key);\n    }\n\n    var aliases = {};\n\n    function addUnitAlias (unit, shorthand) {\n        var lowerCase = unit.toLowerCase();\n        aliases[lowerCase] = aliases[lowerCase + 's'] = aliases[shorthand] = unit;\n    }\n\n    function normalizeUnits(units) {\n        return typeof units === 'string' ? aliases[units] || aliases[units.toLowerCase()] : undefined;\n    }\n\n    function normalizeObjectUnits(inputObject) {\n        var normalizedInput = {},\n            normalizedProp,\n            prop;\n\n        for (prop in inputObject) {\n            if (hasOwnProp(inputObject, prop)) {\n                normalizedProp = normalizeUnits(prop);\n                if (normalizedProp) {\n                    normalizedInput[normalizedProp] = inputObject[prop];\n                }\n            }\n        }\n\n        return normalizedInput;\n    }\n\n    function makeGetSet (unit, keepTime) {\n        return function (value) {\n            if (value != null) {\n                get_set__set(this, unit, value);\n                utils_hooks__hooks.updateOffset(this, keepTime);\n                return this;\n            } else {\n                return get_set__get(this, unit);\n            }\n        };\n    }\n\n    function get_set__get (mom, unit) {\n        return mom._d['get' + (mom._isUTC ? 'UTC' : '') + unit]();\n    }\n\n    function get_set__set (mom, unit, value) {\n        return mom._d['set' + (mom._isUTC ? 'UTC' : '') + unit](value);\n    }\n\n    // MOMENTS\n\n    function getSet (units, value) {\n        var unit;\n        if (typeof units === 'object') {\n            for (unit in units) {\n                this.set(unit, units[unit]);\n            }\n        } else {\n            units = normalizeUnits(units);\n            if (typeof this[units] === 'function') {\n                return this[units](value);\n            }\n        }\n        return this;\n    }\n\n    function zeroFill(number, targetLength, forceSign) {\n        var absNumber = '' + Math.abs(number),\n            zerosToFill = targetLength - absNumber.length,\n            sign = number >= 0;\n        return (sign ? (forceSign ? '+' : '') : '-') +\n            Math.pow(10, Math.max(0, zerosToFill)).toString().substr(1) + absNumber;\n    }\n\n    var formattingTokens = /(\\[[^\\[]*\\])|(\\\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;\n\n    var localFormattingTokens = /(\\[[^\\[]*\\])|(\\\\)?(LTS|LT|LL?L?L?|l{1,4})/g;\n\n    var formatFunctions = {};\n\n    var formatTokenFunctions = {};\n\n    // token:    'M'\n    // padded:   ['MM', 2]\n    // ordinal:  'Mo'\n    // callback: function () { this.month() + 1 }\n    function addFormatToken (token, padded, ordinal, callback) {\n        var func = callback;\n        if (typeof callback === 'string') {\n            func = function () {\n                return this[callback]();\n            };\n        }\n        if (token) {\n            formatTokenFunctions[token] = func;\n        }\n        if (padded) {\n            formatTokenFunctions[padded[0]] = function () {\n                return zeroFill(func.apply(this, arguments), padded[1], padded[2]);\n            };\n        }\n        if (ordinal) {\n            formatTokenFunctions[ordinal] = function () {\n                return this.localeData().ordinal(func.apply(this, arguments), token);\n            };\n        }\n    }\n\n    function removeFormattingTokens(input) {\n        if (input.match(/\\[[\\s\\S]/)) {\n            return input.replace(/^\\[|\\]$/g, '');\n        }\n        return input.replace(/\\\\/g, '');\n    }\n\n    function makeFormatFunction(format) {\n        var array = format.match(formattingTokens), i, length;\n\n        for (i = 0, length = array.length; i < length; i++) {\n            if (formatTokenFunctions[array[i]]) {\n                array[i] = formatTokenFunctions[array[i]];\n            } else {\n                array[i] = removeFormattingTokens(array[i]);\n            }\n        }\n\n        return function (mom) {\n            var output = '';\n            for (i = 0; i < length; i++) {\n                output += array[i] instanceof Function ? array[i].call(mom, format) : array[i];\n            }\n            return output;\n        };\n    }\n\n    // format date using native date object\n    function formatMoment(m, format) {\n        if (!m.isValid()) {\n            return m.localeData().invalidDate();\n        }\n\n        format = expandFormat(format, m.localeData());\n        formatFunctions[format] = formatFunctions[format] || makeFormatFunction(format);\n\n        return formatFunctions[format](m);\n    }\n\n    function expandFormat(format, locale) {\n        var i = 5;\n\n        function replaceLongDateFormatTokens(input) {\n            return locale.longDateFormat(input) || input;\n        }\n\n        localFormattingTokens.lastIndex = 0;\n        while (i >= 0 && localFormattingTokens.test(format)) {\n            format = format.replace(localFormattingTokens, replaceLongDateFormatTokens);\n            localFormattingTokens.lastIndex = 0;\n            i -= 1;\n        }\n\n        return format;\n    }\n\n    var match1         = /\\d/;            //       0 - 9\n    var match2         = /\\d\\d/;          //      00 - 99\n    var match3         = /\\d{3}/;         //     000 - 999\n    var match4         = /\\d{4}/;         //    0000 - 9999\n    var match6         = /[+-]?\\d{6}/;    // -999999 - 999999\n    var match1to2      = /\\d\\d?/;         //       0 - 99\n    var match1to3      = /\\d{1,3}/;       //       0 - 999\n    var match1to4      = /\\d{1,4}/;       //       0 - 9999\n    var match1to6      = /[+-]?\\d{1,6}/;  // -999999 - 999999\n\n    var matchUnsigned  = /\\d+/;           //       0 - inf\n    var matchSigned    = /[+-]?\\d+/;      //    -inf - inf\n\n    var matchOffset    = /Z|[+-]\\d\\d:?\\d\\d/gi; // +00:00 -00:00 +0000 -0000 or Z\n\n    var matchTimestamp = /[+-]?\\d+(\\.\\d{1,3})?/; // 123456789 123456789.123\n\n    // any word (or two) characters or numbers including two/three word month in arabic.\n    var matchWord = /[0-9]*['a-z\\u00A0-\\u05FF\\u0700-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]+|[\\u0600-\\u06FF\\/]+(\\s*?[\\u0600-\\u06FF]+){1,2}/i;\n\n    var regexes = {};\n\n    function isFunction (sth) {\n        // https://github.com/moment/moment/issues/2325\n        return typeof sth === 'function' &&\n            Object.prototype.toString.call(sth) === '[object Function]';\n    }\n\n\n    function addRegexToken (token, regex, strictRegex) {\n        regexes[token] = isFunction(regex) ? regex : function (isStrict) {\n            return (isStrict && strictRegex) ? strictRegex : regex;\n        };\n    }\n\n    function getParseRegexForToken (token, config) {\n        if (!hasOwnProp(regexes, token)) {\n            return new RegExp(unescapeFormat(token));\n        }\n\n        return regexes[token](config._strict, config._locale);\n    }\n\n    // Code from http://stackoverflow.com/questions/3561493/is-there-a-regexp-escape-function-in-javascript\n    function unescapeFormat(s) {\n        return s.replace('\\\\', '').replace(/\\\\(\\[)|\\\\(\\])|\\[([^\\]\\[]*)\\]|\\\\(.)/g, function (matched, p1, p2, p3, p4) {\n            return p1 || p2 || p3 || p4;\n        }).replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n    }\n\n    var tokens = {};\n\n    function addParseToken (token, callback) {\n        var i, func = callback;\n        if (typeof token === 'string') {\n            token = [token];\n        }\n        if (typeof callback === 'number') {\n            func = function (input, array) {\n                array[callback] = toInt(input);\n            };\n        }\n        for (i = 0; i < token.length; i++) {\n            tokens[token[i]] = func;\n        }\n    }\n\n    function addWeekParseToken (token, callback) {\n        addParseToken(token, function (input, array, config, token) {\n            config._w = config._w || {};\n            callback(input, config._w, config, token);\n        });\n    }\n\n    function addTimeToArrayFromToken(token, input, config) {\n        if (input != null && hasOwnProp(tokens, token)) {\n            tokens[token](input, config._a, config, token);\n        }\n    }\n\n    var YEAR = 0;\n    var MONTH = 1;\n    var DATE = 2;\n    var HOUR = 3;\n    var MINUTE = 4;\n    var SECOND = 5;\n    var MILLISECOND = 6;\n\n    function daysInMonth(year, month) {\n        return new Date(Date.UTC(year, month + 1, 0)).getUTCDate();\n    }\n\n    // FORMATTING\n\n    addFormatToken('M', ['MM', 2], 'Mo', function () {\n        return this.month() + 1;\n    });\n\n    addFormatToken('MMM', 0, 0, function (format) {\n        return this.localeData().monthsShort(this, format);\n    });\n\n    addFormatToken('MMMM', 0, 0, function (format) {\n        return this.localeData().months(this, format);\n    });\n\n    // ALIASES\n\n    addUnitAlias('month', 'M');\n\n    // PARSING\n\n    addRegexToken('M',    match1to2);\n    addRegexToken('MM',   match1to2, match2);\n    addRegexToken('MMM',  matchWord);\n    addRegexToken('MMMM', matchWord);\n\n    addParseToken(['M', 'MM'], function (input, array) {\n        array[MONTH] = toInt(input) - 1;\n    });\n\n    addParseToken(['MMM', 'MMMM'], function (input, array, config, token) {\n        var month = config._locale.monthsParse(input, token, config._strict);\n        // if we didn't find a month name, mark the date as invalid.\n        if (month != null) {\n            array[MONTH] = month;\n        } else {\n            getParsingFlags(config).invalidMonth = input;\n        }\n    });\n\n    // LOCALES\n\n    var defaultLocaleMonths = 'January_February_March_April_May_June_July_August_September_October_November_December'.split('_');\n    function localeMonths (m) {\n        return this._months[m.month()];\n    }\n\n    var defaultLocaleMonthsShort = 'Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec'.split('_');\n    function localeMonthsShort (m) {\n        return this._monthsShort[m.month()];\n    }\n\n    function localeMonthsParse (monthName, format, strict) {\n        var i, mom, regex;\n\n        if (!this._monthsParse) {\n            this._monthsParse = [];\n            this._longMonthsParse = [];\n            this._shortMonthsParse = [];\n        }\n\n        for (i = 0; i < 12; i++) {\n            // make the regex if we don't have it already\n            mom = create_utc__createUTC([2000, i]);\n            if (strict && !this._longMonthsParse[i]) {\n                this._longMonthsParse[i] = new RegExp('^' + this.months(mom, '').replace('.', '') + '$', 'i');\n                this._shortMonthsParse[i] = new RegExp('^' + this.monthsShort(mom, '').replace('.', '') + '$', 'i');\n            }\n            if (!strict && !this._monthsParse[i]) {\n                regex = '^' + this.months(mom, '') + '|^' + this.monthsShort(mom, '');\n                this._monthsParse[i] = new RegExp(regex.replace('.', ''), 'i');\n            }\n            // test the regex\n            if (strict && format === 'MMMM' && this._longMonthsParse[i].test(monthName)) {\n                return i;\n            } else if (strict && format === 'MMM' && this._shortMonthsParse[i].test(monthName)) {\n                return i;\n            } else if (!strict && this._monthsParse[i].test(monthName)) {\n                return i;\n            }\n        }\n    }\n\n    // MOMENTS\n\n    function setMonth (mom, value) {\n        var dayOfMonth;\n\n        // TODO: Move this out of here!\n        if (typeof value === 'string') {\n            value = mom.localeData().monthsParse(value);\n            // TODO: Another silent failure?\n            if (typeof value !== 'number') {\n                return mom;\n            }\n        }\n\n        dayOfMonth = Math.min(mom.date(), daysInMonth(mom.year(), value));\n        mom._d['set' + (mom._isUTC ? 'UTC' : '') + 'Month'](value, dayOfMonth);\n        return mom;\n    }\n\n    function getSetMonth (value) {\n        if (value != null) {\n            setMonth(this, value);\n            utils_hooks__hooks.updateOffset(this, true);\n            return this;\n        } else {\n            return get_set__get(this, 'Month');\n        }\n    }\n\n    function getDaysInMonth () {\n        return daysInMonth(this.year(), this.month());\n    }\n\n    function checkOverflow (m) {\n        var overflow;\n        var a = m._a;\n\n        if (a && getParsingFlags(m).overflow === -2) {\n            overflow =\n                a[MONTH]       < 0 || a[MONTH]       > 11  ? MONTH :\n                a[DATE]        < 1 || a[DATE]        > daysInMonth(a[YEAR], a[MONTH]) ? DATE :\n                a[HOUR]        < 0 || a[HOUR]        > 24 || (a[HOUR] === 24 && (a[MINUTE] !== 0 || a[SECOND] !== 0 || a[MILLISECOND] !== 0)) ? HOUR :\n                a[MINUTE]      < 0 || a[MINUTE]      > 59  ? MINUTE :\n                a[SECOND]      < 0 || a[SECOND]      > 59  ? SECOND :\n                a[MILLISECOND] < 0 || a[MILLISECOND] > 999 ? MILLISECOND :\n                -1;\n\n            if (getParsingFlags(m)._overflowDayOfYear && (overflow < YEAR || overflow > DATE)) {\n                overflow = DATE;\n            }\n\n            getParsingFlags(m).overflow = overflow;\n        }\n\n        return m;\n    }\n\n    function warn(msg) {\n        if (utils_hooks__hooks.suppressDeprecationWarnings === false && typeof console !== 'undefined' && console.warn) {\n            console.warn('Deprecation warning: ' + msg);\n        }\n    }\n\n    function deprecate(msg, fn) {\n        var firstTime = true;\n\n        return extend(function () {\n            if (firstTime) {\n                warn(msg + '\\n' + (new Error()).stack);\n                firstTime = false;\n            }\n            return fn.apply(this, arguments);\n        }, fn);\n    }\n\n    var deprecations = {};\n\n    function deprecateSimple(name, msg) {\n        if (!deprecations[name]) {\n            warn(msg);\n            deprecations[name] = true;\n        }\n    }\n\n    utils_hooks__hooks.suppressDeprecationWarnings = false;\n\n    var from_string__isoRegex = /^\\s*(?:[+-]\\d{6}|\\d{4})-(?:(\\d\\d-\\d\\d)|(W\\d\\d$)|(W\\d\\d-\\d)|(\\d\\d\\d))((T| )(\\d\\d(:\\d\\d(:\\d\\d(\\.\\d+)?)?)?)?([\\+\\-]\\d\\d(?::?\\d\\d)?|\\s*Z)?)?$/;\n\n    var isoDates = [\n        ['YYYYYY-MM-DD', /[+-]\\d{6}-\\d{2}-\\d{2}/],\n        ['YYYY-MM-DD', /\\d{4}-\\d{2}-\\d{2}/],\n        ['GGGG-[W]WW-E', /\\d{4}-W\\d{2}-\\d/],\n        ['GGGG-[W]WW', /\\d{4}-W\\d{2}/],\n        ['YYYY-DDD', /\\d{4}-\\d{3}/]\n    ];\n\n    // iso time formats and regexes\n    var isoTimes = [\n        ['HH:mm:ss.SSSS', /(T| )\\d\\d:\\d\\d:\\d\\d\\.\\d+/],\n        ['HH:mm:ss', /(T| )\\d\\d:\\d\\d:\\d\\d/],\n        ['HH:mm', /(T| )\\d\\d:\\d\\d/],\n        ['HH', /(T| )\\d\\d/]\n    ];\n\n    var aspNetJsonRegex = /^\\/?Date\\((\\-?\\d+)/i;\n\n    // date from iso format\n    function configFromISO(config) {\n        var i, l,\n            string = config._i,\n            match = from_string__isoRegex.exec(string);\n\n        if (match) {\n            getParsingFlags(config).iso = true;\n            for (i = 0, l = isoDates.length; i < l; i++) {\n                if (isoDates[i][1].exec(string)) {\n                    config._f = isoDates[i][0];\n                    break;\n                }\n            }\n            for (i = 0, l = isoTimes.length; i < l; i++) {\n                if (isoTimes[i][1].exec(string)) {\n                    // match[6] should be 'T' or space\n                    config._f += (match[6] || ' ') + isoTimes[i][0];\n                    break;\n                }\n            }\n            if (string.match(matchOffset)) {\n                config._f += 'Z';\n            }\n            configFromStringAndFormat(config);\n        } else {\n            config._isValid = false;\n        }\n    }\n\n    // date from iso format or fallback\n    function configFromString(config) {\n        var matched = aspNetJsonRegex.exec(config._i);\n\n        if (matched !== null) {\n            config._d = new Date(+matched[1]);\n            return;\n        }\n\n        configFromISO(config);\n        if (config._isValid === false) {\n            delete config._isValid;\n            utils_hooks__hooks.createFromInputFallback(config);\n        }\n    }\n\n    utils_hooks__hooks.createFromInputFallback = deprecate(\n        'moment construction falls back to js Date. This is ' +\n        'discouraged and will be removed in upcoming major ' +\n        'release. Please refer to ' +\n        'https://github.com/moment/moment/issues/1407 for more info.',\n        function (config) {\n            config._d = new Date(config._i + (config._useUTC ? ' UTC' : ''));\n        }\n    );\n\n    function createDate (y, m, d, h, M, s, ms) {\n        //can't just apply() to create a date:\n        //http://stackoverflow.com/questions/181348/instantiating-a-javascript-object-by-calling-prototype-constructor-apply\n        var date = new Date(y, m, d, h, M, s, ms);\n\n        //the date constructor doesn't accept years < 1970\n        if (y < 1970) {\n            date.setFullYear(y);\n        }\n        return date;\n    }\n\n    function createUTCDate (y) {\n        var date = new Date(Date.UTC.apply(null, arguments));\n        if (y < 1970) {\n            date.setUTCFullYear(y);\n        }\n        return date;\n    }\n\n    addFormatToken(0, ['YY', 2], 0, function () {\n        return this.year() % 100;\n    });\n\n    addFormatToken(0, ['YYYY',   4],       0, 'year');\n    addFormatToken(0, ['YYYYY',  5],       0, 'year');\n    addFormatToken(0, ['YYYYYY', 6, true], 0, 'year');\n\n    // ALIASES\n\n    addUnitAlias('year', 'y');\n\n    // PARSING\n\n    addRegexToken('Y',      matchSigned);\n    addRegexToken('YY',     match1to2, match2);\n    addRegexToken('YYYY',   match1to4, match4);\n    addRegexToken('YYYYY',  match1to6, match6);\n    addRegexToken('YYYYYY', match1to6, match6);\n\n    addParseToken(['YYYYY', 'YYYYYY'], YEAR);\n    addParseToken('YYYY', function (input, array) {\n        array[YEAR] = input.length === 2 ? utils_hooks__hooks.parseTwoDigitYear(input) : toInt(input);\n    });\n    addParseToken('YY', function (input, array) {\n        array[YEAR] = utils_hooks__hooks.parseTwoDigitYear(input);\n    });\n\n    // HELPERS\n\n    function daysInYear(year) {\n        return isLeapYear(year) ? 366 : 365;\n    }\n\n    function isLeapYear(year) {\n        return (year % 4 === 0 && year % 100 !== 0) || year % 400 === 0;\n    }\n\n    // HOOKS\n\n    utils_hooks__hooks.parseTwoDigitYear = function (input) {\n        return toInt(input) + (toInt(input) > 68 ? 1900 : 2000);\n    };\n\n    // MOMENTS\n\n    var getSetYear = makeGetSet('FullYear', false);\n\n    function getIsLeapYear () {\n        return isLeapYear(this.year());\n    }\n\n    addFormatToken('w', ['ww', 2], 'wo', 'week');\n    addFormatToken('W', ['WW', 2], 'Wo', 'isoWeek');\n\n    // ALIASES\n\n    addUnitAlias('week', 'w');\n    addUnitAlias('isoWeek', 'W');\n\n    // PARSING\n\n    addRegexToken('w',  match1to2);\n    addRegexToken('ww', match1to2, match2);\n    addRegexToken('W',  match1to2);\n    addRegexToken('WW', match1to2, match2);\n\n    addWeekParseToken(['w', 'ww', 'W', 'WW'], function (input, week, config, token) {\n        week[token.substr(0, 1)] = toInt(input);\n    });\n\n    // HELPERS\n\n    // firstDayOfWeek       0 = sun, 6 = sat\n    //                      the day of the week that starts the week\n    //                      (usually sunday or monday)\n    // firstDayOfWeekOfYear 0 = sun, 6 = sat\n    //                      the first week is the week that contains the first\n    //                      of this day of the week\n    //                      (eg. ISO weeks use thursday (4))\n    function weekOfYear(mom, firstDayOfWeek, firstDayOfWeekOfYear) {\n        var end = firstDayOfWeekOfYear - firstDayOfWeek,\n            daysToDayOfWeek = firstDayOfWeekOfYear - mom.day(),\n            adjustedMoment;\n\n\n        if (daysToDayOfWeek > end) {\n            daysToDayOfWeek -= 7;\n        }\n\n        if (daysToDayOfWeek < end - 7) {\n            daysToDayOfWeek += 7;\n        }\n\n        adjustedMoment = local__createLocal(mom).add(daysToDayOfWeek, 'd');\n        return {\n            week: Math.ceil(adjustedMoment.dayOfYear() / 7),\n            year: adjustedMoment.year()\n        };\n    }\n\n    // LOCALES\n\n    function localeWeek (mom) {\n        return weekOfYear(mom, this._week.dow, this._week.doy).week;\n    }\n\n    var defaultLocaleWeek = {\n        dow : 0, // Sunday is the first day of the week.\n        doy : 6  // The week that contains Jan 1st is the first week of the year.\n    };\n\n    function localeFirstDayOfWeek () {\n        return this._week.dow;\n    }\n\n    function localeFirstDayOfYear () {\n        return this._week.doy;\n    }\n\n    // MOMENTS\n\n    function getSetWeek (input) {\n        var week = this.localeData().week(this);\n        return input == null ? week : this.add((input - week) * 7, 'd');\n    }\n\n    function getSetISOWeek (input) {\n        var week = weekOfYear(this, 1, 4).week;\n        return input == null ? week : this.add((input - week) * 7, 'd');\n    }\n\n    addFormatToken('DDD', ['DDDD', 3], 'DDDo', 'dayOfYear');\n\n    // ALIASES\n\n    addUnitAlias('dayOfYear', 'DDD');\n\n    // PARSING\n\n    addRegexToken('DDD',  match1to3);\n    addRegexToken('DDDD', match3);\n    addParseToken(['DDD', 'DDDD'], function (input, array, config) {\n        config._dayOfYear = toInt(input);\n    });\n\n    // HELPERS\n\n    //http://en.wikipedia.org/wiki/ISO_week_date#Calculating_a_date_given_the_year.2C_week_number_and_weekday\n    function dayOfYearFromWeeks(year, week, weekday, firstDayOfWeekOfYear, firstDayOfWeek) {\n        var week1Jan = 6 + firstDayOfWeek - firstDayOfWeekOfYear, janX = createUTCDate(year, 0, 1 + week1Jan), d = janX.getUTCDay(), dayOfYear;\n        if (d < firstDayOfWeek) {\n            d += 7;\n        }\n\n        weekday = weekday != null ? 1 * weekday : firstDayOfWeek;\n\n        dayOfYear = 1 + week1Jan + 7 * (week - 1) - d + weekday;\n\n        return {\n            year: dayOfYear > 0 ? year : year - 1,\n            dayOfYear: dayOfYear > 0 ?  dayOfYear : daysInYear(year - 1) + dayOfYear\n        };\n    }\n\n    // MOMENTS\n\n    function getSetDayOfYear (input) {\n        var dayOfYear = Math.round((this.clone().startOf('day') - this.clone().startOf('year')) / 864e5) + 1;\n        return input == null ? dayOfYear : this.add((input - dayOfYear), 'd');\n    }\n\n    // Pick the first defined of two or three arguments.\n    function defaults(a, b, c) {\n        if (a != null) {\n            return a;\n        }\n        if (b != null) {\n            return b;\n        }\n        return c;\n    }\n\n    function currentDateArray(config) {\n        var now = new Date();\n        if (config._useUTC) {\n            return [now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate()];\n        }\n        return [now.getFullYear(), now.getMonth(), now.getDate()];\n    }\n\n    // convert an array to a date.\n    // the array should mirror the parameters below\n    // note: all values past the year are optional and will default to the lowest possible value.\n    // [year, month, day , hour, minute, second, millisecond]\n    function configFromArray (config) {\n        var i, date, input = [], currentDate, yearToUse;\n\n        if (config._d) {\n            return;\n        }\n\n        currentDate = currentDateArray(config);\n\n        //compute day of the year from weeks and weekdays\n        if (config._w && config._a[DATE] == null && config._a[MONTH] == null) {\n            dayOfYearFromWeekInfo(config);\n        }\n\n        //if the day of the year is set, figure out what it is\n        if (config._dayOfYear) {\n            yearToUse = defaults(config._a[YEAR], currentDate[YEAR]);\n\n            if (config._dayOfYear > daysInYear(yearToUse)) {\n                getParsingFlags(config)._overflowDayOfYear = true;\n            }\n\n            date = createUTCDate(yearToUse, 0, config._dayOfYear);\n            config._a[MONTH] = date.getUTCMonth();\n            config._a[DATE] = date.getUTCDate();\n        }\n\n        // Default to current date.\n        // * if no year, month, day of month are given, default to today\n        // * if day of month is given, default month and year\n        // * if month is given, default only year\n        // * if year is given, don't default anything\n        for (i = 0; i < 3 && config._a[i] == null; ++i) {\n            config._a[i] = input[i] = currentDate[i];\n        }\n\n        // Zero out whatever was not defaulted, including time\n        for (; i < 7; i++) {\n            config._a[i] = input[i] = (config._a[i] == null) ? (i === 2 ? 1 : 0) : config._a[i];\n        }\n\n        // Check for 24:00:00.000\n        if (config._a[HOUR] === 24 &&\n                config._a[MINUTE] === 0 &&\n                config._a[SECOND] === 0 &&\n                config._a[MILLISECOND] === 0) {\n            config._nextDay = true;\n            config._a[HOUR] = 0;\n        }\n\n        config._d = (config._useUTC ? createUTCDate : createDate).apply(null, input);\n        // Apply timezone offset from input. The actual utcOffset can be changed\n        // with parseZone.\n        if (config._tzm != null) {\n            config._d.setUTCMinutes(config._d.getUTCMinutes() - config._tzm);\n        }\n\n        if (config._nextDay) {\n            config._a[HOUR] = 24;\n        }\n    }\n\n    function dayOfYearFromWeekInfo(config) {\n        var w, weekYear, week, weekday, dow, doy, temp;\n\n        w = config._w;\n        if (w.GG != null || w.W != null || w.E != null) {\n            dow = 1;\n            doy = 4;\n\n            // TODO: We need to take the current isoWeekYear, but that depends on\n            // how we interpret now (local, utc, fixed offset). So create\n            // a now version of current config (take local/utc/offset flags, and\n            // create now).\n            weekYear = defaults(w.GG, config._a[YEAR], weekOfYear(local__createLocal(), 1, 4).year);\n            week = defaults(w.W, 1);\n            weekday = defaults(w.E, 1);\n        } else {\n            dow = config._locale._week.dow;\n            doy = config._locale._week.doy;\n\n            weekYear = defaults(w.gg, config._a[YEAR], weekOfYear(local__createLocal(), dow, doy).year);\n            week = defaults(w.w, 1);\n\n            if (w.d != null) {\n                // weekday -- low day numbers are considered next week\n                weekday = w.d;\n                if (weekday < dow) {\n                    ++week;\n                }\n            } else if (w.e != null) {\n                // local weekday -- counting starts from begining of week\n                weekday = w.e + dow;\n            } else {\n                // default to begining of week\n                weekday = dow;\n            }\n        }\n        temp = dayOfYearFromWeeks(weekYear, week, weekday, doy, dow);\n\n        config._a[YEAR] = temp.year;\n        config._dayOfYear = temp.dayOfYear;\n    }\n\n    utils_hooks__hooks.ISO_8601 = function () {};\n\n    // date from string and format string\n    function configFromStringAndFormat(config) {\n        // TODO: Move this to another part of the creation flow to prevent circular deps\n        if (config._f === utils_hooks__hooks.ISO_8601) {\n            configFromISO(config);\n            return;\n        }\n\n        config._a = [];\n        getParsingFlags(config).empty = true;\n\n        // This array is used to make a Date, either with `new Date` or `Date.UTC`\n        var string = '' + config._i,\n            i, parsedInput, tokens, token, skipped,\n            stringLength = string.length,\n            totalParsedInputLength = 0;\n\n        tokens = expandFormat(config._f, config._locale).match(formattingTokens) || [];\n\n        for (i = 0; i < tokens.length; i++) {\n            token = tokens[i];\n            parsedInput = (string.match(getParseRegexForToken(token, config)) || [])[0];\n            if (parsedInput) {\n                skipped = string.substr(0, string.indexOf(parsedInput));\n                if (skipped.length > 0) {\n                    getParsingFlags(config).unusedInput.push(skipped);\n                }\n                string = string.slice(string.indexOf(parsedInput) + parsedInput.length);\n                totalParsedInputLength += parsedInput.length;\n            }\n            // don't parse if it's not a known token\n            if (formatTokenFunctions[token]) {\n                if (parsedInput) {\n                    getParsingFlags(config).empty = false;\n                }\n                else {\n                    getParsingFlags(config).unusedTokens.push(token);\n                }\n                addTimeToArrayFromToken(token, parsedInput, config);\n            }\n            else if (config._strict && !parsedInput) {\n                getParsingFlags(config).unusedTokens.push(token);\n            }\n        }\n\n        // add remaining unparsed input length to the string\n        getParsingFlags(config).charsLeftOver = stringLength - totalParsedInputLength;\n        if (string.length > 0) {\n            getParsingFlags(config).unusedInput.push(string);\n        }\n\n        // clear _12h flag if hour is <= 12\n        if (getParsingFlags(config).bigHour === true &&\n                config._a[HOUR] <= 12 &&\n                config._a[HOUR] > 0) {\n            getParsingFlags(config).bigHour = undefined;\n        }\n        // handle meridiem\n        config._a[HOUR] = meridiemFixWrap(config._locale, config._a[HOUR], config._meridiem);\n\n        configFromArray(config);\n        checkOverflow(config);\n    }\n\n\n    function meridiemFixWrap (locale, hour, meridiem) {\n        var isPm;\n\n        if (meridiem == null) {\n            // nothing to do\n            return hour;\n        }\n        if (locale.meridiemHour != null) {\n            return locale.meridiemHour(hour, meridiem);\n        } else if (locale.isPM != null) {\n            // Fallback\n            isPm = locale.isPM(meridiem);\n            if (isPm && hour < 12) {\n                hour += 12;\n            }\n            if (!isPm && hour === 12) {\n                hour = 0;\n            }\n            return hour;\n        } else {\n            // this is not supposed to happen\n            return hour;\n        }\n    }\n\n    function configFromStringAndArray(config) {\n        var tempConfig,\n            bestMoment,\n\n            scoreToBeat,\n            i,\n            currentScore;\n\n        if (config._f.length === 0) {\n            getParsingFlags(config).invalidFormat = true;\n            config._d = new Date(NaN);\n            return;\n        }\n\n        for (i = 0; i < config._f.length; i++) {\n            currentScore = 0;\n            tempConfig = copyConfig({}, config);\n            if (config._useUTC != null) {\n                tempConfig._useUTC = config._useUTC;\n            }\n            tempConfig._f = config._f[i];\n            configFromStringAndFormat(tempConfig);\n\n            if (!valid__isValid(tempConfig)) {\n                continue;\n            }\n\n            // if there is any input that was not parsed add a penalty for that format\n            currentScore += getParsingFlags(tempConfig).charsLeftOver;\n\n            //or tokens\n            currentScore += getParsingFlags(tempConfig).unusedTokens.length * 10;\n\n            getParsingFlags(tempConfig).score = currentScore;\n\n            if (scoreToBeat == null || currentScore < scoreToBeat) {\n                scoreToBeat = currentScore;\n                bestMoment = tempConfig;\n            }\n        }\n\n        extend(config, bestMoment || tempConfig);\n    }\n\n    function configFromObject(config) {\n        if (config._d) {\n            return;\n        }\n\n        var i = normalizeObjectUnits(config._i);\n        config._a = [i.year, i.month, i.day || i.date, i.hour, i.minute, i.second, i.millisecond];\n\n        configFromArray(config);\n    }\n\n    function createFromConfig (config) {\n        var res = new Moment(checkOverflow(prepareConfig(config)));\n        if (res._nextDay) {\n            // Adding is smart enough around DST\n            res.add(1, 'd');\n            res._nextDay = undefined;\n        }\n\n        return res;\n    }\n\n    function prepareConfig (config) {\n        var input = config._i,\n            format = config._f;\n\n        config._locale = config._locale || locale_locales__getLocale(config._l);\n\n        if (input === null || (format === undefined && input === '')) {\n            return valid__createInvalid({nullInput: true});\n        }\n\n        if (typeof input === 'string') {\n            config._i = input = config._locale.preparse(input);\n        }\n\n        if (isMoment(input)) {\n            return new Moment(checkOverflow(input));\n        } else if (isArray(format)) {\n            configFromStringAndArray(config);\n        } else if (format) {\n            configFromStringAndFormat(config);\n        } else if (isDate(input)) {\n            config._d = input;\n        } else {\n            configFromInput(config);\n        }\n\n        return config;\n    }\n\n    function configFromInput(config) {\n        var input = config._i;\n        if (input === undefined) {\n            config._d = new Date();\n        } else if (isDate(input)) {\n            config._d = new Date(+input);\n        } else if (typeof input === 'string') {\n            configFromString(config);\n        } else if (isArray(input)) {\n            config._a = map(input.slice(0), function (obj) {\n                return parseInt(obj, 10);\n            });\n            configFromArray(config);\n        } else if (typeof(input) === 'object') {\n            configFromObject(config);\n        } else if (typeof(input) === 'number') {\n            // from milliseconds\n            config._d = new Date(input);\n        } else {\n            utils_hooks__hooks.createFromInputFallback(config);\n        }\n    }\n\n    function createLocalOrUTC (input, format, locale, strict, isUTC) {\n        var c = {};\n\n        if (typeof(locale) === 'boolean') {\n            strict = locale;\n            locale = undefined;\n        }\n        // object construction must be done this way.\n        // https://github.com/moment/moment/issues/1423\n        c._isAMomentObject = true;\n        c._useUTC = c._isUTC = isUTC;\n        c._l = locale;\n        c._i = input;\n        c._f = format;\n        c._strict = strict;\n\n        return createFromConfig(c);\n    }\n\n    function local__createLocal (input, format, locale, strict) {\n        return createLocalOrUTC(input, format, locale, strict, false);\n    }\n\n    var prototypeMin = deprecate(\n         'moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548',\n         function () {\n             var other = local__createLocal.apply(null, arguments);\n             return other < this ? this : other;\n         }\n     );\n\n    var prototypeMax = deprecate(\n        'moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548',\n        function () {\n            var other = local__createLocal.apply(null, arguments);\n            return other > this ? this : other;\n        }\n    );\n\n    // Pick a moment m from moments so that m[fn](other) is true for all\n    // other. This relies on the function fn to be transitive.\n    //\n    // moments should either be an array of moment objects or an array, whose\n    // first element is an array of moment objects.\n    function pickBy(fn, moments) {\n        var res, i;\n        if (moments.length === 1 && isArray(moments[0])) {\n            moments = moments[0];\n        }\n        if (!moments.length) {\n            return local__createLocal();\n        }\n        res = moments[0];\n        for (i = 1; i < moments.length; ++i) {\n            if (!moments[i].isValid() || moments[i][fn](res)) {\n                res = moments[i];\n            }\n        }\n        return res;\n    }\n\n    // TODO: Use [].sort instead?\n    function min () {\n        var args = [].slice.call(arguments, 0);\n\n        return pickBy('isBefore', args);\n    }\n\n    function max () {\n        var args = [].slice.call(arguments, 0);\n\n        return pickBy('isAfter', args);\n    }\n\n    function Duration (duration) {\n        var normalizedInput = normalizeObjectUnits(duration),\n            years = normalizedInput.year || 0,\n            quarters = normalizedInput.quarter || 0,\n            months = normalizedInput.month || 0,\n            weeks = normalizedInput.week || 0,\n            days = normalizedInput.day || 0,\n            hours = normalizedInput.hour || 0,\n            minutes = normalizedInput.minute || 0,\n            seconds = normalizedInput.second || 0,\n            milliseconds = normalizedInput.millisecond || 0;\n\n        // representation for dateAddRemove\n        this._milliseconds = +milliseconds +\n            seconds * 1e3 + // 1000\n            minutes * 6e4 + // 1000 * 60\n            hours * 36e5; // 1000 * 60 * 60\n        // Because of dateAddRemove treats 24 hours as different from a\n        // day when working around DST, we need to store them separately\n        this._days = +days +\n            weeks * 7;\n        // It is impossible translate months into days without knowing\n        // which months you are are talking about, so we have to store\n        // it separately.\n        this._months = +months +\n            quarters * 3 +\n            years * 12;\n\n        this._data = {};\n\n        this._locale = locale_locales__getLocale();\n\n        this._bubble();\n    }\n\n    function isDuration (obj) {\n        return obj instanceof Duration;\n    }\n\n    function offset (token, separator) {\n        addFormatToken(token, 0, 0, function () {\n            var offset = this.utcOffset();\n            var sign = '+';\n            if (offset < 0) {\n                offset = -offset;\n                sign = '-';\n            }\n            return sign + zeroFill(~~(offset / 60), 2) + separator + zeroFill(~~(offset) % 60, 2);\n        });\n    }\n\n    offset('Z', ':');\n    offset('ZZ', '');\n\n    // PARSING\n\n    addRegexToken('Z',  matchOffset);\n    addRegexToken('ZZ', matchOffset);\n    addParseToken(['Z', 'ZZ'], function (input, array, config) {\n        config._useUTC = true;\n        config._tzm = offsetFromString(input);\n    });\n\n    // HELPERS\n\n    // timezone chunker\n    // '+10:00' > ['10',  '00']\n    // '-1530'  > ['-15', '30']\n    var chunkOffset = /([\\+\\-]|\\d\\d)/gi;\n\n    function offsetFromString(string) {\n        var matches = ((string || '').match(matchOffset) || []);\n        var chunk   = matches[matches.length - 1] || [];\n        var parts   = (chunk + '').match(chunkOffset) || ['-', 0, 0];\n        var minutes = +(parts[1] * 60) + toInt(parts[2]);\n\n        return parts[0] === '+' ? minutes : -minutes;\n    }\n\n    // Return a moment from input, that is local/utc/zone equivalent to model.\n    function cloneWithOffset(input, model) {\n        var res, diff;\n        if (model._isUTC) {\n            res = model.clone();\n            diff = (isMoment(input) || isDate(input) ? +input : +local__createLocal(input)) - (+res);\n            // Use low-level api, because this fn is low-level api.\n            res._d.setTime(+res._d + diff);\n            utils_hooks__hooks.updateOffset(res, false);\n            return res;\n        } else {\n            return local__createLocal(input).local();\n        }\n    }\n\n    function getDateOffset (m) {\n        // On Firefox.24 Date#getTimezoneOffset returns a floating point.\n        // https://github.com/moment/moment/pull/1871\n        return -Math.round(m._d.getTimezoneOffset() / 15) * 15;\n    }\n\n    // HOOKS\n\n    // This function will be called whenever a moment is mutated.\n    // It is intended to keep the offset in sync with the timezone.\n    utils_hooks__hooks.updateOffset = function () {};\n\n    // MOMENTS\n\n    // keepLocalTime = true means only change the timezone, without\n    // affecting the local hour. So 5:31:26 +0300 --[utcOffset(2, true)]-->\n    // 5:31:26 +0200 It is possible that 5:31:26 doesn't exist with offset\n    // +0200, so we adjust the time as needed, to be valid.\n    //\n    // Keeping the time actually adds/subtracts (one hour)\n    // from the actual represented time. That is why we call updateOffset\n    // a second time. In case it wants us to change the offset again\n    // _changeInProgress == true case, then we have to adjust, because\n    // there is no such time in the given timezone.\n    function getSetOffset (input, keepLocalTime) {\n        var offset = this._offset || 0,\n            localAdjust;\n        if (input != null) {\n            if (typeof input === 'string') {\n                input = offsetFromString(input);\n            }\n            if (Math.abs(input) < 16) {\n                input = input * 60;\n            }\n            if (!this._isUTC && keepLocalTime) {\n                localAdjust = getDateOffset(this);\n            }\n            this._offset = input;\n            this._isUTC = true;\n            if (localAdjust != null) {\n                this.add(localAdjust, 'm');\n            }\n            if (offset !== input) {\n                if (!keepLocalTime || this._changeInProgress) {\n                    add_subtract__addSubtract(this, create__createDuration(input - offset, 'm'), 1, false);\n                } else if (!this._changeInProgress) {\n                    this._changeInProgress = true;\n                    utils_hooks__hooks.updateOffset(this, true);\n                    this._changeInProgress = null;\n                }\n            }\n            return this;\n        } else {\n            return this._isUTC ? offset : getDateOffset(this);\n        }\n    }\n\n    function getSetZone (input, keepLocalTime) {\n        if (input != null) {\n            if (typeof input !== 'string') {\n                input = -input;\n            }\n\n            this.utcOffset(input, keepLocalTime);\n\n            return this;\n        } else {\n            return -this.utcOffset();\n        }\n    }\n\n    function setOffsetToUTC (keepLocalTime) {\n        return this.utcOffset(0, keepLocalTime);\n    }\n\n    function setOffsetToLocal (keepLocalTime) {\n        if (this._isUTC) {\n            this.utcOffset(0, keepLocalTime);\n            this._isUTC = false;\n\n            if (keepLocalTime) {\n                this.subtract(getDateOffset(this), 'm');\n            }\n        }\n        return this;\n    }\n\n    function setOffsetToParsedOffset () {\n        if (this._tzm) {\n            this.utcOffset(this._tzm);\n        } else if (typeof this._i === 'string') {\n            this.utcOffset(offsetFromString(this._i));\n        }\n        return this;\n    }\n\n    function hasAlignedHourOffset (input) {\n        input = input ? local__createLocal(input).utcOffset() : 0;\n\n        return (this.utcOffset() - input) % 60 === 0;\n    }\n\n    function isDaylightSavingTime () {\n        return (\n            this.utcOffset() > this.clone().month(0).utcOffset() ||\n            this.utcOffset() > this.clone().month(5).utcOffset()\n        );\n    }\n\n    function isDaylightSavingTimeShifted () {\n        if (typeof this._isDSTShifted !== 'undefined') {\n            return this._isDSTShifted;\n        }\n\n        var c = {};\n\n        copyConfig(c, this);\n        c = prepareConfig(c);\n\n        if (c._a) {\n            var other = c._isUTC ? create_utc__createUTC(c._a) : local__createLocal(c._a);\n            this._isDSTShifted = this.isValid() &&\n                compareArrays(c._a, other.toArray()) > 0;\n        } else {\n            this._isDSTShifted = false;\n        }\n\n        return this._isDSTShifted;\n    }\n\n    function isLocal () {\n        return !this._isUTC;\n    }\n\n    function isUtcOffset () {\n        return this._isUTC;\n    }\n\n    function isUtc () {\n        return this._isUTC && this._offset === 0;\n    }\n\n    var aspNetRegex = /(\\-)?(?:(\\d*)\\.)?(\\d+)\\:(\\d+)(?:\\:(\\d+)\\.?(\\d{3})?)?/;\n\n    // from http://docs.closure-library.googlecode.com/git/closure_goog_date_date.js.source.html\n    // somewhat more in line with 4.4.3.2 2004 spec, but allows decimal anywhere\n    var create__isoRegex = /^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;\n\n    function create__createDuration (input, key) {\n        var duration = input,\n            // matching against regexp is expensive, do it on demand\n            match = null,\n            sign,\n            ret,\n            diffRes;\n\n        if (isDuration(input)) {\n            duration = {\n                ms : input._milliseconds,\n                d  : input._days,\n                M  : input._months\n            };\n        } else if (typeof input === 'number') {\n            duration = {};\n            if (key) {\n                duration[key] = input;\n            } else {\n                duration.milliseconds = input;\n            }\n        } else if (!!(match = aspNetRegex.exec(input))) {\n            sign = (match[1] === '-') ? -1 : 1;\n            duration = {\n                y  : 0,\n                d  : toInt(match[DATE])        * sign,\n                h  : toInt(match[HOUR])        * sign,\n                m  : toInt(match[MINUTE])      * sign,\n                s  : toInt(match[SECOND])      * sign,\n                ms : toInt(match[MILLISECOND]) * sign\n            };\n        } else if (!!(match = create__isoRegex.exec(input))) {\n            sign = (match[1] === '-') ? -1 : 1;\n            duration = {\n                y : parseIso(match[2], sign),\n                M : parseIso(match[3], sign),\n                d : parseIso(match[4], sign),\n                h : parseIso(match[5], sign),\n                m : parseIso(match[6], sign),\n                s : parseIso(match[7], sign),\n                w : parseIso(match[8], sign)\n            };\n        } else if (duration == null) {// checks for null or undefined\n            duration = {};\n        } else if (typeof duration === 'object' && ('from' in duration || 'to' in duration)) {\n            diffRes = momentsDifference(local__createLocal(duration.from), local__createLocal(duration.to));\n\n            duration = {};\n            duration.ms = diffRes.milliseconds;\n            duration.M = diffRes.months;\n        }\n\n        ret = new Duration(duration);\n\n        if (isDuration(input) && hasOwnProp(input, '_locale')) {\n            ret._locale = input._locale;\n        }\n\n        return ret;\n    }\n\n    create__createDuration.fn = Duration.prototype;\n\n    function parseIso (inp, sign) {\n        // We'd normally use ~~inp for this, but unfortunately it also\n        // converts floats to ints.\n        // inp may be undefined, so careful calling replace on it.\n        var res = inp && parseFloat(inp.replace(',', '.'));\n        // apply sign while we're at it\n        return (isNaN(res) ? 0 : res) * sign;\n    }\n\n    function positiveMomentsDifference(base, other) {\n        var res = {milliseconds: 0, months: 0};\n\n        res.months = other.month() - base.month() +\n            (other.year() - base.year()) * 12;\n        if (base.clone().add(res.months, 'M').isAfter(other)) {\n            --res.months;\n        }\n\n        res.milliseconds = +other - +(base.clone().add(res.months, 'M'));\n\n        return res;\n    }\n\n    function momentsDifference(base, other) {\n        var res;\n        other = cloneWithOffset(other, base);\n        if (base.isBefore(other)) {\n            res = positiveMomentsDifference(base, other);\n        } else {\n            res = positiveMomentsDifference(other, base);\n            res.milliseconds = -res.milliseconds;\n            res.months = -res.months;\n        }\n\n        return res;\n    }\n\n    function createAdder(direction, name) {\n        return function (val, period) {\n            var dur, tmp;\n            //invert the arguments, but complain about it\n            if (period !== null && !isNaN(+period)) {\n                deprecateSimple(name, 'moment().' + name  + '(period, number) is deprecated. Please use moment().' + name + '(number, period).');\n                tmp = val; val = period; period = tmp;\n            }\n\n            val = typeof val === 'string' ? +val : val;\n            dur = create__createDuration(val, period);\n            add_subtract__addSubtract(this, dur, direction);\n            return this;\n        };\n    }\n\n    function add_subtract__addSubtract (mom, duration, isAdding, updateOffset) {\n        var milliseconds = duration._milliseconds,\n            days = duration._days,\n            months = duration._months;\n        updateOffset = updateOffset == null ? true : updateOffset;\n\n        if (milliseconds) {\n            mom._d.setTime(+mom._d + milliseconds * isAdding);\n        }\n        if (days) {\n            get_set__set(mom, 'Date', get_set__get(mom, 'Date') + days * isAdding);\n        }\n        if (months) {\n            setMonth(mom, get_set__get(mom, 'Month') + months * isAdding);\n        }\n        if (updateOffset) {\n            utils_hooks__hooks.updateOffset(mom, days || months);\n        }\n    }\n\n    var add_subtract__add      = createAdder(1, 'add');\n    var add_subtract__subtract = createAdder(-1, 'subtract');\n\n    function moment_calendar__calendar (time, formats) {\n        // We want to compare the start of today, vs this.\n        // Getting start-of-today depends on whether we're local/utc/offset or not.\n        var now = time || local__createLocal(),\n            sod = cloneWithOffset(now, this).startOf('day'),\n            diff = this.diff(sod, 'days', true),\n            format = diff < -6 ? 'sameElse' :\n                diff < -1 ? 'lastWeek' :\n                diff < 0 ? 'lastDay' :\n                diff < 1 ? 'sameDay' :\n                diff < 2 ? 'nextDay' :\n                diff < 7 ? 'nextWeek' : 'sameElse';\n        return this.format(formats && formats[format] || this.localeData().calendar(format, this, local__createLocal(now)));\n    }\n\n    function clone () {\n        return new Moment(this);\n    }\n\n    function isAfter (input, units) {\n        var inputMs;\n        units = normalizeUnits(typeof units !== 'undefined' ? units : 'millisecond');\n        if (units === 'millisecond') {\n            input = isMoment(input) ? input : local__createLocal(input);\n            return +this > +input;\n        } else {\n            inputMs = isMoment(input) ? +input : +local__createLocal(input);\n            return inputMs < +this.clone().startOf(units);\n        }\n    }\n\n    function isBefore (input, units) {\n        var inputMs;\n        units = normalizeUnits(typeof units !== 'undefined' ? units : 'millisecond');\n        if (units === 'millisecond') {\n            input = isMoment(input) ? input : local__createLocal(input);\n            return +this < +input;\n        } else {\n            inputMs = isMoment(input) ? +input : +local__createLocal(input);\n            return +this.clone().endOf(units) < inputMs;\n        }\n    }\n\n    function isBetween (from, to, units) {\n        return this.isAfter(from, units) && this.isBefore(to, units);\n    }\n\n    function isSame (input, units) {\n        var inputMs;\n        units = normalizeUnits(units || 'millisecond');\n        if (units === 'millisecond') {\n            input = isMoment(input) ? input : local__createLocal(input);\n            return +this === +input;\n        } else {\n            inputMs = +local__createLocal(input);\n            return +(this.clone().startOf(units)) <= inputMs && inputMs <= +(this.clone().endOf(units));\n        }\n    }\n\n    function diff (input, units, asFloat) {\n        var that = cloneWithOffset(input, this),\n            zoneDelta = (that.utcOffset() - this.utcOffset()) * 6e4,\n            delta, output;\n\n        units = normalizeUnits(units);\n\n        if (units === 'year' || units === 'month' || units === 'quarter') {\n            output = monthDiff(this, that);\n            if (units === 'quarter') {\n                output = output / 3;\n            } else if (units === 'year') {\n                output = output / 12;\n            }\n        } else {\n            delta = this - that;\n            output = units === 'second' ? delta / 1e3 : // 1000\n                units === 'minute' ? delta / 6e4 : // 1000 * 60\n                units === 'hour' ? delta / 36e5 : // 1000 * 60 * 60\n                units === 'day' ? (delta - zoneDelta) / 864e5 : // 1000 * 60 * 60 * 24, negate dst\n                units === 'week' ? (delta - zoneDelta) / 6048e5 : // 1000 * 60 * 60 * 24 * 7, negate dst\n                delta;\n        }\n        return asFloat ? output : absFloor(output);\n    }\n\n    function monthDiff (a, b) {\n        // difference in months\n        var wholeMonthDiff = ((b.year() - a.year()) * 12) + (b.month() - a.month()),\n            // b is in (anchor - 1 month, anchor + 1 month)\n            anchor = a.clone().add(wholeMonthDiff, 'months'),\n            anchor2, adjust;\n\n        if (b - anchor < 0) {\n            anchor2 = a.clone().add(wholeMonthDiff - 1, 'months');\n            // linear across the month\n            adjust = (b - anchor) / (anchor - anchor2);\n        } else {\n            anchor2 = a.clone().add(wholeMonthDiff + 1, 'months');\n            // linear across the month\n            adjust = (b - anchor) / (anchor2 - anchor);\n        }\n\n        return -(wholeMonthDiff + adjust);\n    }\n\n    utils_hooks__hooks.defaultFormat = 'YYYY-MM-DDTHH:mm:ssZ';\n\n    function toString () {\n        return this.clone().locale('en').format('ddd MMM DD YYYY HH:mm:ss [GMT]ZZ');\n    }\n\n    function moment_format__toISOString () {\n        var m = this.clone().utc();\n        if (0 < m.year() && m.year() <= 9999) {\n            if ('function' === typeof Date.prototype.toISOString) {\n                // native implementation is ~50x faster, use it when we can\n                return this.toDate().toISOString();\n            } else {\n                return formatMoment(m, 'YYYY-MM-DD[T]HH:mm:ss.SSS[Z]');\n            }\n        } else {\n            return formatMoment(m, 'YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]');\n        }\n    }\n\n    function format (inputString) {\n        var output = formatMoment(this, inputString || utils_hooks__hooks.defaultFormat);\n        return this.localeData().postformat(output);\n    }\n\n    function from (time, withoutSuffix) {\n        if (!this.isValid()) {\n            return this.localeData().invalidDate();\n        }\n        return create__createDuration({to: this, from: time}).locale(this.locale()).humanize(!withoutSuffix);\n    }\n\n    function fromNow (withoutSuffix) {\n        return this.from(local__createLocal(), withoutSuffix);\n    }\n\n    function to (time, withoutSuffix) {\n        if (!this.isValid()) {\n            return this.localeData().invalidDate();\n        }\n        return create__createDuration({from: this, to: time}).locale(this.locale()).humanize(!withoutSuffix);\n    }\n\n    function toNow (withoutSuffix) {\n        return this.to(local__createLocal(), withoutSuffix);\n    }\n\n    function locale (key) {\n        var newLocaleData;\n\n        if (key === undefined) {\n            return this._locale._abbr;\n        } else {\n            newLocaleData = locale_locales__getLocale(key);\n            if (newLocaleData != null) {\n                this._locale = newLocaleData;\n            }\n            return this;\n        }\n    }\n\n    var lang = deprecate(\n        'moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.',\n        function (key) {\n            if (key === undefined) {\n                return this.localeData();\n            } else {\n                return this.locale(key);\n            }\n        }\n    );\n\n    function localeData () {\n        return this._locale;\n    }\n\n    function startOf (units) {\n        units = normalizeUnits(units);\n        // the following switch intentionally omits break keywords\n        // to utilize falling through the cases.\n        switch (units) {\n        case 'year':\n            this.month(0);\n            /* falls through */\n        case 'quarter':\n        case 'month':\n            this.date(1);\n            /* falls through */\n        case 'week':\n        case 'isoWeek':\n        case 'day':\n            this.hours(0);\n            /* falls through */\n        case 'hour':\n            this.minutes(0);\n            /* falls through */\n        case 'minute':\n            this.seconds(0);\n            /* falls through */\n        case 'second':\n            this.milliseconds(0);\n        }\n\n        // weeks are a special case\n        if (units === 'week') {\n            this.weekday(0);\n        }\n        if (units === 'isoWeek') {\n            this.isoWeekday(1);\n        }\n\n        // quarters are also special\n        if (units === 'quarter') {\n            this.month(Math.floor(this.month() / 3) * 3);\n        }\n\n        return this;\n    }\n\n    function endOf (units) {\n        units = normalizeUnits(units);\n        if (units === undefined || units === 'millisecond') {\n            return this;\n        }\n        return this.startOf(units).add(1, (units === 'isoWeek' ? 'week' : units)).subtract(1, 'ms');\n    }\n\n    function to_type__valueOf () {\n        return +this._d - ((this._offset || 0) * 60000);\n    }\n\n    function unix () {\n        return Math.floor(+this / 1000);\n    }\n\n    function toDate () {\n        return this._offset ? new Date(+this) : this._d;\n    }\n\n    function toArray () {\n        var m = this;\n        return [m.year(), m.month(), m.date(), m.hour(), m.minute(), m.second(), m.millisecond()];\n    }\n\n    function toObject () {\n        var m = this;\n        return {\n            years: m.year(),\n            months: m.month(),\n            date: m.date(),\n            hours: m.hours(),\n            minutes: m.minutes(),\n            seconds: m.seconds(),\n            milliseconds: m.milliseconds()\n        };\n    }\n\n    function moment_valid__isValid () {\n        return valid__isValid(this);\n    }\n\n    function parsingFlags () {\n        return extend({}, getParsingFlags(this));\n    }\n\n    function invalidAt () {\n        return getParsingFlags(this).overflow;\n    }\n\n    addFormatToken(0, ['gg', 2], 0, function () {\n        return this.weekYear() % 100;\n    });\n\n    addFormatToken(0, ['GG', 2], 0, function () {\n        return this.isoWeekYear() % 100;\n    });\n\n    function addWeekYearFormatToken (token, getter) {\n        addFormatToken(0, [token, token.length], 0, getter);\n    }\n\n    addWeekYearFormatToken('gggg',     'weekYear');\n    addWeekYearFormatToken('ggggg',    'weekYear');\n    addWeekYearFormatToken('GGGG',  'isoWeekYear');\n    addWeekYearFormatToken('GGGGG', 'isoWeekYear');\n\n    // ALIASES\n\n    addUnitAlias('weekYear', 'gg');\n    addUnitAlias('isoWeekYear', 'GG');\n\n    // PARSING\n\n    addRegexToken('G',      matchSigned);\n    addRegexToken('g',      matchSigned);\n    addRegexToken('GG',     match1to2, match2);\n    addRegexToken('gg',     match1to2, match2);\n    addRegexToken('GGGG',   match1to4, match4);\n    addRegexToken('gggg',   match1to4, match4);\n    addRegexToken('GGGGG',  match1to6, match6);\n    addRegexToken('ggggg',  match1to6, match6);\n\n    addWeekParseToken(['gggg', 'ggggg', 'GGGG', 'GGGGG'], function (input, week, config, token) {\n        week[token.substr(0, 2)] = toInt(input);\n    });\n\n    addWeekParseToken(['gg', 'GG'], function (input, week, config, token) {\n        week[token] = utils_hooks__hooks.parseTwoDigitYear(input);\n    });\n\n    // HELPERS\n\n    function weeksInYear(year, dow, doy) {\n        return weekOfYear(local__createLocal([year, 11, 31 + dow - doy]), dow, doy).week;\n    }\n\n    // MOMENTS\n\n    function getSetWeekYear (input) {\n        var year = weekOfYear(this, this.localeData()._week.dow, this.localeData()._week.doy).year;\n        return input == null ? year : this.add((input - year), 'y');\n    }\n\n    function getSetISOWeekYear (input) {\n        var year = weekOfYear(this, 1, 4).year;\n        return input == null ? year : this.add((input - year), 'y');\n    }\n\n    function getISOWeeksInYear () {\n        return weeksInYear(this.year(), 1, 4);\n    }\n\n    function getWeeksInYear () {\n        var weekInfo = this.localeData()._week;\n        return weeksInYear(this.year(), weekInfo.dow, weekInfo.doy);\n    }\n\n    addFormatToken('Q', 0, 0, 'quarter');\n\n    // ALIASES\n\n    addUnitAlias('quarter', 'Q');\n\n    // PARSING\n\n    addRegexToken('Q', match1);\n    addParseToken('Q', function (input, array) {\n        array[MONTH] = (toInt(input) - 1) * 3;\n    });\n\n    // MOMENTS\n\n    function getSetQuarter (input) {\n        return input == null ? Math.ceil((this.month() + 1) / 3) : this.month((input - 1) * 3 + this.month() % 3);\n    }\n\n    addFormatToken('D', ['DD', 2], 'Do', 'date');\n\n    // ALIASES\n\n    addUnitAlias('date', 'D');\n\n    // PARSING\n\n    addRegexToken('D',  match1to2);\n    addRegexToken('DD', match1to2, match2);\n    addRegexToken('Do', function (isStrict, locale) {\n        return isStrict ? locale._ordinalParse : locale._ordinalParseLenient;\n    });\n\n    addParseToken(['D', 'DD'], DATE);\n    addParseToken('Do', function (input, array) {\n        array[DATE] = toInt(input.match(match1to2)[0], 10);\n    });\n\n    // MOMENTS\n\n    var getSetDayOfMonth = makeGetSet('Date', true);\n\n    addFormatToken('d', 0, 'do', 'day');\n\n    addFormatToken('dd', 0, 0, function (format) {\n        return this.localeData().weekdaysMin(this, format);\n    });\n\n    addFormatToken('ddd', 0, 0, function (format) {\n        return this.localeData().weekdaysShort(this, format);\n    });\n\n    addFormatToken('dddd', 0, 0, function (format) {\n        return this.localeData().weekdays(this, format);\n    });\n\n    addFormatToken('e', 0, 0, 'weekday');\n    addFormatToken('E', 0, 0, 'isoWeekday');\n\n    // ALIASES\n\n    addUnitAlias('day', 'd');\n    addUnitAlias('weekday', 'e');\n    addUnitAlias('isoWeekday', 'E');\n\n    // PARSING\n\n    addRegexToken('d',    match1to2);\n    addRegexToken('e',    match1to2);\n    addRegexToken('E',    match1to2);\n    addRegexToken('dd',   matchWord);\n    addRegexToken('ddd',  matchWord);\n    addRegexToken('dddd', matchWord);\n\n    addWeekParseToken(['dd', 'ddd', 'dddd'], function (input, week, config) {\n        var weekday = config._locale.weekdaysParse(input);\n        // if we didn't get a weekday name, mark the date as invalid\n        if (weekday != null) {\n            week.d = weekday;\n        } else {\n            getParsingFlags(config).invalidWeekday = input;\n        }\n    });\n\n    addWeekParseToken(['d', 'e', 'E'], function (input, week, config, token) {\n        week[token] = toInt(input);\n    });\n\n    // HELPERS\n\n    function parseWeekday(input, locale) {\n        if (typeof input !== 'string') {\n            return input;\n        }\n\n        if (!isNaN(input)) {\n            return parseInt(input, 10);\n        }\n\n        input = locale.weekdaysParse(input);\n        if (typeof input === 'number') {\n            return input;\n        }\n\n        return null;\n    }\n\n    // LOCALES\n\n    var defaultLocaleWeekdays = 'Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday'.split('_');\n    function localeWeekdays (m) {\n        return this._weekdays[m.day()];\n    }\n\n    var defaultLocaleWeekdaysShort = 'Sun_Mon_Tue_Wed_Thu_Fri_Sat'.split('_');\n    function localeWeekdaysShort (m) {\n        return this._weekdaysShort[m.day()];\n    }\n\n    var defaultLocaleWeekdaysMin = 'Su_Mo_Tu_We_Th_Fr_Sa'.split('_');\n    function localeWeekdaysMin (m) {\n        return this._weekdaysMin[m.day()];\n    }\n\n    function localeWeekdaysParse (weekdayName) {\n        var i, mom, regex;\n\n        this._weekdaysParse = this._weekdaysParse || [];\n\n        for (i = 0; i < 7; i++) {\n            // make the regex if we don't have it already\n            if (!this._weekdaysParse[i]) {\n                mom = local__createLocal([2000, 1]).day(i);\n                regex = '^' + this.weekdays(mom, '') + '|^' + this.weekdaysShort(mom, '') + '|^' + this.weekdaysMin(mom, '');\n                this._weekdaysParse[i] = new RegExp(regex.replace('.', ''), 'i');\n            }\n            // test the regex\n            if (this._weekdaysParse[i].test(weekdayName)) {\n                return i;\n            }\n        }\n    }\n\n    // MOMENTS\n\n    function getSetDayOfWeek (input) {\n        var day = this._isUTC ? this._d.getUTCDay() : this._d.getDay();\n        if (input != null) {\n            input = parseWeekday(input, this.localeData());\n            return this.add(input - day, 'd');\n        } else {\n            return day;\n        }\n    }\n\n    function getSetLocaleDayOfWeek (input) {\n        var weekday = (this.day() + 7 - this.localeData()._week.dow) % 7;\n        return input == null ? weekday : this.add(input - weekday, 'd');\n    }\n\n    function getSetISODayOfWeek (input) {\n        // behaves the same as moment#day except\n        // as a getter, returns 7 instead of 0 (1-7 range instead of 0-6)\n        // as a setter, sunday should belong to the previous week.\n        return input == null ? this.day() || 7 : this.day(this.day() % 7 ? input : input - 7);\n    }\n\n    addFormatToken('H', ['HH', 2], 0, 'hour');\n    addFormatToken('h', ['hh', 2], 0, function () {\n        return this.hours() % 12 || 12;\n    });\n\n    function meridiem (token, lowercase) {\n        addFormatToken(token, 0, 0, function () {\n            return this.localeData().meridiem(this.hours(), this.minutes(), lowercase);\n        });\n    }\n\n    meridiem('a', true);\n    meridiem('A', false);\n\n    // ALIASES\n\n    addUnitAlias('hour', 'h');\n\n    // PARSING\n\n    function matchMeridiem (isStrict, locale) {\n        return locale._meridiemParse;\n    }\n\n    addRegexToken('a',  matchMeridiem);\n    addRegexToken('A',  matchMeridiem);\n    addRegexToken('H',  match1to2);\n    addRegexToken('h',  match1to2);\n    addRegexToken('HH', match1to2, match2);\n    addRegexToken('hh', match1to2, match2);\n\n    addParseToken(['H', 'HH'], HOUR);\n    addParseToken(['a', 'A'], function (input, array, config) {\n        config._isPm = config._locale.isPM(input);\n        config._meridiem = input;\n    });\n    addParseToken(['h', 'hh'], function (input, array, config) {\n        array[HOUR] = toInt(input);\n        getParsingFlags(config).bigHour = true;\n    });\n\n    // LOCALES\n\n    function localeIsPM (input) {\n        // IE8 Quirks Mode & IE7 Standards Mode do not allow accessing strings like arrays\n        // Using charAt should be more compatible.\n        return ((input + '').toLowerCase().charAt(0) === 'p');\n    }\n\n    var defaultLocaleMeridiemParse = /[ap]\\.?m?\\.?/i;\n    function localeMeridiem (hours, minutes, isLower) {\n        if (hours > 11) {\n            return isLower ? 'pm' : 'PM';\n        } else {\n            return isLower ? 'am' : 'AM';\n        }\n    }\n\n\n    // MOMENTS\n\n    // Setting the hour should keep the time, because the user explicitly\n    // specified which hour he wants. So trying to maintain the same hour (in\n    // a new timezone) makes sense. Adding/subtracting hours does not follow\n    // this rule.\n    var getSetHour = makeGetSet('Hours', true);\n\n    addFormatToken('m', ['mm', 2], 0, 'minute');\n\n    // ALIASES\n\n    addUnitAlias('minute', 'm');\n\n    // PARSING\n\n    addRegexToken('m',  match1to2);\n    addRegexToken('mm', match1to2, match2);\n    addParseToken(['m', 'mm'], MINUTE);\n\n    // MOMENTS\n\n    var getSetMinute = makeGetSet('Minutes', false);\n\n    addFormatToken('s', ['ss', 2], 0, 'second');\n\n    // ALIASES\n\n    addUnitAlias('second', 's');\n\n    // PARSING\n\n    addRegexToken('s',  match1to2);\n    addRegexToken('ss', match1to2, match2);\n    addParseToken(['s', 'ss'], SECOND);\n\n    // MOMENTS\n\n    var getSetSecond = makeGetSet('Seconds', false);\n\n    addFormatToken('S', 0, 0, function () {\n        return ~~(this.millisecond() / 100);\n    });\n\n    addFormatToken(0, ['SS', 2], 0, function () {\n        return ~~(this.millisecond() / 10);\n    });\n\n    addFormatToken(0, ['SSS', 3], 0, 'millisecond');\n    addFormatToken(0, ['SSSS', 4], 0, function () {\n        return this.millisecond() * 10;\n    });\n    addFormatToken(0, ['SSSSS', 5], 0, function () {\n        return this.millisecond() * 100;\n    });\n    addFormatToken(0, ['SSSSSS', 6], 0, function () {\n        return this.millisecond() * 1000;\n    });\n    addFormatToken(0, ['SSSSSSS', 7], 0, function () {\n        return this.millisecond() * 10000;\n    });\n    addFormatToken(0, ['SSSSSSSS', 8], 0, function () {\n        return this.millisecond() * 100000;\n    });\n    addFormatToken(0, ['SSSSSSSSS', 9], 0, function () {\n        return this.millisecond() * 1000000;\n    });\n\n\n    // ALIASES\n\n    addUnitAlias('millisecond', 'ms');\n\n    // PARSING\n\n    addRegexToken('S',    match1to3, match1);\n    addRegexToken('SS',   match1to3, match2);\n    addRegexToken('SSS',  match1to3, match3);\n\n    var token;\n    for (token = 'SSSS'; token.length <= 9; token += 'S') {\n        addRegexToken(token, matchUnsigned);\n    }\n\n    function parseMs(input, array) {\n        array[MILLISECOND] = toInt(('0.' + input) * 1000);\n    }\n\n    for (token = 'S'; token.length <= 9; token += 'S') {\n        addParseToken(token, parseMs);\n    }\n    // MOMENTS\n\n    var getSetMillisecond = makeGetSet('Milliseconds', false);\n\n    addFormatToken('z',  0, 0, 'zoneAbbr');\n    addFormatToken('zz', 0, 0, 'zoneName');\n\n    // MOMENTS\n\n    function getZoneAbbr () {\n        return this._isUTC ? 'UTC' : '';\n    }\n\n    function getZoneName () {\n        return this._isUTC ? 'Coordinated Universal Time' : '';\n    }\n\n    var momentPrototype__proto = Moment.prototype;\n\n    momentPrototype__proto.add          = add_subtract__add;\n    momentPrototype__proto.calendar     = moment_calendar__calendar;\n    momentPrototype__proto.clone        = clone;\n    momentPrototype__proto.diff         = diff;\n    momentPrototype__proto.endOf        = endOf;\n    momentPrototype__proto.format       = format;\n    momentPrototype__proto.from         = from;\n    momentPrototype__proto.fromNow      = fromNow;\n    momentPrototype__proto.to           = to;\n    momentPrototype__proto.toNow        = toNow;\n    momentPrototype__proto.get          = getSet;\n    momentPrototype__proto.invalidAt    = invalidAt;\n    momentPrototype__proto.isAfter      = isAfter;\n    momentPrototype__proto.isBefore     = isBefore;\n    momentPrototype__proto.isBetween    = isBetween;\n    momentPrototype__proto.isSame       = isSame;\n    momentPrototype__proto.isValid      = moment_valid__isValid;\n    momentPrototype__proto.lang         = lang;\n    momentPrototype__proto.locale       = locale;\n    momentPrototype__proto.localeData   = localeData;\n    momentPrototype__proto.max          = prototypeMax;\n    momentPrototype__proto.min          = prototypeMin;\n    momentPrototype__proto.parsingFlags = parsingFlags;\n    momentPrototype__proto.set          = getSet;\n    momentPrototype__proto.startOf      = startOf;\n    momentPrototype__proto.subtract     = add_subtract__subtract;\n    momentPrototype__proto.toArray      = toArray;\n    momentPrototype__proto.toObject     = toObject;\n    momentPrototype__proto.toDate       = toDate;\n    momentPrototype__proto.toISOString  = moment_format__toISOString;\n    momentPrototype__proto.toJSON       = moment_format__toISOString;\n    momentPrototype__proto.toString     = toString;\n    momentPrototype__proto.unix         = unix;\n    momentPrototype__proto.valueOf      = to_type__valueOf;\n\n    // Year\n    momentPrototype__proto.year       = getSetYear;\n    momentPrototype__proto.isLeapYear = getIsLeapYear;\n\n    // Week Year\n    momentPrototype__proto.weekYear    = getSetWeekYear;\n    momentPrototype__proto.isoWeekYear = getSetISOWeekYear;\n\n    // Quarter\n    momentPrototype__proto.quarter = momentPrototype__proto.quarters = getSetQuarter;\n\n    // Month\n    momentPrototype__proto.month       = getSetMonth;\n    momentPrototype__proto.daysInMonth = getDaysInMonth;\n\n    // Week\n    momentPrototype__proto.week           = momentPrototype__proto.weeks        = getSetWeek;\n    momentPrototype__proto.isoWeek        = momentPrototype__proto.isoWeeks     = getSetISOWeek;\n    momentPrototype__proto.weeksInYear    = getWeeksInYear;\n    momentPrototype__proto.isoWeeksInYear = getISOWeeksInYear;\n\n    // Day\n    momentPrototype__proto.date       = getSetDayOfMonth;\n    momentPrototype__proto.day        = momentPrototype__proto.days             = getSetDayOfWeek;\n    momentPrototype__proto.weekday    = getSetLocaleDayOfWeek;\n    momentPrototype__proto.isoWeekday = getSetISODayOfWeek;\n    momentPrototype__proto.dayOfYear  = getSetDayOfYear;\n\n    // Hour\n    momentPrototype__proto.hour = momentPrototype__proto.hours = getSetHour;\n\n    // Minute\n    momentPrototype__proto.minute = momentPrototype__proto.minutes = getSetMinute;\n\n    // Second\n    momentPrototype__proto.second = momentPrototype__proto.seconds = getSetSecond;\n\n    // Millisecond\n    momentPrototype__proto.millisecond = momentPrototype__proto.milliseconds = getSetMillisecond;\n\n    // Offset\n    momentPrototype__proto.utcOffset            = getSetOffset;\n    momentPrototype__proto.utc                  = setOffsetToUTC;\n    momentPrototype__proto.local                = setOffsetToLocal;\n    momentPrototype__proto.parseZone            = setOffsetToParsedOffset;\n    momentPrototype__proto.hasAlignedHourOffset = hasAlignedHourOffset;\n    momentPrototype__proto.isDST                = isDaylightSavingTime;\n    momentPrototype__proto.isDSTShifted         = isDaylightSavingTimeShifted;\n    momentPrototype__proto.isLocal              = isLocal;\n    momentPrototype__proto.isUtcOffset          = isUtcOffset;\n    momentPrototype__proto.isUtc                = isUtc;\n    momentPrototype__proto.isUTC                = isUtc;\n\n    // Timezone\n    momentPrototype__proto.zoneAbbr = getZoneAbbr;\n    momentPrototype__proto.zoneName = getZoneName;\n\n    // Deprecations\n    momentPrototype__proto.dates  = deprecate('dates accessor is deprecated. Use date instead.', getSetDayOfMonth);\n    momentPrototype__proto.months = deprecate('months accessor is deprecated. Use month instead', getSetMonth);\n    momentPrototype__proto.years  = deprecate('years accessor is deprecated. Use year instead', getSetYear);\n    momentPrototype__proto.zone   = deprecate('moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779', getSetZone);\n\n    var momentPrototype = momentPrototype__proto;\n\n    function moment__createUnix (input) {\n        return local__createLocal(input * 1000);\n    }\n\n    function moment__createInZone () {\n        return local__createLocal.apply(null, arguments).parseZone();\n    }\n\n    var defaultCalendar = {\n        sameDay : '[Today at] LT',\n        nextDay : '[Tomorrow at] LT',\n        nextWeek : 'dddd [at] LT',\n        lastDay : '[Yesterday at] LT',\n        lastWeek : '[Last] dddd [at] LT',\n        sameElse : 'L'\n    };\n\n    function locale_calendar__calendar (key, mom, now) {\n        var output = this._calendar[key];\n        return typeof output === 'function' ? output.call(mom, now) : output;\n    }\n\n    var defaultLongDateFormat = {\n        LTS  : 'h:mm:ss A',\n        LT   : 'h:mm A',\n        L    : 'MM/DD/YYYY',\n        LL   : 'MMMM D, YYYY',\n        LLL  : 'MMMM D, YYYY h:mm A',\n        LLLL : 'dddd, MMMM D, YYYY h:mm A'\n    };\n\n    function longDateFormat (key) {\n        var format = this._longDateFormat[key],\n            formatUpper = this._longDateFormat[key.toUpperCase()];\n\n        if (format || !formatUpper) {\n            return format;\n        }\n\n        this._longDateFormat[key] = formatUpper.replace(/MMMM|MM|DD|dddd/g, function (val) {\n            return val.slice(1);\n        });\n\n        return this._longDateFormat[key];\n    }\n\n    var defaultInvalidDate = 'Invalid date';\n\n    function invalidDate () {\n        return this._invalidDate;\n    }\n\n    var defaultOrdinal = '%d';\n    var defaultOrdinalParse = /\\d{1,2}/;\n\n    function ordinal (number) {\n        return this._ordinal.replace('%d', number);\n    }\n\n    function preParsePostFormat (string) {\n        return string;\n    }\n\n    var defaultRelativeTime = {\n        future : 'in %s',\n        past   : '%s ago',\n        s  : 'a few seconds',\n        m  : 'a minute',\n        mm : '%d minutes',\n        h  : 'an hour',\n        hh : '%d hours',\n        d  : 'a day',\n        dd : '%d days',\n        M  : 'a month',\n        MM : '%d months',\n        y  : 'a year',\n        yy : '%d years'\n    };\n\n    function relative__relativeTime (number, withoutSuffix, string, isFuture) {\n        var output = this._relativeTime[string];\n        return (typeof output === 'function') ?\n            output(number, withoutSuffix, string, isFuture) :\n            output.replace(/%d/i, number);\n    }\n\n    function pastFuture (diff, output) {\n        var format = this._relativeTime[diff > 0 ? 'future' : 'past'];\n        return typeof format === 'function' ? format(output) : format.replace(/%s/i, output);\n    }\n\n    function locale_set__set (config) {\n        var prop, i;\n        for (i in config) {\n            prop = config[i];\n            if (typeof prop === 'function') {\n                this[i] = prop;\n            } else {\n                this['_' + i] = prop;\n            }\n        }\n        // Lenient ordinal parsing accepts just a number in addition to\n        // number + (possibly) stuff coming from _ordinalParseLenient.\n        this._ordinalParseLenient = new RegExp(this._ordinalParse.source + '|' + (/\\d{1,2}/).source);\n    }\n\n    var prototype__proto = Locale.prototype;\n\n    prototype__proto._calendar       = defaultCalendar;\n    prototype__proto.calendar        = locale_calendar__calendar;\n    prototype__proto._longDateFormat = defaultLongDateFormat;\n    prototype__proto.longDateFormat  = longDateFormat;\n    prototype__proto._invalidDate    = defaultInvalidDate;\n    prototype__proto.invalidDate     = invalidDate;\n    prototype__proto._ordinal        = defaultOrdinal;\n    prototype__proto.ordinal         = ordinal;\n    prototype__proto._ordinalParse   = defaultOrdinalParse;\n    prototype__proto.preparse        = preParsePostFormat;\n    prototype__proto.postformat      = preParsePostFormat;\n    prototype__proto._relativeTime   = defaultRelativeTime;\n    prototype__proto.relativeTime    = relative__relativeTime;\n    prototype__proto.pastFuture      = pastFuture;\n    prototype__proto.set             = locale_set__set;\n\n    // Month\n    prototype__proto.months       =        localeMonths;\n    prototype__proto._months      = defaultLocaleMonths;\n    prototype__proto.monthsShort  =        localeMonthsShort;\n    prototype__proto._monthsShort = defaultLocaleMonthsShort;\n    prototype__proto.monthsParse  =        localeMonthsParse;\n\n    // Week\n    prototype__proto.week = localeWeek;\n    prototype__proto._week = defaultLocaleWeek;\n    prototype__proto.firstDayOfYear = localeFirstDayOfYear;\n    prototype__proto.firstDayOfWeek = localeFirstDayOfWeek;\n\n    // Day of Week\n    prototype__proto.weekdays       =        localeWeekdays;\n    prototype__proto._weekdays      = defaultLocaleWeekdays;\n    prototype__proto.weekdaysMin    =        localeWeekdaysMin;\n    prototype__proto._weekdaysMin   = defaultLocaleWeekdaysMin;\n    prototype__proto.weekdaysShort  =        localeWeekdaysShort;\n    prototype__proto._weekdaysShort = defaultLocaleWeekdaysShort;\n    prototype__proto.weekdaysParse  =        localeWeekdaysParse;\n\n    // Hours\n    prototype__proto.isPM = localeIsPM;\n    prototype__proto._meridiemParse = defaultLocaleMeridiemParse;\n    prototype__proto.meridiem = localeMeridiem;\n\n    function lists__get (format, index, field, setter) {\n        var locale = locale_locales__getLocale();\n        var utc = create_utc__createUTC().set(setter, index);\n        return locale[field](utc, format);\n    }\n\n    function list (format, index, field, count, setter) {\n        if (typeof format === 'number') {\n            index = format;\n            format = undefined;\n        }\n\n        format = format || '';\n\n        if (index != null) {\n            return lists__get(format, index, field, setter);\n        }\n\n        var i;\n        var out = [];\n        for (i = 0; i < count; i++) {\n            out[i] = lists__get(format, i, field, setter);\n        }\n        return out;\n    }\n\n    function lists__listMonths (format, index) {\n        return list(format, index, 'months', 12, 'month');\n    }\n\n    function lists__listMonthsShort (format, index) {\n        return list(format, index, 'monthsShort', 12, 'month');\n    }\n\n    function lists__listWeekdays (format, index) {\n        return list(format, index, 'weekdays', 7, 'day');\n    }\n\n    function lists__listWeekdaysShort (format, index) {\n        return list(format, index, 'weekdaysShort', 7, 'day');\n    }\n\n    function lists__listWeekdaysMin (format, index) {\n        return list(format, index, 'weekdaysMin', 7, 'day');\n    }\n\n    locale_locales__getSetGlobalLocale('en', {\n        ordinalParse: /\\d{1,2}(th|st|nd|rd)/,\n        ordinal : function (number) {\n            var b = number % 10,\n                output = (toInt(number % 100 / 10) === 1) ? 'th' :\n                (b === 1) ? 'st' :\n                (b === 2) ? 'nd' :\n                (b === 3) ? 'rd' : 'th';\n            return number + output;\n        }\n    });\n\n    // Side effect imports\n    utils_hooks__hooks.lang = deprecate('moment.lang is deprecated. Use moment.locale instead.', locale_locales__getSetGlobalLocale);\n    utils_hooks__hooks.langData = deprecate('moment.langData is deprecated. Use moment.localeData instead.', locale_locales__getLocale);\n\n    var mathAbs = Math.abs;\n\n    function duration_abs__abs () {\n        var data           = this._data;\n\n        this._milliseconds = mathAbs(this._milliseconds);\n        this._days         = mathAbs(this._days);\n        this._months       = mathAbs(this._months);\n\n        data.milliseconds  = mathAbs(data.milliseconds);\n        data.seconds       = mathAbs(data.seconds);\n        data.minutes       = mathAbs(data.minutes);\n        data.hours         = mathAbs(data.hours);\n        data.months        = mathAbs(data.months);\n        data.years         = mathAbs(data.years);\n\n        return this;\n    }\n\n    function duration_add_subtract__addSubtract (duration, input, value, direction) {\n        var other = create__createDuration(input, value);\n\n        duration._milliseconds += direction * other._milliseconds;\n        duration._days         += direction * other._days;\n        duration._months       += direction * other._months;\n\n        return duration._bubble();\n    }\n\n    // supports only 2.0-style add(1, 's') or add(duration)\n    function duration_add_subtract__add (input, value) {\n        return duration_add_subtract__addSubtract(this, input, value, 1);\n    }\n\n    // supports only 2.0-style subtract(1, 's') or subtract(duration)\n    function duration_add_subtract__subtract (input, value) {\n        return duration_add_subtract__addSubtract(this, input, value, -1);\n    }\n\n    function absCeil (number) {\n        if (number < 0) {\n            return Math.floor(number);\n        } else {\n            return Math.ceil(number);\n        }\n    }\n\n    function bubble () {\n        var milliseconds = this._milliseconds;\n        var days         = this._days;\n        var months       = this._months;\n        var data         = this._data;\n        var seconds, minutes, hours, years, monthsFromDays;\n\n        // if we have a mix of positive and negative values, bubble down first\n        // check: https://github.com/moment/moment/issues/2166\n        if (!((milliseconds >= 0 && days >= 0 && months >= 0) ||\n                (milliseconds <= 0 && days <= 0 && months <= 0))) {\n            milliseconds += absCeil(monthsToDays(months) + days) * 864e5;\n            days = 0;\n            months = 0;\n        }\n\n        // The following code bubbles up values, see the tests for\n        // examples of what that means.\n        data.milliseconds = milliseconds % 1000;\n\n        seconds           = absFloor(milliseconds / 1000);\n        data.seconds      = seconds % 60;\n\n        minutes           = absFloor(seconds / 60);\n        data.minutes      = minutes % 60;\n\n        hours             = absFloor(minutes / 60);\n        data.hours        = hours % 24;\n\n        days += absFloor(hours / 24);\n\n        // convert days to months\n        monthsFromDays = absFloor(daysToMonths(days));\n        months += monthsFromDays;\n        days -= absCeil(monthsToDays(monthsFromDays));\n\n        // 12 months -> 1 year\n        years = absFloor(months / 12);\n        months %= 12;\n\n        data.days   = days;\n        data.months = months;\n        data.years  = years;\n\n        return this;\n    }\n\n    function daysToMonths (days) {\n        // 400 years have 146097 days (taking into account leap year rules)\n        // 400 years have 12 months === 4800\n        return days * 4800 / 146097;\n    }\n\n    function monthsToDays (months) {\n        // the reverse of daysToMonths\n        return months * 146097 / 4800;\n    }\n\n    function as (units) {\n        var days;\n        var months;\n        var milliseconds = this._milliseconds;\n\n        units = normalizeUnits(units);\n\n        if (units === 'month' || units === 'year') {\n            days   = this._days   + milliseconds / 864e5;\n            months = this._months + daysToMonths(days);\n            return units === 'month' ? months : months / 12;\n        } else {\n            // handle milliseconds separately because of floating point math errors (issue #1867)\n            days = this._days + Math.round(monthsToDays(this._months));\n            switch (units) {\n                case 'week'   : return days / 7     + milliseconds / 6048e5;\n                case 'day'    : return days         + milliseconds / 864e5;\n                case 'hour'   : return days * 24    + milliseconds / 36e5;\n                case 'minute' : return days * 1440  + milliseconds / 6e4;\n                case 'second' : return days * 86400 + milliseconds / 1000;\n                // Math.floor prevents floating point math errors here\n                case 'millisecond': return Math.floor(days * 864e5) + milliseconds;\n                default: throw new Error('Unknown unit ' + units);\n            }\n        }\n    }\n\n    // TODO: Use this.as('ms')?\n    function duration_as__valueOf () {\n        return (\n            this._milliseconds +\n            this._days * 864e5 +\n            (this._months % 12) * 2592e6 +\n            toInt(this._months / 12) * 31536e6\n        );\n    }\n\n    function makeAs (alias) {\n        return function () {\n            return this.as(alias);\n        };\n    }\n\n    var asMilliseconds = makeAs('ms');\n    var asSeconds      = makeAs('s');\n    var asMinutes      = makeAs('m');\n    var asHours        = makeAs('h');\n    var asDays         = makeAs('d');\n    var asWeeks        = makeAs('w');\n    var asMonths       = makeAs('M');\n    var asYears        = makeAs('y');\n\n    function duration_get__get (units) {\n        units = normalizeUnits(units);\n        return this[units + 's']();\n    }\n\n    function makeGetter(name) {\n        return function () {\n            return this._data[name];\n        };\n    }\n\n    var milliseconds = makeGetter('milliseconds');\n    var seconds      = makeGetter('seconds');\n    var minutes      = makeGetter('minutes');\n    var hours        = makeGetter('hours');\n    var days         = makeGetter('days');\n    var months       = makeGetter('months');\n    var years        = makeGetter('years');\n\n    function weeks () {\n        return absFloor(this.days() / 7);\n    }\n\n    var round = Math.round;\n    var thresholds = {\n        s: 45,  // seconds to minute\n        m: 45,  // minutes to hour\n        h: 22,  // hours to day\n        d: 26,  // days to month\n        M: 11   // months to year\n    };\n\n    // helper function for moment.fn.from, moment.fn.fromNow, and moment.duration.fn.humanize\n    function substituteTimeAgo(string, number, withoutSuffix, isFuture, locale) {\n        return locale.relativeTime(number || 1, !!withoutSuffix, string, isFuture);\n    }\n\n    function duration_humanize__relativeTime (posNegDuration, withoutSuffix, locale) {\n        var duration = create__createDuration(posNegDuration).abs();\n        var seconds  = round(duration.as('s'));\n        var minutes  = round(duration.as('m'));\n        var hours    = round(duration.as('h'));\n        var days     = round(duration.as('d'));\n        var months   = round(duration.as('M'));\n        var years    = round(duration.as('y'));\n\n        var a = seconds < thresholds.s && ['s', seconds]  ||\n                minutes === 1          && ['m']           ||\n                minutes < thresholds.m && ['mm', minutes] ||\n                hours   === 1          && ['h']           ||\n                hours   < thresholds.h && ['hh', hours]   ||\n                days    === 1          && ['d']           ||\n                days    < thresholds.d && ['dd', days]    ||\n                months  === 1          && ['M']           ||\n                months  < thresholds.M && ['MM', months]  ||\n                years   === 1          && ['y']           || ['yy', years];\n\n        a[2] = withoutSuffix;\n        a[3] = +posNegDuration > 0;\n        a[4] = locale;\n        return substituteTimeAgo.apply(null, a);\n    }\n\n    // This function allows you to set a threshold for relative time strings\n    function duration_humanize__getSetRelativeTimeThreshold (threshold, limit) {\n        if (thresholds[threshold] === undefined) {\n            return false;\n        }\n        if (limit === undefined) {\n            return thresholds[threshold];\n        }\n        thresholds[threshold] = limit;\n        return true;\n    }\n\n    function humanize (withSuffix) {\n        var locale = this.localeData();\n        var output = duration_humanize__relativeTime(this, !withSuffix, locale);\n\n        if (withSuffix) {\n            output = locale.pastFuture(+this, output);\n        }\n\n        return locale.postformat(output);\n    }\n\n    var iso_string__abs = Math.abs;\n\n    function iso_string__toISOString() {\n        // for ISO strings we do not use the normal bubbling rules:\n        //  * milliseconds bubble up until they become hours\n        //  * days do not bubble at all\n        //  * months bubble up until they become years\n        // This is because there is no context-free conversion between hours and days\n        // (think of clock changes)\n        // and also not between days and months (28-31 days per month)\n        var seconds = iso_string__abs(this._milliseconds) / 1000;\n        var days         = iso_string__abs(this._days);\n        var months       = iso_string__abs(this._months);\n        var minutes, hours, years;\n\n        // 3600 seconds -> 60 minutes -> 1 hour\n        minutes           = absFloor(seconds / 60);\n        hours             = absFloor(minutes / 60);\n        seconds %= 60;\n        minutes %= 60;\n\n        // 12 months -> 1 year\n        years  = absFloor(months / 12);\n        months %= 12;\n\n\n        // inspired by https://github.com/dordille/moment-isoduration/blob/master/moment.isoduration.js\n        var Y = years;\n        var M = months;\n        var D = days;\n        var h = hours;\n        var m = minutes;\n        var s = seconds;\n        var total = this.asSeconds();\n\n        if (!total) {\n            // this is the same as C#'s (Noda) and python (isodate)...\n            // but not other JS (goog.date)\n            return 'P0D';\n        }\n\n        return (total < 0 ? '-' : '') +\n            'P' +\n            (Y ? Y + 'Y' : '') +\n            (M ? M + 'M' : '') +\n            (D ? D + 'D' : '') +\n            ((h || m || s) ? 'T' : '') +\n            (h ? h + 'H' : '') +\n            (m ? m + 'M' : '') +\n            (s ? s + 'S' : '');\n    }\n\n    var duration_prototype__proto = Duration.prototype;\n\n    duration_prototype__proto.abs            = duration_abs__abs;\n    duration_prototype__proto.add            = duration_add_subtract__add;\n    duration_prototype__proto.subtract       = duration_add_subtract__subtract;\n    duration_prototype__proto.as             = as;\n    duration_prototype__proto.asMilliseconds = asMilliseconds;\n    duration_prototype__proto.asSeconds      = asSeconds;\n    duration_prototype__proto.asMinutes      = asMinutes;\n    duration_prototype__proto.asHours        = asHours;\n    duration_prototype__proto.asDays         = asDays;\n    duration_prototype__proto.asWeeks        = asWeeks;\n    duration_prototype__proto.asMonths       = asMonths;\n    duration_prototype__proto.asYears        = asYears;\n    duration_prototype__proto.valueOf        = duration_as__valueOf;\n    duration_prototype__proto._bubble        = bubble;\n    duration_prototype__proto.get            = duration_get__get;\n    duration_prototype__proto.milliseconds   = milliseconds;\n    duration_prototype__proto.seconds        = seconds;\n    duration_prototype__proto.minutes        = minutes;\n    duration_prototype__proto.hours          = hours;\n    duration_prototype__proto.days           = days;\n    duration_prototype__proto.weeks          = weeks;\n    duration_prototype__proto.months         = months;\n    duration_prototype__proto.years          = years;\n    duration_prototype__proto.humanize       = humanize;\n    duration_prototype__proto.toISOString    = iso_string__toISOString;\n    duration_prototype__proto.toString       = iso_string__toISOString;\n    duration_prototype__proto.toJSON         = iso_string__toISOString;\n    duration_prototype__proto.locale         = locale;\n    duration_prototype__proto.localeData     = localeData;\n\n    // Deprecations\n    duration_prototype__proto.toIsoString = deprecate('toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)', iso_string__toISOString);\n    duration_prototype__proto.lang = lang;\n\n    // Side effect imports\n\n    addFormatToken('X', 0, 0, 'unix');\n    addFormatToken('x', 0, 0, 'valueOf');\n\n    // PARSING\n\n    addRegexToken('x', matchSigned);\n    addRegexToken('X', matchTimestamp);\n    addParseToken('X', function (input, array, config) {\n        config._d = new Date(parseFloat(input, 10) * 1000);\n    });\n    addParseToken('x', function (input, array, config) {\n        config._d = new Date(toInt(input));\n    });\n\n    // Side effect imports\n\n\n    utils_hooks__hooks.version = '2.10.6';\n\n    setHookCallback(local__createLocal);\n\n    utils_hooks__hooks.fn                    = momentPrototype;\n    utils_hooks__hooks.min                   = min;\n    utils_hooks__hooks.max                   = max;\n    utils_hooks__hooks.utc                   = create_utc__createUTC;\n    utils_hooks__hooks.unix                  = moment__createUnix;\n    utils_hooks__hooks.months                = lists__listMonths;\n    utils_hooks__hooks.isDate                = isDate;\n    utils_hooks__hooks.locale                = locale_locales__getSetGlobalLocale;\n    utils_hooks__hooks.invalid               = valid__createInvalid;\n    utils_hooks__hooks.duration              = create__createDuration;\n    utils_hooks__hooks.isMoment              = isMoment;\n    utils_hooks__hooks.weekdays              = lists__listWeekdays;\n    utils_hooks__hooks.parseZone             = moment__createInZone;\n    utils_hooks__hooks.localeData            = locale_locales__getLocale;\n    utils_hooks__hooks.isDuration            = isDuration;\n    utils_hooks__hooks.monthsShort           = lists__listMonthsShort;\n    utils_hooks__hooks.weekdaysMin           = lists__listWeekdaysMin;\n    utils_hooks__hooks.defineLocale          = defineLocale;\n    utils_hooks__hooks.weekdaysShort         = lists__listWeekdaysShort;\n    utils_hooks__hooks.normalizeUnits        = normalizeUnits;\n    utils_hooks__hooks.relativeTimeThreshold = duration_humanize__getSetRelativeTimeThreshold;\n\n    var _moment = utils_hooks__hooks;\n\n    return _moment;\n\n}));","/*! version : 4.17.37\n =========================================================\n bootstrap-datetimejs\n https://github.com/Eonasdan/bootstrap-datetimepicker\n Copyright (c) 2015 Jonathan Peterson\n =========================================================\n */\n!function(a){\"use strict\";if(\"function\"==typeof define&&define.amd)define([\"jquery\",\"moment\"],a);else if(\"object\"==typeof exports)a(require(\"jquery\"),require(\"moment\"));else{if(\"undefined\"==typeof jQuery)throw\"bootstrap-datetimepicker requires jQuery to be loaded first\";if(\"undefined\"==typeof moment)throw\"bootstrap-datetimepicker requires Moment.js to be loaded first\";a(jQuery,moment)}}(function(a,b){\"use strict\";if(!b)throw new Error(\"bootstrap-datetimepicker requires Moment.js to be loaded first\");var c=function(c,d){var e,f,g,h,i,j,k,l={},m=!0,n=!1,o=!1,p=0,q=[{clsName:\"days\",navFnc:\"M\",navStep:1},{clsName:\"months\",navFnc:\"y\",navStep:1},{clsName:\"years\",navFnc:\"y\",navStep:10},{clsName:\"decades\",navFnc:\"y\",navStep:100}],r=[\"days\",\"months\",\"years\",\"decades\"],s=[\"top\",\"bottom\",\"auto\"],t=[\"left\",\"right\",\"auto\"],u=[\"default\",\"top\",\"bottom\"],v={up:38,38:\"up\",down:40,40:\"down\",left:37,37:\"left\",right:39,39:\"right\",tab:9,9:\"tab\",escape:27,27:\"escape\",enter:13,13:\"enter\",pageUp:33,33:\"pageUp\",pageDown:34,34:\"pageDown\",shift:16,16:\"shift\",control:17,17:\"control\",space:32,32:\"space\",t:84,84:\"t\",\"delete\":46,46:\"delete\"},w={},x=function(a){var c,e,f,g,h,i=!1;return void 0!==b.tz&&void 0!==d.timeZone&&null!==d.timeZone&&\"\"!==d.timeZone&&(i=!0),void 0===a||null===a?c=i?b().tz(d.timeZone).startOf(\"d\"):b().startOf(\"d\"):i?(e=b().tz(d.timeZone).utcOffset(),f=b(a,j,d.useStrict).utcOffset(),f!==e?(g=b().tz(d.timeZone).format(\"Z\"),h=b(a,j,d.useStrict).format(\"YYYY-MM-DD[T]HH:mm:ss\")+g,c=b(h,j,d.useStrict).tz(d.timeZone)):c=b(a,j,d.useStrict).tz(d.timeZone)):c=b(a,j,d.useStrict),c},y=function(a){if(\"string\"!=typeof a||a.length>1)throw new TypeError(\"isEnabled expects a single character string parameter\");switch(a){case\"y\":return-1!==i.indexOf(\"Y\");case\"M\":return-1!==i.indexOf(\"M\");case\"d\":return-1!==i.toLowerCase().indexOf(\"d\");case\"h\":case\"H\":return-1!==i.toLowerCase().indexOf(\"h\");case\"m\":return-1!==i.indexOf(\"m\");case\"s\":return-1!==i.indexOf(\"s\");default:return!1}},z=function(){return y(\"h\")||y(\"m\")||y(\"s\")},A=function(){return y(\"y\")||y(\"M\")||y(\"d\")},B=function(){var b=a(\"<thead>\").append(a(\"<tr>\").append(a(\"<th>\").addClass(\"prev\").attr(\"data-action\",\"previous\").append(a(\"<span>\").addClass(d.icons.previous))).append(a(\"<th>\").addClass(\"picker-switch\").attr(\"data-action\",\"pickerSwitch\").attr(\"colspan\",d.calendarWeeks?\"6\":\"5\")).append(a(\"<th>\").addClass(\"next\").attr(\"data-action\",\"next\").append(a(\"<span>\").addClass(d.icons.next)))),c=a(\"<tbody>\").append(a(\"<tr>\").append(a(\"<td>\").attr(\"colspan\",d.calendarWeeks?\"8\":\"7\")));return[a(\"<div>\").addClass(\"datepicker-days\").append(a(\"<table>\").addClass(\"table-condensed\").append(b).append(a(\"<tbody>\"))),a(\"<div>\").addClass(\"datepicker-months\").append(a(\"<table>\").addClass(\"table-condensed\").append(b.clone()).append(c.clone())),a(\"<div>\").addClass(\"datepicker-years\").append(a(\"<table>\").addClass(\"table-condensed\").append(b.clone()).append(c.clone())),a(\"<div>\").addClass(\"datepicker-decades\").append(a(\"<table>\").addClass(\"table-condensed\").append(b.clone()).append(c.clone()))]},C=function(){var b=a(\"<tr>\"),c=a(\"<tr>\"),e=a(\"<tr>\");return y(\"h\")&&(b.append(a(\"<td>\").append(a(\"<a>\").attr({href:\"#\",tabindex:\"-1\",title:d.tooltips.incrementHour}).addClass(\"btn\").attr(\"data-action\",\"incrementHours\").append(a(\"<span>\").addClass(d.icons.up)))),c.append(a(\"<td>\").append(a(\"<span>\").addClass(\"timepicker-hour\").attr({\"data-time-component\":\"hours\",title:d.tooltips.pickHour}).attr(\"data-action\",\"showHours\"))),e.append(a(\"<td>\").append(a(\"<a>\").attr({href:\"#\",tabindex:\"-1\",title:d.tooltips.decrementHour}).addClass(\"btn\").attr(\"data-action\",\"decrementHours\").append(a(\"<span>\").addClass(d.icons.down))))),y(\"m\")&&(y(\"h\")&&(b.append(a(\"<td>\").addClass(\"separator\")),c.append(a(\"<td>\").addClass(\"separator\").html(\":\")),e.append(a(\"<td>\").addClass(\"separator\"))),b.append(a(\"<td>\").append(a(\"<a>\").attr({href:\"#\",tabindex:\"-1\",title:d.tooltips.incrementMinute}).addClass(\"btn\").attr(\"data-action\",\"incrementMinutes\").append(a(\"<span>\").addClass(d.icons.up)))),c.append(a(\"<td>\").append(a(\"<span>\").addClass(\"timepicker-minute\").attr({\"data-time-component\":\"minutes\",title:d.tooltips.pickMinute}).attr(\"data-action\",\"showMinutes\"))),e.append(a(\"<td>\").append(a(\"<a>\").attr({href:\"#\",tabindex:\"-1\",title:d.tooltips.decrementMinute}).addClass(\"btn\").attr(\"data-action\",\"decrementMinutes\").append(a(\"<span>\").addClass(d.icons.down))))),y(\"s\")&&(y(\"m\")&&(b.append(a(\"<td>\").addClass(\"separator\")),c.append(a(\"<td>\").addClass(\"separator\").html(\":\")),e.append(a(\"<td>\").addClass(\"separator\"))),b.append(a(\"<td>\").append(a(\"<a>\").attr({href:\"#\",tabindex:\"-1\",title:d.tooltips.incrementSecond}).addClass(\"btn\").attr(\"data-action\",\"incrementSeconds\").append(a(\"<span>\").addClass(d.icons.up)))),c.append(a(\"<td>\").append(a(\"<span>\").addClass(\"timepicker-second\").attr({\"data-time-component\":\"seconds\",title:d.tooltips.pickSecond}).attr(\"data-action\",\"showSeconds\"))),e.append(a(\"<td>\").append(a(\"<a>\").attr({href:\"#\",tabindex:\"-1\",title:d.tooltips.decrementSecond}).addClass(\"btn\").attr(\"data-action\",\"decrementSeconds\").append(a(\"<span>\").addClass(d.icons.down))))),h||(b.append(a(\"<td>\").addClass(\"separator\")),c.append(a(\"<td>\").append(a(\"<button>\").addClass(\"btn btn-primary\").attr({\"data-action\":\"togglePeriod\",tabindex:\"-1\",title:d.tooltips.togglePeriod}))),e.append(a(\"<td>\").addClass(\"separator\"))),a(\"<div>\").addClass(\"timepicker-picker\").append(a(\"<table>\").addClass(\"table-condensed\").append([b,c,e]))},D=function(){var b=a(\"<div>\").addClass(\"timepicker-hours\").append(a(\"<table>\").addClass(\"table-condensed\")),c=a(\"<div>\").addClass(\"timepicker-minutes\").append(a(\"<table>\").addClass(\"table-condensed\")),d=a(\"<div>\").addClass(\"timepicker-seconds\").append(a(\"<table>\").addClass(\"table-condensed\")),e=[C()];return y(\"h\")&&e.push(b),y(\"m\")&&e.push(c),y(\"s\")&&e.push(d),e},E=function(){var b=[];return d.showTodayButton&&b.push(a(\"<td>\").append(a(\"<a>\").attr({\"data-action\":\"today\",title:d.tooltips.today}).append(a(\"<span>\").addClass(d.icons.today)))),!d.sideBySide&&A()&&z()&&b.push(a(\"<td>\").append(a(\"<a>\").attr({\"data-action\":\"togglePicker\",title:d.tooltips.selectTime}).append(a(\"<span>\").addClass(d.icons.time)))),d.showClear&&b.push(a(\"<td>\").append(a(\"<a>\").attr({\"data-action\":\"clear\",title:d.tooltips.clear}).append(a(\"<span>\").addClass(d.icons.clear)))),d.showClose&&b.push(a(\"<td>\").append(a(\"<a>\").attr({\"data-action\":\"close\",title:d.tooltips.close}).append(a(\"<span>\").addClass(d.icons.close)))),a(\"<table>\").addClass(\"table-condensed\").append(a(\"<tbody>\").append(a(\"<tr>\").append(b)))},F=function(){var b=a(\"<div>\").addClass(\"bootstrap-datetimepicker-widget dropdown-menu\"),c=a(\"<div>\").addClass(\"datepicker\").append(B()),e=a(\"<div>\").addClass(\"timepicker\").append(D()),f=a(\"<ul>\").addClass(\"list-unstyled\"),g=a(\"<li>\").addClass(\"picker-switch\"+(d.collapse?\" accordion-toggle\":\"\")).append(E());return d.inline&&b.removeClass(\"dropdown-menu\"),h&&b.addClass(\"usetwentyfour\"),y(\"s\")&&!h&&b.addClass(\"wider\"),d.sideBySide&&A()&&z()?(b.addClass(\"timepicker-sbs\"),\"top\"===d.toolbarPlacement&&b.append(g),b.append(a(\"<div>\").addClass(\"row\").append(c.addClass(\"col-md-6\")).append(e.addClass(\"col-md-6\"))),\"bottom\"===d.toolbarPlacement&&b.append(g),b):(\"top\"===d.toolbarPlacement&&f.append(g),A()&&f.append(a(\"<li>\").addClass(d.collapse&&z()?\"collapse in\":\"\").append(c)),\"default\"===d.toolbarPlacement&&f.append(g),z()&&f.append(a(\"<li>\").addClass(d.collapse&&A()?\"collapse\":\"\").append(e)),\"bottom\"===d.toolbarPlacement&&f.append(g),b.append(f))},G=function(){var b,e={};return b=c.is(\"input\")||d.inline?c.data():c.find(\"input\").data(),b.dateOptions&&b.dateOptions instanceof Object&&(e=a.extend(!0,e,b.dateOptions)),a.each(d,function(a){var c=\"date\"+a.charAt(0).toUpperCase()+a.slice(1);void 0!==b[c]&&(e[a]=b[c])}),e},H=function(){var b,e=(n||c).position(),f=(n||c).offset(),g=d.widgetPositioning.vertical,h=d.widgetPositioning.horizontal;if(d.widgetParent)b=d.widgetParent.append(o);else if(c.is(\"input\"))b=c.after(o).parent();else{if(d.inline)return void(b=c.append(o));b=c,c.children().first().after(o)}if(\"auto\"===g&&(g=f.top+1.5*o.height()>=a(window).height()+a(window).scrollTop()&&o.height()+c.outerHeight()<f.top?\"top\":\"bottom\"),\"auto\"===h&&(h=b.width()<f.left+o.outerWidth()/2&&f.left+o.outerWidth()>a(window).width()?\"right\":\"left\"),\"top\"===g?o.addClass(\"top\").removeClass(\"bottom\"):o.addClass(\"bottom\").removeClass(\"top\"),\"right\"===h?o.addClass(\"pull-right\"):o.removeClass(\"pull-right\"),\"relative\"!==b.css(\"position\")&&(b=b.parents().filter(function(){return\"relative\"===a(this).css(\"position\")}).first()),0===b.length)throw new Error(\"datetimepicker component should be placed within a relative positioned container\");o.css({top:\"top\"===g?\"auto\":e.top+c.outerHeight(),bottom:\"top\"===g?e.top+c.outerHeight():\"auto\",left:\"left\"===h?b===c?0:e.left:\"auto\",right:\"left\"===h?\"auto\":b.outerWidth()-c.outerWidth()-(b===c?0:e.left)})},I=function(a){\"dp.change\"===a.type&&(a.date&&a.date.isSame(a.oldDate)||!a.date&&!a.oldDate)||c.trigger(a)},J=function(a){\"y\"===a&&(a=\"YYYY\"),I({type:\"dp.update\",change:a,viewDate:f.clone()})},K=function(a){o&&(a&&(k=Math.max(p,Math.min(3,k+a))),o.find(\".datepicker > div\").hide().filter(\".datepicker-\"+q[k].clsName).show())},L=function(){var b=a(\"<tr>\"),c=f.clone().startOf(\"w\").startOf(\"d\");for(d.calendarWeeks===!0&&b.append(a(\"<th>\").addClass(\"cw\").text(\"#\"));c.isBefore(f.clone().endOf(\"w\"));)b.append(a(\"<th>\").addClass(\"dow\").text(c.format(\"dd\"))),c.add(1,\"d\");o.find(\".datepicker-days thead\").append(b)},M=function(a){return d.disabledDates[a.format(\"YYYY-MM-DD\")]===!0},N=function(a){return d.enabledDates[a.format(\"YYYY-MM-DD\")]===!0},O=function(a){return d.disabledHours[a.format(\"H\")]===!0},P=function(a){return d.enabledHours[a.format(\"H\")]===!0},Q=function(b,c){if(!b.isValid())return!1;if(d.disabledDates&&\"d\"===c&&M(b))return!1;if(d.enabledDates&&\"d\"===c&&!N(b))return!1;if(d.minDate&&b.isBefore(d.minDate,c))return!1;if(d.maxDate&&b.isAfter(d.maxDate,c))return!1;if(d.daysOfWeekDisabled&&\"d\"===c&&-1!==d.daysOfWeekDisabled.indexOf(b.day()))return!1;if(d.disabledHours&&(\"h\"===c||\"m\"===c||\"s\"===c)&&O(b))return!1;if(d.enabledHours&&(\"h\"===c||\"m\"===c||\"s\"===c)&&!P(b))return!1;if(d.disabledTimeIntervals&&(\"h\"===c||\"m\"===c||\"s\"===c)){var e=!1;if(a.each(d.disabledTimeIntervals,function(){return b.isBetween(this[0],this[1])?(e=!0,!1):void 0}),e)return!1}return!0},R=function(){for(var b=[],c=f.clone().startOf(\"y\").startOf(\"d\");c.isSame(f,\"y\");)b.push(a(\"<span>\").attr(\"data-action\",\"selectMonth\").addClass(\"month\").text(c.format(\"MMM\"))),c.add(1,\"M\");o.find(\".datepicker-months td\").empty().append(b)},S=function(){var b=o.find(\".datepicker-months\"),c=b.find(\"th\"),g=b.find(\"tbody\").find(\"span\");c.eq(0).find(\"span\").attr(\"title\",d.tooltips.prevYear),c.eq(1).attr(\"title\",d.tooltips.selectYear),c.eq(2).find(\"span\").attr(\"title\",d.tooltips.nextYear),b.find(\".disabled\").removeClass(\"disabled\"),Q(f.clone().subtract(1,\"y\"),\"y\")||c.eq(0).addClass(\"disabled\"),c.eq(1).text(f.year()),Q(f.clone().add(1,\"y\"),\"y\")||c.eq(2).addClass(\"disabled\"),g.removeClass(\"active\"),e.isSame(f,\"y\")&&!m&&g.eq(e.month()).addClass(\"active\"),g.each(function(b){Q(f.clone().month(b),\"M\")||a(this).addClass(\"disabled\")})},T=function(){var a=o.find(\".datepicker-years\"),b=a.find(\"th\"),c=f.clone().subtract(5,\"y\"),g=f.clone().add(6,\"y\"),h=\"\";for(b.eq(0).find(\"span\").attr(\"title\",d.tooltips.prevDecade),b.eq(1).attr(\"title\",d.tooltips.selectDecade),b.eq(2).find(\"span\").attr(\"title\",d.tooltips.nextDecade),a.find(\".disabled\").removeClass(\"disabled\"),d.minDate&&d.minDate.isAfter(c,\"y\")&&b.eq(0).addClass(\"disabled\"),b.eq(1).text(c.year()+\"-\"+g.year()),d.maxDate&&d.maxDate.isBefore(g,\"y\")&&b.eq(2).addClass(\"disabled\");!c.isAfter(g,\"y\");)h+='<span data-action=\"selectYear\" class=\"year'+(c.isSame(e,\"y\")&&!m?\" active\":\"\")+(Q(c,\"y\")?\"\":\" disabled\")+'\">'+c.year()+\"</span>\",c.add(1,\"y\");a.find(\"td\").html(h)},U=function(){var a=o.find(\".datepicker-decades\"),c=a.find(\"th\"),g=b({y:f.year()-f.year()%100-1}),h=g.clone().add(100,\"y\"),i=g.clone(),j=\"\";for(c.eq(0).find(\"span\").attr(\"title\",d.tooltips.prevCentury),c.eq(2).find(\"span\").attr(\"title\",d.tooltips.nextCentury),a.find(\".disabled\").removeClass(\"disabled\"),(g.isSame(b({y:1900}))||d.minDate&&d.minDate.isAfter(g,\"y\"))&&c.eq(0).addClass(\"disabled\"),c.eq(1).text(g.year()+\"-\"+h.year()),(g.isSame(b({y:2e3}))||d.maxDate&&d.maxDate.isBefore(h,\"y\"))&&c.eq(2).addClass(\"disabled\");!g.isAfter(h,\"y\");)j+='<span data-action=\"selectDecade\" class=\"decade'+(g.isSame(e,\"y\")?\" active\":\"\")+(Q(g,\"y\")?\"\":\" disabled\")+'\" data-selection=\"'+(g.year()+6)+'\">'+(g.year()+1)+\" - \"+(g.year()+12)+\"</span>\",g.add(12,\"y\");j+=\"<span></span><span></span><span></span>\",a.find(\"td\").html(j),c.eq(1).text(i.year()+1+\"-\"+g.year())},V=function(){var b,c,g,h,i=o.find(\".datepicker-days\"),j=i.find(\"th\"),k=[];if(A()){for(j.eq(0).find(\"span\").attr(\"title\",d.tooltips.prevMonth),j.eq(1).attr(\"title\",d.tooltips.selectMonth),j.eq(2).find(\"span\").attr(\"title\",d.tooltips.nextMonth),i.find(\".disabled\").removeClass(\"disabled\"),j.eq(1).text(f.format(d.dayViewHeaderFormat)),Q(f.clone().subtract(1,\"M\"),\"M\")||j.eq(0).addClass(\"disabled\"),Q(f.clone().add(1,\"M\"),\"M\")||j.eq(2).addClass(\"disabled\"),b=f.clone().startOf(\"M\").startOf(\"w\").startOf(\"d\"),h=0;42>h;h++)0===b.weekday()&&(c=a(\"<tr>\"),d.calendarWeeks&&c.append('<td class=\"cw\">'+b.week()+\"</td>\"),k.push(c)),g=\"\",b.isBefore(f,\"M\")&&(g+=\" old\"),b.isAfter(f,\"M\")&&(g+=\" new\"),b.isSame(e,\"d\")&&!m&&(g+=\" active\"),Q(b,\"d\")||(g+=\" disabled\"),b.isSame(x(),\"d\")&&(g+=\" today\"),(0===b.day()||6===b.day())&&(g+=\" weekend\"),c.append('<td data-action=\"selectDay\" data-day=\"'+b.format(\"L\")+'\" class=\"day'+g+'\">'+b.date()+\"</td>\"),b.add(1,\"d\");i.find(\"tbody\").empty().append(k),S(),T(),U()}},W=function(){var b=o.find(\".timepicker-hours table\"),c=f.clone().startOf(\"d\"),d=[],e=a(\"<tr>\");for(f.hour()>11&&!h&&c.hour(12);c.isSame(f,\"d\")&&(h||f.hour()<12&&c.hour()<12||f.hour()>11);)c.hour()%4===0&&(e=a(\"<tr>\"),d.push(e)),e.append('<td data-action=\"selectHour\" class=\"hour'+(Q(c,\"h\")?\"\":\" disabled\")+'\">'+c.format(h?\"HH\":\"hh\")+\"</td>\"),c.add(1,\"h\");b.empty().append(d)},X=function(){for(var b=o.find(\".timepicker-minutes table\"),c=f.clone().startOf(\"h\"),e=[],g=a(\"<tr>\"),h=1===d.stepping?5:d.stepping;f.isSame(c,\"h\");)c.minute()%(4*h)===0&&(g=a(\"<tr>\"),e.push(g)),g.append('<td data-action=\"selectMinute\" class=\"minute'+(Q(c,\"m\")?\"\":\" disabled\")+'\">'+c.format(\"mm\")+\"</td>\"),c.add(h,\"m\");b.empty().append(e)},Y=function(){for(var b=o.find(\".timepicker-seconds table\"),c=f.clone().startOf(\"m\"),d=[],e=a(\"<tr>\");f.isSame(c,\"m\");)c.second()%20===0&&(e=a(\"<tr>\"),d.push(e)),e.append('<td data-action=\"selectSecond\" class=\"second'+(Q(c,\"s\")?\"\":\" disabled\")+'\">'+c.format(\"ss\")+\"</td>\"),c.add(5,\"s\");b.empty().append(d)},Z=function(){var a,b,c=o.find(\".timepicker span[data-time-component]\");h||(a=o.find(\".timepicker [data-action=togglePeriod]\"),b=e.clone().add(e.hours()>=12?-12:12,\"h\"),a.text(e.format(\"A\")),Q(b,\"h\")?a.removeClass(\"disabled\"):a.addClass(\"disabled\")),c.filter(\"[data-time-component=hours]\").text(e.format(h?\"HH\":\"hh\")),c.filter(\"[data-time-component=minutes]\").text(e.format(\"mm\")),c.filter(\"[data-time-component=seconds]\").text(e.format(\"ss\")),W(),X(),Y()},$=function(){o&&(V(),Z())},_=function(a){var b=m?null:e;return a?(a=a.clone().locale(d.locale),1!==d.stepping&&a.minutes(Math.round(a.minutes()/d.stepping)*d.stepping%60).seconds(0),void(Q(a)?(e=a,f=e.clone(),g.val(e.format(i)),c.data(\"date\",e.format(i)),m=!1,$(),I({type:\"dp.change\",date:e.clone(),oldDate:b})):(d.keepInvalid||g.val(m?\"\":e.format(i)),I({type:\"dp.error\",date:a})))):(m=!0,g.val(\"\"),c.data(\"date\",\"\"),I({type:\"dp.change\",date:!1,oldDate:b}),void $())},aa=function(){var b=!1;return o?(o.find(\".collapse\").each(function(){var c=a(this).data(\"collapse\");return c&&c.transitioning?(b=!0,!1):!0}),b?l:(n&&n.hasClass(\"btn\")&&n.toggleClass(\"active\"),o.hide(),a(window).off(\"resize\",H),o.off(\"click\",\"[data-action]\"),o.off(\"mousedown\",!1),o.remove(),o=!1,I({type:\"dp.hide\",date:e.clone()}),g.blur(),l)):l},ba=function(){_(null)},ca={next:function(){var a=q[k].navFnc;f.add(q[k].navStep,a),V(),J(a)},previous:function(){var a=q[k].navFnc;f.subtract(q[k].navStep,a),V(),J(a)},pickerSwitch:function(){K(1)},selectMonth:function(b){var c=a(b.target).closest(\"tbody\").find(\"span\").index(a(b.target));f.month(c),k===p?(_(e.clone().year(f.year()).month(f.month())),d.inline||aa()):(K(-1),V()),J(\"M\")},selectYear:function(b){var c=parseInt(a(b.target).text(),10)||0;f.year(c),k===p?(_(e.clone().year(f.year())),d.inline||aa()):(K(-1),V()),J(\"YYYY\")},selectDecade:function(b){var c=parseInt(a(b.target).data(\"selection\"),10)||0;f.year(c),k===p?(_(e.clone().year(f.year())),d.inline||aa()):(K(-1),V()),J(\"YYYY\")},selectDay:function(b){var c=f.clone();a(b.target).is(\".old\")&&c.subtract(1,\"M\"),a(b.target).is(\".new\")&&c.add(1,\"M\"),_(c.date(parseInt(a(b.target).text(),10))),z()||d.keepOpen||d.inline||aa()},incrementHours:function(){var a=e.clone().add(1,\"h\");Q(a,\"h\")&&_(a)},incrementMinutes:function(){var a=e.clone().add(d.stepping,\"m\");Q(a,\"m\")&&_(a)},incrementSeconds:function(){var a=e.clone().add(1,\"s\");Q(a,\"s\")&&_(a)},decrementHours:function(){var a=e.clone().subtract(1,\"h\");Q(a,\"h\")&&_(a)},decrementMinutes:function(){var a=e.clone().subtract(d.stepping,\"m\");Q(a,\"m\")&&_(a)},decrementSeconds:function(){var a=e.clone().subtract(1,\"s\");Q(a,\"s\")&&_(a)},togglePeriod:function(){_(e.clone().add(e.hours()>=12?-12:12,\"h\"))},togglePicker:function(b){var c,e=a(b.target),f=e.closest(\"ul\"),g=f.find(\".in\"),h=f.find(\".collapse:not(.in)\");if(g&&g.length){if(c=g.data(\"collapse\"),c&&c.transitioning)return;g.collapse?(g.collapse(\"hide\"),h.collapse(\"show\")):(g.removeClass(\"in\"),h.addClass(\"in\")),e.is(\"span\")?e.toggleClass(d.icons.time+\" \"+d.icons.date):e.find(\"span\").toggleClass(d.icons.time+\" \"+d.icons.date)}},showPicker:function(){o.find(\".timepicker > div:not(.timepicker-picker)\").hide(),o.find(\".timepicker .timepicker-picker\").show()},showHours:function(){o.find(\".timepicker .timepicker-picker\").hide(),o.find(\".timepicker .timepicker-hours\").show()},showMinutes:function(){o.find(\".timepicker .timepicker-picker\").hide(),o.find(\".timepicker .timepicker-minutes\").show()},showSeconds:function(){o.find(\".timepicker .timepicker-picker\").hide(),o.find(\".timepicker .timepicker-seconds\").show()},selectHour:function(b){var c=parseInt(a(b.target).text(),10);h||(e.hours()>=12?12!==c&&(c+=12):12===c&&(c=0)),_(e.clone().hours(c)),ca.showPicker.call(l)},selectMinute:function(b){_(e.clone().minutes(parseInt(a(b.target).text(),10))),ca.showPicker.call(l)},selectSecond:function(b){_(e.clone().seconds(parseInt(a(b.target).text(),10))),ca.showPicker.call(l)},clear:ba,today:function(){var a=x();Q(a,\"d\")&&_(a)},close:aa},da=function(b){return a(b.currentTarget).is(\".disabled\")?!1:(ca[a(b.currentTarget).data(\"action\")].apply(l,arguments),!1)},ea=function(){var b,c={year:function(a){return a.month(0).date(1).hours(0).seconds(0).minutes(0)},month:function(a){return a.date(1).hours(0).seconds(0).minutes(0)},day:function(a){return a.hours(0).seconds(0).minutes(0)},hour:function(a){return a.seconds(0).minutes(0)},minute:function(a){return a.seconds(0)}};return g.prop(\"disabled\")||!d.ignoreReadonly&&g.prop(\"readonly\")||o?l:(void 0!==g.val()&&0!==g.val().trim().length?_(ga(g.val().trim())):d.useCurrent&&m&&(g.is(\"input\")&&0===g.val().trim().length||d.inline)&&(b=x(),\"string\"==typeof d.useCurrent&&(b=c[d.useCurrent](b)),_(b)),o=F(),L(),R(),o.find(\".timepicker-hours\").hide(),o.find(\".timepicker-minutes\").hide(),o.find(\".timepicker-seconds\").hide(),$(),K(),a(window).on(\"resize\",H),o.on(\"click\",\"[data-action]\",da),o.on(\"mousedown\",!1),n&&n.hasClass(\"btn\")&&n.toggleClass(\"active\"),o.show(),H(),d.focusOnShow&&!g.is(\":focus\")&&g.focus(),I({type:\"dp.show\"}),l)},fa=function(){return o?aa():ea()},ga=function(a){return a=void 0===d.parseInputDate?b.isMoment(a)||a instanceof Date?b(a):x(a):d.parseInputDate(a),a.locale(d.locale),a},ha=function(a){var b,c,e,f,g=null,h=[],i={},j=a.which,k=\"p\";w[j]=k;for(b in w)w.hasOwnProperty(b)&&w[b]===k&&(h.push(b),parseInt(b,10)!==j&&(i[b]=!0));for(b in d.keyBinds)if(d.keyBinds.hasOwnProperty(b)&&\"function\"==typeof d.keyBinds[b]&&(e=b.split(\" \"),e.length===h.length&&v[j]===e[e.length-1])){for(f=!0,c=e.length-2;c>=0;c--)if(!(v[e[c]]in i)){f=!1;break}if(f){g=d.keyBinds[b];break}}g&&(g.call(l,o),a.stopPropagation(),a.preventDefault())},ia=function(a){w[a.which]=\"r\",a.stopPropagation(),a.preventDefault()},ja=function(b){var c=a(b.target).val().trim(),d=c?ga(c):null;return _(d),b.stopImmediatePropagation(),!1},ka=function(){g.on({change:ja,blur:d.debug?\"\":aa,keydown:ha,keyup:ia,focus:d.allowInputToggle?ea:\"\"}),c.is(\"input\")?g.on({focus:ea}):n&&(n.on(\"click\",fa),n.on(\"mousedown\",!1))},la=function(){g.off({change:ja,blur:blur,keydown:ha,keyup:ia,focus:d.allowInputToggle?aa:\"\"}),c.is(\"input\")?g.off({focus:ea}):n&&(n.off(\"click\",fa),n.off(\"mousedown\",!1))},ma=function(b){var c={};return a.each(b,function(){var a=ga(this);a.isValid()&&(c[a.format(\"YYYY-MM-DD\")]=!0)}),Object.keys(c).length?c:!1},na=function(b){var c={};return a.each(b,function(){c[this]=!0}),Object.keys(c).length?c:!1},oa=function(){var a=d.format||\"L LT\";i=a.replace(/(\\[[^\\[]*\\])|(\\\\)?(LTS|LT|LL?L?L?|l{1,4})/g,function(a){var b=e.localeData().longDateFormat(a)||a;return b.replace(/(\\[[^\\[]*\\])|(\\\\)?(LTS|LT|LL?L?L?|l{1,4})/g,function(a){return e.localeData().longDateFormat(a)||a})}),j=d.extraFormats?d.extraFormats.slice():[],j.indexOf(a)<0&&j.indexOf(i)<0&&j.push(i),h=i.toLowerCase().indexOf(\"a\")<1&&i.replace(/\\[.*?\\]/g,\"\").indexOf(\"h\")<1,y(\"y\")&&(p=2),y(\"M\")&&(p=1),y(\"d\")&&(p=0),k=Math.max(p,k),m||_(e)};if(l.destroy=function(){aa(),la(),c.removeData(\"DateTimePicker\"),c.removeData(\"date\")},l.toggle=fa,l.show=ea,l.hide=aa,l.disable=function(){return aa(),n&&n.hasClass(\"btn\")&&n.addClass(\"disabled\"),g.prop(\"disabled\",!0),l},l.enable=function(){return n&&n.hasClass(\"btn\")&&n.removeClass(\"disabled\"),g.prop(\"disabled\",!1),l},l.ignoreReadonly=function(a){if(0===arguments.length)return d.ignoreReadonly;if(\"boolean\"!=typeof a)throw new TypeError(\"ignoreReadonly () expects a boolean parameter\");return d.ignoreReadonly=a,l},l.options=function(b){if(0===arguments.length)return a.extend(!0,{},d);if(!(b instanceof Object))throw new TypeError(\"options() options parameter should be an object\");return a.extend(!0,d,b),a.each(d,function(a,b){if(void 0===l[a])throw new TypeError(\"option \"+a+\" is not recognized!\");l[a](b)}),l},l.date=function(a){if(0===arguments.length)return m?null:e.clone();if(!(null===a||\"string\"==typeof a||b.isMoment(a)||a instanceof Date))throw new TypeError(\"date() parameter must be one of [null, string, moment or Date]\");return _(null===a?null:ga(a)),l},l.format=function(a){if(0===arguments.length)return d.format;if(\"string\"!=typeof a&&(\"boolean\"!=typeof a||a!==!1))throw new TypeError(\"format() expects a sting or boolean:false parameter \"+a);return d.format=a,i&&oa(),l},l.timeZone=function(a){return 0===arguments.length?d.timeZone:(d.timeZone=a,l)},l.dayViewHeaderFormat=function(a){if(0===arguments.length)return d.dayViewHeaderFormat;if(\"string\"!=typeof a)throw new TypeError(\"dayViewHeaderFormat() expects a string parameter\");return d.dayViewHeaderFormat=a,l},l.extraFormats=function(a){if(0===arguments.length)return d.extraFormats;if(a!==!1&&!(a instanceof Array))throw new TypeError(\"extraFormats() expects an array or false parameter\");return d.extraFormats=a,j&&oa(),l},l.disabledDates=function(b){if(0===arguments.length)return d.disabledDates?a.extend({},d.disabledDates):d.disabledDates;if(!b)return d.disabledDates=!1,$(),l;if(!(b instanceof Array))throw new TypeError(\"disabledDates() expects an array parameter\");return d.disabledDates=ma(b),d.enabledDates=!1,$(),l},l.enabledDates=function(b){if(0===arguments.length)return d.enabledDates?a.extend({},d.enabledDates):d.enabledDates;if(!b)return d.enabledDates=!1,$(),l;if(!(b instanceof Array))throw new TypeError(\"enabledDates() expects an array parameter\");return d.enabledDates=ma(b),d.disabledDates=!1,$(),l},l.daysOfWeekDisabled=function(a){if(0===arguments.length)return d.daysOfWeekDisabled.splice(0);if(\"boolean\"==typeof a&&!a)return d.daysOfWeekDisabled=!1,$(),l;if(!(a instanceof Array))throw new TypeError(\"daysOfWeekDisabled() expects an array parameter\");if(d.daysOfWeekDisabled=a.reduce(function(a,b){return b=parseInt(b,10),b>6||0>b||isNaN(b)?a:(-1===a.indexOf(b)&&a.push(b),a)},[]).sort(),d.useCurrent&&!d.keepInvalid){for(var b=0;!Q(e,\"d\");){if(e.add(1,\"d\"),7===b)throw\"Tried 7 times to find a valid date\";b++}_(e)}return $(),l},l.maxDate=function(a){if(0===arguments.length)return d.maxDate?d.maxDate.clone():d.maxDate;if(\"boolean\"==typeof a&&a===!1)return d.maxDate=!1,$(),l;\"string\"==typeof a&&(\"now\"===a||\"moment\"===a)&&(a=x());var b=ga(a);if(!b.isValid())throw new TypeError(\"maxDate() Could not parse date parameter: \"+a);if(d.minDate&&b.isBefore(d.minDate))throw new TypeError(\"maxDate() date parameter is before options.minDate: \"+b.format(i));return d.maxDate=b,d.useCurrent&&!d.keepInvalid&&e.isAfter(a)&&_(d.maxDate),f.isAfter(b)&&(f=b.clone().subtract(d.stepping,\"m\")),$(),l},l.minDate=function(a){if(0===arguments.length)return d.minDate?d.minDate.clone():d.minDate;if(\"boolean\"==typeof a&&a===!1)return d.minDate=!1,$(),l;\"string\"==typeof a&&(\"now\"===a||\"moment\"===a)&&(a=x());var b=ga(a);if(!b.isValid())throw new TypeError(\"minDate() Could not parse date parameter: \"+a);if(d.maxDate&&b.isAfter(d.maxDate))throw new TypeError(\"minDate() date parameter is after options.maxDate: \"+b.format(i));return d.minDate=b,d.useCurrent&&!d.keepInvalid&&e.isBefore(a)&&_(d.minDate),f.isBefore(b)&&(f=b.clone().add(d.stepping,\"m\")),$(),l},l.defaultDate=function(a){if(0===arguments.length)return d.defaultDate?d.defaultDate.clone():d.defaultDate;if(!a)return d.defaultDate=!1,l;\"string\"==typeof a&&(\"now\"===a||\"moment\"===a)&&(a=x());var b=ga(a);if(!b.isValid())throw new TypeError(\"defaultDate() Could not parse date parameter: \"+a);if(!Q(b))throw new TypeError(\"defaultDate() date passed is invalid according to component setup validations\");return d.defaultDate=b,(d.defaultDate&&d.inline||\"\"===g.val().trim())&&_(d.defaultDate),l},l.locale=function(a){if(0===arguments.length)return d.locale;if(!b.localeData(a))throw new TypeError(\"locale() locale \"+a+\" is not loaded from moment locales!\");return d.locale=a,e.locale(d.locale),f.locale(d.locale),i&&oa(),o&&(aa(),ea()),l},l.stepping=function(a){return 0===arguments.length?d.stepping:(a=parseInt(a,10),(isNaN(a)||1>a)&&(a=1),d.stepping=a,l)},l.useCurrent=function(a){var b=[\"year\",\"month\",\"day\",\"hour\",\"minute\"];if(0===arguments.length)return d.useCurrent;if(\"boolean\"!=typeof a&&\"string\"!=typeof a)throw new TypeError(\"useCurrent() expects a boolean or string parameter\");if(\"string\"==typeof a&&-1===b.indexOf(a.toLowerCase()))throw new TypeError(\"useCurrent() expects a string parameter of \"+b.join(\", \"));return d.useCurrent=a,l},l.collapse=function(a){if(0===arguments.length)return d.collapse;if(\"boolean\"!=typeof a)throw new TypeError(\"collapse() expects a boolean parameter\");return d.collapse===a?l:(d.collapse=a,o&&(aa(),ea()),l)},l.icons=function(b){if(0===arguments.length)return a.extend({},d.icons);if(!(b instanceof Object))throw new TypeError(\"icons() expects parameter to be an Object\");return a.extend(d.icons,b),o&&(aa(),ea()),l},l.tooltips=function(b){if(0===arguments.length)return a.extend({},d.tooltips);if(!(b instanceof Object))throw new TypeError(\"tooltips() expects parameter to be an Object\");return a.extend(d.tooltips,b),o&&(aa(),ea()),l},l.useStrict=function(a){if(0===arguments.length)return d.useStrict;if(\"boolean\"!=typeof a)throw new TypeError(\"useStrict() expects a boolean parameter\");return d.useStrict=a,l},l.sideBySide=function(a){if(0===arguments.length)return d.sideBySide;if(\"boolean\"!=typeof a)throw new TypeError(\"sideBySide() expects a boolean parameter\");return d.sideBySide=a,o&&(aa(),ea()),l},l.viewMode=function(a){if(0===arguments.length)return d.viewMode;if(\"string\"!=typeof a)throw new TypeError(\"viewMode() expects a string parameter\");if(-1===r.indexOf(a))throw new TypeError(\"viewMode() parameter must be one of (\"+r.join(\", \")+\") value\");return d.viewMode=a,k=Math.max(r.indexOf(a),p),K(),l},l.toolbarPlacement=function(a){if(0===arguments.length)return d.toolbarPlacement;if(\"string\"!=typeof a)throw new TypeError(\"toolbarPlacement() expects a string parameter\");if(-1===u.indexOf(a))throw new TypeError(\"toolbarPlacement() parameter must be one of (\"+u.join(\", \")+\") value\");return d.toolbarPlacement=a,o&&(aa(),ea()),l},l.widgetPositioning=function(b){if(0===arguments.length)return a.extend({},d.widgetPositioning);if(\"[object Object]\"!=={}.toString.call(b))throw new TypeError(\"widgetPositioning() expects an object variable\");if(b.horizontal){if(\"string\"!=typeof b.horizontal)throw new TypeError(\"widgetPositioning() horizontal variable must be a string\");if(b.horizontal=b.horizontal.toLowerCase(),-1===t.indexOf(b.horizontal))throw new TypeError(\"widgetPositioning() expects horizontal parameter to be one of (\"+t.join(\", \")+\")\");d.widgetPositioning.horizontal=b.horizontal}if(b.vertical){if(\"string\"!=typeof b.vertical)throw new TypeError(\"widgetPositioning() vertical variable must be a string\");if(b.vertical=b.vertical.toLowerCase(),-1===s.indexOf(b.vertical))throw new TypeError(\"widgetPositioning() expects vertical parameter to be one of (\"+s.join(\", \")+\")\");d.widgetPositioning.vertical=b.vertical}return $(),l},l.calendarWeeks=function(a){if(0===arguments.length)return d.calendarWeeks;if(\"boolean\"!=typeof a)throw new TypeError(\"calendarWeeks() expects parameter to be a boolean value\");return d.calendarWeeks=a,$(),l},l.showTodayButton=function(a){if(0===arguments.length)return d.showTodayButton;if(\"boolean\"!=typeof a)throw new TypeError(\"showTodayButton() expects a boolean parameter\");return d.showTodayButton=a,o&&(aa(),ea()),l},l.showClear=function(a){if(0===arguments.length)return d.showClear;if(\"boolean\"!=typeof a)throw new TypeError(\"showClear() expects a boolean parameter\");return d.showClear=a,o&&(aa(),ea()),l},l.widgetParent=function(b){if(0===arguments.length)return d.widgetParent;if(\"string\"==typeof b&&(b=a(b)),null!==b&&\"string\"!=typeof b&&!(b instanceof a))throw new TypeError(\"widgetParent() expects a string or a jQuery object parameter\");return d.widgetParent=b,o&&(aa(),ea()),l},l.keepOpen=function(a){if(0===arguments.length)return d.keepOpen;if(\"boolean\"!=typeof a)throw new TypeError(\"keepOpen() expects a boolean parameter\");return d.keepOpen=a,l},l.focusOnShow=function(a){if(0===arguments.length)return d.focusOnShow;if(\"boolean\"!=typeof a)throw new TypeError(\"focusOnShow() expects a boolean parameter\");return d.focusOnShow=a,l},l.inline=function(a){if(0===arguments.length)return d.inline;if(\"boolean\"!=typeof a)throw new TypeError(\"inline() expects a boolean parameter\");return d.inline=a,l},l.clear=function(){return ba(),l},l.keyBinds=function(a){return d.keyBinds=a,l},l.getMoment=function(a){return x(a)},l.debug=function(a){if(\"boolean\"!=typeof a)throw new TypeError(\"debug() expects a boolean parameter\");return d.debug=a,l},l.allowInputToggle=function(a){if(0===arguments.length)return d.allowInputToggle;if(\"boolean\"!=typeof a)throw new TypeError(\"allowInputToggle() expects a boolean parameter\");return d.allowInputToggle=a,l},l.showClose=function(a){if(0===arguments.length)return d.showClose;if(\"boolean\"!=typeof a)throw new TypeError(\"showClose() expects a boolean parameter\");return d.showClose=a,l},l.keepInvalid=function(a){if(0===arguments.length)return d.keepInvalid;if(\"boolean\"!=typeof a)throw new TypeError(\"keepInvalid() expects a boolean parameter\");return d.keepInvalid=a,l},l.datepickerInput=function(a){if(0===arguments.length)return d.datepickerInput;if(\"string\"!=typeof a)throw new TypeError(\"datepickerInput() expects a string parameter\");return d.datepickerInput=a,l},l.parseInputDate=function(a){if(0===arguments.length)return d.parseInputDate;\nif(\"function\"!=typeof a)throw new TypeError(\"parseInputDate() sholud be as function\");return d.parseInputDate=a,l},l.disabledTimeIntervals=function(b){if(0===arguments.length)return d.disabledTimeIntervals?a.extend({},d.disabledTimeIntervals):d.disabledTimeIntervals;if(!b)return d.disabledTimeIntervals=!1,$(),l;if(!(b instanceof Array))throw new TypeError(\"disabledTimeIntervals() expects an array parameter\");return d.disabledTimeIntervals=b,$(),l},l.disabledHours=function(b){if(0===arguments.length)return d.disabledHours?a.extend({},d.disabledHours):d.disabledHours;if(!b)return d.disabledHours=!1,$(),l;if(!(b instanceof Array))throw new TypeError(\"disabledHours() expects an array parameter\");if(d.disabledHours=na(b),d.enabledHours=!1,d.useCurrent&&!d.keepInvalid){for(var c=0;!Q(e,\"h\");){if(e.add(1,\"h\"),24===c)throw\"Tried 24 times to find a valid date\";c++}_(e)}return $(),l},l.enabledHours=function(b){if(0===arguments.length)return d.enabledHours?a.extend({},d.enabledHours):d.enabledHours;if(!b)return d.enabledHours=!1,$(),l;if(!(b instanceof Array))throw new TypeError(\"enabledHours() expects an array parameter\");if(d.enabledHours=na(b),d.disabledHours=!1,d.useCurrent&&!d.keepInvalid){for(var c=0;!Q(e,\"h\");){if(e.add(1,\"h\"),24===c)throw\"Tried 24 times to find a valid date\";c++}_(e)}return $(),l},l.viewDate=function(a){if(0===arguments.length)return f.clone();if(!a)return f=e.clone(),l;if(!(\"string\"==typeof a||b.isMoment(a)||a instanceof Date))throw new TypeError(\"viewDate() parameter must be one of [string, moment or Date]\");return f=ga(a),J(),l},c.is(\"input\"))g=c;else if(g=c.find(d.datepickerInput),0===g.size())g=c.find(\"input\");else if(!g.is(\"input\"))throw new Error('CSS class \"'+d.datepickerInput+'\" cannot be applied to non input element');if(c.hasClass(\"input-group\")&&(n=0===c.find(\".datepickerbutton\").size()?c.find(\".input-group-addon\"):c.find(\".datepickerbutton\")),!d.inline&&!g.is(\"input\"))throw new Error(\"Could not initialize DateTimePicker without an input element\");return e=x(),f=e.clone(),a.extend(!0,d,G()),l.options(d),oa(),ka(),g.prop(\"disabled\")&&l.disable(),g.is(\"input\")&&0!==g.val().trim().length?_(ga(g.val().trim())):d.defaultDate&&void 0===g.attr(\"placeholder\")&&_(d.defaultDate),d.inline&&ea(),l};a.fn.datetimepicker=function(b){return this.each(function(){var d=a(this);d.data(\"DateTimePicker\")||(b=a.extend(!0,{},a.fn.datetimepicker.defaults,b),d.data(\"DateTimePicker\",c(d,b)))})},a.fn.datetimepicker.defaults={timeZone:\"Etc/UTC\",format:!1,dayViewHeaderFormat:\"MMMM YYYY\",extraFormats:!1,stepping:1,minDate:!1,maxDate:!1,useCurrent:!0,collapse:!0,locale:b.locale(),defaultDate:!1,disabledDates:!1,enabledDates:!1,icons:{time:\"glyphicon glyphicon-time\",date:\"glyphicon glyphicon-calendar\",up:\"glyphicon glyphicon-chevron-up\",down:\"glyphicon glyphicon-chevron-down\",previous:\"glyphicon glyphicon-chevron-left\",next:\"glyphicon glyphicon-chevron-right\",today:\"glyphicon glyphicon-screenshot\",clear:\"glyphicon glyphicon-trash\",close:\"glyphicon glyphicon-remove\"},tooltips:{today:\"Go to today\",clear:\"Clear selection\",close:\"Close the picker\",selectMonth:\"Select Month\",prevMonth:\"Previous Month\",nextMonth:\"Next Month\",selectYear:\"Select Year\",prevYear:\"Previous Year\",nextYear:\"Next Year\",selectDecade:\"Select Decade\",prevDecade:\"Previous Decade\",nextDecade:\"Next Decade\",prevCentury:\"Previous Century\",nextCentury:\"Next Century\",pickHour:\"Pick Hour\",incrementHour:\"Increment Hour\",decrementHour:\"Decrement Hour\",pickMinute:\"Pick Minute\",incrementMinute:\"Increment Minute\",decrementMinute:\"Decrement Minute\",pickSecond:\"Pick Second\",incrementSecond:\"Increment Second\",decrementSecond:\"Decrement Second\",togglePeriod:\"Toggle Period\",selectTime:\"Select Time\"},useStrict:!1,sideBySide:!1,daysOfWeekDisabled:!1,calendarWeeks:!1,viewMode:\"days\",toolbarPlacement:\"default\",showTodayButton:!1,showClear:!1,showClose:!1,widgetPositioning:{horizontal:\"auto\",vertical:\"auto\"},widgetParent:null,ignoreReadonly:!1,keepOpen:!1,focusOnShow:!0,inline:!1,keepInvalid:!1,datepickerInput:\".datepickerinput\",keyBinds:{up:function(a){if(a){var b=this.date()||this.getMoment();a.find(\".datepicker\").is(\":visible\")?this.date(b.clone().subtract(7,\"d\")):this.date(b.clone().add(this.stepping(),\"m\"))}},down:function(a){if(!a)return void this.show();var b=this.date()||this.getMoment();a.find(\".datepicker\").is(\":visible\")?this.date(b.clone().add(7,\"d\")):this.date(b.clone().subtract(this.stepping(),\"m\"))},\"control up\":function(a){if(a){var b=this.date()||this.getMoment();a.find(\".datepicker\").is(\":visible\")?this.date(b.clone().subtract(1,\"y\")):this.date(b.clone().add(1,\"h\"))}},\"control down\":function(a){if(a){var b=this.date()||this.getMoment();a.find(\".datepicker\").is(\":visible\")?this.date(b.clone().add(1,\"y\")):this.date(b.clone().subtract(1,\"h\"))}},left:function(a){if(a){var b=this.date()||this.getMoment();a.find(\".datepicker\").is(\":visible\")&&this.date(b.clone().subtract(1,\"d\"))}},right:function(a){if(a){var b=this.date()||this.getMoment();a.find(\".datepicker\").is(\":visible\")&&this.date(b.clone().add(1,\"d\"))}},pageUp:function(a){if(a){var b=this.date()||this.getMoment();a.find(\".datepicker\").is(\":visible\")&&this.date(b.clone().subtract(1,\"M\"))}},pageDown:function(a){if(a){var b=this.date()||this.getMoment();a.find(\".datepicker\").is(\":visible\")&&this.date(b.clone().add(1,\"M\"))}},enter:function(){this.hide()},escape:function(){this.hide()},\"control space\":function(a){a.find(\".timepicker\").is(\":visible\")&&a.find('.btn[data-action=\"togglePeriod\"]').click()},t:function(){this.date(this.getMoment())},\"delete\":function(){this.clear()}},debug:!1,allowInputToggle:!1,disabledTimeIntervals:!1,disabledHours:!1,enabledHours:!1,viewDate:!1}});","/*\n    Redactor v10.0.9\n    Updated: March 16, 2015\n\n    http://imperavi.com/redactor/\n\n    Copyright (c) 2009-2015, Imperavi LLC.\n    License: http://imperavi.com/redactor/license/\n\n    Usage: $('#content').redactor();\n*/\n\n(function($)\n{\n    'use strict';\n\n    if (!Function.prototype.bind)\n    {\n        Function.prototype.bind = function(scope)\n        {\n            var fn = this;\n            return function()\n            {\n                return fn.apply(scope);\n            };\n        };\n    }\n\n    var uuid = 0;\n\n    var reUrlYoutube = /https?:\\/\\/(?:[0-9A-Z-]+\\.)?(?:youtu\\.be\\/|youtube\\.com\\S*[^\\w\\-\\s])([\\w\\-]{11})(?=[^\\w\\-]|$)(?![?=&+%\\w.\\-]*(?:['\"][^<>]*>|<\\/a>))[?=&+%\\w.-]*/ig;\n    var reUrlVimeo = /https?:\\/\\/(www\\.)?vimeo.com\\/(\\d+)($|\\/)/;\n\n    // Plugin\n    $.fn.redactor = function(options)\n    {\n        var val = [];\n        var args = Array.prototype.slice.call(arguments, 1);\n\n        if (typeof options === 'string')\n        {\n            this.each(function()\n            {\n                var instance = $.data(this, 'redactor');\n                var func;\n\n                if (options.search(/\\./) != '-1')\n                {\n                    func = options.split('.');\n                    if (typeof instance[func[0]] != 'undefined')\n                    {\n                        func = instance[func[0]][func[1]];\n                    }\n                }\n                else\n                {\n                    func = instance[options];\n                }\n\n                if (typeof instance !== 'undefined' && $.isFunction(func))\n                {\n                    var methodVal = func.apply(instance, args);\n                    if (methodVal !== undefined && methodVal !== instance)\n                    {\n                        val.push(methodVal);\n                    }\n                }\n                else\n                {\n                    $.error('No such method \"' + options + '\" for Redactor');\n                }\n            });\n        }\n        else\n        {\n            this.each(function()\n            {\n                $.data(this, 'redactor', {});\n                $.data(this, 'redactor', Redactor(this, options));\n            });\n        }\n\n        if (val.length === 0) return this;\n        else if (val.length === 1) return val[0];\n        else return val;\n\n    };\n\n    // Initialization\n    function Redactor(el, options)\n    {\n        return new Redactor.prototype.init(el, options);\n    }\n\n    // Functionality\n    $.Redactor = Redactor;\n    $.Redactor.VERSION = '10.0.9';\n    $.Redactor.modules = ['alignment', 'autosave', 'block', 'buffer', 'build', 'button',\n                          'caret', 'clean', 'code', 'core', 'dropdown', 'file', 'focus',\n                          'image', 'indent', 'inline', 'insert', 'keydown', 'keyup',\n                          'lang', 'line', 'link', 'list', 'modal', 'observe', 'paragraphize',\n                          'paste', 'placeholder', 'progress', 'selection', 'shortcuts',\n                          'tabifier', 'tidy',  'toolbar', 'upload', 'utils'];\n\n    $.Redactor.opts = {\n\n        // settings\n        lang: 'en',\n        direction: 'ltr', // ltr or rtl\n\n        plugins: false, // array\n\n        focus: false,\n        focusEnd: false,\n\n        placeholder: false,\n\n        visual: true,\n        tabindex: false,\n\n        minHeight: false,\n        maxHeight: false,\n\n        linebreaks: false,\n        replaceDivs: true,\n        paragraphize: true,\n        cleanStyleOnEnter: false,\n        enterKey: true,\n\n        cleanOnPaste: true,\n        cleanSpaces: true,\n        pastePlainText: false,\n\n        autosave: false, // false or url\n        autosaveName: false,\n        autosaveInterval: 60, // seconds\n        autosaveOnChange: false,\n        autosaveFields: false,\n\n        linkTooltip: true,\n        linkProtocol: 'http',\n        linkNofollow: false,\n        linkSize: 50,\n\n        imageEditable: true,\n        imageLink: true,\n        imagePosition: true,\n        imageFloatMargin: '10px',\n        imageResizable: true,\n\n        imageUpload: null,\n        imageUploadParam: 'file',\n\n        uploadImageField: false,\n\n        dragImageUpload: true,\n\n        fileUpload: null,\n        fileUploadParam: 'file',\n\n        dragFileUpload: true,\n\n        s3: false,\n\n        convertLinks: true,\n        convertUrlLinks: true,\n        convertImageLinks: true,\n        convertVideoLinks: true,\n\n        preSpaces: 4, // or false\n        tabAsSpaces: false, // true or number of spaces\n        tabKey: true,\n\n        scrollTarget: false,\n\n        toolbar: true,\n        toolbarFixed: true,\n        toolbarFixedTarget: document,\n        toolbarFixedTopOffset: 0, // pixels\n        toolbarExternal: false, // ID selector\n        toolbarOverflow: false,\n\n        source: true,\n        buttons: ['html', 'formatting', 'bold', 'italic', 'deleted', 'unorderedlist', 'orderedlist',\n                  'outdent', 'indent', 'image', 'file', 'link', 'alignment', 'horizontalrule'], // + 'underline'\n\n        buttonsHide: [],\n        buttonsHideOnMobile: [],\n\n        formatting: ['p', 'blockquote', 'pre', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'sup', 'sub', 'small'],\n        formattingAdd: false,\n\n        tabifier: true,\n\n        deniedTags: ['script', 'style'],\n        allowedTags: false, // or array\n\n        removeComments: false,\n        replaceTags: [\n            ['strike', 'del']\n        ],\n        replaceStyles: [\n            ['font-weight:\\\\s?bold', \"strong\"],\n            ['font-style:\\\\s?italic', \"em\"],\n            ['text-decoration:\\\\s?underline', \"u\"],\n            ['text-decoration:\\\\s?line-through', 'del']\n        ],\n        removeDataAttr: false,\n\n        removeAttr: false, // or multi array\n        allowedAttr: false, // or multi array\n\n        removeWithoutAttr: ['span'], // or false\n        removeEmpty: ['p'], // or false;\n\n        activeButtons: ['deleted', 'italic', 'bold', 'underline', 'unorderedlist', 'orderedlist',\n                        'alignleft', 'aligncenter', 'alignright', 'justify'],\n        activeButtonsStates: {\n            b: 'bold',\n            strong: 'bold',\n            i: 'italic',\n            em: 'italic',\n            del: 'deleted',\n            strike: 'deleted',\n            ul: 'unorderedlist',\n            ol: 'orderedlist',\n            u: 'underline'\n        },\n\n        shortcuts: {\n            'ctrl+shift+m, meta+shift+m': { func: 'inline.removeFormat' },\n            'ctrl+b, meta+b': { func: 'inline.format', params: ['bold'] },\n            'ctrl+i, meta+i': { func: 'inline.format', params: ['italic'] },\n            'ctrl+h, meta+h': { func: 'inline.format', params: ['superscript'] },\n            'ctrl+l, meta+l': { func: 'inline.format', params: ['subscript'] },\n            'ctrl+k, meta+k': { func: 'link.show' },\n            'ctrl+shift+7':   { func: 'list.toggle', params: ['orderedlist'] },\n            'ctrl+shift+8':   { func: 'list.toggle', params: ['unorderedlist'] }\n        },\n        shortcutsAdd: false,\n\n        // private\n        buffer: [],\n        rebuffer: [],\n        emptyHtml: '<p>&#x200b;</p>',\n        invisibleSpace: '&#x200b;',\n        imageTypes: ['image/png', 'image/jpeg', 'image/gif'],\n        indentValue: 20,\n        verifiedTags:       ['a', 'img', 'b', 'strong', 'sub', 'sup', 'i', 'em', 'u', 'small', 'strike', 'del', 'cite', 'ul', 'ol', 'li'], // and for span tag special rule\n        inlineTags:         ['strong', 'b', 'u', 'em', 'i', 'code', 'del', 'ins', 'samp', 'kbd', 'sup', 'sub', 'mark', 'var', 'cite', 'small'],\n        alignmentTags:      ['P', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6',  'DL', 'DT', 'DD', 'DIV', 'TD', 'BLOCKQUOTE', 'OUTPUT', 'FIGCAPTION', 'ADDRESS', 'SECTION', 'HEADER', 'FOOTER', 'ASIDE', 'ARTICLE'],\n        blockLevelElements: ['PRE', 'UL', 'OL', 'LI'],\n\n\n        // lang\n        langs: {\n            en: {\n                html: 'HTML/Markdown',\n                video: 'Insert Video',\n                image: 'Insert Image',\n                table: 'Table',\n                link: 'Link',\n                link_insert: 'Insert link',\n                link_edit: 'Edit link',\n                unlink: 'Unlink',\n                formatting: 'Formatting',\n                paragraph: 'Normal text',\n                quote: 'Quote',\n                code: 'Code',\n                header1: 'Header 1',\n                header2: 'Header 2',\n                header3: 'Header 3',\n                header4: 'Header 4',\n                header5: 'Header 5',\n                bold: 'Bold',\n                italic: 'Italic',\n                fontcolor: 'Font Color',\n                backcolor: 'Back Color',\n                unorderedlist: 'Unordered List',\n                orderedlist: 'Ordered List',\n                outdent: 'Outdent',\n                indent: 'Indent',\n                cancel: 'Cancel',\n                insert: 'Insert',\n                save: 'Save',\n                _delete: 'Delete',\n                insert_table: 'Insert Table',\n                insert_row_above: 'Add Row Above',\n                insert_row_below: 'Add Row Below',\n                insert_column_left: 'Add Column Left',\n                insert_column_right: 'Add Column Right',\n                delete_column: 'Delete Column',\n                delete_row: 'Delete Row',\n                delete_table: 'Delete Table',\n                rows: 'Rows',\n                columns: 'Columns',\n                add_head: 'Add Head',\n                delete_head: 'Delete Head',\n                title: 'Title',\n                image_position: 'Position',\n                none: 'None',\n                left: 'Left',\n                right: 'Right',\n                center: 'Center',\n                image_web_link: 'Image Web Link',\n                text: 'Text',\n                mailto: 'Email',\n                web: 'URL',\n                video_html_code: 'Video Embed Code or Youtube/Vimeo Link',\n                file: 'Insert File',\n                upload: 'Upload',\n                download: 'Download',\n                choose: 'Choose',\n                or_choose: 'Or choose',\n                drop_file_here: 'Drop file here',\n                align_left: 'Align text to the left',\n                align_center: 'Center text',\n                align_right: 'Align text to the right',\n                align_justify: 'Justify text',\n                horizontalrule: 'Insert Horizontal Rule',\n                deleted: 'Deleted',\n                anchor: 'Anchor',\n                link_new_tab: 'Open link in new tab',\n                underline: 'Underline',\n                alignment: 'Alignment',\n                filename: 'Name (optional)',\n                edit: 'Edit',\n                upload_label: 'Drop file here or '\n\n            }\n        }\n    };\n\n    // Functionality\n    Redactor.fn = $.Redactor.prototype = {\n\n        keyCode: {\n            BACKSPACE: 8,\n            DELETE: 46,\n            DOWN: 40,\n            ENTER: 13,\n            SPACE: 32,\n            ESC: 27,\n            TAB: 9,\n            CTRL: 17,\n            META: 91,\n            SHIFT: 16,\n            ALT: 18,\n            RIGHT: 39,\n            LEFT: 37,\n            LEFT_WIN: 91\n        },\n\n        // Initialization\n        init: function(el, options)\n        {\n            this.$element = $(el);\n            this.uuid = uuid++;\n\n            // if paste event detected = true\n            this.rtePaste = false;\n            this.$pasteBox = false;\n\n            this.loadOptions(options);\n            this.loadModules();\n\n            // formatting storage\n            this.formatting = {};\n\n            // block level tags\n            $.merge(this.opts.blockLevelElements, this.opts.alignmentTags);\n            this.reIsBlock = new RegExp('^(' + this.opts.blockLevelElements.join('|' ) + ')$', 'i');\n\n            // setup allowed and denied tags\n            this.tidy.setupAllowed();\n\n            // setup denied tags\n            if (this.opts.deniedTags !== false)\n            {\n                var tags = ['html', 'head', 'link', 'body', 'meta', 'applet'];\n                for (var i = 0; i < tags.length; i++)\n                {\n                    this.opts.deniedTags.push(tags[i]);\n                }\n            }\n\n            // load lang\n            this.lang.load();\n\n            // extend shortcuts\n            $.extend(this.opts.shortcuts, this.opts.shortcutsAdd);\n\n            // start callback\n            this.core.setCallback('start');\n\n            // build\n            this.start = true;\n            this.build.run();\n        },\n\n        loadOptions: function(options)\n        {\n            this.opts = $.extend(\n                {},\n                $.extend(true, {}, $.Redactor.opts),\n                this.$element.data(),\n                options\n            );\n        },\n        getModuleMethods: function(object)\n        {\n            return Object.getOwnPropertyNames(object).filter(function(property)\n            {\n                return typeof object[property] == 'function';\n            });\n        },\n        loadModules: function()\n        {\n            var len = $.Redactor.modules.length;\n            for (var i = 0; i < len; i++)\n            {\n                this.bindModuleMethods($.Redactor.modules[i]);\n            }\n        },\n        bindModuleMethods: function(module)\n        {\n            if (typeof this[module] == 'undefined') return;\n\n            // init module\n            this[module] = this[module]();\n\n            var methods = this.getModuleMethods(this[module]);\n            var len = methods.length;\n\n            // bind methods\n            for (var z = 0; z < len; z++)\n            {\n                this[module][methods[z]] = this[module][methods[z]].bind(this);\n            }\n        },\n\n        alignment: function()\n        {\n            return {\n                left: function()\n                {\n                    this.alignment.set('');\n                },\n                right: function()\n                {\n                    this.alignment.set('right');\n                },\n                center: function()\n                {\n                    this.alignment.set('center');\n                },\n                justify: function()\n                {\n                    this.alignment.set('justify');\n                },\n                set: function(type)\n                {\n                    // focus\n                    if (!this.utils.browser('msie')) this.$editor.focus();\n\n                    this.buffer.set();\n                    this.selection.save();\n\n                    // get blocks\n                    this.alignment.blocks = this.selection.getBlocks();\n                    this.alignment.type = type;\n\n                    // set alignment\n                    if (this.alignment.isLinebreaksOrNoBlocks())\n                    {\n                        this.alignment.setText();\n                    }\n                    else\n                    {\n                        this.alignment.setBlocks();\n                    }\n\n                    // sync\n                    this.selection.restore();\n                    this.code.sync();\n                },\n                setText: function()\n                {\n                    var wrapper = this.selection.wrap('div');\n                    $(wrapper).attr('data-tagblock', 'redactor').css('text-align', this.alignment.type);\n                },\n                setBlocks: function()\n                {\n                    $.each(this.alignment.blocks, $.proxy(function(i, el)\n                    {\n                        var $el = this.utils.getAlignmentElement(el);\n                        if (!$el) return;\n\n                        if (this.alignment.isNeedReplaceElement($el))\n                        {\n                            this.alignment.replaceElement($el);\n                        }\n                        else\n                        {\n                            this.alignment.alignElement($el);\n                        }\n\n                    }, this));\n                },\n                isLinebreaksOrNoBlocks: function()\n                {\n                    return (this.opts.linebreaks && this.alignment.blocks[0] === false);\n                },\n                isNeedReplaceElement: function($el)\n                {\n                    return (this.alignment.type === '' && typeof($el.data('tagblock')) !== 'undefined');\n                },\n                replaceElement: function($el)\n                {\n                    $el.replaceWith($el.html());\n                },\n                alignElement: function($el)\n                {\n                    $el.css('text-align', this.alignment.type);\n                    this.utils.removeEmptyAttr($el, 'style');\n                }\n            };\n        },\n        autosave: function()\n        {\n            return {\n                enable: function()\n                {\n                    if (!this.opts.autosave) return;\n\n                    this.autosave.html = false;\n                    this.autosave.name = (this.opts.autosaveName) ? this.opts.autosaveName : this.$textarea.attr('name');\n\n                    if (this.opts.autosaveOnChange) return;\n                    this.autosaveInterval = setInterval(this.autosave.load, this.opts.autosaveInterval * 1000);\n                },\n                onChange: function()\n                {\n                    if (!this.opts.autosaveOnChange) return;\n                    this.autosave.load();\n                },\n                load: function()\n                {\n                    this.autosave.source = this.code.get();\n\n                    if (this.autosave.html === this.autosave.source) return;\n                    if (this.utils.isEmpty(this.autosave.source)) return;\n\n                    // data\n                    var data = {};\n                    data['name'] = this.autosave.name;\n                    data[this.autosave.name] = this.autosave.source;\n                    data = this.autosave.getHiddenFields(data);\n\n                    // ajax\n                    var jsxhr = $.ajax({\n                        url: this.opts.autosave,\n                        type: 'post',\n                        data: data\n                    });\n\n                    jsxhr.done(this.autosave.success);\n                },\n                getHiddenFields: function(data)\n                {\n                    if (this.opts.autosaveFields === false || typeof this.opts.autosaveFields !== 'object')\n                    {\n                        return data;\n                    }\n\n                    $.each(this.opts.autosaveFields, $.proxy(function(k, v)\n                    {\n                        if (v !== null && v.toString().indexOf('#') === 0) v = $(v).val();\n                        data[k] = v;\n\n                    }, this));\n\n                    return data;\n\n                },\n                success: function(data)\n                {\n                    var json;\n                    try\n                    {\n                        json = $.parseJSON(data);\n                    }\n                    catch(e)\n                    {\n                        //data has already been parsed\n                        json = data;\n                    }\n\n                    var callbackName = (typeof json.error == 'undefined') ? 'autosave' :  'autosaveError';\n\n                    this.core.setCallback(callbackName, this.autosave.name, json);\n                    this.autosave.html = this.autosave.source;\n                },\n                disable: function()\n                {\n                    clearInterval(this.autosaveInterval);\n                }\n            };\n        },\n        block: function()\n        {\n            return {\n                formatting: function(name)\n                {\n                    this.block.clearStyle = false;\n                    var type, value;\n\n                    if (typeof this.formatting[name].data != 'undefined') type = 'data';\n                    else if (typeof this.formatting[name].attr != 'undefined') type = 'attr';\n                    else if (typeof this.formatting[name]['class'] != 'undefined') type = 'class';\n\n                    if (typeof this.formatting[name].clear != 'undefined')\n                    {\n                        this.block.clearStyle = true;\n                    }\n\n                    if (type) value = this.formatting[name][type];\n\n                    this.block.format(this.formatting[name].tag, type, value);\n\n                },\n                format: function(tag, type, value)\n                {\n                    if (tag == 'quote') tag = 'blockquote';\n\n                    var formatTags = ['p', 'pre', 'blockquote', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'sup', 'sub', 'small'];\n                    if ($.inArray(tag, formatTags) == -1) return;\n\n                    this.block.isRemoveInline = (tag == 'pre' || tag.search(/h[1-6]/i) != -1);\n\n                    // focus\n                    if (!this.utils.browser('msie')) this.$editor.focus();\n\n                    this.block.blocks = this.selection.getBlocks();\n\n                    this.block.blocksSize = this.block.blocks.length;\n                    this.block.type = type;\n                    this.block.value = value;\n\n                    this.buffer.set();\n                    this.selection.save();\n\n                    this.block.set(tag);\n\n                    this.selection.restore();\n                    this.code.sync();\n\n                },\n                set: function(tag)\n                {\n                    this.selection.get();\n                    this.block.containerTag = this.range.commonAncestorContainer.tagName;\n\n                    if (this.range.collapsed)\n                    {\n                        this.block.setCollapsed(tag);\n                    }\n                    else\n                    {\n                        this.block.setMultiple(tag);\n                    }\n                },\n                setCollapsed: function(tag)\n                {\n                    var block = this.block.blocks[0];\n                    if (block === false) return;\n\n                    if (block.tagName == 'LI')\n                    {\n                        if (tag != 'blockquote') return;\n\n                        this.block.formatListToBlockquote();\n                        return;\n                    }\n\n                    var isContainerTable = (this.block.containerTag  == 'TD' || this.block.containerTag  == 'TH');\n                    if (isContainerTable && !this.opts.linebreaks)\n                    {\n\n                        document.execCommand('formatblock', false, '<' + tag + '>');\n\n                        block = this.selection.getBlock();\n                        this.block.toggle($(block));\n\n                    }\n                    else if (block.tagName.toLowerCase() != tag)\n                    {\n                        if (this.opts.linebreaks && tag == 'p')\n                        {\n                            $(block).prepend('<br>').append('<br>');\n                            this.utils.replaceWithContents(block);\n                        }\n                        else\n                        {\n                            var $formatted = this.utils.replaceToTag(block, tag);\n\n                            this.block.toggle($formatted);\n\n                            if (tag != 'p' && tag != 'blockquote') $formatted.find('img').remove();\n                            if (this.block.isRemoveInline) this.utils.removeInlineTags($formatted);\n                            if (tag == 'p' || this.block.headTag) $formatted.find('p').contents().unwrap();\n\n                            this.block.formatTableWrapping($formatted);\n                        }\n                    }\n                    else if (tag == 'blockquote' && block.tagName.toLowerCase() == tag)\n                    {\n                        // blockquote off\n                        if (this.opts.linebreaks)\n                        {\n                            $(block).prepend('<br>').append('<br>');\n                            this.utils.replaceWithContents(block);\n                        }\n                        else\n                        {\n                            var $el = this.utils.replaceToTag(block, 'p');\n                            this.block.toggle($el);\n                        }\n                    }\n                    else if (block.tagName.toLowerCase() == tag)\n                    {\n                        this.block.toggle($(block));\n                    }\n\n                    if (typeof this.block.type == 'undefined' && typeof this.block.value == 'undefined')\n                    {\n                        $(block).removeAttr('class').removeAttr('style');\n                    }\n\n                },\n                setMultiple: function(tag)\n                {\n                    var block = this.block.blocks[0];\n                    var isContainerTable = (this.block.containerTag  == 'TD' || this.block.containerTag  == 'TH');\n\n                    if (block !== false && this.block.blocksSize === 1)\n                    {\n                        if (block.tagName.toLowerCase() == tag &&  tag == 'blockquote')\n                        {\n                            // blockquote off\n                            if (this.opts.linebreaks)\n                            {\n                                $(block).prepend('<br>').append('<br>');\n                                this.utils.replaceWithContents(block);\n                            }\n                            else\n                            {\n                                var $el = this.utils.replaceToTag(block, 'p');\n                                this.block.toggle($el);\n                            }\n                        }\n                        else if (block.tagName == 'LI')\n                        {\n                            if (tag != 'blockquote') return;\n\n                            this.block.formatListToBlockquote();\n                        }\n                        else if (this.block.containerTag == 'BLOCKQUOTE')\n                        {\n                            this.block.formatBlockquote(tag);\n                        }\n                        else if (this.opts.linebreaks && ((isContainerTable) || (this.range.commonAncestorContainer != block)))\n                        {\n                            this.block.formatWrap(tag);\n                        }\n                        else\n                        {\n                            if (this.opts.linebreaks && tag == 'p')\n                            {\n                                $(block).prepend('<br>').append('<br>');\n                                this.utils.replaceWithContents(block);\n                            }\n                            else if (block.tagName === 'TD')\n                            {\n                                this.block.formatWrap(tag);\n                            }\n                            else\n                            {\n                                var $formatted = this.utils.replaceToTag(block, tag);\n\n                                this.block.toggle($formatted);\n\n                                if (this.block.isRemoveInline) this.utils.removeInlineTags($formatted);\n                                if (tag == 'p' || this.block.headTag) $formatted.find('p').contents().unwrap();\n                            }\n                        }\n                    }\n                    else\n                    {\n\n                        if (this.opts.linebreaks || tag != 'p')\n                        {\n                            if (tag == 'blockquote')\n                            {\n                                var count = 0;\n                                for (var i = 0; i < this.block.blocksSize; i++)\n                                {\n                                    if (this.block.blocks[i].tagName == 'BLOCKQUOTE') count++;\n                                }\n\n                                // only blockquote selected\n                                if (count == this.block.blocksSize)\n                                {\n                                    $.each(this.block.blocks, $.proxy(function(i,s)\n                                    {\n                                        var $formatted = false;\n                                        if (this.opts.linebreaks)\n                                        {\n                                            $(s).prepend('<br>').append('<br>');\n                                            $formatted = this.utils.replaceWithContents(s);\n                                        }\n                                        else\n                                        {\n                                            $formatted = this.utils.replaceToTag(s, 'p');\n                                        }\n\n                                        if ($formatted && typeof this.block.type == 'undefined' && typeof this.block.value == 'undefined')\n                                        {\n                                            $formatted.removeAttr('class').removeAttr('style');\n                                        }\n\n                                    }, this));\n\n                                    return;\n                                }\n\n                            }\n\n\n                            this.block.formatWrap(tag);\n                        }\n                        else\n                        {\n                            var classSize = 0;\n                            var toggleType = false;\n                            if (this.block.type == 'class')\n                            {\n                                toggleType = 'toggle';\n                                classSize = $(this.block.blocks).filter('.' + this.block.value).length;\n\n                                if (this.block.blocksSize == classSize) toggleType = 'toggle';\n                                else if (this.block.blocksSize > classSize) toggleType = 'set';\n                                else if (classSize === 0) toggleType = 'set';\n\n                            }\n\n                            var exceptTags = ['ul', 'ol', 'li', 'td', 'th', 'dl', 'dt', 'dd'];\n                            $.each(this.block.blocks, $.proxy(function(i,s)\n                            {\n                                if ($.inArray(s.tagName.toLowerCase(), exceptTags) != -1) return;\n\n                                var $formatted = this.utils.replaceToTag(s, tag);\n\n                                if (toggleType)\n                                {\n                                    if (toggleType == 'toggle') this.block.toggle($formatted);\n                                    else if (toggleType == 'remove') this.block.remove($formatted);\n                                    else if (toggleType == 'set') this.block.setForce($formatted);\n                                }\n                                else this.block.toggle($formatted);\n\n                                if (tag != 'p' && tag != 'blockquote') $formatted.find('img').remove();\n                                if (this.block.isRemoveInline) this.utils.removeInlineTags($formatted);\n                                if (tag == 'p' || this.block.headTag) $formatted.find('p').contents().unwrap();\n\n                                if (typeof this.block.type == 'undefined' && typeof this.block.value == 'undefined')\n                                {\n                                    $formatted.removeAttr('class').removeAttr('style');\n                                }\n\n\n                            }, this));\n                        }\n                    }\n                },\n                setForce: function($el)\n                {\n                    // remove style and class if the specified setting\n                    if (this.block.clearStyle)\n                    {\n                        $el.removeAttr('class').removeAttr('style');\n                    }\n\n                    if (this.block.type == 'class')\n                    {\n                        $el.addClass(this.block.value);\n                        return;\n                    }\n                    else if (this.block.type == 'attr' || this.block.type == 'data')\n                    {\n                        $el.attr(this.block.value.name, this.block.value.value);\n                        return;\n                    }\n                },\n                toggle: function($el)\n                {\n                    // remove style and class if the specified setting\n                    if (this.block.clearStyle)\n                    {\n                        $el.removeAttr('class').removeAttr('style');\n                    }\n\n                    if (this.block.type == 'class')\n                    {\n                        $el.toggleClass(this.block.value);\n                        return;\n                    }\n                    else if (this.block.type == 'attr' || this.block.type == 'data')\n                    {\n                        if ($el.attr(this.block.value.name) == this.block.value.value)\n                        {\n                            $el.removeAttr(this.block.value.name);\n                        }\n                        else\n                        {\n                            $el.attr(this.block.value.name, this.block.value.value);\n                        }\n\n                        return;\n                    }\n                    else\n                    {\n                        $el.removeAttr('style class');\n                        return;\n                    }\n                },\n                remove: function($el)\n                {\n                    $el.removeClass(this.block.value);\n                },\n                formatListToBlockquote: function()\n                {\n                    var block = $(this.block.blocks[0]).closest('ul, ol');\n\n                    $(block).find('ul, ol').contents().unwrap();\n                    $(block).find('li').append($('<br>')).contents().unwrap();\n\n                    var $el = this.utils.replaceToTag(block, 'blockquote');\n                    this.block.toggle($el);\n                },\n                formatBlockquote: function(tag)\n                {\n                    document.execCommand('outdent');\n                    document.execCommand('formatblock', false, tag);\n\n                    this.clean.clearUnverified();\n                    this.$editor.find('p:empty').remove();\n\n                    var formatted = this.selection.getBlock();\n\n                    if (tag != 'p')\n                    {\n                        $(formatted).find('img').remove();\n                    }\n\n                    if (!this.opts.linebreaks)\n                    {\n                        this.block.toggle($(formatted));\n                    }\n\n                    this.$editor.find('ul, ol, tr, blockquote, p').each($.proxy(this.utils.removeEmpty, this));\n\n                    if (this.opts.linebreaks && tag == 'p')\n                    {\n                        this.utils.replaceWithContents(formatted);\n                    }\n\n                },\n                formatWrap: function(tag)\n                {\n                    if (this.block.containerTag == 'UL' || this.block.containerTag == 'OL')\n                    {\n                        if (tag == 'blockquote')\n                        {\n                            this.block.formatListToBlockquote();\n                        }\n                        else\n                        {\n                            return;\n                        }\n                    }\n\n                    var formatted = this.selection.wrap(tag);\n                    if (formatted === false) return;\n\n                    var $formatted = $(formatted);\n\n                    this.block.formatTableWrapping($formatted);\n\n                    var $elements = $formatted.find(this.opts.blockLevelElements.join(',') + ', td, table, thead, tbody, tfoot, th, tr');\n\n                    if ((this.opts.linebreaks && tag == 'p') || tag == 'pre' || tag == 'blockquote')\n                    {\n                        $elements.append('<br />');\n                    }\n\n                    $elements.contents().unwrap();\n\n                    if (tag != 'p' && tag != 'blockquote') $formatted.find('img').remove();\n\n                    $.each(this.block.blocks, $.proxy(this.utils.removeEmpty, this));\n\n                    $formatted.append(this.selection.getMarker(2));\n\n                    if (!this.opts.linebreaks)\n                    {\n                        this.block.toggle($formatted);\n                    }\n\n                    this.$editor.find('ul, ol, tr, blockquote, p').each($.proxy(this.utils.removeEmpty, this));\n                    $formatted.find('blockquote:empty').remove();\n\n                    if (this.block.isRemoveInline)\n                    {\n                        this.utils.removeInlineTags($formatted);\n                    }\n\n                    if (this.opts.linebreaks && tag == 'p')\n                    {\n                        this.utils.replaceWithContents($formatted);\n                    }\n\n                },\n                formatTableWrapping: function($formatted)\n                {\n                    if ($formatted.closest('table').length === 0) return;\n\n                    if ($formatted.closest('tr').length === 0) $formatted.wrap('<tr>');\n                    if ($formatted.closest('td').length === 0 && $formatted.closest('th').length === 0)\n                    {\n                        $formatted.wrap('<td>');\n                    }\n                },\n                removeData: function(name, value)\n                {\n                    var blocks = this.selection.getBlocks();\n                    $(blocks).removeAttr('data-' + name);\n\n                    this.code.sync();\n                },\n                setData: function(name, value)\n                {\n                    var blocks = this.selection.getBlocks();\n                    $(blocks).attr('data-' + name, value);\n\n                    this.code.sync();\n                },\n                toggleData: function(name, value)\n                {\n                    var blocks = this.selection.getBlocks();\n                    $.each(blocks, function()\n                    {\n                        if ($(this).attr('data-' + name))\n                        {\n                            $(this).removeAttr('data-' + name);\n                        }\n                        else\n                        {\n                            $(this).attr('data-' + name, value);\n                        }\n                    });\n                },\n                removeAttr: function(attr, value)\n                {\n                    var blocks = this.selection.getBlocks();\n                    $(blocks).removeAttr(attr);\n\n                    this.code.sync();\n                },\n                setAttr: function(attr, value)\n                {\n                    var blocks = this.selection.getBlocks();\n                    $(blocks).attr(attr, value);\n\n                    this.code.sync();\n                },\n                toggleAttr: function(attr, value)\n                {\n                    var blocks = this.selection.getBlocks();\n                    $.each(blocks, function()\n                    {\n                        if ($(this).attr(name))\n                        {\n                            $(this).removeAttr(name);\n                        }\n                        else\n                        {\n                            $(this).attr(name, value);\n                        }\n                    });\n                },\n                removeClass: function(className)\n                {\n                    var blocks = this.selection.getBlocks();\n                    $(blocks).removeClass(className);\n\n                    this.utils.removeEmptyAttr(blocks, 'class');\n\n                    this.code.sync();\n                },\n                setClass: function(className)\n                {\n                    var blocks = this.selection.getBlocks();\n                    $(blocks).addClass(className);\n\n                    this.code.sync();\n                },\n                toggleClass: function(className)\n                {\n                    var blocks = this.selection.getBlocks();\n                    $(blocks).toggleClass(className);\n\n                    this.code.sync();\n                }\n            };\n        },\n        buffer: function()\n        {\n            return {\n                set: function(type)\n                {\n                    if (typeof type == 'undefined' || type == 'undo')\n                    {\n                        this.buffer.setUndo();\n                    }\n                    else\n                    {\n                        this.buffer.setRedo();\n                    }\n                },\n                setUndo: function()\n                {\n                    this.selection.save();\n                    this.opts.buffer.push(this.$editor.html());\n                    this.selection.restore();\n                },\n                setRedo: function()\n                {\n                    this.selection.save();\n                    this.opts.rebuffer.push(this.$editor.html());\n                    this.selection.restore();\n                },\n                getUndo: function()\n                {\n                    this.$editor.html(this.opts.buffer.pop());\n                },\n                getRedo: function()\n                {\n                    this.$editor.html(this.opts.rebuffer.pop());\n                },\n                add: function()\n                {\n                    this.opts.buffer.push(this.$editor.html());\n                },\n                undo: function()\n                {\n                    if (this.opts.buffer.length === 0) return;\n\n                    this.buffer.set('redo');\n                    this.buffer.getUndo();\n\n                    this.selection.restore();\n\n                    setTimeout($.proxy(this.observe.load, this), 50);\n                },\n                redo: function()\n                {\n                    if (this.opts.rebuffer.length === 0) return;\n\n                    this.buffer.set('undo');\n                    this.buffer.getRedo();\n\n                    this.selection.restore();\n\n                    setTimeout($.proxy(this.observe.load, this), 50);\n                }\n            };\n        },\n        build: function()\n        {\n            return {\n                run: function()\n                {\n                    this.build.createContainerBox();\n                    this.build.loadContent();\n                    this.build.loadEditor();\n                    this.build.enableEditor();\n                    this.build.setCodeAndCall();\n                },\n                isTextarea: function()\n                {\n                    return (this.$element[0].tagName === 'TEXTAREA');\n                },\n                createContainerBox: function()\n                {\n                    this.$box = $('<div class=\"redactor-box\" />');\n                },\n                createTextarea: function()\n                {\n                    this.$textarea = $('<textarea />').attr('name', this.build.getTextareaName());\n                },\n                getTextareaName: function()\n                {\n                    return ((typeof(name) == 'undefined')) ? 'content-' + this.uuid : this.$element.attr('id');\n                },\n                loadContent: function()\n                {\n                    var func = (this.build.isTextarea()) ? 'val' : 'html';\n                    this.content = $.trim(this.$element[func]());\n                },\n                enableEditor: function()\n                {\n                    this.$editor.attr({ 'contenteditable': true, 'dir': this.opts.direction });\n                },\n                loadEditor: function()\n                {\n                    var func = (this.build.isTextarea()) ? 'fromTextarea' : 'fromElement';\n                    this.build[func]();\n                },\n                fromTextarea: function()\n                {\n                    this.$editor = $('<div />');\n                    this.$textarea = this.$element;\n                    this.$box.insertAfter(this.$element).append(this.$editor).append(this.$element);\n                    this.$editor.addClass('redactor-editor');\n\n                    this.$element.hide();\n                },\n                fromElement: function()\n                {\n                    this.$editor = this.$element;\n                    this.build.createTextarea();\n                    this.$box.insertAfter(this.$editor).append(this.$editor).append(this.$textarea);\n                    this.$editor.addClass('redactor-editor');\n\n                    this.$textarea.hide();\n                },\n                setCodeAndCall: function()\n                {\n                    // set code\n                    this.code.set(this.content);\n\n                    this.build.setOptions();\n                    this.build.callEditor();\n\n                    // code mode\n                    if (this.opts.visual) return;\n                    setTimeout($.proxy(this.code.showCode, this), 200);\n                },\n                callEditor: function()\n                {\n                    this.build.disableMozillaEditing();\n                    this.build.setEvents();\n                    this.build.setHelpers();\n\n                    // load toolbar\n                    if (this.opts.toolbar)\n                    {\n                        this.opts.toolbar = this.toolbar.init();\n                        this.toolbar.build();\n                    }\n\n                    // modal templates init\n                    this.modal.loadTemplates();\n\n                    // plugins\n                    this.build.plugins();\n\n                    // observers\n                    setTimeout($.proxy(this.observe.load, this), 4);\n\n                    // init callback\n                    this.core.setCallback('init');\n                },\n                setOptions: function()\n                {\n                    // textarea direction\n                    $(this.$textarea).attr('dir', this.opts.direction);\n\n                    if (this.opts.linebreaks) this.$editor.addClass('redactor-linebreaks');\n\n                    if (this.opts.tabindex) this.$editor.attr('tabindex', this.opts.tabindex);\n\n                    if (this.opts.minHeight) this.$editor.css('minHeight', this.opts.minHeight);\n                    if (this.opts.maxHeight) this.$editor.css('maxHeight', this.opts.maxHeight);\n\n                },\n                setEventDropUpload: function(e)\n                {\n                    e.preventDefault();\n\n                    if (!this.opts.dragImageUpload || !this.opts.dragFileUpload) return;\n\n                    var files = e.dataTransfer.files;\n                    this.upload.directUpload(files[0], e);\n                },\n                setEventDrop: function(e)\n                {\n                    this.code.sync();\n                    setTimeout(this.clean.clearUnverified, 1);\n                    this.core.setCallback('drop', e);\n                },\n                setEvents: function()\n                {\n                    // drop\n                    this.$editor.on('drop.redactor', $.proxy(function(e)\n                    {\n                        e = e.originalEvent || e;\n\n                        if (window.FormData === undefined || !e.dataTransfer) return true;\n\n                        if (e.dataTransfer.files.length === 0)\n                        {\n                            return this.build.setEventDrop(e);\n                        }\n                        else\n                        {\n                            this.build.setEventDropUpload(e);\n                        }\n\n                        setTimeout(this.clean.clearUnverified, 1);\n                        this.core.setCallback('drop', e);\n\n                    }, this));\n\n\n                    // click\n                    this.$editor.on('click.redactor', $.proxy(function(e)\n                    {\n                        var event = this.core.getEvent();\n                        var type = (event == 'click' || event == 'arrow') ? false : 'click';\n\n                        this.core.addEvent(type);\n                        this.utils.disableSelectAll();\n                        this.core.setCallback('click', e);\n\n                    }, this));\n\n                    // paste\n                    this.$editor.on('paste.redactor', $.proxy(this.paste.init, this));\n\n                    // keydown\n                    this.$editor.on('keydown.redactor', $.proxy(this.keydown.init, this));\n\n                    // keyup\n                    this.$editor.on('keyup.redactor', $.proxy(this.keyup.init, this));\n\n                    // textarea keydown\n                    if ($.isFunction(this.opts.codeKeydownCallback))\n                    {\n                        this.$textarea.on('keydown.redactor-textarea', $.proxy(this.opts.codeKeydownCallback, this));\n                    }\n\n                    // textarea keyup\n                    if ($.isFunction(this.opts.codeKeyupCallback))\n                    {\n                        this.$textarea.on('keyup.redactor-textarea', $.proxy(this.opts.codeKeyupCallback, this));\n                    }\n\n                    // focus\n                    if ($.isFunction(this.opts.focusCallback))\n                    {\n                        this.$editor.on('focus.redactor', $.proxy(this.opts.focusCallback, this));\n                    }\n\n                    var clickedElement;\n                    $(document).on('mousedown', function(e) { clickedElement = e.target; });\n\n                    // blur\n                    this.$editor.on('blur.redactor', $.proxy(function(e)\n                    {\n                        if (this.rtePaste) return;\n                        if (!this.build.isBlured(clickedElement)) return;\n\n                        this.utils.disableSelectAll();\n                        if ($.isFunction(this.opts.blurCallback)) this.core.setCallback('blur', e);\n\n                    }, this));\n                },\n                isBlured: function(clickedElement)\n                {\n                    var $el = $(clickedElement);\n\n                    return (!$el.hasClass('redactor-toolbar, redactor-dropdown') && !$el.is('#redactor-modal') && $el.parents('.redactor-toolbar, .redactor-dropdown, #redactor-modal').length === 0);\n                },\n                setHelpers: function()\n                {\n                    // autosave\n                    this.autosave.enable();\n\n                    // placeholder\n                    this.placeholder.enable();\n\n                    // focus\n                    if (this.opts.focus) setTimeout(this.focus.setStart, 100);\n                    if (this.opts.focusEnd) setTimeout(this.focus.setEnd, 100);\n\n                },\n                plugins: function()\n                {\n                    if (!this.opts.plugins) return;\n                    if (!RedactorPlugins) return;\n\n                    $.each(this.opts.plugins, $.proxy(function(i, s)\n                    {\n                        if (typeof RedactorPlugins[s] === 'undefined') return;\n\n                        if ($.inArray(s, $.Redactor.modules) !== -1)\n                        {\n                            $.error('Plugin name \"' + s + '\" matches the name of the Redactor\\'s module.');\n                            return;\n                        }\n\n                        if (!$.isFunction(RedactorPlugins[s])) return;\n\n                        this[s] = RedactorPlugins[s]();\n\n                        // get methods\n                        var methods = this.getModuleMethods(this[s]);\n                        var len = methods.length;\n\n                        // bind methods\n                        for (var z = 0; z < len; z++)\n                        {\n                            this[s][methods[z]] = this[s][methods[z]].bind(this);\n                        }\n\n                        if ($.isFunction(this[s].init)) this[s].init();\n\n\n                    }, this));\n\n                },\n                disableMozillaEditing: function()\n                {\n                    if (!this.utils.browser('mozilla')) return;\n\n                    // FF fix\n                    try {\n                        document.execCommand('enableObjectResizing', false, false);\n                        document.execCommand('enableInlineTableEditing', false, false);\n                    } catch (e) {}\n                }\n            };\n        },\n        button: function()\n        {\n            return {\n                build: function(btnName, btnObject)\n                {\n                    var $button = $('<a href=\"#\" class=\"re-icon re-' + btnName + '\" rel=\"' + btnName + '\" />').attr('tabindex', '-1');\n\n                    // click\n                    if (btnObject.func || btnObject.command || btnObject.dropdown)\n                    {\n                        this.button.setEvent($button, btnName, btnObject);\n                    }\n\n                    // dropdown\n                    if (btnObject.dropdown)\n                    {\n                        var $dropdown = $('<div class=\"redactor-dropdown redactor-dropdown-' +  + this.uuid + ' redactor-dropdown-box-' + btnName + '\" style=\"display: none;\">');\n                        $button.data('dropdown', $dropdown);\n                        this.dropdown.build(btnName, $dropdown, btnObject.dropdown);\n                    }\n\n                    // tooltip\n                    if (this.utils.isDesktop())\n                    {\n                        this.button.createTooltip($button, btnName, btnObject.title);\n                    }\n\n                    return $button;\n                },\n                setEvent: function($button, btnName, btnObject)\n                {\n                    $button.on('touchstart click', $.proxy(function(e)\n                    {\n                        if ($button.hasClass('redactor-button-disabled')) return false;\n\n                        var type = 'func';\n                        var callback = btnObject.func;\n\n                        if (btnObject.command)\n                        {\n                            type = 'command';\n                            callback = btnObject.command;\n                        }\n                        else if (btnObject.dropdown)\n                        {\n                            type = 'dropdown';\n                            callback = false;\n                        }\n\n                        this.button.onClick(e, btnName, type, callback);\n\n                    }, this));\n                },\n                createTooltip: function($button, name, title)\n                {\n                    var $tooltip = $('<span>').addClass('redactor-toolbar-tooltip redactor-toolbar-tooltip-' + name).hide().html(title);\n                    $tooltip.appendTo('body');\n\n                    $button.on('mouseover', function()\n                    {\n                        if ($(this).hasClass('redactor-button-disabled')) return;\n\n                        var pos = $button.offset();\n\n                        $tooltip.show();\n                        $tooltip.css({\n                            top: (pos.top + $button.innerHeight()) + 'px',\n                            left: (pos.left + $button.innerWidth()/2 - $tooltip.innerWidth()/2) + 'px'\n                        });\n                    });\n\n                    $button.on('mouseout', function()\n                    {\n                        $tooltip.hide();\n                    });\n\n                },\n                onClick: function(e, btnName, type, callback)\n                {\n                    this.button.caretOffset = this.caret.getOffset();\n\n                    e.preventDefault();\n\n                    if (this.utils.browser('msie')) e.returnValue = false;\n\n                    if (type == 'command') this.inline.format(callback);\n                    else if (type == 'dropdown') this.dropdown.show(e, btnName);\n                    else this.button.onClickCallback(e, callback, btnName);\n                },\n                onClickCallback: function(e, callback, btnName)\n                {\n                    var func;\n\n                    if ($.isFunction(callback)) callback.call(this, btnName);\n                    else if (callback.search(/\\./) != '-1')\n                    {\n                        func = callback.split('.');\n                        if (typeof this[func[0]] == 'undefined') return;\n\n                        this[func[0]][func[1]](btnName);\n                    }\n                    else this[callback](btnName);\n\n                    this.observe.buttons(e, btnName);\n                },\n                get: function(key)\n                {\n                    return this.$toolbar.find('a.re-' + key);\n                },\n                setActive: function(key)\n                {\n                    this.button.get(key).addClass('redactor-act');\n                },\n                setInactive: function(key)\n                {\n                    this.button.get(key).removeClass('redactor-act');\n                },\n                setInactiveAll: function(key)\n                {\n                    if (typeof key === 'undefined')\n                    {\n                        this.$toolbar.find('a.re-icon').removeClass('redactor-act');\n                    }\n                    else\n                    {\n                        this.$toolbar.find('a.re-icon').not('.re-' + key).removeClass('redactor-act');\n                    }\n                },\n                setActiveInVisual: function()\n                {\n                    this.$toolbar.find('a.re-icon').not('a.re-html').removeClass('redactor-button-disabled');\n                },\n                setInactiveInCode: function()\n                {\n                    this.$toolbar.find('a.re-icon').not('a.re-html').addClass('redactor-button-disabled');\n                },\n                changeIcon: function(key, classname)\n                {\n                    this.button.get(key).addClass('re-' + classname);\n                },\n                removeIcon: function(key, classname)\n                {\n                    this.button.get(key).removeClass('re-' + classname);\n                },\n                setAwesome: function(key, name)\n                {\n                    var $button = this.button.get(key);\n                    $button.removeClass('redactor-btn-image').addClass('fa-redactor-btn');\n                    $button.html('<i class=\"fa ' + name + '\"></i>');\n                },\n                addCallback: function($btn, callback)\n                {\n                    var type = (callback == 'dropdown') ? 'dropdown' : 'func';\n                    var key = $btn.attr('rel');\n                    $btn.on('touchstart click', $.proxy(function(e)\n                    {\n                        if ($btn.hasClass('redactor-button-disabled')) return false;\n                        this.button.onClick(e, key, type, callback);\n\n                    }, this));\n                },\n                addDropdown: function($btn, dropdown)\n                {\n                    var key = $btn.attr('rel');\n                    this.button.addCallback($btn, 'dropdown');\n\n                    var $dropdown = $('<div class=\"redactor-dropdown redactor-dropdown-' +  + this.uuid + ' redactor-dropdown-box-' + key + '\" style=\"display: none;\">');\n                    $btn.data('dropdown', $dropdown);\n\n                    // build dropdown\n                    if (dropdown) this.dropdown.build(key, $dropdown, dropdown);\n\n                    return $dropdown;\n                },\n                add: function(key, title)\n                {\n                    if (!this.opts.toolbar) return;\n\n                    var btn = this.button.build(key, { title: title });\n                    btn.addClass('redactor-btn-image');\n\n                    this.$toolbar.append($('<li>').append(btn));\n\n                    return btn;\n                },\n                addFirst: function(key, title)\n                {\n                    if (!this.opts.toolbar) return;\n\n                    var btn = this.button.build(key, { title: title });\n                    btn.addClass('redactor-btn-image');\n                    this.$toolbar.prepend($('<li>').append(btn));\n\n                    return btn;\n                },\n                addAfter: function(afterkey, key, title)\n                {\n                    if (!this.opts.toolbar) return;\n\n                    var btn = this.button.build(key, { title: title });\n                    btn.addClass('redactor-btn-image');\n                    var $btn = this.button.get(afterkey);\n\n                    if ($btn.length !== 0) $btn.parent().after($('<li>').append(btn));\n                    else this.$toolbar.append($('<li>').append(btn));\n\n                    return btn;\n                },\n                addBefore: function(beforekey, key, title)\n                {\n                    if (!this.opts.toolbar) return;\n\n                    var btn = this.button.build(key, { title: title });\n                    btn.addClass('redactor-btn-image');\n                    var $btn = this.button.get(beforekey);\n\n                    if ($btn.length !== 0) $btn.parent().before($('<li>').append(btn));\n                    else this.$toolbar.append($('<li>').append(btn));\n\n                    return btn;\n                },\n                remove: function(key)\n                {\n                    this.button.get(key).remove();\n                }\n            };\n        },\n        caret: function()\n        {\n            return {\n                setStart: function(node)\n                {\n                    // inline tag\n                    if (!this.utils.isBlock(node))\n                    {\n                        var space = this.utils.createSpaceElement();\n\n                        $(node).prepend(space);\n                        this.caret.setEnd(space);\n                    }\n                    else\n                    {\n                        this.caret.set(node, 0, node, 0);\n                    }\n                },\n                setEnd: function(node)\n                {\n                    this.caret.set(node, 1, node, 1);\n                },\n                set: function(orgn, orgo, focn, foco)\n                {\n                    // focus\n                    // disabled in 10.0.7\n                    // if (!this.utils.browser('msie')) this.$editor.focus();\n\n                    orgn = orgn[0] || orgn;\n                    focn = focn[0] || focn;\n\n                    if (this.utils.isBlockTag(orgn.tagName) && orgn.innerHTML === '')\n                    {\n                        orgn.innerHTML = this.opts.invisibleSpace;\n                    }\n\n                    if (orgn.tagName == 'BR' && this.opts.linebreaks === false)\n                    {\n                        var parent = $(this.opts.emptyHtml)[0];\n                        $(orgn).replaceWith(parent);\n                        orgn = parent;\n                        focn = orgn;\n                    }\n\n                    this.selection.get();\n\n                    try\n                    {\n                        this.range.setStart(orgn, orgo);\n                        this.range.setEnd(focn, foco);\n                    }\n                    catch (e) {}\n\n                    this.selection.addRange();\n                },\n                setAfter: function(node)\n                {\n                    try\n                    {\n                        var tag = $(node)[0].tagName;\n\n                        // inline tag\n                        if (tag != 'BR' && !this.utils.isBlock(node))\n                        {\n                            var space = this.utils.createSpaceElement();\n\n                            $(node).after(space);\n                            this.caret.setEnd(space);\n                        }\n                        else\n                        {\n                            if (tag != 'BR' && this.utils.browser('msie'))\n                            {\n                                this.caret.setStart($(node).next());\n                            }\n                            else\n                            {\n                                this.caret.setAfterOrBefore(node, 'after');\n                            }\n                        }\n                    }\n                    catch (e)\n                    {\n                        var space = this.utils.createSpaceElement();\n                        $(node).after(space);\n                        this.caret.setEnd(space);\n                    }\n                },\n                setBefore: function(node)\n                {\n                    // block tag\n                    if (this.utils.isBlock(node))\n                    {\n                        this.caret.setEnd($(node).prev());\n                    }\n                    else\n                    {\n                        this.caret.setAfterOrBefore(node, 'before');\n                    }\n                },\n                setAfterOrBefore: function(node, type)\n                {\n                    // focus\n                    if (!this.utils.browser('msie')) this.$editor.focus();\n\n                    node = node[0] || node;\n\n                    this.selection.get();\n\n                    if (type == 'after')\n                    {\n                        try {\n\n                            this.range.setStartAfter(node);\n                            this.range.setEndAfter(node);\n                        }\n                        catch (e) {}\n                    }\n                    else\n                    {\n                        try {\n                            this.range.setStartBefore(node);\n                            this.range.setEndBefore(node);\n                        }\n                        catch (e) {}\n                    }\n\n\n                    this.range.collapse(false);\n                    this.selection.addRange();\n                },\n                getOffsetOfElement: function(node)\n                {\n                    node = node[0] || node;\n\n                    this.selection.get();\n\n                    var cloned = this.range.cloneRange();\n                    cloned.selectNodeContents(node);\n                    cloned.setEnd(this.range.endContainer, this.range.endOffset);\n\n                    return $.trim(cloned.toString()).length;\n                },\n                getOffset: function()\n                {\n                    var offset = 0;\n                    var sel = window.getSelection();\n\n                    if (sel.rangeCount > 0)\n                    {\n                        var range = window.getSelection().getRangeAt(0);\n                        var caretRange = range.cloneRange();\n                        caretRange.selectNodeContents(this.$editor[0]);\n                        caretRange.setEnd(range.endContainer, range.endOffset);\n                        offset = caretRange.toString().length;\n                    }\n\n                    return offset;\n                },\n                setOffset: function(start, end)\n                {\n                    if (typeof end == 'undefined') end = start;\n                    if (!this.focus.isFocused()) this.focus.setStart();\n\n                    var sel = this.selection.get();\n                    var node, offset = 0;\n                    var walker = document.createTreeWalker(this.$editor[0], NodeFilter.SHOW_TEXT, null, null);\n\n                    while (node = walker.nextNode())\n                    {\n                        offset += node.nodeValue.length;\n                        if (offset > start)\n                        {\n                            this.range.setStart(node, node.nodeValue.length + start - offset);\n                            start = Infinity;\n                        }\n\n                        if (offset >= end)\n                        {\n                            this.range.setEnd(node, node.nodeValue.length + end - offset);\n                            break;\n                        }\n                    }\n\n                    this.range.collapse(false);\n                    this.selection.addRange();\n                },\n                // deprecated\n                setToPoint: function(start, end)\n                {\n                    this.caret.setOffset(start, end);\n                },\n                getCoords: function()\n                {\n                    return this.caret.getOffset();\n                }\n            };\n        },\n        clean: function()\n        {\n            return {\n                onSet: function(html)\n                {\n                    html = this.clean.savePreCode(html);\n\n                    // convert script tag\n                    html = html.replace(/<script(.*?[^>]?)>([\\w\\W]*?)<\\/script>/gi, '<pre class=\"redactor-script-tag\" style=\"display: none;\" $1>$2</pre>');\n\n                    // replace dollar sign to entity\n                    html = html.replace(/\\$/g, '&#36;');\n\n                    // replace special characters in links\n                    html = html.replace(/<a href=\"(.*?[^>]?)®(.*?[^>]?)\">/gi, '<a href=\"$1&reg$2\">');\n\n                    if (this.opts.replaceDivs) html = this.clean.replaceDivs(html);\n                    if (this.opts.linebreaks)  html = this.clean.replaceParagraphsToBr(html);\n\n                    // save form tag\n                    html = this.clean.saveFormTags(html);\n\n                    // convert font tag to span\n                    var $div = $('<div>');\n                    $div.html(html);\n                    var fonts = $div.find('font[style]');\n                    if (fonts.length !== 0)\n                    {\n                        fonts.replaceWith(function()\n                        {\n                            var $el = $(this);\n                            var $span = $('<span>').attr('style', $el.attr('style'));\n                            return $span.append($el.contents());\n                        });\n\n                        html = $div.html();\n                    }\n                    $div.remove();\n\n                    // remove font tag\n                    html = html.replace(/<font(.*?[^<])>/gi, '');\n                    html = html.replace(/<\\/font>/gi, '');\n\n                    // tidy html\n                    html = this.tidy.load(html);\n\n                    // paragraphize\n                    if (this.opts.paragraphize) html = this.paragraphize.load(html);\n\n                    // verified\n                    html = this.clean.setVerified(html);\n\n                    // convert inline tags\n                    html = this.clean.convertInline(html);\n\n                    return html;\n                },\n                onSync: function(html)\n                {\n                    // remove spaces\n                    html = html.replace(/[\\u200B-\\u200D\\uFEFF]/g, '');\n                    html = html.replace(/&#x200b;/gi, '');\n\n                    if (this.opts.cleanSpaces)\n                    {\n                        html = html.replace(/&nbsp;/gi, ' ');\n                    }\n\n                    if (html.search(/^<p>(||\\s||<br\\s?\\/?>||&nbsp;)<\\/p>$/i) != -1)\n                    {\n                        return '';\n                    }\n\n                    // reconvert script tag\n                    html = html.replace(/<pre class=\"redactor-script-tag\" style=\"display: none;\"(.*?[^>]?)>([\\w\\W]*?)<\\/pre>/gi, '<script$1>$2</script>');\n\n                    // restore form tag\n                    html = this.clean.restoreFormTags(html);\n\n                    var chars = {\n                        '\\u2122': '&trade;',\n                        '\\u00a9': '&copy;',\n                        '\\u2026': '&hellip;',\n                        '\\u2014': '&mdash;',\n                        '\\u2010': '&dash;'\n                    };\n                    // replace special characters\n                    $.each(chars, function(i,s)\n                    {\n                        html = html.replace(new RegExp(i, 'g'), s);\n                    });\n\n                    // remove br in the of li\n                    html = html.replace(new RegExp('<br\\\\s?/?></li>', 'gi'), '</li>');\n                    html = html.replace(new RegExp('</li><br\\\\s?/?>', 'gi'), '</li>');\n                    // remove verified\n                    html = html.replace(new RegExp('<div(.*?[^>]) data-tagblock=\"redactor\"(.*?[^>])>', 'gi'), '<div$1$2>');\n                    html = html.replace(new RegExp('<(.*?) data-verified=\"redactor\"(.*?[^>])>', 'gi'), '<$1$2>');\n                    html = html.replace(new RegExp('<span(.*?[^>])\\srel=\"(.*?[^>])\"(.*?[^>])>', 'gi'), '<span$1$3>');\n                    html = html.replace(new RegExp('<img(.*?[^>])\\srel=\"(.*?[^>])\"(.*?[^>])>', 'gi'), '<img$1$3>');\n                    html = html.replace(new RegExp('<img(.*?[^>])\\sstyle=\"\" (.*?[^>])>', 'gi'), '<img$1 $2>');\n                    html = html.replace(new RegExp('<img(.*?[^>])\\sstyle (.*?[^>])>', 'gi'), '<img$1 $2>');\n                    html = html.replace(new RegExp('<span class=\"redactor-invisible-space\">(.*?)</span>', 'gi'), '$1');\n                    html = html.replace(/ data-save-url=\"(.*?[^>])\"/gi, '');\n\n                    // remove image resize\n                    html = html.replace(/<span(.*?)id=\"redactor-image-box\"(.*?[^>])>([\\w\\W]*?)<img(.*?)><\\/span>/gi, '$3<img$4>');\n                    html = html.replace(/<span(.*?)id=\"redactor-image-resizer\"(.*?[^>])>(.*?)<\\/span>/gi, '');\n                    html = html.replace(/<span(.*?)id=\"redactor-image-editter\"(.*?[^>])>(.*?)<\\/span>/gi, '');\n\n                    // remove font tag\n                    html = html.replace(/<font(.*?[^<])>/gi, '');\n                    html = html.replace(/<\\/font>/gi, '');\n\n                    // tidy html\n                    html = this.tidy.load(html);\n\n                    // link nofollow\n                    if (this.opts.linkNofollow)\n                    {\n                        html = html.replace(/<a(.*?)rel=\"nofollow\"(.*?[^>])>/gi, '<a$1$2>');\n                        html = html.replace(/<a(.*?[^>])>/gi, '<a$1 rel=\"nofollow\">');\n                    }\n\n                    // reconvert inline\n                    html = html.replace(/\\sdata-redactor-(tag|class|style)=\"(.*?[^>])\"/gi, '');\n                    html = html.replace(new RegExp('<(.*?) data-verified=\"redactor\"(.*?[^>])>', 'gi'), '<$1$2>');\n                    html = html.replace(new RegExp('<(.*?) data-verified=\"redactor\">', 'gi'), '<$1>');\n\n                    return html;\n                },\n                onPaste: function(html, setMode)\n                {\n                    html = $.trim(html);\n\n                    html = html.replace(/\\$/g, '&#36;');\n\n                    // convert dirty spaces\n                    html = html.replace(/<span class=\"s1\">/gi, '<span>');\n                    html = html.replace(/<span class=\"Apple-converted-space\">&nbsp;<\\/span>/gi, ' ');\n                    html = html.replace(/<span class=\"Apple-tab-span\"[^>]*>\\t<\\/span>/gi, '\\t');\n                    html = html.replace(/<span[^>]*>(\\s|&nbsp;)<\\/span>/gi, ' ');\n\n                    if (this.opts.pastePlainText)\n                    {\n                        return this.clean.getPlainText(html);\n                    }\n\n                    if (!this.utils.isSelectAll() && typeof setMode == 'undefined')\n                    {\n                        if (this.utils.isCurrentOrParent(['FIGCAPTION', 'A']))\n                        {\n                            return this.clean.getPlainText(html, false);\n                        }\n\n                        if (this.utils.isCurrentOrParent('PRE'))\n                        {\n                            html = html.replace(/”/g, '\"');\n                            html = html.replace(/“/g, '\"');\n                            html = html.replace(/‘/g, '\\'');\n                            html = html.replace(/’/g, '\\'');\n\n                            return this.clean.getPreCode(html);\n                        }\n\n                        if (this.utils.isCurrentOrParent(['BLOCKQUOTE', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6']))\n                        {\n                            html = this.clean.getOnlyImages(html);\n\n                            if (!this.utils.browser('msie'))\n                            {\n                                var block = this.selection.getBlock();\n                                if (block && block.tagName == 'P')\n                                {\n                                    html = html.replace(/<img(.*?)>/gi, '<p><img$1></p>');\n                                }\n                            }\n\n                            return html;\n                        }\n\n                        if (this.utils.isCurrentOrParent(['TD']))\n                        {\n                            html = this.clean.onPasteTidy(html, 'td');\n\n                            if (this.opts.linebreaks) html = this.clean.replaceParagraphsToBr(html);\n\n                            html = this.clean.replaceDivsToBr(html);\n\n                            return html;\n                        }\n\n\n                        if (this.utils.isCurrentOrParent(['LI']))\n                        {\n                            return this.clean.onPasteTidy(html, 'li');\n                        }\n                    }\n\n\n                    html = this.clean.isSingleLine(html, setMode);\n\n                    if (!this.clean.singleLine)\n                    {\n                        if (this.opts.linebreaks)  html = this.clean.replaceParagraphsToBr(html);\n                        if (this.opts.replaceDivs) html = this.clean.replaceDivs(html);\n\n                        html = this.clean.saveFormTags(html);\n                    }\n\n\n                    html = this.clean.onPasteWord(html);\n                    html = this.clean.onPasteExtra(html);\n\n                    html = this.clean.onPasteTidy(html, 'all');\n\n\n                    // paragraphize\n                    if (!this.clean.singleLine && this.opts.paragraphize)\n                    {\n                        html = this.paragraphize.load(html);\n                    }\n\n                    html = this.clean.removeDirtyStyles(html);\n                    html = this.clean.onPasteRemoveSpans(html);\n                    html = this.clean.onPasteRemoveEmpty(html);\n\n\n                    html = this.clean.convertInline(html);\n\n                    return html;\n                },\n                onPasteWord: function(html)\n                {\n                    // comments\n                    html = html.replace(/<!--[\\s\\S]*?-->/gi, '');\n\n                    // style\n                    html = html.replace(/<style[^>]*>[\\s\\S]*?<\\/style>/gi, '');\n\n                    if (/(class=\\\"?Mso|style=\\\"[^\\\"]*\\bmso\\-|w:WordDocument)/.test(html))\n                    {\n                        html = this.clean.onPasteIeFixLinks(html);\n\n                        // shapes\n                        html = html.replace(/<img(.*?)v:shapes=(.*?)>/gi, '');\n                        html = html.replace(/src=\"file\\:\\/\\/(.*?)\"/, 'src=\"\"');\n\n                        // list\n                        html = html.replace(/<p(.*?)class=\"MsoListParagraphCxSpFirst\"([\\w\\W]*?)<\\/p>/gi, '<ul><li$2</li>');\n                        html = html.replace(/<p(.*?)class=\"MsoListParagraphCxSpMiddle\"([\\w\\W]*?)<\\/p>/gi, '<li$2</li>');\n                        html = html.replace(/<p(.*?)class=\"MsoListParagraphCxSpLast\"([\\w\\W]*?)<\\/p>/gi, '<li$2</li></ul>');\n                        // one line\n                        html = html.replace(/<p(.*?)class=\"MsoListParagraph\"([\\w\\W]*?)<\\/p>/gi, '<ul><li$2</li></ul>');\n                        // remove ms word's bullet\n                        html = html.replace(/·/g, '');\n                        html = html.replace(/<p class=\"Mso(.*?)\"/gi, '<p');\n\n                        // classes\n                        html = html.replace(/ class=\\\"(mso[^\\\"]*)\\\"/gi, \"\");\n                        html = html.replace(/ class=(mso\\w+)/gi, \"\");\n\n                        // remove ms word tags\n                        html = html.replace(/<o:p(.*?)>([\\w\\W]*?)<\\/o:p>/gi, '$2');\n\n                        // ms word break lines\n                        html = html.replace(/\\n/g, ' ');\n\n                        // ms word lists break lines\n                        html = html.replace(/<p>\\n?<li>/gi, '<li>');\n                    }\n\n                    // remove nbsp\n                    if (this.opts.cleanSpaces)\n                    {\n                        html = html.replace(/(\\s|&nbsp;)+/g, ' ');\n                    }\n\n                    return html;\n                },\n                onPasteExtra: function(html)\n                {\n                    // remove google docs markers\n                    html = html.replace(/<b\\sid=\"internal-source-marker(.*?)\">([\\w\\W]*?)<\\/b>/gi, \"$2\");\n                    html = html.replace(/<b(.*?)id=\"docs-internal-guid(.*?)\">([\\w\\W]*?)<\\/b>/gi, \"$3\");\n\n                    // google docs styles\n                    html = html.replace(/<span[^>]*(font-style: italic; font-weight: bold|font-weight: bold; font-style: italic)[^>]*>/gi, '<span style=\"font-weight: bold;\"><span style=\"font-style: italic;\">');\n                    html = html.replace(/<span[^>]*font-style: italic[^>]*>/gi, '<span style=\"font-style: italic;\">');\n                    html = html.replace(/<span[^>]*font-weight: bold[^>]*>/gi, '<span style=\"font-weight: bold;\">');\n                    html = html.replace(/<span[^>]*text-decoration: underline[^>]*>/gi, '<span style=\"text-decoration: underline;\">');\n\n                    html = html.replace(/<img>/gi, '');\n                    html = html.replace(/\\n{3,}/gi, '\\n');\n                    html = html.replace(/<font(.*?)>([\\w\\W]*?)<\\/font>/gi, '$2');\n\n                    // remove dirty p\n                    html = html.replace(/<p><p>/gi, '<p>');\n                    html = html.replace(/<\\/p><\\/p>/gi, '</p>');\n                    html = html.replace(/<li>(\\s*|\\t*|\\n*)<p>/gi, '<li>');\n                    html = html.replace(/<\\/p>(\\s*|\\t*|\\n*)<\\/li>/gi, '</li>');\n\n                    // remove space between paragraphs\n                    html = html.replace(/<\\/p>\\s<p/gi, '<\\/p><p');\n\n                    // remove safari local images\n                    html = html.replace(/<img src=\"webkit-fake-url\\:\\/\\/(.*?)\"(.*?)>/gi, '');\n\n                    // bullets\n                    html = html.replace(/<p>•([\\w\\W]*?)<\\/p>/gi, '<li>$1</li>');\n\n                    // FF fix\n                    if (this.utils.browser('mozilla'))\n                    {\n                        html = html.replace(/<br\\s?\\/?>$/gi, '');\n                    }\n\n                    return html;\n                },\n                onPasteTidy: function(html, type)\n                {\n                    // remove all tags except these\n                    var tags = ['span', 'a', 'pre', 'blockquote', 'small', 'em', 'strong', 'code', 'kbd', 'mark', 'address', 'cite', 'var', 'samp', 'dfn', 'sup', 'sub', 'b', 'i', 'u', 'del',\n                                'ol', 'ul', 'li', 'dl', 'dt', 'dd', 'p', 'br', 'video', 'audio', 'iframe', 'embed', 'param', 'object', 'img', 'table',\n                                'td', 'th', 'tr', 'tbody', 'tfoot', 'thead', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'sup', 'sub'];\n                    var tagsEmpty = false;\n                    var attrAllowed =  [\n                            ['a', '*'],\n                            ['img', ['src', 'alt']],\n                            ['span', ['class', 'rel', 'data-verified']],\n                            ['iframe', '*'],\n                            ['video', '*'],\n                            ['audio', '*'],\n                            ['embed', '*'],\n                            ['object', '*'],\n                            ['param', '*'],\n                            ['source', '*']\n                        ];\n\n                    if (type == 'all')\n                    {\n                        tagsEmpty = ['p', 'span', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\n                        attrAllowed =  [\n                            ['table', 'class'],\n                            ['td', ['colspan', 'rowspan']],\n                            ['a', '*'],\n                            ['img', ['src', 'alt', 'data-redactor-inserted-image']],\n                            ['span', ['class', 'rel', 'data-verified']],\n                            ['iframe', '*'],\n                            ['video', '*'],\n                            ['audio', '*'],\n                            ['embed', '*'],\n                            ['object', '*'],\n                            ['param', '*'],\n                            ['source', '*']\n                        ];\n                    }\n                    else if (type == 'td')\n                    {\n                        // remove all tags except these and remove all table tags: tr, td etc\n                        tags = ['ul', 'ol', 'li', 'span', 'a', 'small', 'em', 'strong', 'code', 'kbd', 'mark', 'cite', 'var', 'samp', 'dfn', 'sup', 'sub', 'b', 'i', 'u', 'del',\n                                'ol', 'ul', 'li', 'dl', 'dt', 'dd', 'br', 'iframe', 'video', 'audio', 'embed', 'param', 'object', 'img', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\n\n                    }\n                    else if (type == 'li')\n                    {\n                        // only inline tags and ul, ol, li\n                        tags = ['ul', 'ol', 'li', 'span', 'a', 'small', 'em', 'strong', 'code', 'kbd', 'mark', 'cite', 'var', 'samp', 'dfn', 'sup', 'sub', 'b', 'i', 'u', 'del', 'br',\n                                'iframe', 'video', 'audio', 'embed', 'param', 'object', 'img'];\n                    }\n\n                    var options = {\n                        deniedTags: false,\n                        allowedTags: tags,\n                        removeComments: true,\n                        removePhp: true,\n                        removeAttr: false,\n                        allowedAttr: attrAllowed,\n                        removeEmpty: tagsEmpty\n                    };\n\n                    // denied tags\n                    if (this.opts.deniedTags)\n                    {\n                        options.deniedTags = this.opts.deniedTags;\n                    }\n\n                    // allowed tags\n                    if (this.opts.allowedTags)\n                    {\n                        options.allowedTags = this.opts.allowedTags;\n                    }\n\n                    return this.tidy.load(html, options);\n\n                },\n                onPasteRemoveEmpty: function(html)\n                {\n                    html = html.replace(/<(p|h[1-6])>(|\\s|\\n|\\t|<br\\s?\\/?>)<\\/(p|h[1-6])>/gi, '');\n\n                    // remove br in the end\n                    if (!this.opts.linebreaks) html = html.replace(/<br>$/i, '');\n\n                    return html;\n                },\n                onPasteRemoveSpans: function(html)\n                {\n                    html = html.replace(/<span>(.*?)<\\/span>/gi, '$1');\n                    html = html.replace(/<span[^>]*>\\s|&nbsp;<\\/span>/gi, ' ');\n\n                    return html;\n                },\n                onPasteIeFixLinks: function(html)\n                {\n                    if (!this.utils.browser('msie')) return html;\n\n                    var tmp = $.trim(html);\n                    if (tmp.search(/^<a(.*?)>(.*?)<\\/a>$/i) === 0)\n                    {\n                        html = html.replace(/^<a(.*?)>(.*?)<\\/a>$/i, \"$2\");\n                    }\n\n                    return html;\n                },\n                isSingleLine: function(html, setMode)\n                {\n                    this.clean.singleLine = false;\n\n                    if (!this.utils.isSelectAll() && typeof setMode == 'undefined')\n                    {\n                        var blocks = this.opts.blockLevelElements.join('|').replace('P|', '').replace('DIV|', '');\n\n                        var matchBlocks = html.match(new RegExp('</(' + blocks + ')>', 'gi'));\n                        var matchContainers = html.match(/<\\/(p|div)>/gi);\n\n                        if (!matchBlocks && (matchContainers === null || (matchContainers && matchContainers.length <= 1)))\n                        {\n                            var matchBR = html.match(/<br\\s?\\/?>/gi);\n                            var matchIMG = html.match(/<img(.*?[^>])>/gi);\n                            if (!matchBR && !matchIMG)\n                            {\n                                this.clean.singleLine = true;\n                                html = html.replace(/<\\/?(p|div)(.*?)>/gi, '');\n                            }\n                        }\n                    }\n\n                    return html;\n                },\n                stripTags: function(input, allowed)\n                {\n                    allowed = (((allowed || '') + '').toLowerCase().match(/<[a-z][a-z0-9]*>/g) || []).join('');\n                    var tags = /<\\/?([a-z][a-z0-9]*)\\b[^>]*>/gi;\n\n                    return input.replace(tags, function ($0, $1) {\n                        return allowed.indexOf('<' + $1.toLowerCase() + '>') > -1 ? $0 : '';\n                    });\n                },\n                savePreCode: function(html)\n                {\n                    html = this.clean.savePreFormatting(html);\n                    html = this.clean.saveCodeFormatting(html);\n\n                    return html;\n                },\n                savePreFormatting: function(html)\n                {\n                    var pre = html.match(/<pre(.*?)>([\\w\\W]*?)<\\/pre>/gi);\n                    if (pre !== null)\n                    {\n                        $.each(pre, $.proxy(function(i,s)\n                        {\n                            var arr = s.match(/<pre(.*?)>([\\w\\W]*?)<\\/pre>/i);\n\n                            arr[2] = arr[2].replace(/<br\\s?\\/?>/g, '\\n');\n                            arr[2] = arr[2].replace(/&nbsp;/g, ' ');\n\n                            if (this.opts.preSpaces)\n                            {\n                                arr[2] = arr[2].replace(/\\t/g, Array(this.opts.preSpaces + 1).join(' '));\n                            }\n\n                            arr[2] = this.clean.encodeEntities(arr[2]);\n\n                            // $ fix\n                            arr[2] = arr[2].replace(/\\$/g, '&#36;');\n\n                            html = html.replace(s, '<pre' + arr[1] + '>' + arr[2] + '</pre>');\n\n                        }, this));\n                    }\n\n                    return html;\n                },\n                saveCodeFormatting: function(html)\n                {\n                    var code = html.match(/<code(.*?[^>])>(.*?)<\\/code>/gi);\n                    if (code !== null)\n                    {\n                        $.each(code, $.proxy(function(i,s)\n                        {\n                            var arr = s.match(/<code(.*?[^>])>(.*?)<\\/code>/i);\n\n                            arr[2] = arr[2].replace(/&nbsp;/g, ' ');\n                            arr[2] = this.clean.encodeEntities(arr[2]);\n\n                            // $ fix\n                            arr[2] = arr[2].replace(/\\$/g, '&#36;');\n\n                            html = html.replace(s, '<code' + arr[1] + '>' + arr[2] + '</code>');\n\n                        }, this));\n                    }\n\n                    return html;\n                },\n                getTextFromHtml: function(html)\n                {\n                    html = html.replace(/<br\\s?\\/?>|<\\/H[1-6]>|<\\/p>|<\\/div>|<\\/li>|<\\/td>/gi, '\\n');\n\n                    var tmp = document.createElement('div');\n                    tmp.innerHTML = html;\n                    html = tmp.textContent || tmp.innerText;\n\n                    return $.trim(html);\n                },\n                getPlainText: function(html, paragraphize)\n                {\n                    html = this.clean.getTextFromHtml(html);\n                    html = html.replace(/\\n/g, '<br />');\n\n                    if (this.opts.paragraphize && typeof paragraphize == 'undefined' && !this.utils.browser('mozilla'))\n                    {\n                        html = this.paragraphize.load(html);\n                    }\n\n                    return html;\n                },\n                getPreCode: function(html)\n                {\n                    html = html.replace(/<img(.*?) style=\"(.*?)\"(.*?[^>])>/gi, '<img$1$3>');\n                    html = html.replace(/<img(.*?)>/gi, '&lt;img$1&gt;');\n                    html = this.clean.getTextFromHtml(html);\n\n                    if (this.opts.preSpaces)\n                    {\n                        html = html.replace(/\\t/g, Array(this.opts.preSpaces + 1).join(' '));\n                    }\n\n                    html = this.clean.encodeEntities(html);\n\n                    return html;\n                },\n                getOnlyImages: function(html)\n                {\n                    html = html.replace(/<img(.*?)>/gi, '[img$1]');\n\n                    // remove all tags\n                    html = html.replace(/<([Ss]*?)>/gi, '');\n\n                    html = html.replace(/\\[img(.*?)\\]/gi, '<img$1>');\n\n                    return html;\n                },\n                getOnlyLinksAndImages: function(html)\n                {\n                    html = html.replace(/<a(.*?)href=\"(.*?)\"(.*?)>([\\w\\W]*?)<\\/a>/gi, '[a href=\"$2\"]$4[/a]');\n                    html = html.replace(/<img(.*?)>/gi, '[img$1]');\n\n                    // remove all tags\n                    html = html.replace(/<(.*?)>/gi, '');\n\n                    html = html.replace(/\\[a href=\"(.*?)\"\\]([\\w\\W]*?)\\[\\/a\\]/gi, '<a href=\"$1\">$2</a>');\n                    html = html.replace(/\\[img(.*?)\\]/gi, '<img$1>');\n\n                    return html;\n                },\n                encodeEntities: function(str)\n                {\n                    str = String(str).replace(/&amp;/g, '&').replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\"');\n                    return str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\n                },\n                removeDirtyStyles: function(html)\n                {\n                    if (this.utils.browser('msie')) return html;\n\n                    var div = document.createElement('div');\n                    div.innerHTML = html;\n\n                    this.clean.clearUnverifiedRemove($(div));\n\n                    html = div.innerHTML;\n                    $(div).remove();\n\n                    return html;\n                },\n                clearUnverified: function()\n                {\n                    if (this.utils.browser('msie')) return;\n\n                    this.clean.clearUnverifiedRemove(this.$editor);\n\n                    var headers = this.$editor.find('h1, h2, h3, h4, h5, h6');\n                    headers.find('span').removeAttr('style');\n                    headers.find(this.opts.verifiedTags.join(', ')).removeAttr('style');\n\n                    this.code.sync();\n                },\n                clearUnverifiedRemove: function($editor)\n                {\n                    $editor.find(this.opts.verifiedTags.join(', ')).removeAttr('style');\n                    $editor.find('span').not('[data-verified=\"redactor\"]').removeAttr('style');\n\n                    $editor.find('span[data-verified=\"redactor\"], img[data-verified=\"redactor\"]').each(function(i, s)\n                    {\n                        var $s = $(s);\n                        $s.attr('style', $s.attr('rel'));\n                    });\n\n                },\n                setVerified: function(html)\n                {\n                    if (this.utils.browser('msie')) return html;\n\n                    html = html.replace(new RegExp('<img(.*?[^>])>', 'gi'), '<img$1 data-verified=\"redactor\">');\n                    html = html.replace(new RegExp('<span(.*?[^>])>', 'gi'), '<span$1 data-verified=\"redactor\">');\n\n                    var matches = html.match(new RegExp('<(span|img)(.*?)style=\"(.*?)\"(.*?[^>])>', 'gi'));\n\n                    if (matches)\n                    {\n                        var len = matches.length;\n                        for (var i = 0; i < len; i++)\n                        {\n                            try {\n\n                                var newTag = matches[i].replace(/style=\"(.*?)\"/i, 'style=\"$1\" rel=\"$1\"');\n                                html = html.replace(matches[i], newTag);\n\n                            }\n                            catch (e) {}\n                        }\n                    }\n\n                    return html;\n                },\n                convertInline: function(html)\n                {\n                    var $div = $('<div />').html(html);\n\n                    var tags = this.opts.inlineTags;\n                    tags.push('span');\n\n                    $div.find(tags.join(',')).each(function()\n                    {\n                        var $el = $(this);\n                        var tag = this.tagName.toLowerCase();\n                        $el.attr('data-redactor-tag', tag);\n\n                        if (tag == 'span')\n                        {\n                            if ($el.attr('style')) $el.attr('data-redactor-style', $el.attr('style'));\n                            else if ($el.attr('class')) $el.attr('data-redactor-class', $el.attr('class'));\n                        }\n\n                    });\n\n                    html = $div.html();\n                    $div.remove();\n\n                    return html;\n                },\n                normalizeLists: function()\n                {\n                    this.$editor.find('li').each(function(i,s)\n                    {\n                        var $next = $(s).next();\n                        if ($next.length !== 0 && ($next[0].tagName == 'UL' || $next[0].tagName == 'OL'))\n                        {\n                            $(s).append($next);\n                        }\n\n                    });\n                },\n                removeSpaces: function(html)\n                {\n                    html = html.replace(/\\n/g, '');\n                    html = html.replace(/[\\t]*/g, '');\n                    html = html.replace(/\\n\\s*\\n/g, \"\\n\");\n                    html = html.replace(/^[\\s\\n]*/g, ' ');\n                    html = html.replace(/[\\s\\n]*$/g, ' ');\n                    html = html.replace( />\\s{2,}</g, '> <'); // between inline tags can be only one space\n                    html = html.replace(/\\n\\n/g, \"\\n\");\n                    html = html.replace(/[\\u200B-\\u200D\\uFEFF]/g, '');\n\n                    return html;\n                },\n                replaceDivs: function(html)\n                {\n                    if (this.opts.linebreaks)\n                    {\n                        html = html.replace(/<div><br\\s?\\/?><\\/div>/gi, '<br />');\n                        html = html.replace(/<div(.*?)>([\\w\\W]*?)<\\/div>/gi, '$2<br />');\n                    }\n                    else\n                    {\n                        html = html.replace(/<div(.*?)>([\\w\\W]*?)<\\/div>/gi, '<p$1>$2</p>');\n                    }\n\n                    html = html.replace(/<div(.*?[^>])>/gi, '');\n                    html = html.replace(/<\\/div>/gi, '');\n\n                    return html;\n                },\n                replaceDivsToBr: function(html)\n                {\n                    html = html.replace(/<div\\s(.*?)>/gi, '<p>');\n                    html = html.replace(/<div><br\\s?\\/?><\\/div>/gi, '<br /><br />');\n                    html = html.replace(/<div>([\\w\\W]*?)<\\/div>/gi, '$1<br /><br />');\n\n                    return html;\n                },\n                replaceParagraphsToBr: function(html)\n                {\n                    html = html.replace(/<p\\s(.*?)>/gi, '<p>');\n                    html = html.replace(/<p><br\\s?\\/?><\\/p>/gi, '<br />');\n                    html = html.replace(/<p>([\\w\\W]*?)<\\/p>/gi, '$1<br /><br />');\n                    html = html.replace(/(<br\\s?\\/?>){1,}\\n?<\\/blockquote>/gi, '</blockquote>');\n\n                    return html;\n                },\n                saveFormTags: function(html)\n                {\n                    return html.replace(/<form(.*?)>([\\w\\W]*?)<\\/form>/gi, '<section$1 rel=\"redactor-form-tag\">$2</section>');\n                },\n                restoreFormTags: function(html)\n                {\n                    return html.replace(/<section(.*?) rel=\"redactor-form-tag\"(.*?)>([\\w\\W]*?)<\\/section>/gi, '<form$1$2>$3</form>');\n                }\n            };\n        },\n        code: function()\n        {\n            return {\n                set: function(html)\n                {\n                    html = $.trim(html.toString());\n\n                    // clean\n                    html = this.clean.onSet(html);\n\n                    this.$editor.html(html);\n                    this.code.sync();\n\n                    if (html !== '') this.placeholder.remove();\n\n                    setTimeout($.proxy(this.buffer.add, this), 15);\n                    if (this.start === false) this.observe.load();\n\n                },\n                get: function()\n                {\n                    var code = this.$textarea.val();\n\n                    // indent code\n                    code = this.tabifier.get(code);\n\n                    return code;\n                },\n                sync: function()\n                {\n                    setTimeout($.proxy(this.code.startSync, this), 10);\n                },\n                startSync: function()\n                {\n                    var html = this.$editor.html();\n\n                    // is there a need to synchronize\n                    if (this.code.syncCode && this.code.syncCode == html)\n                    {\n                        // do not sync\n                        return;\n                    }\n\n                    // save code\n                    this.code.syncCode = html;\n\n                    // before clean callback\n                    html = this.core.setCallback('syncBefore', html);\n\n                    // clean\n                    html = this.clean.onSync(html);\n\n                    // set code\n                    this.$textarea.val(html);\n\n                    // after sync callback\n                    this.core.setCallback('sync', html);\n\n                    if (this.start === false)\n                    {\n                        this.core.setCallback('change', html);\n                    }\n\n                    this.start = false;\n\n                    // autosave on change\n                    this.autosave.onChange();\n                },\n                toggle: function()\n                {\n                    if (this.opts.visual)\n                    {\n                        this.code.showCode();\n                    }\n                    else\n                    {\n                        this.code.showVisual();\n                    }\n                },\n                showCode: function()\n                {\n                    this.code.offset = this.caret.getOffset();\n                    var scroll = $(window).scrollTop();\n\n                    var height = this.$editor.innerHeight();\n\n                    this.$editor.hide();\n\n                    var html = this.$textarea.val();\n                    this.modified = this.clean.removeSpaces(html);\n\n                    // indent code\n                    html = this.tabifier.get(html);\n\n                    this.$textarea.val(html).height(height).show().focus();\n                    this.$textarea.on('keydown.redactor-textarea-indenting', this.code.textareaIndenting);\n\n                    $(window).scrollTop(scroll);\n\n                    if (this.$textarea[0].setSelectionRange)\n                    {\n                        this.$textarea[0].setSelectionRange(0, 0);\n                    }\n\n                    this.$textarea[0].scrollTop = 0;\n\n                    this.opts.visual = false;\n\n                    this.button.setInactiveInCode();\n                    this.button.setActive('html');\n                    this.core.setCallback('source', html);\n                },\n                showVisual: function()\n                {\n                    if (this.opts.visual) return;\n\n                    var html = this.$textarea.hide().val();\n\n                    if (this.modified !== this.clean.removeSpaces(html))\n                    {\n                        this.code.set(html);\n                    }\n\n                    this.$editor.show();\n\n                    if (!this.utils.isEmpty(html))\n                    {\n                        this.placeholder.remove();\n                    }\n\n                    this.caret.setOffset(this.code.offset);\n\n                    this.$textarea.off('keydown.redactor-textarea-indenting');\n\n                    this.button.setActiveInVisual();\n                    this.button.setInactive('html');\n\n                    this.observe.load();\n                    this.opts.visual = true;\n                    this.core.setCallback('visual', html);\n                },\n                textareaIndenting: function(e)\n                {\n                    if (e.keyCode !== 9) return true;\n\n                    var $el = this.$textarea;\n                    var start = $el.get(0).selectionStart;\n                    $el.val($el.val().substring(0, start) + \"\\t\" + $el.val().substring($el.get(0).selectionEnd));\n                    $el.get(0).selectionStart = $el.get(0).selectionEnd = start + 1;\n\n                    return false;\n                }\n            };\n        },\n        core: function()\n        {\n            return {\n                getObject: function()\n                {\n                    return $.extend({}, this);\n                },\n                getEditor: function()\n                {\n                    return this.$editor;\n                },\n                getBox: function()\n                {\n                    return this.$box;\n                },\n                getElement: function()\n                {\n                    return this.$element;\n                },\n                getTextarea: function()\n                {\n                    return this.$textarea;\n                },\n                getToolbar: function()\n                {\n                    return (this.$toolbar) ? this.$toolbar : false;\n                },\n                addEvent: function(name)\n                {\n                    this.core.event = name;\n                },\n                getEvent: function()\n                {\n                    return this.core.event;\n                },\n                setCallback: function(type, e, data)\n                {\n                    var callback = this.opts[type + 'Callback'];\n                    if ($.isFunction(callback))\n                    {\n                        return (typeof data == 'undefined') ? callback.call(this, e) : callback.call(this, e, data);\n                    }\n                    else\n                    {\n                        return (typeof data == 'undefined') ? e : data;\n                    }\n                },\n                destroy: function()\n                {\n                    this.core.setCallback('destroy');\n\n                    // off events and remove data\n                    this.$element.off('.redactor').removeData('redactor');\n                    this.$editor.off('.redactor');\n\n                    $(document).off('click.redactor-image-delete.' + this.uuid);\n                    $(document).off('click.redactor-image-resize-hide.' + this.uuid);\n                    $(document).off('touchstart.redactor.' + this.uuid + ' click.redactor.' + this.uuid);\n                    $(\"body\").off('scroll.redactor.' + this.uuid);\n                    $(this.opts.toolbarFixedTarget).off('scroll.redactor.' + this.uuid);\n\n                    // common\n                    this.$editor.removeClass('redactor-editor redactor-linebreaks redactor-placeholder');\n                    this.$editor.removeAttr('contenteditable');\n\n                    var html = this.code.get();\n\n                    // dropdowns off\n                    this.$toolbar.find('a').each(function()\n                    {\n                        var $el = $(this);\n                        if ($el.data('dropdown'))\n                        {\n                            $el.data('dropdown').remove();\n                            $el.data('dropdown', {});\n                        }\n                    });\n\n\n                    if (this.build.isTextarea())\n                    {\n                        this.$box.after(this.$element);\n                        this.$box.remove();\n                        this.$element.val(html).show();\n                    }\n                    else\n                    {\n                        this.$box.after(this.$editor);\n                        this.$box.remove();\n                        this.$element.html(html).show();\n                    }\n\n                    // paste box\n                    if (this.$pasteBox) this.$pasteBox.remove();\n\n                    // modal\n                    if (this.$modalBox) this.$modalBox.remove();\n                    if (this.$modalOverlay) this.$modalOverlay.remove();\n\n                    // buttons tooltip\n                    $('.redactor-toolbar-tooltip').remove();\n\n                    // autosave\n                    clearInterval(this.autosaveInterval);\n\n                }\n            };\n        },\n        dropdown: function()\n        {\n            return {\n                build: function(name, $dropdown, dropdownObject)\n                {\n                    if (name == 'formatting' && this.opts.formattingAdd)\n                    {\n                        $.each(this.opts.formattingAdd, $.proxy(function(i,s)\n                        {\n                            var name = s.tag;\n                            if (typeof s['class'] != 'undefined')\n                            {\n                                name = name + '-' + s['class'];\n                            }\n\n                            s.type = (this.utils.isBlockTag(s.tag)) ? 'block' : 'inline';\n                            var func = (s.type == 'inline') ? 'inline.formatting' : 'block.formatting';\n\n                            if (this.opts.linebreaks && s.type == 'block' && s.tag == 'p') return;\n\n                            this.formatting[name] = {\n                                tag: s.tag,\n                                style: s.style,\n                                'class': s['class'],\n                                attr: s.attr,\n                                data: s.data,\n                                clear: s.clear\n                            };\n\n                            dropdownObject[name] = {\n                                func: func,\n                                title: s.title\n                            };\n\n                        }, this));\n\n                    }\n\n                    $.each(dropdownObject, $.proxy(function(btnName, btnObject)\n                    {\n                        var $item = $('<a href=\"#\" class=\"redactor-dropdown-' + btnName + '\">' + btnObject.title + '</a>');\n                        if (name == 'formatting') $item.addClass('redactor-formatting-' + btnName);\n\n                        $item.on('click', $.proxy(function(e)\n                        {\n                            e.preventDefault();\n\n                            var type = 'func';\n                            var callback = btnObject.func;\n                            if (btnObject.command)\n                            {\n                                type = 'command';\n                                callback = btnObject.command;\n                            }\n                            else if (btnObject.dropdown)\n                            {\n                                type = 'dropdown';\n                                callback = btnObject.dropdown;\n                            }\n\n                            this.button.onClick(e, btnName, type, callback);\n                            this.dropdown.hideAll();\n\n                        }, this));\n\n                        $dropdown.append($item);\n\n                    }, this));\n                },\n                show: function(e, key)\n                {\n                    if (!this.opts.visual)\n                    {\n                        e.preventDefault();\n                        return false;\n                    }\n\n                    var $button = this.button.get(key);\n\n                    // Always re-append it to the end of <body> so it always has the highest sub-z-index.\n                    var $dropdown = $button.data('dropdown').appendTo(document.body);\n\n                    // ios keyboard hide\n                    if (this.utils.isMobile() && !this.utils.browser('msie'))\n                    {\n                        document.activeElement.blur();\n                    }\n\n                    if ($button.hasClass('dropact'))\n                    {\n                        this.dropdown.hideAll();\n                    }\n                    else\n                    {\n                        this.dropdown.hideAll();\n                        this.core.setCallback('dropdownShow', { dropdown: $dropdown, key: key, button: $button });\n\n                        this.button.setActive(key);\n\n                        $button.addClass('dropact');\n\n                        var keyPosition = $button.offset();\n\n                        // fix right placement\n                        var dropdownWidth = $dropdown.width();\n                        if ((keyPosition.left + dropdownWidth) > $(document).width())\n                        {\n                            keyPosition.left = Math.max(0, keyPosition.left - dropdownWidth);\n                        }\n\n                        var left = keyPosition.left + 'px';\n                        if (this.$toolbar.hasClass('toolbar-fixed-box'))\n                        {\n                            var top = this.$toolbar.innerHeight() + this.opts.toolbarFixedTopOffset;\n                            var position = 'fixed';\n                            if (this.opts.toolbarFixedTarget !== document)\n                            {\n                                top = (this.$toolbar.innerHeight() + this.$toolbar.offset().top) + this.opts.toolbarFixedTopOffset;\n                                position = 'absolute';\n                            }\n\n                            $dropdown.css({ position: position, left: left, top: top + 'px' }).show();\n                        }\n                        else\n                        {\n                            var top = ($button.innerHeight() + keyPosition.top) + 'px';\n\n                            $dropdown.css({ position: 'absolute', left: left, top: top }).show();\n                        }\n\n                        this.core.setCallback('dropdownShown', { dropdown: $dropdown, key: key, button: $button });\n                    }\n\n                    $(document).one('click', $.proxy(this.dropdown.hide, this));\n                    this.$editor.one('click', $.proxy(this.dropdown.hide, this));\n\n                    // disable scroll whan dropdown scroll\n                    var $body = $(document.body);\n                    var width = $body.width();\n\n                    $dropdown.on('mouseover', function() {\n\n                        $body.addClass('body-redactor-hidden');\n                        $body.css('margin-right', ($body.width() - width) + 'px');\n\n                     });\n\n                    $dropdown.on('mouseout', function() {\n\n                        $body.removeClass('body-redactor-hidden').css('margin-right', 0);\n\n                    });\n\n\n                    e.stopPropagation();\n                },\n                hideAll: function()\n                {\n                    this.$toolbar.find('a.dropact').removeClass('redactor-act').removeClass('dropact');\n\n                    $(document.body).removeClass('body-redactor-hidden').css('margin-right', 0);\n                    $('.redactor-dropdown-' + this.uuid).hide();\n                    this.core.setCallback('dropdownHide');\n                },\n                hide: function (e)\n                {\n                    var $dropdown = $(e.target);\n                    if (!$dropdown.hasClass('dropact'))\n                    {\n                        $dropdown.removeClass('dropact');\n                        this.dropdown.hideAll();\n                    }\n                }\n            };\n        },\n        file: function()\n        {\n            return {\n                show: function()\n                {\n                    this.modal.load('file', this.lang.get('file'), 700);\n                    this.upload.init('#redactor-modal-file-upload', this.opts.fileUpload, this.file.insert);\n\n                    this.selection.save();\n\n                    this.selection.get();\n                    var text = this.sel.toString();\n\n                    $('#redactor-filename').val(text);\n\n                    this.modal.show();\n                },\n                insert: function(json, direct, e)\n                {\n                    // error callback\n                    if (typeof json.error != 'undefined')\n                    {\n                        this.modal.close();\n                        this.selection.restore();\n                        this.core.setCallback('fileUploadError', json);\n                        return;\n                    }\n\n                    var link;\n                    if (typeof json == 'string')\n                    {\n                        link = json;\n                    }\n                    else\n                    {\n                        var text = $('#redactor-filename').val();\n                        if (typeof text == 'undefined' || text === '') text = json.filename;\n\n                        link = '<a href=\"' + json.filelink + '\" id=\"filelink-marker\">' + text + '</a>';\n                    }\n\n                    if (direct)\n                    {\n                        this.selection.removeMarkers();\n                        var marker = this.selection.getMarker();\n                        this.insert.nodeToCaretPositionFromPoint(e, marker);\n                    }\n                    else\n                    {\n                        this.modal.close();\n                    }\n\n                    this.selection.restore();\n                    this.buffer.set();\n\n                    this.insert.htmlWithoutClean(link);\n\n                    if (typeof json == 'string') return;\n\n                    var linkmarker = $(this.$editor.find('a#filelink-marker'));\n                    if (linkmarker.length !== 0)\n                    {\n                        linkmarker.removeAttr('id').removeAttr('style');\n                    }\n                    else linkmarker = false;\n\n                    this.core.setCallback('fileUpload', linkmarker, json);\n\n                }\n            };\n        },\n        focus: function()\n        {\n            return {\n                setStart: function()\n                {\n                    this.$editor.focus();\n\n                    var first = this.$editor.children().first();\n\n                    if (first.length === 0) return;\n                    if (first[0].length === 0 || first[0].tagName == 'BR' || first[0].nodeType == 3)\n                    {\n                        return;\n                    }\n\n                    if (first[0].tagName == 'UL' || first[0].tagName == 'OL')\n                    {\n                        var child = first.find('li').first();\n                        if (!this.utils.isBlock(child) && child.text() === '')\n                        {\n                            // empty inline tag in li\n                            this.caret.setStart(child);\n                            return;\n                        }\n                    }\n\n                    if (this.opts.linebreaks && !this.utils.isBlockTag(first[0].tagName))\n                    {\n                        this.selection.get();\n                        this.range.setStart(this.$editor[0], 0);\n                        this.range.setEnd(this.$editor[0], 0);\n                        this.selection.addRange();\n\n                        return;\n                    }\n\n                    // if node is tag\n                    this.caret.setStart(first);\n                },\n                setEnd: function()\n                {\n                    if (this.utils.browser('mozilla') || this.utils.browser('msie'))\n                    {\n                        var last = this.$editor.children().last();\n\n                        this.$editor.focus();\n                        this.caret.setEnd(last);\n                    }\n                    else\n                    {\n                        this.selection.get();\n\n                        try {\n                            this.range.selectNodeContents(this.$editor[0]);\n                            this.range.collapse(false);\n\n                            this.selection.addRange();\n                        }\n                        catch (e) {}\n                    }\n\n                },\n                isFocused: function()\n                {\n                    var focusNode = document.getSelection().focusNode;\n                    if (focusNode === null) return false;\n\n                    if (this.opts.linebreaks && $(focusNode.parentNode).hasClass('redactor-linebreaks')) return true;\n                    else if (!this.utils.isRedactorParent(focusNode.parentNode)) return false;\n\n                    return this.$editor.is(':focus');\n                }\n            };\n        },\n        image: function()\n        {\n            return {\n                show: function()\n                {\n                    this.modal.load('image', this.lang.get('image'), 700);\n                    this.upload.init('#redactor-modal-image-droparea', this.opts.imageUpload, this.image.insert);\n\n                    this.selection.save();\n                    this.modal.show();\n\n                },\n                showEdit: function($image)\n                {\n                    var $link = $image.closest('a');\n\n                    this.modal.load('imageEdit', this.lang.get('edit'), 705);\n\n                    this.modal.createCancelButton();\n                    this.image.buttonDelete = this.modal.createDeleteButton(this.lang.get('_delete'));\n                    this.image.buttonSave = this.modal.createActionButton(this.lang.get('save'));\n\n                    this.image.buttonDelete.on('click', $.proxy(function()\n                    {\n                        this.image.remove($image);\n\n                    }, this));\n\n                    this.image.buttonSave.on('click', $.proxy(function()\n                    {\n                        this.image.update($image);\n\n                    }, this));\n\n                    $('#redactor-image-title').val($image.attr('alt'));\n\n                    if ($image.attr('style').indexOf('width: 100%;') >= 0) {\n                        $('#redactor-image-full-screen-width').attr('checked', true);\n                    };\n\n                    if (!this.opts.imageLink) $('.redactor-image-link-option').hide();\n                    else\n                    {\n                        var $redactorImageLink = $('#redactor-image-link');\n\n                        $redactorImageLink.attr('href', $image.attr('src'));\n                        if ($link.length !== 0)\n                        {\n                            $redactorImageLink.val($link.attr('href'));\n                            if ($link.attr('target') == '_blank') $('#redactor-image-link-blank').prop('checked', true);\n                        }\n                    }\n\n                    if (!this.opts.imagePosition) $('.redactor-image-position-option').hide();\n                    else\n                    {\n                        var floatValue = ($image.css('display') == 'block' && $image.css('float') == 'none') ? 'center' : $image.css('float');\n                        $('#redactor-image-align').val(floatValue);\n                    }\n\n                    this.modal.show();\n\n                },\n                setFloating: function($image)\n                {\n                    var floating = $('#redactor-image-align').val();\n\n                    var imageFloat = '';\n                    var imageDisplay = '';\n                    var imageMargin = '';\n\n                    switch (floating)\n                    {\n                        case 'left':\n                            imageFloat = 'left';\n                            imageMargin = '0 ' + this.opts.imageFloatMargin + ' ' + this.opts.imageFloatMargin + ' 0';\n                        break;\n                        case 'right':\n                            imageFloat = 'right';\n                            imageMargin = '0 0 ' + this.opts.imageFloatMargin + ' ' + this.opts.imageFloatMargin;\n                        break;\n                        case 'center':\n                            imageDisplay = 'block';\n                            imageMargin = 'auto';\n                        break;\n                    }\n\n                    $image.css({ 'float': imageFloat, display: imageDisplay, margin: imageMargin });\n                    $image.attr('rel', $image.attr('style'));\n                },\n                update: function($image)\n                {\n                    this.image.hideResize();\n                    this.buffer.set();\n\n                    var $link = $image.closest('a');\n\n                    $image.attr('alt', $('#redactor-image-title').val());\n                    if ($('#redactor-image-full-screen-width').is(':checked')) {\n                        $image.css({\n                            width: '100%',\n                            height: 'auto'\n                        });\n                    } else {\n                        $image.attr('style', $image.attr('style').replace('width: 100%; height: auto;', ''));\n                    }\n\n                    this.image.setFloating($image);\n\n                    // as link\n                    var link = $.trim($('#redactor-image-link').val());\n                    if (link !== '')\n                    {\n                        // test url (add protocol)\n                        var pattern = '((xn--)?[a-z0-9]+(-[a-z0-9]+)*\\\\.)+[a-z]{2,}';\n                        var re = new RegExp('^(http|ftp|https)://' + pattern, 'i');\n                        var re2 = new RegExp('^' + pattern, 'i');\n\n                        if (link.search(re) == -1 && link.search(re2) === 0 && this.opts.linkProtocol)\n                        {\n                            link = this.opts.linkProtocol + '://' + link;\n                        }\n\n                        var target = ($('#redactor-image-link-blank').prop('checked')) ? true : false;\n\n                        if ($link.length === 0)\n                        {\n                            var a = $('<a href=\"' + link + '\">' + this.utils.getOuterHtml($image) + '</a>');\n                            if (target) a.attr('target', '_blank');\n\n                            $image.replaceWith(a);\n                        }\n                        else\n                        {\n                            $link.attr('href', link);\n                            if (target)\n                            {\n                                $link.attr('target', '_blank');\n                            }\n                            else\n                            {\n                                $link.removeAttr('target');\n                            }\n                        }\n                    }\n                    else if ($link.length !== 0)\n                    {\n                        $link.replaceWith(this.utils.getOuterHtml($image));\n\n                    }\n\n                    this.modal.close();\n                    this.observe.images();\n                    this.code.sync();\n\n\n                },\n                setEditable: function($image)\n                {\n                    if (this.opts.imageEditable)\n                    {\n                        $image.on('dragstart', $.proxy(this.image.onDrag, this));\n                    }\n\n                    $image.on('mousedown', $.proxy(this.image.hideResize, this));\n                    $image.on('click.redactor touchstart', $.proxy(function(e)\n                    {\n                        this.observe.image = $image;\n\n                        if (this.$editor.find('#redactor-image-box').length !== 0) return false;\n\n                        this.image.resizer = this.image.loadEditableControls($image);\n\n                        $(document).on('click.redactor-image-resize-hide.' + this.uuid, $.proxy(this.image.hideResize, this));\n                        this.$editor.on('click.redactor-image-resize-hide.' + this.uuid, $.proxy(this.image.hideResize, this));\n\n                        // resize\n                        if (!this.opts.imageResizable) return;\n\n                        this.image.resizer.on('mousedown.redactor touchstart.redactor', $.proxy(function(e)\n                        {\n                            this.image.setResizable(e, $image);\n                        }, this));\n\n\n                    }, this));\n                },\n                setResizable: function(e, $image)\n                {\n                    e.preventDefault();\n\n                    this.image.resizeHandle = {\n                        x : e.pageX,\n                        y : e.pageY,\n                        el : $image,\n                        ratio: $image.width() / $image.height(),\n                        h: $image.height()\n                    };\n\n                    e = e.originalEvent || e;\n\n                    if (e.targetTouches)\n                    {\n                         this.image.resizeHandle.x = e.targetTouches[0].pageX;\n                         this.image.resizeHandle.y = e.targetTouches[0].pageY;\n                    }\n\n                    this.image.startResize();\n\n\n                },\n                startResize: function()\n                {\n                    $(document).on('mousemove.redactor-image-resize touchmove.redactor-image-resize', $.proxy(this.image.moveResize, this));\n                    $(document).on('mouseup.redactor-image-resize touchend.redactor-image-resize', $.proxy(this.image.stopResize, this));\n                },\n                moveResize: function(e)\n                {\n                    e.preventDefault();\n\n                    e = e.originalEvent || e;\n\n                    var height = this.image.resizeHandle.h;\n\n                    if (e.targetTouches) height += (e.targetTouches[0].pageY -  this.image.resizeHandle.y);\n                    else height += (e.pageY -  this.image.resizeHandle.y);\n\n                    var width = Math.round(height * this.image.resizeHandle.ratio);\n\n                    if (height < 50 || width < 100) return;\n\n                    this.image.resizeHandle.el.width(width);\n                    this.image.resizeHandle.el.height(this.image.resizeHandle.el.width()/this.image.resizeHandle.ratio);\n\n                    this.code.sync();\n                },\n                stopResize: function()\n                {\n                    this.handle = false;\n                    $(document).off('.redactor-image-resize');\n\n                    this.image.hideResize();\n                },\n                onDrag: function(e)\n                {\n                    if (this.$editor.find('#redactor-image-box').length !== 0)\n                    {\n                        e.preventDefault();\n                        return false;\n                    }\n\n                    this.$editor.on('drop.redactor-image-inside-drop', $.proxy(function()\n                    {\n                        setTimeout($.proxy(this.image.onDrop, this), 1);\n\n                    }, this));\n                },\n                onDrop: function()\n                {\n                    this.image.fixImageSourceAfterDrop();\n                    this.observe.images();\n                    this.$editor.off('drop.redactor-image-inside-drop');\n                    this.clean.clearUnverified();\n                    this.code.sync();\n                },\n                fixImageSourceAfterDrop: function()\n                {\n                    this.$editor.find('img[data-save-url]').each(function()\n                    {\n                        var $el = $(this);\n                        $el.attr('src', $el.attr('data-save-url'));\n                        $el.removeAttr('data-save-url');\n                    });\n                },\n                hideResize: function(e)\n                {\n                    if (e && $(e.target).closest('#redactor-image-box').length !== 0) return;\n                    if (e && e.target.tagName == 'IMG')\n                    {\n                        var $image = $(e.target);\n                        $image.attr('data-save-url', $image.attr('src'));\n                    }\n\n                    var imageBox = this.$editor.find('#redactor-image-box');\n                    if (imageBox.length === 0) return;\n\n                    if (this.opts.imageEditable)\n                    {\n                        this.image.editter.remove();\n                    }\n\n                    $(this.image.resizer).remove();\n\n                    imageBox.find('img').css({\n                        marginTop: imageBox[0].style.marginTop,\n                        marginBottom: imageBox[0].style.marginBottom,\n                        marginLeft: imageBox[0].style.marginLeft,\n                        marginRight: imageBox[0].style.marginRight\n                    });\n\n                    imageBox.css('margin', '');\n                    imageBox.find('img').css('opacity', '');\n                    imageBox.replaceWith(function()\n                    {\n                        return $(this).contents();\n                    });\n\n                    $(document).off('click.redactor-image-resize-hide.' + this.uuid);\n                    this.$editor.off('click.redactor-image-resize-hide.' + this.uuid);\n\n                    if (typeof this.image.resizeHandle !== 'undefined')\n                    {\n                        this.image.resizeHandle.el.attr('rel', this.image.resizeHandle.el.attr('style'));\n                    }\n\n                    this.code.sync();\n\n                },\n                loadResizableControls: function($image, imageBox)\n                {\n                    if (this.opts.imageResizable && !this.utils.isMobile())\n                    {\n                        var imageResizer = $('<span id=\"redactor-image-resizer\" data-redactor=\"verified\"></span>');\n\n                        if (!this.utils.isDesktop())\n                        {\n                            imageResizer.css({ width: '15px', height: '15px' });\n                        }\n\n                        imageResizer.attr('contenteditable', false);\n                        imageBox.append(imageResizer);\n                        imageBox.append($image);\n\n                        return imageResizer;\n                    }\n                    else\n                    {\n                        imageBox.append($image);\n                        return false;\n                    }\n                },\n                loadEditableControls: function($image)\n                {\n                    var imageBox = $('<span id=\"redactor-image-box\" data-redactor=\"verified\">');\n                    imageBox.css('float', $image.css('float')).attr('contenteditable', false);\n\n                    if ($image[0].style.margin != 'auto')\n                    {\n                        imageBox.css({\n                            marginTop: $image[0].style.marginTop,\n                            marginBottom: $image[0].style.marginBottom,\n                            marginLeft: $image[0].style.marginLeft,\n                            marginRight: $image[0].style.marginRight\n                        });\n\n                        $image.css('margin', '');\n                    }\n                    else\n                    {\n                        imageBox.css({ 'display': 'block', 'margin': 'auto' });\n                    }\n\n                    $image.css('opacity', '.5').after(imageBox);\n\n\n                    if (this.opts.imageEditable)\n                    {\n                        // editter\n                        this.image.editter = $('<span id=\"redactor-image-editter\" data-redactor=\"verified\">' + this.lang.get('edit') + '</span>');\n                        this.image.editter.attr('contenteditable', false);\n                        this.image.editter.on('click', $.proxy(function()\n                        {\n                            this.image.showEdit($image);\n                        }, this));\n\n                        imageBox.append(this.image.editter);\n\n                        // position correction\n                        var editerWidth = this.image.editter.innerWidth();\n                        this.image.editter.css('margin-left', '-' + editerWidth/2 + 'px');\n                    }\n\n                    return this.image.loadResizableControls($image, imageBox);\n\n                },\n                remove: function(image)\n                {\n                    var $image = $(image);\n                    var $link = $image.closest('a');\n                    var $figure = $image.closest('figure');\n                    var $parent = $image.parent();\n                    if ($('#redactor-image-box').length !== 0)\n                    {\n                        $parent = $('#redactor-image-box').parent();\n                    }\n\n                    var $next;\n                    if ($figure.length !== 0)\n                    {\n                        $next = $figure.next();\n                        $figure.remove();\n                    }\n                    else if ($link.length !== 0)\n                    {\n                        $parent = $link.parent();\n                        $link.remove();\n                    }\n                    else\n                    {\n                        $image.remove();\n                    }\n\n                    $('#redactor-image-box').remove();\n\n                    if ($figure.length !== 0)\n                    {\n                        this.caret.setStart($next);\n                    }\n                    else\n                    {\n                        this.caret.setStart($parent);\n                    }\n\n                    // delete callback\n                    this.core.setCallback('imageDelete', $image[0].src, $image);\n\n                    this.modal.close();\n                    this.code.sync();\n                },\n                insert: function(json, direct, e)\n                {\n                    // error callback\n                    if (typeof json.error != 'undefined')\n                    {\n                        this.modal.close();\n                        this.selection.restore();\n                        this.core.setCallback('imageUploadError', json);\n                        return;\n                    }\n\n                    var $img;\n                    if (typeof json == 'string')\n                    {\n                        $img = $(json).attr('data-redactor-inserted-image', 'true');\n                    }\n                    else\n                    {\n                        $img = $('<img>');\n                        $img.attr('src', json.filelink).attr('data-redactor-inserted-image', 'true');\n                    }\n\n\n                    var node = $img;\n                    var isP = this.utils.isCurrentOrParent('P');\n                    if (isP)\n                    {\n                        // will replace\n                        node = $('<blockquote />').append($img);\n                    }\n\n                    if (direct)\n                    {\n                        this.selection.removeMarkers();\n                        var marker = this.selection.getMarker();\n                        this.insert.nodeToCaretPositionFromPoint(e, marker);\n                    }\n                    else\n                    {\n                        this.modal.close();\n                    }\n\n                    this.selection.restore();\n                    this.buffer.set();\n\n                    this.insert.html(this.utils.getOuterHtml(node), false);\n\n                    var $image = this.$editor.find('img[data-redactor-inserted-image=true]').removeAttr('data-redactor-inserted-image');\n\n                    if (isP)\n                    {\n                        $image.parent().contents().unwrap().wrap('<p />');\n                    }\n                    else if (this.opts.linebreaks)\n                    {\n                        $image.before('<br>').after('<br>');\n                    }\n\n                    if (typeof json == 'string') return;\n\n                    this.core.setCallback('imageUpload', $image, json);\n\n                }\n            };\n        },\n        indent: function()\n        {\n            return {\n                increase: function()\n                {\n                    // focus\n                    if (!this.utils.browser('msie')) this.$editor.focus();\n\n                    this.buffer.set();\n                    this.selection.save();\n\n                    var block = this.selection.getBlock();\n\n                    if (block && block.tagName == 'LI')\n                    {\n                        this.indent.increaseLists();\n                    }\n                    else if (block === false && this.opts.linebreaks)\n                    {\n                        this.indent.increaseText();\n                    }\n                    else\n                    {\n                        this.indent.increaseBlocks();\n                    }\n\n                    this.selection.restore();\n                    this.code.sync();\n                },\n                increaseLists: function()\n                {\n                    document.execCommand('indent');\n\n                    this.indent.fixEmptyIndent();\n                    this.clean.normalizeLists();\n                    this.clean.clearUnverified();\n                },\n                increaseBlocks: function()\n                {\n                    $.each(this.selection.getBlocks(), $.proxy(function(i, elem)\n                    {\n                        if (elem.tagName === 'TD' || elem.tagName === 'TH') return;\n\n                        var $el = this.utils.getAlignmentElement(elem);\n\n                        var left = this.utils.normalize($el.css('margin-left')) + this.opts.indentValue;\n                        $el.css('margin-left', left + 'px');\n\n                    }, this));\n                },\n                increaseText: function()\n                {\n                    var wrapper = this.selection.wrap('div');\n                    $(wrapper).attr('data-tagblock', 'redactor');\n                    $(wrapper).css('margin-left', this.opts.indentValue + 'px');\n                },\n                decrease: function()\n                {\n                    this.buffer.set();\n                    this.selection.save();\n\n                    var block = this.selection.getBlock();\n                    if (block && block.tagName == 'LI')\n                    {\n                        this.indent.decreaseLists();\n                    }\n                    else\n                    {\n                        this.indent.decreaseBlocks();\n                    }\n\n                    this.selection.restore();\n                    this.code.sync();\n                },\n                decreaseLists: function ()\n                {\n                    document.execCommand('outdent');\n\n                    var current = this.selection.getCurrent();\n\n                    var $item = $(current).closest('li');\n                    var $parent = $item.parent();\n                    if ($item.length !== 0 && $parent.length !== 0 && $parent[0].tagName == 'LI')\n                    {\n                        $parent.after($item);\n                    }\n\n                    this.indent.fixEmptyIndent();\n\n                    if (!this.opts.linebreaks && $item.length === 0)\n                    {\n                        document.execCommand('formatblock', false, 'p');\n                        this.$editor.find('ul, ol, blockquote, p').each($.proxy(this.utils.removeEmpty, this));\n                    }\n\n                    this.clean.clearUnverified();\n                },\n                decreaseBlocks: function()\n                {\n                    $.each(this.selection.getBlocks(), $.proxy(function(i, elem)\n                    {\n                        var $el = this.utils.getAlignmentElement(elem);\n                        var left = this.utils.normalize($el.css('margin-left')) - this.opts.indentValue;\n\n                        if (left <= 0)\n                        {\n                            if (this.opts.linebreaks && typeof($el.data('tagblock')) !== 'undefined')\n                            {\n                                $el.replaceWith($el.html() + '<br />');\n                            }\n                            else\n                            {\n                                $el.css('margin-left', '');\n                                this.utils.removeEmptyAttr($el, 'style');\n                            }\n                        }\n                        else\n                        {\n                            $el.css('margin-left', left + 'px');\n                        }\n\n                    }, this));\n                },\n                fixEmptyIndent: function()\n                {\n                    var block = this.selection.getBlock();\n\n                    if (this.range.collapsed && block && block.tagName == 'LI' && this.utils.isEmpty($(block).text()))\n                    {\n                        var $block = $(block);\n                        $block.find('span').not('.redactor-selection-marker').contents().unwrap();\n                        $block.append('<br>');\n                    }\n                }\n            };\n        },\n        inline: function()\n        {\n            return {\n                formatting: function(name)\n                {\n                    var type, value;\n\n                    if (typeof this.formatting[name].style != 'undefined') type = 'style';\n                    else if (typeof this.formatting[name]['class'] != 'undefined') type = 'class';\n\n                    if (type) value = this.formatting[name][type];\n\n                    this.inline.format(this.formatting[name].tag, type, value);\n\n                },\n                format: function(tag, type, value)\n                {\n                    // Stop formatting pre and headers\n                    if (this.utils.isCurrentOrParent('PRE') || this.utils.isCurrentOrParentHeader()) return;\n\n                    var tags = ['b', 'bold', 'i', 'italic', 'underline', 'strikethrough', 'deleted', 'superscript', 'subscript'];\n                    var replaced = ['strong', 'strong', 'em', 'em', 'u', 'del', 'del', 'sup', 'sub'];\n\n                    for (var i = 0; i < tags.length; i++)\n                    {\n                        if (tag == tags[i]) tag = replaced[i];\n                    }\n\n                    this.inline.type = type || false;\n                    this.inline.value = value || false;\n\n                    this.buffer.set();\n\n                    if (!this.utils.browser('msie'))\n                    {\n                        this.$editor.focus();\n                    }\n\n                    this.selection.get();\n\n                    if (this.range.collapsed)\n                    {\n                        this.inline.formatCollapsed(tag);\n                    }\n                    else\n                    {\n                        this.inline.formatMultiple(tag);\n                    }\n                },\n                formatCollapsed: function(tag)\n                {\n                    var current = this.selection.getCurrent();\n                    var $parent = $(current).closest(tag + '[data-redactor-tag=' + tag + ']');\n\n                    // inline there is\n                    if ($parent.length !== 0 && (this.inline.type != 'style' && $parent[0].tagName != 'SPAN'))\n                    {\n                        // remove empty\n                        if (this.utils.isEmpty($parent.text()))\n                        {\n                            this.caret.setAfter($parent[0]);\n\n                            $parent.remove();\n                            this.code.sync();\n                        }\n                        else if (this.utils.isEndOfElement($parent))\n                        {\n                            this.caret.setAfter($parent[0]);\n                        }\n\n                        return;\n                    }\n\n                    // create empty inline\n                    var node = $('<' + tag + '>').attr('data-verified', 'redactor').attr('data-redactor-tag', tag);\n                    node.html(this.opts.invisibleSpace);\n\n                    node = this.inline.setFormat(node);\n\n                    var node = this.insert.node(node);\n                    this.caret.setEnd(node);\n\n                    this.code.sync();\n                },\n                formatMultiple: function(tag)\n                {\n                    this.inline.formatConvert(tag);\n\n                    this.selection.save();\n                    document.execCommand('strikethrough');\n\n                    this.$editor.find('strike').each($.proxy(function(i,s)\n                    {\n                        var $el = $(s);\n\n                        this.inline.formatRemoveSameChildren($el, tag);\n\n                        var $span;\n                        if (this.inline.type)\n                        {\n                            $span = $('<span>').attr('data-redactor-tag', tag).attr('data-verified', 'redactor');\n                            $span = this.inline.setFormat($span);\n                        }\n                        else\n                        {\n                            $span = $('<' + tag + '>').attr('data-redactor-tag', tag).attr('data-verified', 'redactor');\n                        }\n\n                        $el.replaceWith($span.html($el.contents()));\n\n                        if (tag == 'span')\n                        {\n                            var $parent = $span.parent();\n                            if ($parent && $parent[0].tagName == 'SPAN' && this.inline.type == 'style')\n                            {\n                                var arr = this.inline.value.split(';');\n\n                                for (var z = 0; z < arr.length; z++)\n                                {\n                                    if (arr[z] === '') return;\n                                    var style = arr[z].split(':');\n                                    $parent.css(style[0], '');\n\n                                    if (this.utils.removeEmptyAttr($parent, 'style'))\n                                    {\n                                        $parent.replaceWith($parent.contents());\n                                    }\n\n                                }\n\n                            }\n                        }\n\n                    }, this));\n\n                    // clear text decoration\n                    if (tag != 'span')\n                    {\n                        this.$editor.find(this.opts.inlineTags.join(', ')).each($.proxy(function(i,s)\n                        {\n                            var $el = $(s);\n                            var property = $el.css('text-decoration');\n                            if (property == 'line-through')\n                            {\n                                $el.css('text-decoration', '');\n                                this.utils.removeEmptyAttr($el, 'style');\n                            }\n                        }, this));\n                    }\n\n                    if (tag != 'del')\n                    {\n                        var _this = this;\n                        this.$editor.find('inline').each(function(i,s)\n                        {\n                            _this.utils.replaceToTag(s, 'del');\n                        });\n                    }\n\n                    this.selection.restore();\n                    this.code.sync();\n\n                },\n                formatRemoveSameChildren: function($el, tag)\n                {\n                    var self = this;\n                    $el.children(tag).each(function()\n                    {\n                        var $child = $(this);\n\n                        if (!$child.hasClass('redactor-selection-marker'))\n                        {\n                            if (self.inline.type == 'style')\n                            {\n                                var arr = self.inline.value.split(';');\n\n                                for (var z = 0; z < arr.length; z++)\n                                {\n                                    if (arr[z] === '') return;\n\n                                    var style = arr[z].split(':');\n                                    $child.css(style[0], '');\n\n                                    if (self.utils.removeEmptyAttr($child , 'style'))\n                                    {\n                                        $child.replaceWith($child.contents());\n                                    }\n\n                                }\n                            }\n                            else\n                            {\n                                $child.contents().unwrap();\n                            }\n                        }\n\n                    });\n                },\n                formatConvert: function(tag)\n                {\n                    this.selection.save();\n\n                    var find = '';\n                    if (this.inline.type == 'class') find = '[data-redactor-class=' + this.inline.value + ']';\n                    else if (this.inline.type == 'style')\n                    {\n                        find = '[data-redactor-style=\"' + this.inline.value + '\"]';\n                    }\n\n                    var self = this;\n                    if (tag != 'del')\n                    {\n                        this.$editor.find('del').each(function(i,s)\n                        {\n                            self.utils.replaceToTag(s, 'inline');\n                        });\n                    }\n\n                    if (tag != 'span')\n                    {\n                        this.$editor.find(tag).each(function()\n                        {\n                            var $el = $(this);\n                            $el.replaceWith($('<strike />').html($el.contents()));\n\n                        });\n                    }\n\n                    this.$editor.find('[data-redactor-tag=\"' + tag + '\"]' + find).each(function()\n                    {\n                        if (find === '' && tag == 'span' && this.tagName.toLowerCase() == tag) return;\n\n                        var $el = $(this);\n                        $el.replaceWith($('<strike />').html($el.contents()));\n\n                    });\n\n                    this.selection.restore();\n                },\n                setFormat: function(node)\n                {\n                    switch (this.inline.type)\n                    {\n                        case 'class':\n\n                            if (node.hasClass(this.inline.value))\n                            {\n                                node.removeClass(this.inline.value);\n                                node.removeAttr('data-redactor-class');\n                            }\n                            else\n                            {\n                                node.addClass(this.inline.value);\n                                node.attr('data-redactor-class', this.inline.value);\n                            }\n\n\n                        break;\n                        case 'style':\n\n                            node[0].style.cssText = this.inline.value;\n                            node.attr('data-redactor-style', this.inline.value);\n\n                        break;\n                    }\n\n                    return node;\n                },\n                removeStyle: function()\n                {\n                    this.buffer.set();\n                    var current = this.selection.getCurrent();\n                    var nodes = this.selection.getInlines();\n\n                    this.selection.save();\n\n                    if (current && current.tagName === 'SPAN')\n                    {\n                        var $s = $(current);\n\n                        $s.removeAttr('style');\n                        if ($s[0].attributes.length === 0)\n                        {\n                            $s.replaceWith($s.contents());\n                        }\n                    }\n\n                    $.each(nodes, $.proxy(function(i,s)\n                    {\n                        var $s = $(s);\n                        if ($.inArray(s.tagName.toLowerCase(), this.opts.inlineTags) != -1 && !$s.hasClass('redactor-selection-marker'))\n                        {\n                            $s.removeAttr('style');\n                            if ($s[0].attributes.length === 0)\n                            {\n                                $s.replaceWith($s.contents());\n                            }\n                        }\n                    }, this));\n\n                    this.selection.restore();\n                    this.code.sync();\n\n                },\n                removeStyleRule: function(name)\n                {\n                    this.buffer.set();\n                    var parent = this.selection.getParent();\n                    var nodes = this.selection.getInlines();\n\n                    this.selection.save();\n\n                    if (parent && parent.tagName === 'SPAN')\n                    {\n                        var $s = $(parent);\n\n                        $s.css(name, '');\n                        this.utils.removeEmptyAttr($s, 'style');\n                        if ($s[0].attributes.length === 0)\n                        {\n                            $s.replaceWith($s.contents());\n                        }\n                    }\n\n                    $.each(nodes, $.proxy(function(i,s)\n                    {\n                        var $s = $(s);\n                        if ($.inArray(s.tagName.toLowerCase(), this.opts.inlineTags) != -1 && !$s.hasClass('redactor-selection-marker'))\n                        {\n                            $s.css(name, '');\n                            this.utils.removeEmptyAttr($s, 'style');\n                            if ($s[0].attributes.length === 0)\n                            {\n                                $s.replaceWith($s.contents());\n                            }\n                        }\n                    }, this));\n\n                    this.selection.restore();\n                    this.code.sync();\n                },\n                removeFormat: function()\n                {\n                    this.buffer.set();\n                    var current = this.selection.getCurrent();\n\n                    this.selection.save();\n\n                    document.execCommand('removeFormat');\n\n                    if (current && current.tagName === 'SPAN')\n                    {\n                        $(current).replaceWith($(current).contents());\n                    }\n\n\n                    $.each(this.selection.getNodes(), $.proxy(function(i,s)\n                    {\n                        var $s = $(s);\n                        if ($.inArray(s.tagName.toLowerCase(), this.opts.inlineTags) != -1 && !$s.hasClass('redactor-selection-marker'))\n                        {\n                            $s.replaceWith($s.contents());\n                        }\n                    }, this));\n\n                    this.selection.restore();\n                    this.code.sync();\n\n                },\n                toggleClass: function(className)\n                {\n                    this.inline.format('span', 'class', className);\n                },\n                toggleStyle: function(value)\n                {\n                    this.inline.format('span', 'style', value);\n                }\n            };\n        },\n        insert: function()\n        {\n            return {\n                set: function(html, clean)\n                {\n                    this.placeholder.remove();\n\n                    html = this.clean.setVerified(html);\n\n                    if (typeof clean == 'undefined')\n                    {\n                        html = this.clean.onPaste(html, false);\n                    }\n\n                    this.$editor.html(html);\n                    this.selection.remove();\n                    this.focus.setEnd();\n                    this.clean.normalizeLists();\n                    this.code.sync();\n                    this.observe.load();\n\n                    if (typeof clean == 'undefined')\n                    {\n                        setTimeout($.proxy(this.clean.clearUnverified, this), 10);\n                    }\n                },\n                text: function(text)\n                {\n                    this.placeholder.remove();\n\n                    text = text.toString();\n                    text = $.trim(text);\n                    text = this.clean.getPlainText(text, false);\n\n                    this.$editor.focus();\n\n                    if (this.utils.browser('msie'))\n                    {\n                        this.insert.htmlIe(text);\n                    }\n                    else\n                    {\n                        this.selection.get();\n\n                        this.range.deleteContents();\n                        var el = document.createElement(\"div\");\n                        el.innerHTML = text;\n                        var frag = document.createDocumentFragment(), node, lastNode;\n                        while ((node = el.firstChild))\n                        {\n                            lastNode = frag.appendChild(node);\n                        }\n\n                        this.range.insertNode(frag);\n\n                        if (lastNode)\n                        {\n                            var range = this.range.cloneRange();\n                            range.setStartAfter(lastNode);\n                            range.collapse(true);\n                            this.sel.removeAllRanges();\n                            this.sel.addRange(range);\n                        }\n                    }\n\n                    this.code.sync();\n                    this.clean.clearUnverified();\n                },\n                htmlWithoutClean: function(html)\n                {\n                    this.insert.html(html, false);\n                },\n                html: function(html, clean)\n                {\n                    this.placeholder.remove();\n\n                    if (typeof clean == 'undefined') clean = true;\n\n                    this.$editor.focus();\n\n                    html = this.clean.setVerified(html);\n\n                    if (clean)\n                    {\n                        html = this.clean.onPaste(html);\n                    }\n\n                    if (this.utils.browser('msie'))\n                    {\n                        this.insert.htmlIe(html);\n                    }\n                    else\n                    {\n                        if (this.clean.singleLine) this.insert.execHtml(html);\n                        else document.execCommand('insertHTML', false, html);\n\n                        this.insert.htmlFixMozilla();\n\n                    }\n\n                    this.clean.normalizeLists();\n\n                    // remove empty paragraphs finaly\n                    if (!this.opts.linebreaks)\n                    {\n                        this.$editor.find('p').each($.proxy(this.utils.removeEmpty, this));\n                    }\n\n                    this.code.sync();\n                    this.observe.load();\n\n                    if (clean)\n                    {\n                        this.clean.clearUnverified();\n                    }\n\n                },\n                htmlFixMozilla: function()\n                {\n                    // FF inserts empty p when content was selected dblclick\n                    if (!this.utils.browser('mozilla')) return;\n\n                    var $next = $(this.selection.getBlock()).next();\n                    if ($next.length > 0 && $next[0].tagName == 'P' && $next.html() === '')\n                    {\n                        $next.remove();\n                    }\n\n                },\n                htmlIe: function(html)\n                {\n                    if (this.utils.isIe11())\n                    {\n                        var parent = this.utils.isCurrentOrParent('P');\n                        var $html = $('<div>').append(html);\n                        var blocksMatch = $html.contents().is('p, :header, dl, ul, ol, div, table, td, blockquote, pre, address, section, header, footer, aside, article');\n\n                        if (parent && blocksMatch) this.insert.ie11FixInserting(parent, html);\n                        else this.insert.ie11PasteFrag(html);\n\n                        return;\n                    }\n\n                    document.selection.createRange().pasteHTML(html);\n\n                },\n                execHtml: function(html)\n                {\n                    html = this.clean.setVerified(html);\n\n                    this.selection.get();\n\n                    this.range.deleteContents();\n\n                    var el = document.createElement('div');\n                    el.innerHTML = html;\n\n                    var frag = document.createDocumentFragment(), node, lastNode;\n                    while ((node = el.firstChild))\n                    {\n                        lastNode = frag.appendChild(node);\n                    }\n\n                    this.range.insertNode(frag);\n\n                    this.range.collapse(true);\n                    this.caret.setAfter(lastNode);\n\n                },\n                node: function(node, deleteContents)\n                {\n                    node = node[0] || node;\n\n                    var html = this.utils.getOuterHtml(node);\n                    html = this.clean.setVerified(html);\n\n                    if (html.match(/</g) !== null)\n                    {\n                        node = $(html)[0];\n                    }\n\n                    this.selection.get();\n\n                    if (deleteContents !== false)\n                    {\n                        this.range.deleteContents();\n                    }\n\n                    this.range.insertNode(node);\n                    this.range.collapse(false);\n                    this.selection.addRange();\n\n                    return node;\n                },\n                nodeToPoint: function(node, x, y)\n                {\n                    node = node[0] || node;\n\n                    this.selection.get();\n\n                    var range;\n                    if (document.caretPositionFromPoint)\n                    {\n                        var pos = document.caretPositionFromPoint(x, y);\n\n                        this.range.setStart(pos.offsetNode, pos.offset);\n                        this.range.collapse(true);\n                        this.range.insertNode(node);\n                    }\n                    else if (document.caretRangeFromPoint)\n                    {\n                        range = document.caretRangeFromPoint(x, y);\n                        range.insertNode(node);\n                    }\n                    else if (typeof document.body.createTextRange != \"undefined\")\n                    {\n                        range = document.body.createTextRange();\n                        range.moveToPoint(x, y);\n                        var endRange = range.duplicate();\n                        endRange.moveToPoint(x, y);\n                        range.setEndPoint(\"EndToEnd\", endRange);\n                        range.select();\n                    }\n                },\n                nodeToCaretPositionFromPoint: function(e, node)\n                {\n                    node = node[0] || node;\n\n                    var range;\n                    var x = e.clientX, y = e.clientY;\n                    if (document.caretPositionFromPoint)\n                    {\n                        var pos = document.caretPositionFromPoint(x, y);\n                        var sel = document.getSelection();\n                        range = sel.getRangeAt(0);\n                        range.setStart(pos.offsetNode, pos.offset);\n                        range.collapse(true);\n                        range.insertNode(node);\n                    }\n                    else if (document.caretRangeFromPoint)\n                    {\n                        range = document.caretRangeFromPoint(x, y);\n                        range.insertNode(node);\n                    }\n                    else if (typeof document.body.createTextRange != \"undefined\")\n                    {\n                        range = document.body.createTextRange();\n                        range.moveToPoint(x, y);\n                        var endRange = range.duplicate();\n                        endRange.moveToPoint(x, y);\n                        range.setEndPoint(\"EndToEnd\", endRange);\n                        range.select();\n                    }\n\n                },\n                ie11FixInserting: function(parent, html)\n                {\n                    var node = document.createElement('span');\n                    node.className = 'redactor-ie-paste';\n                    this.insert.node(node);\n\n                    var parHtml = $(parent).html();\n\n                    parHtml = '<p>' + parHtml.replace(/<span class=\"redactor-ie-paste\"><\\/span>/gi, '</p>' + html + '<p>') + '</p>';\n                    $(parent).replaceWith(parHtml);\n                },\n                ie11PasteFrag: function(html)\n                {\n                    this.selection.get();\n                    this.range.deleteContents();\n\n                    var el = document.createElement(\"div\");\n                    el.innerHTML = html;\n\n                    var frag = document.createDocumentFragment(), node, lastNode;\n                    while ((node = el.firstChild))\n                    {\n                        lastNode = frag.appendChild(node);\n                    }\n\n                    this.range.insertNode(frag);\n                    this.range.collapse(false);\n                    this.selection.addRange();\n                }\n            };\n        },\n        keydown: function()\n        {\n            return {\n                init: function(e)\n                {\n                    if (this.rtePaste) return;\n\n                    var key = e.which;\n                    var arrow = (key >= 37 && key <= 40);\n\n                    this.keydown.ctrl = e.ctrlKey || e.metaKey;\n                    this.keydown.current = this.selection.getCurrent();\n                    this.keydown.parent = this.selection.getParent();\n                    this.keydown.block = this.selection.getBlock();\n\n                    // detect tags\n                    this.keydown.pre = this.utils.isTag(this.keydown.current, 'pre');\n                    this.keydown.blockquote = this.utils.isTag(this.keydown.current, 'blockquote');\n                    this.keydown.figcaption = this.utils.isTag(this.keydown.current, 'figcaption');\n\n                    // shortcuts setup\n                    this.shortcuts.init(e, key);\n\n                    this.keydown.checkEvents(arrow, key);\n                    this.keydown.setupBuffer(e, key);\n                    this.keydown.addArrowsEvent(arrow);\n                    this.keydown.setupSelectAll(e, key);\n\n                    // callback\n                    var keydownStop = this.core.setCallback('keydown', e);\n                    if (keydownStop === false)\n                    {\n                        e.preventDefault();\n                        return false;\n                    }\n\n                    // ie and ff exit from table\n                    if (this.opts.enterKey && (this.utils.browser('msie') || this.utils.browser('mozilla')) && (key === this.keyCode.DOWN || key === this.keyCode.RIGHT))\n                    {\n                        var isEndOfTable = false;\n                        var $table = false;\n                        if (this.keydown.block && this.keydown.block.tagName === 'TD')\n                        {\n                            $table = $(this.keydown.block).closest('table');\n                        }\n\n                        if ($table && $table.find('td').last()[0] === this.keydown.block)\n                        {\n                            isEndOfTable = true;\n                        }\n\n                        if (this.utils.isEndOfElement() && isEndOfTable)\n                        {\n                            var node = $(this.opts.emptyHtml);\n                            $table.after(node);\n                            this.caret.setStart(node);\n                        }\n                    }\n\n                    // down\n                    if (this.opts.enterKey && key === this.keyCode.DOWN)\n                    {\n                        this.keydown.onArrowDown();\n                    }\n\n                    // turn off enter key\n                    if (!this.opts.enterKey && key === this.keyCode.ENTER)\n                    {\n                        e.preventDefault();\n                        // remove selected\n                        if (!this.range.collapsed) this.range.deleteContents();\n                        return;\n                    }\n\n                    // on enter\n                    if (key == this.keyCode.ENTER && !e.shiftKey && !e.ctrlKey && !e.metaKey)\n                    {\n                        var stop = this.core.setCallback('enter', e);\n                        if (stop === false)\n                        {\n                            e.preventDefault();\n                            return false;\n                        }\n\n                        if (this.keydown.blockquote && this.keydown.exitFromBlockquote(e) === true)\n                        {\n                            return false;\n                        }\n\n                        var current, $next;\n                        if (this.keydown.pre)\n                        {\n                            return this.keydown.insertNewLine(e);\n                        }\n                        else if (this.keydown.blockquote || this.keydown.figcaption)\n                        {\n                            current = this.selection.getCurrent();\n                            $next = $(current).next();\n\n                            if ($next.length !== 0 && $next[0].tagName == 'BR')\n                            {\n                                return this.keydown.insertBreakLine(e);\n                            }\n                            else if (this.utils.isEndOfElement() && (current && current != 'SPAN'))\n                            {\n                                return this.keydown.insertDblBreakLine(e);\n                            }\n                            else\n                            {\n                                return this.keydown.insertBreakLine(e);\n                            }\n                        }\n                        else if (this.opts.linebreaks && !this.keydown.block)\n                        {\n                            current = this.selection.getCurrent();\n                            $next = $(this.keydown.current).next();\n\n\n\n                            if ($next.length !== 0 && $next[0].tagName == 'BR')\n                            {\n                                return this.keydown.insertBreakLine(e);\n                            }\n                            else if (current !== false && $(current).hasClass('redactor-invisible-space'))\n                            {\n                                this.caret.setAfter(current);\n                                $(current).contents().unwrap();\n\n                                return this.keydown.insertDblBreakLine(e);\n                            }\n                            else\n                            {\n                                if (this.utils.isEndOfEditor())\n                                {\n                                    return this.keydown.insertDblBreakLine(e);\n                                }\n                                else if ($next.length === 0 && current === false && typeof $next.context != 'undefined')\n                                {\n                                    return this.keydown.insertBreakLine(e);\n                                }\n\n                                return this.keydown.insertBreakLine(e);\n                            }\n                        }\n                        else if (this.opts.linebreaks && this.keydown.block)\n                        {\n                            setTimeout($.proxy(this.keydown.replaceDivToBreakLine, this), 1);\n                        }\n                        // paragraphs\n                        else if (!this.opts.linebreaks && this.keydown.block)\n                        {\n                            if (this.keydown.block.tagName !== 'LI')\n                            {\n                                setTimeout($.proxy(this.keydown.replaceDivToParagraph, this), 1);\n                            }\n                            else\n                            {\n                                current = this.selection.getCurrent();\n                                var $parent = $(current).closest('li');\n                                var $list = $parent.closest('ul,ol');\n\n                                if ($parent.length !== 0 && this.utils.isEmpty($parent.html()) && $list.next().length === 0)\n                                {\n                                    var node = $(this.opts.emptyHtml);\n                                    $list.after(node);\n                                    this.caret.setStart(node);\n\n                                    return false;\n                                }\n                            }\n                        }\n                        else if (!this.opts.linebreaks && !this.keydown.block)\n                        {\n                            return this.keydown.insertParagraph(e);\n                        }\n                    }\n\n                    // Shift+Enter or Ctrl+Enter\n                    if (key === this.keyCode.ENTER && (e.ctrlKey || e.shiftKey))\n                    {\n                        return this.keydown.onShiftEnter(e);\n                    }\n\n\n                    // tab or cmd + [\n                    if (key === this.keyCode.TAB || e.metaKey && key === 221 || e.metaKey && key === 219)\n                    {\n                        return this.keydown.onTab(e, key);\n                    }\n\n                    // image delete and backspace\n                    if (key === this.keyCode.BACKSPACE || key === this.keyCode.DELETE)\n                    {\n                        if (this.utils.browser('mozilla') && this.keydown.current && this.keydown.current.tagName === 'TD')\n                        {\n                            e.preventDefault();\n                            return false;\n                        }\n\n                        var nodes = this.selection.getNodes();\n                        if (nodes)\n                        {\n                            var len = nodes.length;\n                            var last;\n                            for (var i = 0; i < len; i++)\n                            {\n                                var children = $(nodes[i]).children('img');\n                                if (children.length !== 0)\n                                {\n                                    var self = this;\n                                    $.each(children, function(z,s)\n                                    {\n                                        var $s = $(s);\n                                        if ($s.css('float') != 'none') return;\n\n                                        // image delete callback\n                                        self.core.setCallback('imageDelete', s.src, $s);\n                                        last = s;\n                                    });\n                                }\n                                else if (nodes[i].tagName == 'IMG')\n                                {\n                                    if (last != nodes[i])\n                                    {\n                                        // image delete callback\n                                        this.core.setCallback('imageDelete', nodes[i].src, $(nodes[i]));\n                                        last = nodes[i];\n                                    }\n                                }\n                            }\n                        }\n                    }\n\n                    // backspace\n                    if (key === this.keyCode.BACKSPACE)\n                    {\n                        this.keydown.removeInvisibleSpace();\n                        this.keydown.removeEmptyListInTable(e);\n                    }\n\n                    this.code.sync();\n                },\n                checkEvents: function(arrow, key)\n                {\n                    if (!arrow && (this.core.getEvent() == 'click' || this.core.getEvent() == 'arrow'))\n                    {\n                        this.core.addEvent(false);\n\n                        if (this.keydown.checkKeyEvents(key))\n                        {\n                            this.buffer.set();\n                        }\n                    }\n                },\n                checkKeyEvents: function(key)\n                {\n                    var k = this.keyCode;\n                    var keys = [k.BACKSPACE, k.DELETE, k.ENTER, k.SPACE, k.ESC, k.TAB, k.CTRL, k.META, k.ALT, k.SHIFT];\n\n                    return ($.inArray(key, keys) == -1) ? true : false;\n\n                },\n                addArrowsEvent: function(arrow)\n                {\n                    if (!arrow) return;\n\n                    if ((this.core.getEvent() == 'click' || this.core.getEvent() == 'arrow'))\n                    {\n                        this.core.addEvent(false);\n                        return;\n                    }\n\n                    this.core.addEvent('arrow');\n                },\n                setupBuffer: function(e, key)\n                {\n                    if (this.keydown.ctrl && key === 90 && !e.shiftKey && !e.altKey && this.opts.buffer.length) // z key\n                    {\n                        e.preventDefault();\n                        this.buffer.undo();\n                        return;\n                    }\n                    // undo\n                    else if (this.keydown.ctrl && key === 90 && e.shiftKey && !e.altKey && this.opts.rebuffer.length !== 0)\n                    {\n                        e.preventDefault();\n                        this.buffer.redo();\n                        return;\n                    }\n                    else if (!this.keydown.ctrl)\n                    {\n                        if (key == this.keyCode.BACKSPACE || key == this.keyCode.DELETE || (key == this.keyCode.ENTER && !e.ctrlKey && !e.shiftKey) || key == this.keyCode.SPACE)\n                        {\n                            this.buffer.set();\n                        }\n                    }\n                },\n                setupSelectAll: function(e, key)\n                {\n                    if (this.keydown.ctrl && key === 65)\n                    {\n                        this.utils.enableSelectAll();\n                    }\n                    else if (key != this.keyCode.LEFT_WIN && !this.keydown.ctrl)\n                    {\n                        this.utils.disableSelectAll();\n                    }\n                },\n                onArrowDown: function()\n                {\n                    var tags = [this.keydown.blockquote, this.keydown.pre, this.keydown.figcaption];\n\n                    for (var i = 0; i < tags.length; i++)\n                    {\n                        if (tags[i])\n                        {\n                            this.keydown.insertAfterLastElement(tags[i]);\n                            return false;\n                        }\n                    }\n                },\n                onShiftEnter: function(e)\n                {\n                    this.buffer.set();\n\n                    if (this.utils.isEndOfElement())\n                    {\n                        return this.keydown.insertDblBreakLine(e);\n                    }\n\n                    return this.keydown.insertBreakLine(e);\n                },\n                onTab: function(e, key)\n                {\n                    if (!this.opts.tabKey) return true;\n                    if (this.utils.isEmpty(this.code.get()) && this.opts.tabAsSpaces === false) return true;\n\n                    e.preventDefault();\n\n                    var node;\n                    if (this.keydown.pre && !e.shiftKey)\n                    {\n                        node = (this.opts.preSpaces) ? document.createTextNode(Array(this.opts.preSpaces + 1).join('\\u00a0')) : document.createTextNode('\\t');\n                        this.insert.node(node);\n                        this.code.sync();\n                    }\n                    else if (this.opts.tabAsSpaces !== false)\n                    {\n                        node = document.createTextNode(Array(this.opts.tabAsSpaces + 1).join('\\u00a0'));\n                        this.insert.node(node);\n                        this.code.sync();\n                    }\n                    else\n                    {\n                        if (e.metaKey && key === 219) this.indent.decrease();\n                        else if (e.metaKey && key === 221) this.indent.increase();\n                        else if (!e.shiftKey) this.indent.increase();\n                        else this.indent.decrease();\n                    }\n\n                    return false;\n                },\n                replaceDivToBreakLine: function()\n                {\n                    var blockElem = this.selection.getBlock();\n                    var blockHtml = blockElem.innerHTML.replace(/<br\\s?\\/?>/gi, '');\n                    if ((blockElem.tagName === 'DIV' || blockElem.tagName === 'P') && blockHtml === '' && !$(blockElem).hasClass('redactor-editor'))\n                    {\n                        var br = document.createElement('br');\n\n                        $(blockElem).replaceWith(br);\n                        this.caret.setBefore(br);\n\n                        this.code.sync();\n\n                        return false;\n                    }\n                },\n                replaceDivToParagraph: function()\n                {\n                    var blockElem = this.selection.getBlock();\n                    var blockHtml = blockElem.innerHTML.replace(/<br\\s?\\/?>/gi, '');\n                    if (blockElem.tagName === 'DIV' && blockHtml === '' && !$(blockElem).hasClass('redactor-editor'))\n                    {\n                        var p = document.createElement('p');\n                        p.innerHTML = this.opts.invisibleSpace;\n\n                        $(blockElem).replaceWith(p);\n                        this.caret.setStart(p);\n\n                        this.code.sync();\n\n                        return false;\n                    }\n                    else if (this.opts.cleanStyleOnEnter && blockElem.tagName == 'P')\n                    {\n                        $(blockElem).removeAttr('class').removeAttr('style');\n                    }\n                },\n                insertParagraph: function(e)\n                {\n                    e.preventDefault();\n\n                    this.selection.get();\n\n                    var p = document.createElement('p');\n                    p.innerHTML = this.opts.invisibleSpace;\n\n                    this.range.deleteContents();\n                    this.range.insertNode(p);\n\n                    this.caret.setStart(p);\n\n                    this.code.sync();\n\n                    return false;\n                },\n                exitFromBlockquote: function(e)\n                {\n                    if (!this.utils.isEndOfElement()) return;\n\n                    var tmp = $.trim($(this.keydown.block).html());\n                    if (tmp.search(/(<br\\s?\\/?>){2}$/i) != -1)\n                    {\n                        e.preventDefault();\n\n                        if (this.opts.linebreaks)\n                        {\n                            var br = document.createElement('br');\n                            $(this.keydown.blockquote).after(br);\n\n                            this.caret.setBefore(br);\n                            $(this.keydown.block).html(tmp.replace(/<br\\s?\\/?>$/i, ''));\n                        }\n                        else\n                        {\n                            var node = $(this.opts.emptyHtml);\n                            $(this.keydown.blockquote).after(node);\n                            this.caret.setStart(node);\n                        }\n\n                        return true;\n\n                    }\n\n                    return;\n\n                },\n                insertAfterLastElement: function(element)\n                {\n                    if (!this.utils.isEndOfElement()) return;\n\n                    this.buffer.set();\n\n                    if (this.opts.linebreaks)\n                    {\n                        var contents = $('<div>').append($.trim(this.$editor.html())).contents();\n                        var last = contents.last()[0];\n                        if (last.tagName == 'SPAN' && last.innerHTML === '')\n                        {\n                            last = contents.prev()[0];\n                        }\n\n                        if (this.utils.getOuterHtml(last) != this.utils.getOuterHtml(element)) return;\n\n                        var br = document.createElement('br');\n                        $(element).after(br);\n                        this.caret.setAfter(br);\n\n                    }\n                    else\n                    {\n                        if (this.$editor.contents().last()[0] !== element) return;\n\n                        var node = $(this.opts.emptyHtml);\n                        $(element).after(node);\n                        this.caret.setStart(node);\n                    }\n                },\n                insertNewLine: function(e)\n                {\n                    e.preventDefault();\n\n                    var node = document.createTextNode('\\n');\n\n                    this.selection.get();\n\n                    this.range.deleteContents();\n                    this.range.insertNode(node);\n\n                    this.caret.setAfter(node);\n\n                    this.code.sync();\n\n                    return false;\n                },\n                insertBreakLine: function(e)\n                {\n                    return this.keydown.insertBreakLineProcessing(e);\n                },\n                insertDblBreakLine: function(e)\n                {\n                    return this.keydown.insertBreakLineProcessing(e, true);\n                },\n                insertBreakLineProcessing: function(e, dbl)\n                {\n                    e.stopPropagation();\n\n                    this.selection.get();\n                    var br1 = document.createElement('br');\n\n                    if (this.utils.browser('msie'))\n                    {\n                        this.range.collapse(false);\n                        this.range.setEnd(this.range.endContainer, this.range.endOffset);\n                    }\n                    else\n                    {\n                        this.range.deleteContents();\n                    }\n\n                    this.range.insertNode(br1);\n\n                    if (dbl === true)\n                    {\n\n                        var $next = $(br1).next();\n                        if ($next.length !== 0 && $next[0].tagName === 'BR' && this.utils.isEndOfEditor())\n                        {\n                            this.caret.setAfter(br1);\n                            this.code.sync();\n                            return false;\n                        }\n\n                        var br2 = document.createElement('br');\n                        this.range.insertNode(br2);\n                        this.caret.setAfter(br2);\n                    }\n                    else\n                    {\n                        this.keydown.insertBreakLineProcessingAfter(br1);\n                    }\n\n                    this.code.sync();\n                    return false;\n                },\n                insertBreakLineProcessingAfter: function(node)\n                {\n                    var space = this.utils.createSpaceElement();\n                    $(node).after(space);\n                    this.selection.selectElement(space);\n\n                    $(space).replaceWith(function()\n                    {\n                        return $(this).contents();\n                    });\n                },\n                removeInvisibleSpace: function()\n                {\n                    var $current = $(this.keydown.current);\n                    if ($current.text().search(/^\\u200B$/g) === 0)\n                    {\n                        $current.remove();\n                    }\n                },\n                removeEmptyListInTable: function(e)\n                {\n                    var $current = $(this.keydown.current);\n                    var $parent = $(this.keydown.parent);\n                    var td = $current.closest('td');\n\n                    if (td.length !== 0 && $current.closest('li') && $parent.children('li').length === 1)\n                    {\n                        if (!this.utils.isEmpty($current.text())) return;\n\n                        e.preventDefault();\n\n                        $current.remove();\n                        $parent.remove();\n\n                        this.caret.setStart(td);\n                    }\n                }\n            };\n        },\n        keyup: function()\n        {\n            return {\n                init: function(e)\n                {\n                    if (this.rtePaste) return;\n\n                    var key = e.which;\n\n                    this.keyup.current = this.selection.getCurrent();\n                    this.keyup.parent = this.selection.getParent();\n                    var $parent = this.utils.isRedactorParent($(this.keyup.parent).parent());\n\n                    // callback\n                    var keyupStop = this.core.setCallback('keyup', e);\n                    if (keyupStop === false)\n                    {\n                        e.preventDefault();\n                        return false;\n                    }\n\n                    // replace to p before / after the table or body\n                    if (!this.opts.linebreaks && this.keyup.current.nodeType == 3 && this.keyup.current.length <= 1 && (this.keyup.parent === false || this.keyup.parent.tagName == 'BODY'))\n                    {\n                        this.keyup.replaceToParagraph();\n                    }\n\n                    // replace div after lists\n                    if (!this.opts.linebreaks && this.utils.isRedactorParent(this.keyup.current) && this.keyup.current.tagName === 'DIV')\n                    {\n                        this.keyup.replaceToParagraph(false);\n                    }\n\n\n                    if (!this.opts.linebreaks && $(this.keyup.parent).hasClass('redactor-invisible-space') && ($parent === false || $parent[0].tagName == 'BODY'))\n                    {\n                        $(this.keyup.parent).contents().unwrap();\n                        this.keyup.replaceToParagraph();\n                    }\n\n                    // linkify\n                    if (this.keyup.isLinkify(key))\n                    {\n                        this.formatLinkify(this.opts.linkProtocol, this.opts.convertLinks, this.opts.convertUrlLinks, this.opts.convertImageLinks, this.opts.convertVideoLinks, this.opts.linkSize);\n\n                        this.observe.load();\n                        this.code.sync();\n                    }\n\n                    if (key === this.keyCode.DELETE || key === this.keyCode.BACKSPACE)\n                    {\n                        // clear unverified\n                        this.clean.clearUnverified();\n\n                        if (this.observe.image)\n                        {\n                            e.preventDefault();\n\n                            this.image.hideResize();\n\n                            this.buffer.set();\n                            this.image.remove(this.observe.image);\n                            this.observe.image = false;\n\n                            return false;\n                        }\n\n                        // remove empty paragraphs\n                        this.$editor.find('p').each($.proxy(this.utils.removeEmpty, this));\n\n                        // remove invisible space\n                        if (this.opts.linebreaks && this.keyup.current && this.keyup.current.tagName == 'DIV' && this.utils.isEmpty(this.keyup.current.innerHTML))\n                        {\n                            $(this.keyup.current).after(this.selection.getMarkerAsHtml());\n                            this.selection.restore();\n                            $(this.keyup.current).remove();\n                        }\n\n                        // if empty\n                        return this.keyup.formatEmpty(e);\n                    }\n                },\n                isLinkify: function(key)\n                {\n                    return this.opts.convertLinks && (this.opts.convertUrlLinks || this.opts.convertImageLinks || this.opts.convertVideoLinks) && key === this.keyCode.ENTER && !this.utils.isCurrentOrParent('PRE');\n                },\n                replaceToParagraph: function(clone)\n                {\n                    var $current = $(this.keyup.current);\n\n                    var node;\n                    if (clone === false)\n                    {\n                        node = $('<p>').append($current.html());\n                    }\n                    else\n                    {\n                        node = $('<p>').append($current.clone());\n                    }\n\n                    $current.replaceWith(node);\n                    var next = $(node).next();\n                    if (typeof(next[0]) !== 'undefined' && next[0].tagName == 'BR')\n                    {\n                        next.remove();\n                    }\n\n                    this.caret.setEnd(node);\n                },\n                formatEmpty: function(e)\n                {\n                    var html = $.trim(this.$editor.html());\n\n                    if (!this.utils.isEmpty(html)) return;\n\n                    e.preventDefault();\n\n                    if (this.opts.linebreaks)\n                    {\n                        this.$editor.html(this.selection.getMarkerAsHtml());\n                        this.selection.restore();\n                    }\n                    else\n                    {\n                        html = '<p><br /></p>';\n\n                        this.$editor.html(html);\n                        this.focus.setStart();\n                    }\n\n                    this.code.sync();\n\n                    return false;\n                }\n            };\n        },\n        lang: function()\n        {\n            return {\n                load: function()\n                {\n                    this.opts.curLang = this.opts.langs[this.opts.lang];\n                },\n                get: function(name)\n                {\n                    return (typeof this.opts.curLang[name] != 'undefined') ? this.opts.curLang[name] : '';\n                }\n            };\n        },\n        line: function()\n        {\n            return {\n                insert: function()\n                {\n                    this.buffer.set();\n\n                    var blocks = this.selection.getBlocks();\n                    if (blocks[0] !== false && this.line.isExceptLastOrFirst(blocks))\n                    {\n                        if (!this.utils.browser('msie')) this.$editor.focus();\n                        return;\n                    }\n\n                    if (this.utils.browser('msie'))\n                    {\n                        this.line.insertInIe();\n                    }\n                    else\n                    {\n                        this.line.insertInOthersBrowsers();\n                    }\n                },\n                isExceptLastOrFirst: function(blocks)\n                {\n                    var exceptTags = ['li', 'td', 'th', 'blockquote', 'figcaption', 'pre', 'dl', 'dt', 'dd'];\n\n                    var first = blocks[0].tagName.toLowerCase();\n                    var last = this.selection.getLastBlock();\n\n                    last = (typeof last == 'undefined') ? first : last.tagName.toLowerCase();\n\n                    var firstFound = $.inArray(first, exceptTags) != -1;\n                    var lastFound = $.inArray(last, exceptTags) != -1;\n\n                    if ((firstFound && lastFound) || firstFound)\n                    {\n                        return true;\n                    }\n                },\n                insertInIe: function()\n                {\n                    this.utils.saveScroll();\n                    this.buffer.set();\n\n                    this.insert.node(document.createElement('hr'));\n\n                    this.utils.restoreScroll();\n                    this.code.sync();\n                },\n                insertInOthersBrowsers: function()\n                {\n                    this.buffer.set();\n\n                    var extra = '<p id=\"redactor-insert-line\"><br /></p>';\n                    if (this.opts.linebreaks) extra = '<br id=\"redactor-insert-line\">';\n\n                    document.execCommand('insertHTML', false, '<hr>' + extra);\n\n                    this.line.setFocus();\n                    this.code.sync();\n                },\n                setFocus: function()\n                {\n                    var node = this.$editor.find('#redactor-insert-line');\n                    var next = $(node).next()[0];\n\n                    if (next)\n                    {\n                        this.caret.setAfter(node);\n                        node.remove();\n                    }\n                    else\n                    {\n                        node.removeAttr('id');\n                    }\n                }\n            };\n        },\n        link: function()\n        {\n            return {\n                show: function(e)\n                {\n                    if (typeof e != 'undefined' && e.preventDefault) e.preventDefault();\n\n                    this.modal.load('link', this.lang.get('link_insert'), 600);\n\n                    this.modal.createCancelButton();\n                    this.link.buttonInsert = this.modal.createActionButton(this.lang.get('insert'));\n\n                    this.selection.get();\n\n                    this.link.getData();\n                    this.link.cleanUrl();\n\n                    if (this.link.target == '_blank') $('#redactor-link-blank').prop('checked', true);\n\n                    this.link.$inputUrl = $('#redactor-link-url');\n                    this.link.$inputText = $('#redactor-link-url-text');\n\n                    this.link.$inputText.val(this.link.text);\n                    this.link.$inputUrl.val(this.link.url);\n\n                    this.link.buttonInsert.on('click', $.proxy(this.link.insert, this));\n\n                    // hide link's tooltip\n                    $('.redactor-link-tooltip').remove();\n\n                    // show modal\n                    this.selection.save();\n                    this.modal.show();\n                    this.link.$inputUrl.focus();\n                },\n                cleanUrl: function()\n                {\n                    var thref = self.location.href.replace(/\\/$/i, '');\n                    this.link.url = this.link.url.replace(thref, '');\n                    this.link.url = this.link.url.replace(/^\\/#/, '#');\n                    this.link.url = this.link.url.replace('mailto:', '');\n\n                    // remove host from href\n                    if (!this.opts.linkProtocol)\n                    {\n                        var re = new RegExp('^(http|ftp|https)://' + self.location.host, 'i');\n                        this.link.url = this.link.url.replace(re, '');\n                    }\n\n                },\n                getData: function()\n                {\n                    this.link.$node = false;\n\n                    var $el = $(this.selection.getCurrent()).closest('a');\n                    if ($el.length !== 0 && $el[0].tagName === 'A')\n                    {\n                        this.link.$node = $el;\n\n                        this.link.url = $el.attr('href');\n                        this.link.text = $el.text();\n                        this.link.target = $el.attr('target');\n                    }\n                    else\n                    {\n                        this.link.text = this.sel.toString();\n                        this.link.url = '';\n                        this.link.target = '';\n                    }\n\n                },\n                insert: function()\n                {\n                    var target = '';\n                    var link = this.link.$inputUrl.val();\n                    var text = this.link.$inputText.val();\n\n                    if ($.trim(link) === '')\n                    {\n                        this.link.$inputUrl.addClass('redactor-input-error').on('keyup', function()\n                        {\n                            $(this).removeClass('redactor-input-error');\n                            $(this).off('keyup');\n\n                        });\n\n                        return;\n                    }\n\n                    // mailto\n                    if (link.search('@') != -1 && /(http|ftp|https):\\/\\//i.test(link) === false)\n                    {\n                        link = 'mailto:' + link;\n                    }\n                    // url, not anchor\n                    else if (link.search('#') !== 0)\n                    {\n                        if ($('#redactor-link-blank').prop('checked'))\n                        {\n                            target = '_blank';\n                        }\n\n                        // test url (add protocol)\n                        var pattern = '((xn--)?[a-z0-9]+(-[a-z0-9]+)*\\\\.)+[a-z]{2,}';\n                        var re = new RegExp('^(http|ftp|https)://' + pattern, 'i');\n                        var re2 = new RegExp('^' + pattern, 'i');\n                        var re3 = new RegExp('\\.(html|php)$', 'i');\n                        if (link.search(re) == -1 && link.search(re3) == -1 && link.search(re2) === 0 && this.opts.linkProtocol)\n                        {\n                            link = this.opts.linkProtocol + '://' + link;\n                        }\n                    }\n\n                    this.link.set(text, link, target);\n                    this.modal.close();\n                },\n                set: function(text, link, target)\n                {\n                    text = $.trim(text.replace(/<|>/g, ''));\n\n                    this.selection.restore();\n\n                    if (text === '' && link === '') return;\n                    if (text === '' && link !== '') text = link;\n\n                    if (this.link.$node)\n                    {\n                        this.buffer.set();\n\n                        this.link.$node.text(text).attr('href', link);\n                        if (target !== '')\n                        {\n                            this.link.$node.attr('target', target);\n                        }\n                        else\n                        {\n                            this.link.$node.removeAttr('target');\n                        }\n\n                        this.code.sync();\n                    }\n                    else\n                    {\n                        if (this.utils.browser('mozilla') && this.link.text === '')\n                        {\n                            var $a = $('<a />').attr('href', link).text(text);\n                            if (target !== '') $a.attr('target', target);\n\n                            this.insert.node($a);\n                            this.selection.selectElement($a);\n                        }\n                        else\n                        {\n                            var $a;\n                            if (this.utils.browser('msie'))\n                            {\n                                $a = $('<a href=\"' + link + '\">').text(text);\n                                if (target !== '') $a.attr('target', target);\n\n                                $a = $(this.insert.node($a));\n                                this.selection.selectElement($a);\n                            }\n                            else\n                            {\n                                document.execCommand('createLink', false, link);\n\n                                $a = $(this.selection.getCurrent()).closest('a');\n                                if (this.utils.browser('mozilla'))\n                                {\n                                    $a = $('a[_moz_dirty=\"\"]');\n                                }\n\n                                if (target !== '') $a.attr('target', target);\n                                $a.removeAttr('style').removeAttr('_moz_dirty');\n\n                                if (this.link.text !== '' || this.link.text != text)\n                                {\n\n                                    $a.text(text);\n                                    this.selection.selectElement($a);\n                                }\n                            }\n                        }\n\n                        this.code.sync();\n                        this.core.setCallback('insertedLink', $a);\n\n                    }\n\n                    // link tooltip\n                    setTimeout($.proxy(function()\n                    {\n                        this.observe.links();\n\n                    }, this), 5);\n                },\n                unlink: function(e)\n                {\n                    if (typeof e != 'undefined' && e.preventDefault)\n                    {\n                        e.preventDefault();\n                    }\n\n                    var nodes = this.selection.getNodes();\n                    if (!nodes) return;\n\n                    this.buffer.set();\n\n                    var len = nodes.length;\n                    for (var i = 0; i < len; i++)\n                    {\n                        var $node = $(nodes[i]).closest('a');\n                        $node.replaceWith($node.contents());\n                    }\n\n                    // hide link's tooltip\n                    $('.redactor-link-tooltip').remove();\n\n                    this.code.sync();\n\n                },\n                toggleClass: function(className)\n                {\n                    this.link.setClass(className, 'toggleClass');\n                },\n                addClass: function(className)\n                {\n                    this.link.setClass(className, 'addClass');\n                },\n                removeClass: function(className)\n                {\n                    this.link.setClass(className, 'removeClass');\n                },\n                setClass: function(className, func)\n                {\n                    var links = this.selection.getInlinesTags(['a']);\n                    if (links === false) return;\n\n                    $.each(links, function()\n                    {\n                        $(this)[func](className);\n                    });\n                }\n            };\n        },\n        list: function()\n        {\n            return {\n                toggle: function(cmd)\n                {\n                    this.placeholder.remove();\n                    if (!this.utils.browser('msie')) this.$editor.focus();\n\n                    this.buffer.set();\n                    this.selection.save();\n\n                    var parent = this.selection.getParent();\n                    var $list = $(parent).closest('ol, ul');\n\n                    if (!this.utils.isRedactorParent($list) && $list.length !== 0)\n                    {\n                        $list = false;\n                    }\n\n                    var isUnorderedCmdOrdered, isOrderedCmdUnordered;\n                    var remove = false;\n                    if ($list && $list.length)\n                    {\n                        remove = true;\n                        var listTag = $list[0].tagName;\n\n                        isUnorderedCmdOrdered = (cmd === 'orderedlist' && listTag === 'UL');\n                        isOrderedCmdUnordered = (cmd === 'unorderedlist' && listTag === 'OL');\n                    }\n\n                    if (isUnorderedCmdOrdered)\n                    {\n                        this.utils.replaceToTag($list, 'ol');\n                    }\n                    else if (isOrderedCmdUnordered)\n                    {\n                        this.utils.replaceToTag($list, 'ul');\n                    }\n                    else\n                    {\n                        if (remove)\n                        {\n                            this.list.remove(cmd);\n                        }\n                        else\n                        {\n                            this.list.insert(cmd);\n                        }\n                    }\n\n\n                    this.selection.restore();\n                    this.code.sync();\n                },\n                insert: function(cmd)\n                {\n                    var parent = this.selection.getParent();\n                    var current = this.selection.getCurrent();\n                    var $td = $(current).closest('td, th');\n\n                    if (this.utils.browser('msie') && this.opts.linebreaks)\n                    {\n                        this.list.insertInIe(cmd);\n                    }\n                    else\n                    {\n                        document.execCommand('insert' + cmd);\n                    }\n\n                    var $list = $(this.selection.getParent()).closest('ol, ul');\n\n                    if ($td.length !== 0)\n                    {\n                        var prev = $td.prev();\n                        var html = $td.html();\n                        $td.html('');\n                        if (prev && prev.length === 1 && (prev[0].tagName === 'TD' || prev[0].tagName === 'TH'))\n                        {\n                            $(prev).after($td);\n                        }\n                        else\n                        {\n                            $(parent).prepend($td);\n                        }\n\n                        $td.html(html);\n                    }\n\n                    if (this.utils.isEmpty($list.find('li').text()))\n                    {\n                        var $children = $list.children('li');\n                        $children.find('br').remove();\n                        $children.append(this.selection.getMarkerAsHtml());\n                    }\n\n                    if ($list.length)\n                    {\n                        // remove block-element list wrapper\n                        var $listParent = $list.parent();\n                        if (this.utils.isRedactorParent($listParent) && $listParent[0].tagName != 'LI' && this.utils.isBlock($listParent[0]))\n                        {\n                            $listParent.replaceWith($listParent.contents());\n                        }\n                    }\n\n                    if (!this.utils.browser('msie'))\n                    {\n                        this.$editor.focus();\n                    }\n\n                    this.clean.clearUnverified();\n                },\n                insertInIe: function(cmd)\n                {\n                    var wrapper = this.selection.wrap('div');\n                    var wrapperHtml = $(wrapper).html();\n\n                    var tmpList = (cmd == 'orderedlist') ? $('<ol>') : $('<ul>');\n                    var tmpLi = $('<li>');\n\n                    if ($.trim(wrapperHtml) === '')\n                    {\n                        tmpLi.append(this.selection.getMarkerAsHtml());\n                        tmpList.append(tmpLi);\n                        this.$editor.find('#selection-marker-1').replaceWith(tmpList);\n                    }\n                    else\n                    {\n                        var items = wrapperHtml.split(/<br\\s?\\/?>/gi);\n                        if (items)\n                        {\n                            for (var i = 0; i < items.length; i++)\n                            {\n                                if ($.trim(items[i]) !== '')\n                                {\n                                    tmpList.append($('<li>').html(items[i]));\n                                }\n                            }\n                        }\n                        else\n                        {\n                            tmpLi.append(wrapperHtml);\n                            tmpList.append(tmpLi);\n                        }\n\n                        $(wrapper).replaceWith(tmpList);\n                    }\n                },\n                remove: function(cmd)\n                {\n                    document.execCommand('insert' + cmd);\n\n                    var $current = $(this.selection.getCurrent());\n\n                    this.indent.fixEmptyIndent();\n\n                    if (!this.opts.linebreaks && $current.closest('li, th, td').length === 0)\n                    {\n                        document.execCommand('formatblock', false, 'p');\n                        this.$editor.find('ul, ol, blockquote').each($.proxy(this.utils.removeEmpty, this));\n                    }\n\n                    var $table = $(this.selection.getCurrent()).closest('table');\n                    var $prev = $table.prev();\n                    if (!this.opts.linebreaks && $table.length !== 0 && $prev.length !== 0 && $prev[0].tagName == 'BR')\n                    {\n                        $prev.remove();\n                    }\n\n                    this.clean.clearUnverified();\n\n                }\n            };\n        },\n        modal: function()\n        {\n            return {\n                callbacks: {},\n                loadTemplates: function()\n                {\n                    this.opts.modal = {\n                        imageEdit: String()\n                        + '<section id=\"redactor-modal-image-edit\">'\n                            + '<label>' + this.lang.get('title') + '</label>'\n                            + '<input type=\"text\" id=\"redactor-image-title\" />'\n                            + '<label class=\"redactor-image-link-option\">' + this.lang.get('link') + '</label>'\n                            + '<input type=\"text\" id=\"redactor-image-link\" class=\"redactor-image-link-option\" />'\n                            + '<label class=\"redactor-image-link-option\"><input type=\"checkbox\" id=\"redactor-image-link-blank\"> ' + this.lang.get('link_new_tab') + '</label>'\n                            + '<label class=\"redactor-image-position-option\">' + this.lang.get('image_position') + '</label>'\n                            + '<select class=\"redactor-image-position-option\" id=\"redactor-image-align\">'\n                                + '<option value=\"none\">' + this.lang.get('none') + '</option>'\n                                + '<option value=\"left\">' + this.lang.get('left') + '</option>'\n                                + '<option value=\"center\">' + this.lang.get('center') + '</option>'\n                                + '<option value=\"right\">' + this.lang.get('right') + '</option>'\n                            + '</select>'\n                            + '<label>Full Screen Width</label>'\n                            + '<input type=\"checkbox\" id=\"redactor-image-full-screen-width\" />'\n                        + '</section>',\n\n                        image: String()\n                        + '<section id=\"redactor-modal-image-insert\">'\n                            + '<div id=\"redactor-modal-image-droparea\"></div>'\n                        + '</section>',\n\n                        file: String()\n                        + '<section id=\"redactor-modal-file-insert\">'\n                            + '<div id=\"redactor-modal-file-upload-box\">'\n                                + '<label>' + this.lang.get('filename') + '</label>'\n                                + '<input type=\"text\" id=\"redactor-filename\" /><br><br>'\n                                + '<div id=\"redactor-modal-file-upload\"></div>'\n                            + '</div>'\n                        + '</section>',\n\n                        link: String()\n                        + '<section id=\"redactor-modal-link-insert\">'\n                            + '<label>URL</label>'\n                            + '<input type=\"url\" id=\"redactor-link-url\" />'\n                            + '<label>' + this.lang.get('text') + '</label>'\n                            + '<input type=\"text\" id=\"redactor-link-url-text\" />'\n                            + '<label><input type=\"checkbox\" id=\"redactor-link-blank\"> ' + this.lang.get('link_new_tab') + '</label>'\n                        + '</section>'\n                    };\n\n\n                    $.extend(this.opts, this.opts.modal);\n\n                },\n                addCallback: function(name, callback)\n                {\n                    this.modal.callbacks[name] = callback;\n                },\n                createTabber: function($modal)\n                {\n                    this.modal.$tabber = $('<div>').attr('id', 'redactor-modal-tabber');\n\n                    $modal.prepend(this.modal.$tabber);\n                },\n                addTab: function(id, name, active)\n                {\n                    var $tab = $('<a href=\"#\" rel=\"tab' + id + '\">').text(name);\n                    if (active)\n                    {\n                        $tab.addClass('active');\n                    }\n\n                    var self = this;\n                    $tab.on('click', function(e)\n                    {\n                        e.preventDefault();\n                        $('.redactor-tab').hide();\n                        $('.redactor-' + $(this).attr('rel')).show();\n\n                        self.modal.$tabber.find('a').removeClass('active');\n                        $(this).addClass('active');\n\n                    });\n\n                    this.modal.$tabber.append($tab);\n                },\n                addTemplate: function(name, template)\n                {\n                    this.opts.modal[name] = template;\n                },\n                getTemplate: function(name)\n                {\n                    return this.opts.modal[name];\n                },\n                getModal: function()\n                {\n                    return this.$modalBody.find('section');\n                },\n                load: function(templateName, title, width)\n                {\n                    this.modal.templateName = templateName;\n                    this.modal.width = width;\n\n                    this.modal.build();\n                    this.modal.enableEvents();\n                    this.modal.setTitle(title);\n                    this.modal.setDraggable();\n                    this.modal.setContent();\n\n                    // callbacks\n                    if (typeof this.modal.callbacks[templateName] != 'undefined')\n                    {\n                        this.modal.callbacks[templateName].call(this);\n                    }\n\n                },\n                show: function()\n                {\n                    // ios keyboard hide\n                    if (this.utils.isMobile() && !this.utils.browser('msie'))\n                    {\n                        document.activeElement.blur();\n                    }\n\n                    $(document.body).removeClass('body-redactor-hidden');\n                    this.modal.bodyOveflow = $(document.body).css('overflow');\n                    $(document.body).css('overflow', 'hidden');\n\n                    if (this.utils.isMobile())\n                    {\n                        this.modal.showOnMobile();\n                    }\n                    else\n                    {\n                        this.modal.showOnDesktop();\n                    }\n\n                    this.$modalOverlay.show();\n                    this.$modalBox.show();\n\n                    this.modal.setButtonsWidth();\n\n                    this.utils.saveScroll();\n\n                    // resize\n                    if (!this.utils.isMobile())\n                    {\n                        setTimeout($.proxy(this.modal.showOnDesktop, this), 0);\n                        $(window).on('resize.redactor-modal', $.proxy(this.modal.resize, this));\n                    }\n\n                    // modal shown callback\n                    this.core.setCallback('modalOpened', this.modal.templateName, this.$modal);\n\n                    // fix bootstrap modal focus\n                    $(document).off('focusin.modal');\n\n                    // enter\n                    this.$modal.find('input[type=text],input[type=url],input[type=email]').on('keydown.redactor-modal', $.proxy(this.modal.setEnter, this));\n                },\n                showOnDesktop: function()\n                {\n                    var height = this.$modal.outerHeight();\n                    var windowHeight = $(window).height();\n                    var windowWidth = $(window).width();\n\n                    if (this.modal.width > windowWidth)\n                    {\n                        this.$modal.css({\n                            width: '96%',\n                            marginTop: (windowHeight/2 - height/2) + 'px'\n                        });\n                        return;\n                    }\n\n                    if (height > windowHeight)\n                    {\n                        this.$modal.css({\n                            width: this.modal.width + 'px',\n                            marginTop: '20px'\n                        });\n                    }\n                    else\n                    {\n                        this.$modal.css({\n                            width: this.modal.width + 'px',\n                            marginTop: (windowHeight/2 - height/2) + 'px'\n                        });\n                    }\n                },\n                showOnMobile: function()\n                {\n                    this.$modal.css({\n                        width: '96%',\n                        marginTop: '2%'\n                    });\n\n                },\n                resize: function()\n                {\n                    if (this.utils.isMobile())\n                    {\n                        this.modal.showOnMobile();\n                    }\n                    else\n                    {\n                        this.modal.showOnDesktop();\n                    }\n                },\n                setTitle: function(title)\n                {\n                    this.$modalHeader.html(title);\n                },\n                setContent: function()\n                {\n                    this.$modalBody.html(this.modal.getTemplate(this.modal.templateName));\n                },\n                setDraggable: function()\n                {\n                    if (typeof $.fn.draggable === 'undefined') return;\n\n                    this.$modal.draggable({ handle: this.$modalHeader });\n                    this.$modalHeader.css('cursor', 'move');\n                },\n                setEnter: function(e)\n                {\n                    if (e.which != 13) return;\n\n                    e.preventDefault();\n                    this.$modal.find('button.redactor-modal-action-btn').click();\n                },\n                createCancelButton: function()\n                {\n                    var button = $('<button>').addClass('redactor-modal-btn redactor-modal-close-btn').html(this.lang.get('cancel'));\n                    button.on('click', $.proxy(this.modal.close, this));\n\n                    this.$modalFooter.append(button);\n                },\n                createDeleteButton: function(label)\n                {\n                    return this.modal.createButton(label, 'delete');\n                },\n                createActionButton: function(label)\n                {\n                    return this.modal.createButton(label, 'action');\n                },\n                createButton: function(label, className)\n                {\n                    var button = $('<button>').addClass('redactor-modal-btn').addClass('redactor-modal-' + className + '-btn').html(label);\n                    this.$modalFooter.append(button);\n\n                    return button;\n                },\n                setButtonsWidth: function()\n                {\n                    var buttons = this.$modalFooter.find('button');\n                    var buttonsSize = buttons.length;\n                    if (buttonsSize === 0) return;\n\n                    buttons.css('width', (100/buttonsSize) + '%');\n                },\n                build: function()\n                {\n                    this.modal.buildOverlay();\n\n                    this.$modalBox = $('<div id=\"redactor-modal-box\" />').hide();\n                    this.$modal = $('<div id=\"redactor-modal\" />');\n                    this.$modalHeader = $('<header />');\n                    this.$modalClose = $('<span id=\"redactor-modal-close\" />').html('&times;');\n                    this.$modalBody = $('<div id=\"redactor-modal-body\" />');\n                    this.$modalFooter = $('<footer />');\n\n                    this.$modal.append(this.$modalHeader);\n                    this.$modal.append(this.$modalClose);\n                    this.$modal.append(this.$modalBody);\n                    this.$modal.append(this.$modalFooter);\n                    this.$modalBox.append(this.$modal);\n                    this.$modalBox.appendTo(document.body);\n                },\n                buildOverlay: function()\n                {\n                    this.$modalOverlay = $('<div id=\"redactor-modal-overlay\">').hide();\n                    $('body').prepend(this.$modalOverlay);\n                },\n                enableEvents: function()\n                {\n                    this.$modalClose.on('click.redactor-modal', $.proxy(this.modal.close, this));\n                    $(document).on('keyup.redactor-modal', $.proxy(this.modal.closeHandler, this));\n                    this.$editor.on('keyup.redactor-modal', $.proxy(this.modal.closeHandler, this));\n                    this.$modalBox.on('click.redactor-modal', $.proxy(this.modal.close, this));\n                },\n                disableEvents: function()\n                {\n                    this.$modalClose.off('click.redactor-modal');\n                    $(document).off('keyup.redactor-modal');\n                    this.$editor.off('keyup.redactor-modal');\n                    this.$modalBox.off('click.redactor-modal');\n                    $(window).off('resize.redactor-modal');\n                },\n                closeHandler: function(e)\n                {\n                    if (e.which != this.keyCode.ESC) return;\n\n                    this.modal.close(false);\n                },\n                close: function(e)\n                {\n                    if (e)\n                    {\n                        if (!$(e.target).hasClass('redactor-modal-close-btn') && e.target != this.$modalClose[0] && e.target != this.$modalBox[0])\n                        {\n                            return;\n                        }\n\n                        e.preventDefault();\n                    }\n\n                    if (!this.$modalBox) return;\n\n                    this.modal.disableEvents();\n\n                    this.$modalOverlay.remove();\n\n                    this.$modalBox.fadeOut('fast', $.proxy(function()\n                    {\n                        this.$modalBox.remove();\n\n                        setTimeout($.proxy(this.utils.restoreScroll, this), 0);\n\n                        if (e !== undefined) this.selection.restore();\n\n                        $(document.body).css('overflow', this.modal.bodyOveflow);\n                        this.core.setCallback('modalClosed', this.modal.templateName);\n\n                    }, this));\n\n                }\n            };\n        },\n        observe: function()\n        {\n            return {\n                load: function()\n                {\n                    this.observe.images();\n                    this.observe.links();\n                },\n                buttons: function(e, btnName)\n                {\n                    var current = this.selection.getCurrent();\n                    var parent = this.selection.getParent();\n\n                    if (e !== false)\n                    {\n                        this.button.setInactiveAll();\n                    }\n                    else\n                    {\n                        this.button.setInactiveAll(btnName);\n                    }\n\n                    if (e === false && btnName !== 'html')\n                    {\n                        if ($.inArray(btnName, this.opts.activeButtons) != -1) this.button.toggleActive(btnName);\n                        return;\n                    }\n\n                    //var linkButtonName = (this.utils.isCurrentOrParent('A')) ? this.lang.get('link_edit') : this.lang.get('link_insert');\n                    //$('body').find('a.redactor-dropdown-link').text(linkButtonName);\n\n                    $.each(this.opts.activeButtonsStates, $.proxy(function(key, value)\n                    {\n                        var parentEl = $(parent).closest(key);\n                        var currentEl = $(current).closest(key);\n\n                        if (parentEl.length !== 0 && !this.utils.isRedactorParent(parentEl)) return;\n                        if (!this.utils.isRedactorParent(currentEl)) return;\n                        if (parentEl.length !== 0 || currentEl.closest(key).length !== 0)\n                        {\n                            this.button.setActive(value);\n                        }\n\n                    }, this));\n\n                    var $parent = $(parent).closest(this.opts.alignmentTags.toString().toLowerCase());\n                    if (this.utils.isRedactorParent(parent) && $parent.length)\n                    {\n                        var align = ($parent.css('text-align') === '') ? 'left' : $parent.css('text-align');\n                        this.button.setActive('align' + align);\n                    }\n                },\n                addButton: function(tag, btnName)\n                {\n                    this.opts.activeButtons.push(btnName);\n                    this.opts.activeButtonsStates[tag] = btnName;\n                },\n                images: function()\n                {\n                    this.$editor.find('img').each($.proxy(function(i, img)\n                    {\n                        var $img = $(img);\n\n                        // IE fix (when we clicked on an image and then press backspace IE does goes to image's url)\n                        $img.closest('a').on('click', function(e) { e.preventDefault(); });\n\n                        if (this.utils.browser('msie')) $img.attr('unselectable', 'on');\n\n                        this.image.setEditable($img);\n\n                    }, this));\n\n                    $(document).on('click.redactor-image-delete.' + this.uuid, $.proxy(function(e)\n                    {\n                        this.observe.image = false;\n                        if (e.target.tagName == 'IMG' && this.utils.isRedactorParent(e.target))\n                        {\n                            this.observe.image = (this.observe.image && this.observe.image == e.target) ? false : e.target;\n                        }\n\n                    }, this));\n\n                },\n                links: function()\n                {\n                    if (!this.opts.linkTooltip) return;\n\n                    this.$editor.find('a').on('touchstart.redactor.' + this.uuid + ' click.redactor.' + this.uuid, $.proxy(this.observe.showTooltip, this));\n                    this.$editor.on('touchstart.redactor.' + this.uuid + ' click.redactor.' + this.uuid, $.proxy(this.observe.closeTooltip, this));\n                    $(document).on('touchstart.redactor.' + this.uuid + ' click.redactor.' + this.uuid, $.proxy(this.observe.closeTooltip, this));\n                },\n                getTooltipPosition: function($link)\n                {\n                    return $link.offset();\n                },\n                showTooltip: function(e)\n                {\n                    var $link = $(e.target);\n                    var $parent = $link.closest('a');\n                    var tag = ($link.length !== 0) ? $link[0].tagName : false;\n\n                    if ($parent[0].tagName === 'A')\n                    {\n                        if (tag === 'IMG') return;\n                        else if (tag !== 'A') $link = $parent;\n                    }\n\n                    if (tag !== 'A')\n                    {\n                        return;\n                    }\n\n                    var pos = this.observe.getTooltipPosition($link);\n                    var tooltip = $('<span class=\"redactor-link-tooltip\"></span>');\n\n                    var href = $link.attr('href');\n                    if (href === undefined)\n                    {\n                        href = '';\n                    }\n\n                    if (href.length > 24) href = href.substring(0, 24) + '...';\n\n                    var aLink = $('<a href=\"' + $link.attr('href') + '\" target=\"_blank\" />').html(href).addClass('redactor-link-tooltip-action');\n                    var aEdit = $('<a href=\"#\" />').html(this.lang.get('edit')).on('click', $.proxy(this.link.show, this)).addClass('redactor-link-tooltip-action');\n                    var aUnlink = $('<a href=\"#\" />').html(this.lang.get('unlink')).on('click', $.proxy(this.link.unlink, this)).addClass('redactor-link-tooltip-action');\n\n                    tooltip.append(aLink).append(' | ').append(aEdit).append(' | ').append(aUnlink);\n                    tooltip.css({\n                        top: (pos.top + parseInt($link.css('line-height'), 10)) + 'px',\n                        left: pos.left + 'px'\n                    });\n\n                    $('.redactor-link-tooltip').remove();\n                    $('body').append(tooltip);\n                },\n                closeTooltip: function(e)\n                {\n                    e = e.originalEvent || e;\n\n                    var target = e.target;\n                    var $parent = $(target).closest('a');\n                    if ($parent.length !== 0 && $parent[0].tagName === 'A' && target.tagName !== 'A')\n                    {\n                        return;\n                    }\n                    else if ((target.tagName === 'A' && this.utils.isRedactorParent(target)) || $(target).hasClass('redactor-link-tooltip-action'))\n                    {\n                        return;\n                    }\n\n                    $('.redactor-link-tooltip').remove();\n                }\n\n            };\n        },\n        paragraphize: function()\n        {\n            return {\n                load: function(html)\n                {\n                    if (this.opts.linebreaks) return html;\n                    if (html === '' || html === '<p></p>') return this.opts.emptyHtml;\n\n                    this.paragraphize.blocks = ['table', 'div', 'pre', 'form', 'ul', 'ol', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'dl', 'blockquote', 'figcaption',\n                    'address', 'section', 'header', 'footer', 'aside', 'article', 'object', 'style', 'script', 'iframe', 'select', 'input', 'textarea',\n                    'button', 'option', 'map', 'area', 'math', 'hr', 'fieldset', 'legend', 'hgroup', 'nav', 'figure', 'details', 'menu', 'summary', 'p'];\n\n                    html = html + \"\\n\";\n\n                    this.paragraphize.safes = [];\n                    this.paragraphize.z = 0;\n\n                    html = html.replace(/(<br\\s?\\/?>){1,}\\n?<\\/blockquote>/gi, '</blockquote>');\n\n                    html = this.paragraphize.getSafes(html);\n                    html = this.paragraphize.getSafesComments(html);\n                    html = this.paragraphize.replaceBreaksToNewLines(html);\n                    html = this.paragraphize.replaceBreaksToParagraphs(html);\n                    html = this.paragraphize.clear(html);\n                    html = this.paragraphize.restoreSafes(html);\n\n                    html = html.replace(new RegExp('<br\\\\s?/?>\\n?<(' + this.paragraphize.blocks.join('|') + ')(.*?[^>])>', 'gi'), '<p><br /></p>\\n<$1$2>');\n\n                    return $.trim(html);\n                },\n                getSafes: function(html)\n                {\n                    var $div = $('<div />').append(html);\n\n                    // remove paragraphs in blockquotes\n                    $div.find('blockquote p').replaceWith(function()\n                    {\n                        return $(this).append('<br />').contents();\n                    });\n\n                    html = $div.html();\n\n                    $div.find(this.paragraphize.blocks.join(', ')).each($.proxy(function(i,s)\n                    {\n                        this.paragraphize.z++;\n                        this.paragraphize.safes[this.paragraphize.z] = s.outerHTML;\n                        html = html.replace(s.outerHTML, '\\n{replace' + this.paragraphize.z + '}');\n\n                    }, this));\n\n                    return html;\n                },\n                getSafesComments: function(html)\n                {\n                    var commentsMatches = html.match(/<!--([\\w\\W]*?)-->/gi);\n\n                    if (!commentsMatches) return html;\n\n                    $.each(commentsMatches, $.proxy(function(i,s)\n                    {\n                        this.paragraphize.z++;\n                        this.paragraphize.safes[this.paragraphize.z] = s;\n                        html = html.replace(s, '\\n{replace' + this.paragraphize.z + '}');\n                    }, this));\n\n                    return html;\n                },\n                restoreSafes: function(html)\n                {\n                    $.each(this.paragraphize.safes, function(i,s)\n                    {\n                        s = (typeof s !== 'undefined') ? s.replace(/\\$/g, '&#36;') : s;\n                        html = html.replace('{replace' + i + '}', s);\n\n                    });\n\n                    return html;\n                },\n                replaceBreaksToParagraphs: function(html)\n                {\n                    var htmls = html.split(new RegExp('\\n', 'g'), -1);\n\n                    html = '';\n                    if (htmls)\n                    {\n                        var len = htmls.length;\n                        for (var i = 0; i < len; i++)\n                        {\n                            if (!htmls.hasOwnProperty(i)) return;\n\n                            if (htmls[i].search('{replace') == -1)\n                            {\n                                htmls[i] = htmls[i].replace(/<p>\\n\\t?<\\/p>/gi, '');\n                                htmls[i] = htmls[i].replace(/<p><\\/p>/gi, '');\n\n                                if (htmls[i] !== '')\n                                {\n                                    html += '<p>' +  htmls[i].replace(/^\\n+|\\n+$/g, \"\") + \"</p>\";\n                                }\n                            }\n                            else html += htmls[i];\n                        }\n                    }\n\n                    return html;\n                },\n                replaceBreaksToNewLines: function(html)\n                {\n                    html = html.replace(/<br \\/>\\s*<br \\/>/gi, \"\\n\\n\");\n                    html = html.replace(/<br\\s?\\/?>\\n?<br\\s?\\/?>/gi, \"\\n<br /><br />\");\n\n                    html = html.replace(new RegExp(\"\\r\\n\", 'g'), \"\\n\");\n                    html = html.replace(new RegExp(\"\\r\", 'g'), \"\\n\");\n                    html = html.replace(new RegExp(\"/\\n\\n+/\"), 'g', \"\\n\\n\");\n\n                    return html;\n                },\n                clear: function(html)\n                {\n                    html = html.replace(new RegExp('</blockquote></p>', 'gi'), '</blockquote>');\n                    html = html.replace(new RegExp('<p></blockquote>', 'gi'), '</blockquote>');\n                    html = html.replace(new RegExp('<p><blockquote>', 'gi'), '<blockquote>');\n                    html = html.replace(new RegExp('<blockquote></p>', 'gi'), '<blockquote>');\n\n                    html = html.replace(new RegExp('<p><p ', 'gi'), '<p ');\n                    html = html.replace(new RegExp('<p><p>', 'gi'), '<p>');\n                    html = html.replace(new RegExp('</p></p>', 'gi'), '</p>');\n                    html = html.replace(new RegExp('<p>\\\\s?</p>', 'gi'), '');\n                    html = html.replace(new RegExp(\"\\n</p>\", 'gi'), '</p>');\n                    html = html.replace(new RegExp('<p>\\t?\\t?\\n?<p>', 'gi'), '<p>');\n                    html = html.replace(new RegExp('<p>\\t*</p>', 'gi'), '');\n\n                    return html;\n                }\n            };\n        },\n        paste: function()\n        {\n            return {\n                init: function(e)\n                {\n                    if (!this.opts.cleanOnPaste)\n                    {\n                        setTimeout($.proxy(this.code.sync, this), 1);\n                        return;\n                    }\n\n                    this.rtePaste = true;\n\n                    this.buffer.set();\n                    this.selection.save();\n                    this.utils.saveScroll();\n\n                    this.paste.createPasteBox();\n\n                    $(window).on('scroll.redactor-freeze', $.proxy(function()\n                    {\n                        $(window).scrollTop(this.saveBodyScroll);\n\n                    }, this));\n\n                    setTimeout($.proxy(function()\n                    {\n                        var html = this.$pasteBox.html();\n\n                        this.$pasteBox.remove();\n\n                        this.selection.restore();\n                        this.utils.restoreScroll();\n\n                        this.paste.insert(html);\n\n                        $(window).off('scroll.redactor-freeze');\n\n                    }, this), 1);\n\n                },\n                createPasteBox: function()\n                {\n                    this.$pasteBox = $('<div>').html('').attr('contenteditable', 'true').css({ position: 'fixed', width: 0, top: 0, left: '-9999px' });\n\n                    if (this.utils.browser('msie'))\n                    {\n                        this.$box.append(this.$pasteBox);\n                    }\n                    else\n                    {\n                        $('body').append(this.$pasteBox);\n                    }\n\n                    this.$pasteBox.focus();\n                },\n                insert: function(html)\n                {\n                    html = this.core.setCallback('pasteBefore', html);\n\n                    // clean\n                    html = (this.utils.isSelectAll()) ? this.clean.onPaste(html, false) : this.clean.onPaste(html);\n\n                    html = this.core.setCallback('paste', html);\n\n                    if (this.utils.isSelectAll())\n                    {\n                        this.insert.set(html, false);\n                    }\n                    else\n                    {\n                        this.insert.html(html, false);\n                    }\n\n                    this.utils.disableSelectAll();\n                    this.rtePaste = false;\n\n                    setTimeout($.proxy(this.clean.clearUnverified, this), 10);\n\n                    // clean empty spans\n                    setTimeout($.proxy(function()\n                    {\n                        var spans = this.$editor.find('span');\n                        $.each(spans, function(i,s)\n                        {\n                            var html = s.innerHTML.replace(/[\\u200B-\\u200D\\uFEFF]/, '');\n                            if (html === '' && s.attributes.length === 0) $(s).remove();\n\n                        });\n\n                    }, this), 10);\n                }\n            };\n        },\n        placeholder: function()\n        {\n            return {\n                enable: function()\n                {\n                    if (!this.placeholder.is()) return;\n\n                    this.$editor.attr('placeholder', this.$element.attr('placeholder'));\n\n                    this.placeholder.toggle();\n                    this.$editor.on('keyup.redactor-placeholder', $.proxy(this.placeholder.toggle, this));\n\n                },\n                toggle: function()\n                {\n                    var func = 'removeClass';\n                    if (this.utils.isEmpty(this.$editor.html(), false)) func = 'addClass';\n                    this.$editor[func]('redactor-placeholder');\n                },\n                remove: function()\n                {\n                    this.$editor.removeClass('redactor-placeholder');\n                },\n                is: function()\n                {\n                    if (this.opts.placeholder)\n                    {\n                        return this.$element.attr('placeholder', this.opts.placeholder);\n                    }\n                    else\n                    {\n                        return !(typeof this.$element.attr('placeholder') == 'undefined' || this.$element.attr('placeholder') === '');\n                    }\n                }\n            };\n        },\n        progress: function()\n        {\n            return {\n                show: function()\n                {\n                    $(document.body).append($('<div id=\"redactor-progress\"><span></span></div>'));\n                    $('#redactor-progress').fadeIn();\n                },\n                hide: function()\n                {\n                    $('#redactor-progress').fadeOut(1500, function()\n                    {\n                        $(this).remove();\n                    });\n                }\n\n            };\n        },\n        selection: function()\n        {\n            return {\n                get: function()\n                {\n                    this.sel = document.getSelection();\n\n                    if (document.getSelection && this.sel.getRangeAt && this.sel.rangeCount)\n                    {\n                        this.range = this.sel.getRangeAt(0);\n                    }\n                    else\n                    {\n                        this.range = document.createRange();\n                    }\n                },\n                addRange: function()\n                {\n                    try {\n                        this.sel.removeAllRanges();\n                    } catch (e) {}\n\n                    this.sel.addRange(this.range);\n                },\n                getCurrent: function()\n                {\n                    var el = false;\n                    this.selection.get();\n\n                    if (this.sel && this.sel.rangeCount > 0)\n                    {\n                        el = this.sel.getRangeAt(0).startContainer;\n                    }\n\n                    return this.utils.isRedactorParent(el);\n                },\n                getParent: function(elem)\n                {\n                    elem = elem || this.selection.getCurrent();\n                    if (elem)\n                    {\n                        return this.utils.isRedactorParent($(elem).parent()[0]);\n                    }\n\n                    return false;\n                },\n                getBlock: function(node)\n                {\n                    node = node || this.selection.getCurrent();\n\n                    while (node)\n                    {\n                        if (this.utils.isBlockTag(node.tagName))\n                        {\n                            return ($(node).hasClass('redactor-editor')) ? false : node;\n                        }\n\n                        node = node.parentNode;\n                    }\n\n                    return false;\n                },\n                getInlines: function(nodes, tags)\n                {\n                    this.selection.get();\n\n                    if (this.range && this.range.collapsed)\n                    {\n                        return false;\n                    }\n\n                    var inlines = [];\n                    nodes = (typeof nodes == 'undefined' || nodes === false) ? this.selection.getNodes() : nodes;\n                    var inlineTags = this.opts.inlineTags;\n                    inlineTags.push('span');\n\n                    if (typeof tags !== 'undefined')\n                    {\n                        for (var i = 0; i < tags.length; i++)\n                        {\n                            inlineTags.push(tags[i]);\n                        }\n                    }\n\n                    $.each(nodes, $.proxy(function(i,node)\n                    {\n                        if ($.inArray(node.tagName.toLowerCase(), inlineTags) != -1)\n                        {\n                            inlines.push(node);\n                        }\n\n                    }, this));\n\n                    return (inlines.length === 0) ? false : inlines;\n                },\n                getInlinesTags: function(tags)\n                {\n                    this.selection.get();\n\n                    if (this.range && this.range.collapsed)\n                    {\n                        return false;\n                    }\n\n                    var inlines = [];\n                    var nodes =  this.selection.getNodes();\n                    $.each(nodes, $.proxy(function(i,node)\n                    {\n                        if ($.inArray(node.tagName.toLowerCase(), tags) != -1)\n                        {\n                            inlines.push(node);\n                        }\n\n                    }, this));\n\n                    return (inlines.length === 0) ? false : inlines;\n                },\n                getBlocks: function(nodes)\n                {\n                    this.selection.get();\n\n                    if (this.range && this.range.collapsed)\n                    {\n                        return [this.selection.getBlock()];\n                    }\n\n                    var blocks = [];\n                    nodes = (typeof nodes == 'undefined') ? this.selection.getNodes() : nodes;\n                    $.each(nodes, $.proxy(function(i,node)\n                    {\n                        if (this.utils.isBlock(node))\n                        {\n                            this.selection.lastBlock = node;\n                            blocks.push(node);\n                        }\n\n                    }, this));\n\n                    return (blocks.length === 0) ? [this.selection.getBlock()] : blocks;\n                },\n                getLastBlock: function()\n                {\n                    return this.selection.lastBlock;\n                },\n                getNodes: function()\n                {\n                    this.selection.get();\n\n                    var startNode = this.selection.getNodesMarker(1);\n                    var endNode = this.selection.getNodesMarker(2);\n                    var range = this.range.cloneRange();\n\n                    if (this.range.collapsed === false)\n                    {\n                        var startContainer = range.startContainer;\n                        var startOffset = range.startOffset;\n\n                        // end marker\n                        this.selection.setNodesMarker(range, endNode, false);\n\n                        // start marker\n                        range.setStart(startContainer, startOffset);\n                        this.selection.setNodesMarker(range, startNode, true);\n                    }\n                    else\n                    {\n                        this.selection.setNodesMarker(range, startNode, true);\n                        endNode = startNode;\n                    }\n\n                    var nodes = [];\n                    var counter = 0;\n\n                    var self = this;\n                    this.$editor.find('*').each(function()\n                    {\n                        if (this == startNode)\n                        {\n                            var parent = $(this).parent();\n                            if (parent.length !== 0 && parent[0].tagName != 'BODY' && self.utils.isRedactorParent(parent[0]))\n                            {\n                                nodes.push(parent[0]);\n                            }\n\n                            nodes.push(this);\n                            counter = 1;\n                        }\n                        else\n                        {\n                            if (counter > 0)\n                            {\n                                nodes.push(this);\n                                counter = counter + 1;\n                            }\n                        }\n\n                        if (this == endNode)\n                        {\n                            return false;\n                        }\n\n                    });\n\n                    var finalNodes = [];\n                    var len = nodes.length;\n                    for (var i = 0; i < len; i++)\n                    {\n                        if (nodes[i].id != 'nodes-marker-1' && nodes[i].id != 'nodes-marker-2')\n                        {\n                            finalNodes.push(nodes[i]);\n                        }\n                    }\n\n                    this.selection.removeNodesMarkers();\n\n                    return finalNodes;\n\n                },\n                getNodesMarker: function(num)\n                {\n                    return $('<span id=\"nodes-marker-' + num + '\" class=\"redactor-nodes-marker\" data-verified=\"redactor\">' + this.opts.invisibleSpace + '</span>')[0];\n                },\n                setNodesMarker: function(range, node, type)\n                {\n                    try {\n                        range.collapse(type);\n                        range.insertNode(node);\n                    }\n                    catch (e) {}\n                },\n                removeNodesMarkers: function()\n                {\n                    $(document).find('span.redactor-nodes-marker').remove();\n                    this.$editor.find('span.redactor-nodes-marker').remove();\n                },\n                fromPoint: function(start, end)\n                {\n                    this.caret.setOffset(start, end);\n                },\n                wrap: function(tag)\n                {\n                    this.selection.get();\n\n                    if (this.range.collapsed) return false;\n\n                    var wrapper = document.createElement(tag);\n                    wrapper.appendChild(this.range.extractContents());\n                    this.range.insertNode(wrapper);\n\n                    return wrapper;\n                },\n                selectElement: function(node)\n                {\n                    this.caret.set(node, 0, node, 1);\n                },\n                selectAll: function()\n                {\n                    this.selection.get();\n                    this.range.selectNodeContents(this.$editor[0]);\n                    this.selection.addRange();\n                },\n                remove: function()\n                {\n                    this.selection.get();\n                    this.sel.removeAllRanges();\n                },\n                save: function()\n                {\n                    this.selection.createMarkers();\n                },\n                createMarkers: function()\n                {\n                    this.selection.get();\n\n                    var node1 = this.selection.getMarker(1);\n\n                    this.selection.setMarker(this.range, node1, true);\n\n                    if (this.range.collapsed === false)\n                    {\n                        var node2 = this.selection.getMarker(2);\n                        this.selection.setMarker(this.range, node2, false);\n                    }\n\n                    this.savedSel = this.$editor.html();\n                },\n                getMarker: function(num)\n                {\n                    if (typeof num == 'undefined') num = 1;\n\n                    return $('<span id=\"selection-marker-' + num + '\" class=\"redactor-selection-marker\"  data-verified=\"redactor\">' + this.opts.invisibleSpace + '</span>')[0];\n                },\n                getMarkerAsHtml: function(num)\n                {\n                    return this.utils.getOuterHtml(this.selection.getMarker(num));\n                },\n                setMarker: function(range, node, type)\n                {\n                    range = range.cloneRange();\n\n                    try {\n                        range.collapse(type);\n                        range.insertNode(node);\n                    }\n                    catch (e)\n                    {\n                        this.focus.setStart();\n                    }\n                },\n                restore: function()\n                {\n                    var node1 = this.$editor.find('span#selection-marker-1');\n                    var node2 = this.$editor.find('span#selection-marker-2');\n\n                    if (node1.length !== 0 && node2.length !== 0)\n                    {\n                        this.caret.set(node1, 0, node2, 0);\n                    }\n                    else if (node1.length !== 0)\n                    {\n                        this.caret.set(node1, 0, node1, 0);\n                    }\n                    else\n                    {\n                        this.$editor.focus();\n                    }\n\n                    this.selection.removeMarkers();\n                    this.savedSel = false;\n\n                },\n                removeMarkers: function()\n                {\n                    this.$editor.find('span.redactor-selection-marker').each(function(i,s)\n                    {\n                        var text = $(s).text().replace(/[\\u200B-\\u200D\\uFEFF]/g, '');\n                        if (text === '') $(s).remove();\n                        else $(s).replaceWith(function() { return $(this).contents(); });\n                    });\n                },\n                getText: function()\n                {\n                    this.selection.get();\n\n                    return this.sel.toString();\n                },\n                getHtml: function()\n                {\n                    var html = '';\n\n                    this.selection.get();\n                    if (this.sel.rangeCount)\n                    {\n                        var container = document.createElement('div');\n                        var len = this.sel.rangeCount;\n                        for (var i = 0; i < len; ++i)\n                        {\n                            container.appendChild(this.sel.getRangeAt(i).cloneContents());\n                        }\n\n                        html = container.innerHTML;\n                    }\n\n                    return this.clean.onSync(html);\n                },\n                replaceWithHtml: function(html)\n                {\n                    html = this.selection.getMarkerAsHtml(1) + html + this.selection.getMarkerAsHtml(2);\n\n                    this.selection.get();\n\n                    if (window.getSelection && window.getSelection().getRangeAt)\n                    {\n                        this.range.deleteContents();\n                        var div = document.createElement(\"div\");\n                        div.innerHTML = html;\n\n                        var frag = document.createDocumentFragment(), child;\n                        while ((child = div.firstChild))\n                        {\n                            frag.appendChild(child);\n                        }\n\n                        this.range.insertNode(frag);\n                    }\n                    else if (document.selection && document.selection.createRange)\n                    {\n                        this.range.pasteHTML(html);\n                    }\n\n                    this.selection.restore();\n                    this.code.sync();\n                }\n            };\n        },\n        shortcuts: function()\n        {\n            return {\n                init: function(e, key)\n                {\n                    // disable browser's hot keys for bold and italic\n                    if (!this.opts.shortcuts)\n                    {\n                        if ((e.ctrlKey || e.metaKey) && (key === 66 || key === 73)) e.preventDefault();\n                        return false;\n                    }\n\n                    $.each(this.opts.shortcuts, $.proxy(function(str, command)\n                    {\n                        var keys = str.split(',');\n                        var len = keys.length;\n                        for (var i = 0; i < len; i++)\n                        {\n                            if (typeof keys[i] === 'string')\n                            {\n                                this.shortcuts.handler(e, $.trim(keys[i]), $.proxy(function()\n                                {\n                                    var func;\n                                    if (command.func.search(/\\./) != '-1')\n                                    {\n                                        func = command.func.split('.');\n                                        if (typeof this[func[0]] != 'undefined')\n                                        {\n                                            this[func[0]][func[1]].apply(this, command.params);\n                                        }\n                                    }\n                                    else\n                                    {\n                                        this[command.func].apply(this, command.params);\n                                    }\n\n                                }, this));\n                            }\n\n                        }\n\n                    }, this));\n                },\n                handler: function(e, keys, origHandler)\n                {\n                    // based on https://github.com/jeresig/jquery.hotkeys\n                    var hotkeysSpecialKeys =\n                    {\n                        8: \"backspace\", 9: \"tab\", 10: \"return\", 13: \"return\", 16: \"shift\", 17: \"ctrl\", 18: \"alt\", 19: \"pause\",\n                        20: \"capslock\", 27: \"esc\", 32: \"space\", 33: \"pageup\", 34: \"pagedown\", 35: \"end\", 36: \"home\",\n                        37: \"left\", 38: \"up\", 39: \"right\", 40: \"down\", 45: \"insert\", 46: \"del\", 59: \";\", 61: \"=\",\n                        96: \"0\", 97: \"1\", 98: \"2\", 99: \"3\", 100: \"4\", 101: \"5\", 102: \"6\", 103: \"7\",\n                        104: \"8\", 105: \"9\", 106: \"*\", 107: \"+\", 109: \"-\", 110: \".\", 111 : \"/\",\n                        112: \"f1\", 113: \"f2\", 114: \"f3\", 115: \"f4\", 116: \"f5\", 117: \"f6\", 118: \"f7\", 119: \"f8\",\n                        120: \"f9\", 121: \"f10\", 122: \"f11\", 123: \"f12\", 144: \"numlock\", 145: \"scroll\", 173: \"-\", 186: \";\", 187: \"=\",\n                        188: \",\", 189: \"-\", 190: \".\", 191: \"/\", 192: \"`\", 219: \"[\", 220: \"\\\\\", 221: \"]\", 222: \"'\"\n                    };\n\n\n                    var hotkeysShiftNums =\n                    {\n                        \"`\": \"~\", \"1\": \"!\", \"2\": \"@\", \"3\": \"#\", \"4\": \"$\", \"5\": \"%\", \"6\": \"^\", \"7\": \"&\",\n                        \"8\": \"*\", \"9\": \"(\", \"0\": \")\", \"-\": \"_\", \"=\": \"+\", \";\": \": \", \"'\": \"\\\"\", \",\": \"<\",\n                        \".\": \">\",  \"/\": \"?\",  \"\\\\\": \"|\"\n                    };\n\n                    keys = keys.toLowerCase().split(\" \");\n                    var special = hotkeysSpecialKeys[e.keyCode],\n                        character = String.fromCharCode( e.which ).toLowerCase(),\n                        modif = \"\", possible = {};\n\n                    $.each([ \"alt\", \"ctrl\", \"meta\", \"shift\"], function(index, specialKey)\n                    {\n                        if (e[specialKey + 'Key'] && special !== specialKey)\n                        {\n                            modif += specialKey + '+';\n                        }\n                    });\n\n\n                    if (special) possible[modif + special] = true;\n                    if (character)\n                    {\n                        possible[modif + character] = true;\n                        possible[modif + hotkeysShiftNums[character]] = true;\n\n                        // \"$\" can be triggered as \"Shift+4\" or \"Shift+$\" or just \"$\"\n                        if (modif === \"shift+\")\n                        {\n                            possible[hotkeysShiftNums[character]] = true;\n                        }\n                    }\n\n                    for (var i = 0, len = keys.length; i < len; i++)\n                    {\n                        if (possible[keys[i]])\n                        {\n                            e.preventDefault();\n                            return origHandler.apply(this, arguments);\n                        }\n                    }\n                }\n            };\n        },\n        tabifier: function()\n        {\n            return {\n                get: function(code)\n                {\n                    if (!this.opts.tabifier) return code;\n\n                    // clean setup\n                    var ownLine = ['area', 'body', 'head', 'hr', 'i?frame', 'link', 'meta', 'noscript', 'style', 'script', 'table', 'tbody', 'thead', 'tfoot'];\n                    var contOwnLine = ['li', 'dt', 'dt', 'h[1-6]', 'option', 'script'];\n                    var newLevel = ['p', 'blockquote', 'div', 'dl', 'fieldset', 'form', 'frameset', 'map', 'ol', 'pre', 'select', 'td', 'th', 'tr', 'ul'];\n\n                    this.tabifier.lineBefore = new RegExp('^<(/?' + ownLine.join('|/?' ) + '|' + contOwnLine.join('|') + ')[ >]');\n                    this.tabifier.lineAfter = new RegExp('^<(br|/?' + ownLine.join('|/?' ) + '|/' + contOwnLine.join('|/') + ')[ >]');\n                    this.tabifier.newLevel = new RegExp('^</?(' + newLevel.join('|' ) + ')[ >]');\n\n                    var i = 0,\n                    codeLength = code.length,\n                    point = 0,\n                    start = null,\n                    end = null,\n                    tag = '',\n                    out = '',\n                    cont = '';\n\n                    this.tabifier.cleanlevel = 0;\n\n                    for (; i < codeLength; i++)\n                    {\n                        point = i;\n\n                        // if no more tags, copy and exit\n                        if (-1 == code.substr(i).indexOf( '<' ))\n                        {\n                            out += code.substr(i);\n\n                            return this.tabifier.finish(out);\n                        }\n\n                        // copy verbatim until a tag\n                        while (point < codeLength && code.charAt(point) != '<')\n                        {\n                            point++;\n                        }\n\n                        if (i != point)\n                        {\n                            cont = code.substr(i, point - i);\n                            if (!cont.match(/^\\s{2,}$/g))\n                            {\n                                if ('\\n' == out.charAt(out.length - 1)) out += this.tabifier.getTabs();\n                                else if ('\\n' == cont.charAt(0))\n                                {\n                                    out += '\\n' + this.tabifier.getTabs();\n                                    cont = cont.replace(/^\\s+/, '');\n                                }\n\n                                out += cont;\n                            }\n\n                            if (cont.match(/\\n/)) out += '\\n' + this.tabifier.getTabs();\n                        }\n\n                        start = point;\n\n                        // find the end of the tag\n                        while (point < codeLength && '>' != code.charAt(point))\n                        {\n                            point++;\n                        }\n\n                        tag = code.substr(start, point - start);\n                        i = point;\n\n                        var t;\n\n                        if ('!--' == tag.substr(1, 3))\n                        {\n                            if (!tag.match(/--$/))\n                            {\n                                while ('-->' != code.substr(point, 3))\n                                {\n                                    point++;\n                                }\n                                point += 2;\n                                tag = code.substr(start, point - start);\n                                i = point;\n                            }\n\n                            if ('\\n' != out.charAt(out.length - 1)) out += '\\n';\n\n                            out += this.tabifier.getTabs();\n                            out += tag + '>\\n';\n                        }\n                        else if ('!' == tag[1])\n                        {\n                            out = this.tabifier.placeTag(tag + '>', out);\n                        }\n                        else if ('?' == tag[1])\n                        {\n                            out += tag + '>\\n';\n                        }\n                        else if (t = tag.match(/^<(script|style|pre)/i))\n                        {\n                            t[1] = t[1].toLowerCase();\n                            tag = this.tabifier.cleanTag(tag);\n                            out = this.tabifier.placeTag(tag, out);\n                            end = String(code.substr(i + 1)).toLowerCase().indexOf('</' + t[1]);\n\n                            if (end)\n                            {\n                                cont = code.substr(i + 1, end);\n                                i += end;\n                                out += cont;\n                            }\n                        }\n                        else\n                        {\n                            tag = this.tabifier.cleanTag(tag);\n                            out = this.tabifier.placeTag(tag, out);\n                        }\n                    }\n\n                    return this.tabifier.finish(out);\n                },\n                getTabs: function()\n                {\n                    var s = '';\n                    for ( var j = 0; j < this.tabifier.cleanlevel; j++ )\n                    {\n                        s += '\\t';\n                    }\n\n                    return s;\n                },\n                finish: function(code)\n                {\n                    code = code.replace(/\\n\\s*\\n/g, '\\n');\n                    code = code.replace(/^[\\s\\n]*/, '');\n                    code = code.replace(/[\\s\\n]*$/, '');\n                    code = code.replace(/<script(.*?)>\\n<\\/script>/gi, '<script$1></script>');\n\n                    this.tabifier.cleanlevel = 0;\n\n                    return code;\n                },\n                cleanTag: function (tag)\n                {\n                    var tagout = '';\n                    tag = tag.replace(/\\n/g, ' ');\n                    tag = tag.replace(/\\s{2,}/g, ' ');\n                    tag = tag.replace(/^\\s+|\\s+$/g, ' ');\n\n                    var suffix = '';\n                    if (tag.match(/\\/$/))\n                    {\n                        suffix = '/';\n                        tag = tag.replace(/\\/+$/, '');\n                    }\n\n                    var m;\n                    while (m = /\\s*([^= ]+)(?:=((['\"']).*?\\3|[^ ]+))?/.exec(tag))\n                    {\n                        if (m[2]) tagout += m[1].toLowerCase() + '=' + m[2];\n                        else if (m[1]) tagout += m[1].toLowerCase();\n\n                        tagout += ' ';\n                        tag = tag.substr(m[0].length);\n                    }\n\n                    return tagout.replace(/\\s*$/, '') + suffix + '>';\n                },\n                placeTag: function (tag, out)\n                {\n                    var nl = tag.match(this.tabifier.newLevel);\n\n                    if (tag.match(this.tabifier.lineBefore) || nl)\n                    {\n                        out = out.replace(/\\s*$/, '');\n                        out += '\\n';\n                    }\n\n                    if (nl && '/' == tag.charAt(1)) this.tabifier.cleanlevel--;\n                    if ('\\n' == out.charAt(out.length - 1)) out += this.tabifier.getTabs();\n                    if (nl && '/' != tag.charAt(1)) this.tabifier.cleanlevel++;\n\n                    out += tag;\n\n                    if (tag.match(this.tabifier.lineAfter) || tag.match(this.tabifier.newLevel))\n                    {\n                        out = out.replace(/ *$/, '');\n                        //out += '\\n';\n                    }\n\n                    return out;\n                }\n            };\n        },\n        tidy: function()\n        {\n            return {\n                setupAllowed: function()\n                {\n                    if (this.opts.allowedTags) this.opts.deniedTags = false;\n                    if (this.opts.allowedAttr) this.opts.removeAttr = false;\n\n                    if (this.opts.linebreaks) return;\n\n                    var tags = ['p', 'section'];\n                    if (this.opts.allowedTags) this.tidy.addToAllowed(tags);\n                    if (this.opts.deniedTags) this.tidy.removeFromDenied(tags);\n\n                },\n                addToAllowed: function(tags)\n                {\n                    var len = tags.length;\n                    for (var i = 0; i < len; i++)\n                    {\n                        if ($.inArray(tags[i], this.opts.allowedTags) == -1)\n                        {\n                            this.opts.allowedTags.push(tags[i]);\n                        }\n                    }\n                },\n                removeFromDenied: function(tags)\n                {\n                    var len = tags.length;\n                    for (var i = 0; i < len; i++)\n                    {\n                        var pos = $.inArray(tags[i], this.opts.deniedTags);\n                        if (pos != -1)\n                        {\n                            this.opts.deniedTags.splice(pos, 1);\n                        }\n                    }\n                },\n                load: function(html, options)\n                {\n                    this.tidy.settings = {\n                        deniedTags: this.opts.deniedTags,\n                        allowedTags: this.opts.allowedTags,\n                        removeComments: this.opts.removeComments,\n                        replaceTags: this.opts.replaceTags,\n                        replaceStyles: this.opts.replaceStyles,\n                        removeDataAttr: this.opts.removeDataAttr,\n                        removeAttr: this.opts.removeAttr,\n                        allowedAttr: this.opts.allowedAttr,\n                        removeWithoutAttr: this.opts.removeWithoutAttr,\n                        removeEmpty: this.opts.removeEmpty\n                    };\n\n                    $.extend(this.tidy.settings, options);\n\n                    html = this.tidy.removeComments(html);\n\n                    // create container\n                    this.tidy.$div = $('<div />').append(html);\n\n                    // clean\n                    this.tidy.replaceTags();\n                    this.tidy.replaceStyles();\n                    this.tidy.removeTags();\n\n                    this.tidy.removeAttr();\n                    this.tidy.removeEmpty();\n                    this.tidy.removeParagraphsInLists();\n                    this.tidy.removeDataAttr();\n                    this.tidy.removeWithoutAttr();\n\n                    html = this.tidy.$div.html();\n                    this.tidy.$div.remove();\n\n                    return html;\n                },\n                removeComments: function(html)\n                {\n                    if (!this.tidy.settings.removeComments) return html;\n\n                    return html.replace(/<!--[\\s\\S]*?-->/gi, '');\n                },\n                replaceTags: function(html)\n                {\n                    if (!this.tidy.settings.replaceTags) return html;\n\n                    var len = this.tidy.settings.replaceTags.length;\n                    var replacement = [], rTags = [];\n                    for (var i = 0; i < len; i++)\n                    {\n                        rTags.push(this.tidy.settings.replaceTags[i][1]);\n                        replacement.push(this.tidy.settings.replaceTags[i][0]);\n                    }\n\n                    this.tidy.$div.find(replacement.join(',')).each($.proxy(function(n,s)\n                    {\n                        var tag = rTags[n];\n                        $(s).replaceWith(function()\n                        {\n                            var replaced = $('<' + tag + ' />').append($(this).contents());\n\n                            for (var i = 0; i < this.attributes.length; i++)\n                            {\n                                replaced.attr(this.attributes[i].name, this.attributes[i].value);\n                            }\n\n                            return replaced;\n                        });\n\n                    }, this));\n\n                    return html;\n                },\n                replaceStyles: function()\n                {\n                    if (!this.tidy.settings.replaceStyles) return;\n\n                    var len = this.tidy.settings.replaceStyles.length;\n                    this.tidy.$div.find('span').each($.proxy(function(n,s)\n                    {\n                        var $el = $(s);\n                        var style = $el.attr('style');\n                        for (var i = 0; i < len; i++)\n                        {\n                            if (style && style.match(new RegExp('^' + this.tidy.settings.replaceStyles[i][0], 'i')))\n                            {\n                                var tagName = this.tidy.settings.replaceStyles[i][1];\n                                $el.replaceWith(function()\n                                {\n                                    var tag = document.createElement(tagName);\n                                    return $(tag).append($(this).contents());\n                                });\n                            }\n                        }\n\n                    }, this));\n\n                },\n                removeTags: function()\n                {\n                    if (!this.tidy.settings.deniedTags && this.tidy.settings.allowedTags)\n                    {\n                        this.tidy.$div.find('*').not(this.tidy.settings.allowedTags.join(',')).each(function(i, s)\n                        {\n                            if (s.innerHTML === '') $(s).remove();\n                            else $(s).contents().unwrap();\n                        });\n                    }\n\n                    if (this.tidy.settings.deniedTags)\n                    {\n                        this.tidy.$div.find(this.tidy.settings.deniedTags.join(',')).each(function(i, s)\n                        {\n                            if (s.innerHTML === '') $(s).remove();\n                            else $(s).contents().unwrap();\n                        });\n                    }\n                },\n                removeAttr: function()\n                {\n                    var len;\n                    if (!this.tidy.settings.removeAttr && this.tidy.settings.allowedAttr)\n                    {\n\n                        var allowedAttrTags = [], allowedAttrData = [];\n                        len = this.tidy.settings.allowedAttr.length;\n                        for (var i = 0; i < len; i++)\n                        {\n                            allowedAttrTags.push(this.tidy.settings.allowedAttr[i][0]);\n                            allowedAttrData.push(this.tidy.settings.allowedAttr[i][1]);\n                        }\n\n\n                        this.tidy.$div.find('*').each($.proxy(function(n,s)\n                        {\n                            var $el = $(s);\n                            var pos = $.inArray($el[0].tagName.toLowerCase(), allowedAttrTags);\n                            var attributesRemove = this.tidy.removeAttrGetRemoves(pos, allowedAttrData, $el);\n\n                            if (attributesRemove)\n                            {\n                                $.each(attributesRemove, function(z,f) {\n                                    $el.removeAttr(f);\n                                });\n                            }\n                        }, this));\n                    }\n\n                    if (this.tidy.settings.removeAttr)\n                    {\n                        len = this.tidy.settings.removeAttr.length;\n                        for (var i = 0; i < len; i++)\n                        {\n                            var attrs = this.tidy.settings.removeAttr[i][1];\n                            if ($.isArray(attrs)) attrs = attrs.join(' ');\n\n                            this.tidy.$div.find(this.tidy.settings.removeAttr[i][0]).removeAttr(attrs);\n                        }\n                    }\n\n                },\n                removeAttrGetRemoves: function(pos, allowed, $el)\n                {\n                    var attributesRemove = [];\n\n                    // remove all attrs\n                    if (pos == -1)\n                    {\n                        $.each($el[0].attributes, function(i, item)\n                        {\n                            attributesRemove.push(item.name);\n                        });\n\n                    }\n                    // allow all attrs\n                    else if (allowed[pos] == '*')\n                    {\n                        attributesRemove = [];\n                    }\n                    // allow specific attrs\n                    else\n                    {\n                        $.each($el[0].attributes, function(i, item)\n                        {\n                            if ($.isArray(allowed[pos]))\n                            {\n                                if ($.inArray(item.name, allowed[pos]) == -1)\n                                {\n                                    attributesRemove.push(item.name);\n                                }\n                            }\n                            else if (allowed[pos] != item.name)\n                            {\n                                attributesRemove.push(item.name);\n                            }\n\n                        });\n                    }\n\n                    return attributesRemove;\n                },\n                removeAttrs: function (el, regex)\n                {\n                    regex = new RegExp(regex, \"g\");\n                    return el.each(function()\n                    {\n                        var self = $(this);\n                        var len = this.attributes.length - 1;\n                        for (var i = len; i >= 0; i--)\n                        {\n                            var item = this.attributes[i];\n                            if (item && item.specified && item.name.search(regex)>=0)\n                            {\n                                self.removeAttr(item.name);\n                            }\n                        }\n                    });\n                },\n                removeEmpty: function()\n                {\n                    if (!this.tidy.settings.removeEmpty) return;\n\n                    this.tidy.$div.find(this.tidy.settings.removeEmpty.join(',')).each(function()\n                    {\n                        var $el = $(this);\n                        var text = $el.text();\n                        text = text.replace(/[\\u200B-\\u200D\\uFEFF]/g, '');\n                        text = text.replace(/&nbsp;/gi, '');\n                        text = text.replace(/\\s/g, '');\n\n                        if (text === '' && $el.children().length === 0)\n                        {\n                            $el.remove();\n                        }\n                    });\n                },\n                removeParagraphsInLists: function()\n                {\n                    this.tidy.$div.find('li p').contents().unwrap();\n                },\n                removeDataAttr: function()\n                {\n                    if (!this.tidy.settings.removeDataAttr) return;\n\n                    var tags = this.tidy.settings.removeDataAttr;\n                    if ($.isArray(this.tidy.settings.removeDataAttr)) tags = this.tidy.settings.removeDataAttr.join(',');\n\n                    this.tidy.removeAttrs(this.tidy.$div.find(tags), '^(data-)');\n\n                },\n                removeWithoutAttr: function()\n                {\n                    if (!this.tidy.settings.removeWithoutAttr) return;\n\n                    this.tidy.$div.find(this.tidy.settings.removeWithoutAttr.join(',')).each(function()\n                    {\n                        if (this.attributes.length === 0)\n                        {\n                            $(this).contents().unwrap();\n                        }\n                    });\n                }\n            };\n        },\n        toolbar: function()\n        {\n            return {\n                init: function()\n                {\n                    return {\n                        html:\n                        {\n                            title: this.lang.get('html'),\n                            func: 'code.toggle'\n                        },\n                        formatting:\n                        {\n                            title: this.lang.get('formatting'),\n                            dropdown:\n                            {\n                                p:\n                                {\n                                    title: this.lang.get('paragraph'),\n                                    func: 'block.format'\n                                },\n                                blockquote:\n                                {\n                                    title: this.lang.get('quote'),\n                                    func: 'block.format'\n                                },\n                                pre:\n                                {\n                                    title: this.lang.get('code'),\n                                    func: 'block.format'\n                                },\n                                h1:\n                                {\n                                    title: this.lang.get('header1'),\n                                    func: 'block.format'\n                                },\n                                h2:\n                                {\n                                    title: this.lang.get('header2'),\n                                    func: 'block.format'\n                                },\n                                h3:\n                                {\n                                    title: this.lang.get('header3'),\n                                    func: 'block.format'\n                                },\n                                h4:\n                                {\n                                    title: this.lang.get('header4'),\n                                    func: 'block.format'\n                                },\n                                h5:\n                                {\n                                    title: this.lang.get('header5'),\n                                    func: 'block.format'\n                                },\n                                sup:\n                                {\n                                    title: 'Superscript',\n                                    func: 'inline.format'\n                                },\n                                sub:\n                                {\n                                    title: 'Subscript',\n                                    func: 'inline.format'\n                                },\n                                small:\n                                {\n                                    title: 'Small text',\n                                    func: 'inline.format'\n                                }\n                            }\n                        },\n                        bold:\n                        {\n                            title: this.lang.get('bold'),\n                            func: 'inline.format'\n                        },\n                        italic:\n                        {\n                            title: this.lang.get('italic'),\n                            func: 'inline.format'\n                        },\n                        deleted:\n                        {\n                            title: this.lang.get('deleted'),\n                            func: 'inline.format'\n                        },\n                        underline:\n                        {\n                            title: this.lang.get('underline'),\n                            func: 'inline.format'\n                        },\n                        unorderedlist:\n                        {\n                            title: '&bull; ' + this.lang.get('unorderedlist'),\n                            func: 'list.toggle'\n                        },\n                        orderedlist:\n                        {\n                            title: '1. ' + this.lang.get('orderedlist'),\n                            func: 'list.toggle'\n                        },\n                        outdent:\n                        {\n                            title: '< ' + this.lang.get('outdent'),\n                            func: 'indent.decrease'\n                        },\n                        indent:\n                        {\n                            title: '> ' + this.lang.get('indent'),\n                            func: 'indent.increase'\n                        },\n                        image:\n                        {\n                            title: this.lang.get('image'),\n                            func: 'image.show'\n                        },\n                        file:\n                        {\n                            title: this.lang.get('file'),\n                            func: 'file.show'\n                        },\n                        link:\n                        {\n                            title: this.lang.get('link'),\n                            dropdown:\n                            {\n                                link:\n                                {\n                                    title: this.lang.get('link_insert'),\n                                    func: 'link.show'\n                                },\n                                unlink:\n                                {\n                                    title: this.lang.get('unlink'),\n                                    func: 'link.unlink'\n                                }\n                            }\n                        },\n                        alignment:\n                        {\n                            title: this.lang.get('alignment'),\n                            dropdown:\n                            {\n                                left:\n                                {\n                                    title: this.lang.get('align_left'),\n                                    func: 'alignment.left'\n                                },\n                                center:\n                                {\n                                    title: this.lang.get('align_center'),\n                                    func: 'alignment.center'\n                                },\n                                right:\n                                {\n                                    title: this.lang.get('align_right'),\n                                    func: 'alignment.right'\n                                },\n                                justify:\n                                {\n                                    title: this.lang.get('align_justify'),\n                                    func: 'alignment.justify'\n                                }\n                            }\n                        },\n                        horizontalrule:\n                        {\n                            title: this.lang.get('horizontalrule'),\n                            func: 'line.insert'\n                        }\n                    };\n                },\n                build: function()\n                {\n                    this.toolbar.hideButtons();\n                    this.toolbar.hideButtonsOnMobile();\n                    this.toolbar.isButtonSourceNeeded();\n\n                    if (this.opts.buttons.length === 0) return;\n\n                    this.$toolbar = this.toolbar.createContainer();\n\n                    this.toolbar.setOverflow();\n                    this.toolbar.append();\n                    this.toolbar.setFormattingTags();\n                    this.toolbar.loadButtons();\n                    this.toolbar.setFixed();\n\n                    // buttons response\n                    if (this.opts.activeButtons)\n                    {\n                        this.$editor.on('mouseup.redactor keyup.redactor focus.redactor', $.proxy(this.observe.buttons, this));\n                    }\n\n                },\n                createContainer: function()\n                {\n                    return $('<ul>').addClass('redactor-toolbar').attr('id', 'redactor-toolbar-' + this.uuid);\n                },\n                setFormattingTags: function()\n                {\n                    $.each(this.opts.toolbar.formatting.dropdown, $.proxy(function (i, s)\n                    {\n                        if ($.inArray(i, this.opts.formatting) == -1) delete this.opts.toolbar.formatting.dropdown[i];\n                    }, this));\n\n                },\n                loadButtons: function()\n                {\n                    $.each(this.opts.buttons, $.proxy(function(i, btnName)\n                    {\n                        if (!this.opts.toolbar[btnName]) return;\n\n                        if (btnName === 'file')\n                        {\n                             if (this.opts.fileUpload === false) return;\n                             else if (!this.opts.fileUpload && this.opts.s3 === false) return;\n                        }\n\n                        if (btnName === 'image')\n                        {\n                             if (this.opts.imageUpload === false) return;\n                             else if (!this.opts.imageUpload && this.opts.s3 === false) return;\n                        }\n\n                        var btnObject = this.opts.toolbar[btnName];\n                        this.$toolbar.append($('<li>').append(this.button.build(btnName, btnObject)));\n\n                    }, this));\n                },\n                append: function()\n                {\n                    if (this.opts.toolbarExternal)\n                    {\n                        this.$toolbar.addClass('redactor-toolbar-external');\n                        $(this.opts.toolbarExternal).html(this.$toolbar);\n                    }\n                    else\n                    {\n                        this.$box.prepend(this.$toolbar);\n                    }\n                },\n                setFixed: function()\n                {\n                    if (!this.utils.isDesktop()) return;\n                    if (this.opts.toolbarExternal) return;\n                    if (!this.opts.toolbarFixed) return;\n\n                    this.toolbar.observeScroll();\n                    $(this.opts.toolbarFixedTarget).on('scroll.redactor.' + this.uuid, $.proxy(this.toolbar.observeScroll, this));\n\n                },\n                setOverflow: function()\n                {\n                    if (this.utils.isMobile() && this.opts.toolbarOverflow)\n                    {\n                        this.$toolbar.addClass('redactor-toolbar-overflow');\n                    }\n                },\n                isButtonSourceNeeded: function()\n                {\n                    if (this.opts.source) return;\n\n                    var index = this.opts.buttons.indexOf('html');\n                    if (index !== -1)\n                    {\n                        this.opts.buttons.splice(index, 1);\n                    }\n                },\n                hideButtons: function()\n                {\n                    if (this.opts.buttonsHide.length === 0) return;\n\n                    $.each(this.opts.buttonsHide, $.proxy(function(i, s)\n                    {\n                        var index = this.opts.buttons.indexOf(s);\n                        this.opts.buttons.splice(index, 1);\n\n                    }, this));\n                },\n                hideButtonsOnMobile: function()\n                {\n                    if (!this.utils.isMobile() || this.opts.buttonsHideOnMobile.length === 0) return;\n\n                    $.each(this.opts.buttonsHideOnMobile, $.proxy(function(i, s)\n                    {\n                        var index = this.opts.buttons.indexOf(s);\n                        this.opts.buttons.splice(index, 1);\n\n                    }, this));\n                },\n                observeScroll: function()\n                {\n                    var scrollTop = $(this.opts.toolbarFixedTarget).scrollTop();\n                    var boxTop = 1;\n\n                    if (this.opts.toolbarFixedTarget === document)\n                    {\n                        boxTop = this.$box.offset().top;\n                    }\n\n                    if (scrollTop > boxTop)\n                    {\n                        this.toolbar.observeScrollEnable(scrollTop, boxTop);\n                    }\n                    else\n                    {\n                        this.toolbar.observeScrollDisable();\n                    }\n                },\n                observeScrollEnable: function(scrollTop, boxTop)\n                {\n                    var top = this.opts.toolbarFixedTopOffset + scrollTop - boxTop + 50;\n                    var left = 0;\n                    var end = boxTop + this.$box.height() - 32;\n                    var width = this.$box.innerWidth();\n\n                    this.$toolbar.addClass('toolbar-fixed-box');\n                    this.$toolbar.css({\n                        position: 'absolute',\n                        width: width,\n                        top: top + 'px',\n                        left: left\n                    });\n\n                    this.toolbar.setDropdownsFixed();\n                    this.$toolbar.css('visibility', (scrollTop < end) ? 'visible' : 'hidden');\n                },\n                observeScrollDisable: function()\n                {\n                    this.$toolbar.css({\n                        position: 'relative',\n                        width: 'auto',\n                        top: 0,\n                        left: 0,\n                        visibility: 'visible'\n                    });\n\n                    this.toolbar.unsetDropdownsFixed();\n                    this.$toolbar.removeClass('toolbar-fixed-box');\n\n\n                },\n                setDropdownsFixed: function()\n                {\n                    var top = this.$toolbar.innerHeight() + this.opts.toolbarFixedTopOffset;\n                    var position = 'fixed';\n                    if (this.opts.toolbarFixedTarget !== document)\n                    {\n                        top = (this.$toolbar.innerHeight() + this.$toolbar.offset().top) + this.opts.toolbarFixedTopOffset;\n                        position = 'absolute';\n                    }\n\n                    $('.redactor-dropdown-' + this.uuid).each(function()\n                    {\n                        $(this).css({ position: position, top: top + 'px' });\n                    });\n                },\n                unsetDropdownsFixed: function()\n                {\n                    var top = (this.$toolbar.innerHeight() + this.$toolbar.offset().top);\n                    $('.redactor-dropdown-' + this.uuid).each(function()\n                    {\n                        $(this).css({ position: 'absolute', top: top + 'px' });\n                    });\n                }\n            };\n        },\n        upload: function()\n        {\n            return {\n                init: function(id, url, callback)\n                {\n                    this.upload.direct = false;\n                    this.upload.callback = callback;\n                    this.upload.url = url;\n                    this.upload.$el = $(id);\n                    this.upload.$droparea = $('<div id=\"redactor-droparea\" />');\n\n                    this.upload.$placeholdler = $('<div id=\"redactor-droparea-placeholder\" />').text(this.lang.get('upload_label'));\n                    this.upload.$input = $('<input type=\"file\" name=\"file\" />');\n\n                    this.upload.$placeholdler.append(this.upload.$input);\n                    this.upload.$droparea.append(this.upload.$placeholdler);\n                    this.upload.$el.append(this.upload.$droparea);\n\n                    this.upload.$droparea.off('redactor.upload');\n                    this.upload.$input.off('redactor.upload');\n\n                    this.upload.$droparea.on('dragover.redactor.upload', $.proxy(this.upload.onDrag, this));\n                    this.upload.$droparea.on('dragleave.redactor.upload', $.proxy(this.upload.onDragLeave, this));\n\n                    // change\n                    this.upload.$input.on('change.redactor.upload', $.proxy(function(e)\n                    {\n                        e = e.originalEvent || e;\n                        this.upload.traverseFile(this.upload.$input[0].files[0], e);\n                    }, this));\n\n                    // drop\n                    this.upload.$droparea.on('drop.redactor.upload', $.proxy(function(e)\n                    {\n                        e.preventDefault();\n\n                        this.upload.$droparea.removeClass('drag-hover').addClass('drag-drop');\n                        this.upload.onDrop(e);\n\n                    }, this));\n                },\n                directUpload: function(file, e)\n                {\n                    this.upload.direct = true;\n                    this.upload.traverseFile(file, e);\n                },\n                onDrop: function(e)\n                {\n                    e = e.originalEvent || e;\n                    var files = e.dataTransfer.files;\n\n                    this.upload.traverseFile(files[0], e);\n                },\n                traverseFile: function(file, e)\n                {\n                    if (this.opts.s3)\n                    {\n                        this.upload.setConfig(file);\n                        this.upload.s3uploadFile(file);\n                        return;\n                    }\n\n                    var formData = !!window.FormData ? new FormData() : null;\n                    if (window.FormData)\n                    {\n                        this.upload.setConfig(file);\n\n                        var name = (this.upload.type == 'image') ? this.opts.imageUploadParam : this.opts.fileUploadParam;\n                        formData.append(name, file);\n                    }\n\n                    this.progress.show();\n                    this.core.setCallback('uploadStart', e, formData);\n                    this.upload.sendData(formData, e);\n                },\n                setConfig: function(file)\n                {\n                    this.upload.getType(file);\n\n                    if (this.upload.direct)\n                    {\n                        this.upload.url = (this.upload.type == 'image') ? this.opts.imageUpload : this.opts.fileUpload;\n                        this.upload.callback = (this.upload.type == 'image') ? this.image.insert : this.file.insert;\n                    }\n                },\n                getType: function(file)\n                {\n                    this.upload.type = 'image';\n                    if (this.opts.imageTypes.indexOf(file.type) == -1)\n                    {\n                        this.upload.type = 'file';\n                    }\n                },\n                getHiddenFields: function(obj, fd)\n                {\n                    if (obj === false || typeof obj !== 'object') return fd;\n\n                    $.each(obj, $.proxy(function(k, v)\n                    {\n                        if (v !== null && v.toString().indexOf('#') === 0) v = $(v).val();\n                        fd.append(k, v);\n\n                    }, this));\n\n                    return fd;\n\n                },\n                sendData: function(formData, e)\n                {\n                    // append hidden fields\n                    if (this.upload.type == 'image')\n                    {\n                        formData = this.upload.getHiddenFields(this.opts.uploadImageFields, formData);\n                        formData = this.upload.getHiddenFields(this.upload.imageFields, formData);\n                    }\n                    else\n                    {\n                        formData = this.upload.getHiddenFields(this.opts.uploadFileFields, formData);\n                        formData = this.upload.getHiddenFields(this.upload.fileFields, formData);\n                    }\n\n                    var xhr = new XMLHttpRequest();\n                    xhr.open('POST', this.upload.url);\n\n                    // complete\n                    xhr.onreadystatechange = $.proxy(function()\n                    {\n                        if (xhr.readyState == 4)\n                        {\n                            var data = xhr.responseText;\n\n                            data = data.replace(/^\\[/, '');\n                            data = data.replace(/\\]$/, '');\n\n                            var json;\n                            try\n                            {\n                                json = (typeof data === 'string' ? $.parseJSON(data) : data);\n                            }\n                            catch(err)\n                            {\n                                json = {\n                                    error: true\n                                };\n                            }\n\n\n                            this.progress.hide();\n\n                            if (!this.upload.direct)\n                            {\n                                this.upload.$droparea.removeClass('drag-drop');\n                            }\n\n                            this.upload.callback(json, this.upload.direct, e);\n                        }\n                    }, this);\n\n\n                    /*\n                    xhr.upload.onprogress = $.proxy(function(e)\n                    {\n                        if (e.lengthComputable)\n                        {\n                            var complete = (e.loaded / e.total * 100 | 0);\n                            //progress.value = progress.innerHTML = complete;\n                        }\n\n                    }, this);\n                    */\n\n\n                    xhr.send(formData);\n                },\n                onDrag: function(e)\n                {\n                    e.preventDefault();\n                    this.upload.$droparea.addClass('drag-hover');\n                },\n                onDragLeave: function(e)\n                {\n                    e.preventDefault();\n                    this.upload.$droparea.removeClass('drag-hover');\n                },\n                clearImageFields: function()\n                {\n                    this.upload.imageFields = {};\n                },\n                addImageFields: function(name, value)\n                {\n                    this.upload.imageFields[name] = value;\n                },\n                removeImageFields: function(name)\n                {\n                    delete this.upload.imageFields[name];\n                },\n                clearFileFields: function()\n                {\n                    this.upload.fileFields = {};\n                },\n                addFileFields: function(name, value)\n                {\n                    this.upload.fileFields[name] = value;\n                },\n                removeFileFields: function(name)\n                {\n                    delete this.upload.fileFields[name];\n                },\n\n\n                // S3\n                s3uploadFile: function(file)\n                {\n                    this.upload.s3executeOnSignedUrl(file, $.proxy(function(signedURL)\n                    {\n                        this.upload.s3uploadToS3(file, signedURL);\n                    }, this));\n                },\n                s3executeOnSignedUrl: function(file, callback)\n                {\n                    var xhr = new XMLHttpRequest();\n\n                    var mark = '?';\n                    if (this.opts.s3.search(/\\?/) != '-1') mark = '&';\n\n                    xhr.open('GET', this.opts.s3 + mark + 'name=' + file.name + '&type=' + file.type, true);\n\n                    // Hack to pass bytes through unprocessed.\n                    if (xhr.overrideMimeType) xhr.overrideMimeType('text/plain; charset=x-user-defined');\n\n                    var that = this;\n                    xhr.onreadystatechange = function(e)\n                    {\n                        if (this.readyState == 4 && this.status == 200)\n                        {\n                            that.progress.show();\n                            callback(decodeURIComponent(this.responseText));\n                        }\n                        else if (this.readyState == 4 && this.status != 200)\n                        {\n                            //setProgress(0, 'Could not contact signing script. Status = ' + this.status);\n                        }\n                    };\n\n                    xhr.send();\n                },\n                s3createCORSRequest: function(method, url)\n                {\n                    var xhr = new XMLHttpRequest();\n                    if (\"withCredentials\" in xhr)\n                    {\n                        xhr.open(method, url, true);\n                    }\n                    else if (typeof XDomainRequest != \"undefined\")\n                    {\n                        xhr = new XDomainRequest();\n                        xhr.open(method, url);\n                    }\n                    else\n                    {\n                        xhr = null;\n                    }\n\n                    return xhr;\n                },\n                s3uploadToS3: function(file, url)\n                {\n                    var xhr = this.upload.s3createCORSRequest('PUT', url);\n                    if (!xhr)\n                    {\n                        //setProgress(0, 'CORS not supported');\n                    }\n                    else\n                    {\n                        xhr.onload = $.proxy(function()\n                        {\n                            if (xhr.status == 200)\n                            {\n                                //setProgress(100, 'Upload completed.');\n\n                                this.progress.hide();\n\n                                var s3file = url.split('?');\n\n                                if (!s3file[0])\n                                {\n                                     // url parsing is fail\n                                     return false;\n                                }\n\n\n                                if (!this.upload.direct)\n                                {\n                                    this.upload.$droparea.removeClass('drag-drop');\n                                }\n\n                                var json = { filelink: s3file[0] };\n                                if (this.upload.type == 'file')\n                                {\n                                    var arr = s3file[0].split('/');\n                                    json.filename = arr[arr.length-1];\n                                }\n\n                                this.upload.callback(json, this.upload.direct, false);\n\n\n                            }\n                            else\n                            {\n                                //setProgress(0, 'Upload error: ' + xhr.status);\n                            }\n                        }, this);\n\n                        xhr.onerror = function()\n                        {\n                            //setProgress(0, 'XHR error.');\n                        };\n\n                        xhr.upload.onprogress = function(e)\n                        {\n                            /*\n                            if (e.lengthComputable)\n                            {\n                                var percentLoaded = Math.round((e.loaded / e.total) * 100);\n                                setProgress(percentLoaded, percentLoaded == 100 ? 'Finalizing.' : 'Uploading.');\n                            }\n                            */\n                        };\n\n                        xhr.setRequestHeader('Content-Type', file.type);\n                        xhr.setRequestHeader('x-amz-acl', 'public-read');\n\n                        xhr.send(file);\n                    }\n                }\n            };\n        },\n        utils: function()\n        {\n            return {\n                isMobile: function()\n                {\n                    return /(iPhone|iPod|BlackBerry|Android)/.test(navigator.userAgent);\n                },\n                isDesktop: function()\n                {\n                    return !/(iPhone|iPod|iPad|BlackBerry|Android)/.test(navigator.userAgent);\n                },\n                isString: function(obj)\n                {\n                    return Object.prototype.toString.call(obj) == '[object String]';\n                },\n                isEmpty: function(html, removeEmptyTags)\n                {\n                    html = html.replace(/[\\u200B-\\u200D\\uFEFF]/g, '');\n                    html = html.replace(/&nbsp;/gi, '');\n                    html = html.replace(/<\\/?br\\s?\\/?>/g, '');\n                    html = html.replace(/\\s/g, '');\n                    html = html.replace(/^<p>[^\\W\\w\\D\\d]*?<\\/p>$/i, '');\n                    html = html.replace(/<iframe(.*?[^>])>$/i, 'iframe');\n                    html = html.replace(/<source(.*?[^>])>$/i, 'source');\n\n                    // remove empty tags\n                    if (removeEmptyTags !== false)\n                    {\n                        html = html.replace(/<[^\\/>][^>]*><\\/[^>]+>/gi, '');\n                        html = html.replace(/<[^\\/>][^>]*><\\/[^>]+>/gi, '');\n                    }\n\n                    html = $.trim(html);\n\n                    return html === '';\n                },\n                normalize: function(str)\n                {\n                    if (typeof(str) === 'undefined') return 0;\n                    return parseInt(str.replace('px',''), 10);\n                },\n                hexToRgb: function(hex)\n                {\n                    if (typeof hex == 'undefined') return;\n                    if (hex.search(/^#/) == -1) return hex;\n\n                    var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n                    hex = hex.replace(shorthandRegex, function(m, r, g, b)\n                    {\n                        return r + r + g + g + b + b;\n                    });\n\n                    var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n                    return 'rgb(' + parseInt(result[1], 16) + ', ' + parseInt(result[2], 16) + ', ' + parseInt(result[3], 16) + ')';\n                },\n                getOuterHtml: function(el)\n                {\n                    return $('<div>').append($(el).eq(0).clone()).html();\n                },\n                getAlignmentElement: function(el)\n                {\n                    if ($.inArray(el.tagName, this.opts.alignmentTags) !== -1)\n                    {\n                        return $(el);\n                    }\n                    else\n                    {\n                        return $(el).closest(this.opts.alignmentTags.toString().toLowerCase(), this.$editor[0]);\n                    }\n                },\n                removeEmptyAttr: function(el, attr)\n                {\n                    var $el = $(el);\n                    if (typeof $el.attr(attr) == 'undefined')\n                    {\n                        return true;\n                    }\n\n                    if ($el.attr(attr) === '')\n                    {\n                        $el.removeAttr(attr);\n                        return true;\n                    }\n\n                    return false;\n                },\n                removeEmpty: function(i, s)\n                {\n                    var $s = $(s);\n\n                    $s.find('.redactor-invisible-space').removeAttr('style').removeAttr('class');\n\n                    if ($s.find('hr, br, img, iframe, source').length !== 0) return;\n                    var text = $.trim($s.text());\n                    if (this.utils.isEmpty(text, false))\n                    {\n                        $s.remove();\n                    }\n                },\n\n                // save and restore scroll\n                saveScroll: function()\n                {\n                    this.saveEditorScroll = this.$editor.scrollTop();\n                    this.saveBodyScroll = $(window).scrollTop();\n\n                    if (this.opts.scrollTarget) this.saveTargetScroll = $(this.opts.scrollTarget).scrollTop();\n                },\n                restoreScroll: function()\n                {\n                    if (typeof this.saveScroll === 'undefined' && typeof this.saveBodyScroll === 'undefined') return;\n\n                    $(window).scrollTop(this.saveBodyScroll);\n                    this.$editor.scrollTop(this.saveEditorScroll);\n\n                    if (this.opts.scrollTarget) $(this.opts.scrollTarget).scrollTop(this.saveTargetScroll);\n                },\n\n                // get invisible space element\n                createSpaceElement: function()\n                {\n                    var space = document.createElement('span');\n                    space.className = 'redactor-invisible-space';\n                    space.innerHTML = this.opts.invisibleSpace;\n\n                    return space;\n                },\n\n                // replace\n                removeInlineTags: function(node)\n                {\n                    var tags = this.opts.inlineTags;\n                    tags.push('span');\n\n                    if (node.tagName == 'PRE') tags.push('a');\n\n                    $(node).find(tags.join(',')).not('span.redactor-selection-marker').contents().unwrap();\n                },\n                replaceWithContents: function(node, removeInlineTags)\n                {\n                    var self = this;\n                    $(node).replaceWith(function()\n                    {\n                        if (removeInlineTags === true) self.utils.removeInlineTags(this);\n\n                        return $(this).contents();\n                    });\n\n                    return $(node);\n                },\n                replaceToTag: function(node, tag, removeInlineTags)\n                {\n                    var replacement;\n                    var self = this;\n                    $(node).replaceWith(function()\n                    {\n                        replacement = $('<' + tag + ' />').append($(this).contents());\n\n                        for (var i = 0; i < this.attributes.length; i++)\n                        {\n                            replacement.attr(this.attributes[i].name, this.attributes[i].value);\n                        }\n\n                        if (removeInlineTags === true) self.utils.removeInlineTags(replacement);\n\n                        return replacement;\n                    });\n\n                    return replacement;\n                },\n\n                // start and end of element\n                isStartOfElement: function()\n                {\n                    var block = this.selection.getBlock();\n                    if (!block) return false;\n\n                    var offset = this.caret.getOffsetOfElement(block);\n\n                    return (offset === 0) ? true : false;\n                },\n                isEndOfElement: function(element)\n                {\n                    if (typeof element == 'undefined')\n                    {\n                        var element = this.selection.getBlock();\n                        if (!element) return false;\n                    }\n\n                    var offset = this.caret.getOffsetOfElement(element);\n                    var text = $.trim($(element).text()).replace(/\\n\\r\\n/g, '');\n\n                    return (offset == text.length) ? true : false;\n                },\n                isEndOfEditor: function()\n                {\n                    var block = this.$editor[0];\n\n                    var offset = this.caret.getOffsetOfElement(block);\n                    var text = $.trim($(block).html().replace(/(<([^>]+)>)/gi,''));\n\n                    return (offset == text.length) ? true : false;\n                },\n\n                // test blocks\n                isBlock: function(block)\n                {\n                    block = block[0] || block;\n\n                    return block && this.utils.isBlockTag(block.tagName);\n                },\n                isBlockTag: function(tag)\n                {\n                    if (typeof tag == 'undefined') return false;\n\n                    return this.reIsBlock.test(tag);\n                },\n\n                // tag detection\n                isTag: function(current, tag)\n                {\n                    var element = $(current).closest(tag);\n                    if (element.length == 1)\n                    {\n                        return element[0];\n                    }\n\n                    return false;\n                },\n\n                // select all\n                isSelectAll: function()\n                {\n                    return this.selectAll;\n                },\n                enableSelectAll: function()\n                {\n                    this.selectAll = true;\n                },\n                disableSelectAll: function()\n                {\n                    this.selectAll = false;\n                },\n\n                // parents detection\n                isRedactorParent: function(el)\n                {\n                    if (!el)\n                    {\n                        return false;\n                    }\n\n                    if ($(el).parents('.redactor-editor').length === 0 || $(el).hasClass('redactor-editor'))\n                    {\n                        return false;\n                    }\n\n                    return el;\n                },\n                isCurrentOrParentHeader: function()\n                {\n                    return this.utils.isCurrentOrParent(['H1', 'H2', 'H3', 'H4', 'H5', 'H6']);\n                },\n                isCurrentOrParent: function(tagName)\n                {\n                    var parent = this.selection.getParent();\n                    var current = this.selection.getCurrent();\n\n                    if ($.isArray(tagName))\n                    {\n                        var matched = 0;\n                        $.each(tagName, $.proxy(function(i, s)\n                        {\n                            if (this.utils.isCurrentOrParentOne(current, parent, s))\n                            {\n                                matched++;\n                            }\n                        }, this));\n\n                        return (matched === 0) ? false : true;\n                    }\n                    else\n                    {\n                        return this.utils.isCurrentOrParentOne(current, parent, tagName);\n                    }\n                },\n                isCurrentOrParentOne: function(current, parent, tagName)\n                {\n                    tagName = tagName.toUpperCase();\n\n                    return parent && parent.tagName === tagName ? parent : current && current.tagName === tagName ? current : false;\n                },\n\n\n                // browsers detection\n                isOldIe: function()\n                {\n                    return (this.utils.browser('msie') && parseInt(this.utils.browser('version'), 10) < 9) ? true : false;\n                },\n                isLessIe10: function()\n                {\n                    return (this.utils.browser('msie') && parseInt(this.utils.browser('version'), 10) < 10) ? true : false;\n                },\n                isIe11: function()\n                {\n                    return !!navigator.userAgent.match(/Trident\\/7\\./);\n                },\n                browser: function(browser)\n                {\n                    var ua = navigator.userAgent.toLowerCase();\n                    var match = /(opr)[\\/]([\\w.]+)/.exec( ua ) ||\n                    /(chrome)[ \\/]([\\w.]+)/.exec( ua ) ||\n                    /(webkit)[ \\/]([\\w.]+).*(safari)[ \\/]([\\w.]+)/.exec(ua) ||\n                    /(webkit)[ \\/]([\\w.]+)/.exec( ua ) ||\n                    /(opera)(?:.*version|)[ \\/]([\\w.]+)/.exec( ua ) ||\n                    /(msie) ([\\w.]+)/.exec( ua ) ||\n                    ua.indexOf(\"trident\") >= 0 && /(rv)(?::| )([\\w.]+)/.exec( ua ) ||\n                    ua.indexOf(\"compatible\") < 0 && /(mozilla)(?:.*? rv:([\\w.]+)|)/.exec( ua ) ||\n                    [];\n\n                    if (browser == 'safari') return (typeof match[3] != 'undefined') ? match[3] == 'safari' : false;\n                    if (browser == 'version') return match[2];\n                    if (browser == 'webkit') return (match[1] == 'chrome' || match[1] == 'opr' || match[1] == 'webkit');\n                    if (match[1] == 'rv') return browser == 'msie';\n                    if (match[1] == 'opr') return browser == 'webkit';\n\n                    return browser == match[1];\n                }\n            };\n        }\n    };\n\n    $(window).on('load.tools.redactor', function()\n    {\n        $('[data-tools=\"redactor\"]').redactor();\n    });\n\n    // constructor\n    Redactor.prototype.init.prototype = Redactor.prototype;\n\n    // LINKIFY\n    $.Redactor.fn.formatLinkify = function(protocol, convertLinks, convertUrlLinks, convertImageLinks, convertVideoLinks, linkSize)\n    {\n        var urlCheck = '((?:http[s]?:\\\\/\\\\/(?:www\\\\.)?|www\\\\.){1}(?:[0-9A-Za-z\\\\-%_]+\\\\.)+[a-zA-Z]{2,}(?::[0-9]+)?(?:(?:/[0-9A-Za-z\\\\-#\\\\.%\\+_]*)+)?(?:\\\\?(?:[0-9A-Za-z\\\\-\\\\.%_]+(?:=[0-9A-Za-z\\\\-\\\\.%_\\\\+]*)?)?(?:&(?:[0-9A-Za-z\\\\-\\\\.%_]+(?:=[0-9A-Za-z\\\\-\\\\.%_\\\\+]*)?)?)*)?(?:#[0-9A-Za-z\\\\-\\\\.%_\\\\+=\\\\?&;]*)?)';\n        var regex = new RegExp(urlCheck, 'gi');\n        var rProtocol = /(https?|ftp):\\/\\//i;\n        var urlImage = new RegExp('(?:([^:/?#]+):)?(?:\\/\\/([^/?#]*))?([^?#]*\\\\.(?:jpg|gif|png))(?:\\\\?([^#]*))?(?:#(.*))?', 'gi');\n\n        var childNodes = (this.$editor ? this.$editor[0] : this).childNodes, i = childNodes.length;\n        while (i--)\n        {\n            var n = childNodes[i];\n\n            if (n.nodeType === 3 && n.parentNode !== 'PRE')\n            {\n                var html = n.nodeValue;\n\n                // youtube & vimeo\n                if (convertVideoLinks && html)\n                {\n                    var iframeStart = '<iframe width=\"500\" height=\"281\" src=\"',\n                        iframeEnd = '\" frameborder=\"0\" allowfullscreen></iframe>';\n\n                    if (html.match(reUrlYoutube))\n                    {\n                        html = html.replace(reUrlYoutube, iframeStart + '//www.youtube.com/embed/$1' + iframeEnd);\n                        $(n).after(html).remove();\n                    }\n                    else if (html.match(reUrlVimeo))\n                    {\n                        html = html.replace(reUrlVimeo, iframeStart + '//player.vimeo.com/video/$2' + iframeEnd);\n                        $(n).after(html).remove();\n                    }\n                }\n\n                // image\n                if (convertImageLinks && html && html.match(urlImage))\n                {\n                    var matches = html.match(urlImage);\n                    html = html.replace(urlImage, '<img src=\"' + matches + '\" />');\n\n                    $(n).after(html).remove();\n                    return;\n                }\n\n                // link\n                if (html.search(/\\$/g) != -1) html = html.replace(/\\$/g, '&#36;');\n\n                var matches = html.match(regex);\n                if (convertUrlLinks && html && matches)\n                {\n                    var len = matches.length;\n                    for (var z = 0; z < len; z++)\n                    {\n                        // remove dot in the end\n                        if (matches[z].match(/\\.$/) !== null) matches[z] = matches[z].replace(/\\.$/, '');\n\n                        var href = matches[z];\n                        var text = href;\n\n                        var space = '';\n                        if (href.match(/\\s$/) !== null) space = ' ';\n\n                        var addProtocol = protocol + '://';\n                        if (href.match(rProtocol) !== null) addProtocol = '';\n\n                        if (text.length > linkSize) text = text.substring(0, linkSize) + '...';\n                        text = text.replace(/&#36;/g, '$').replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\n\n                        // buffer\n                        var buffer = [];\n                        var links = html.match('<a(.*?)</a>');\n                        if (links !== null)\n                        {\n                            var len = links.length;\n                            for (i = 0; i < len; i++)\n                            {\n                                buffer[i] = links[i];\n                                html = html.replace(links[i], '{abuffer' + i + '}');\n                            }\n                        }\n\n                        html = html.replace(href, '<a href=\\\"' + addProtocol + $.trim(href) + '\\\">' + $.trim(text) + '</a>' + space);\n\n                        // rebuffer\n                        $.each(buffer, function(i,s)\n                        {\n                            html = html.replace('{abuffer' + i + '}', s);\n                        });\n                    }\n\n                    $(n).after(html).remove();\n                }\n            }\n            else if (n.nodeType === 1 && !/^(pre|a|button|textarea)$/i.test(n.tagName))\n            {\n                $.Redactor.fn.formatLinkify.call(n, protocol, convertLinks, convertUrlLinks, convertImageLinks, convertVideoLinks, linkSize);\n            }\n        }\n    };\n\n})(jQuery);","if (!RedactorPlugins) var RedactorPlugins = {};\n\nRedactorPlugins.filemanager = function()\n{\n    return {\n        getTemplate: function()\n        {\n            return String()\n            + '<section id=\"redactor-modal-filemanager\">'\n            + '<div class=\"input-group\">'\n            + '<input id=\"filemanager-filter\" type=\"textbox\" placeholder=\"Search\" class=\"form-control\">'\n            + '<span class=\"input-group-btn\">'\n            + '<span class=\"btn btn-default\"><span class=\"fa fa-search\"></span></span>'\n            + '</span>'\n            + '</div>'\n            + '<div id=\"filemanager-container\" class=\"raw-block-400 siravel-row raw-margin-top-24\" style=\"overflow: scroll;\">Loading your file collection...</div>'\n            + '</section>';\n        },\n        init: function()\n        {\n            var button = this.button.add('filemanager', 'Insert File');\n\n            this.button.setAwesome('filemanager', 'fa-archive');\n            this.button.addCallback(button, this.filemanager.show);\n        },\n        show: function()\n        {\n            this.modal.addTemplate('filemanager', this.filemanager.getTemplate());\n\n            this.modal.load('filemanager', 'File Insert', 600);\n\n            this.modal.show();\n\n            this.filemanager.load();\n        },\n        load: function()\n        {\n            $.ajax({\n                dataType: \"json\",\n                cache: false,\n                headers: {\n                    Siravel: _apiKey,\n                    Authorization: 'Bearer '+_apiToken\n                },\n                url: this.opts.fileManagerJson,\n                error: function(data){\n                    console.log(data)\n                },\n                success: $.proxy(function(data)\n                {\n                    $('#filemanager-container').html('');\n\n                    $.each((data.data), $.proxy(function(key, val)\n                    {\n                        var file = $('<div class=\"list-row raw-left raw100\"><div class=\"raw100 raw-left\"><p><span class=\"fa fa-download\"></span> <a class=\"file-link\" href=\"#\" data-url=\"/public-download/'+val.file_identifier +'\">' + val.file_name + '</a></p></div>');\n                        $('#filemanager-container').append(file);\n                        $(file).click($.proxy(this.filemanager.insert, this));\n                    }, this));\n\n                    $(\"#filemanager-filter\").bind(\"keyup\", function(){\n                        $(\"#filemanager-container\").find(\".file-link\").each(function(){\n                            if ($(this).html().indexOf($(\"#filemanager-filter\").val()) < 0) {\n                                $(this).parent().parent().parent().hide();\n                            } else {\n                                $(this).parent().parent().parent().show();\n                            }\n                        });\n                    })\n\n                }, this)\n            });\n        },\n        insert: function(e)\n        {\n            e.preventDefault();\n            this.insert.html('<a href=\"' + $(e.target).attr('data-url') + '\">'+ $(e.target).html() +'</a>', false);\n            this.modal.close();\n        }\n    };\n};","if (!RedactorPlugins) var RedactorPlugins = {};\n\nRedactorPlugins.fontcolor = function()\n{\n\treturn {\n\t\tinit: function()\n\t\t{\n\t\t\tvar colors = [\n\t\t\t\t'#ffffff', '#000000', '#eeece1', '#1f497d', '#4f81bd', '#c0504d', '#9bbb59', '#8064a2', '#4bacc6', '#f79646', '#ffff00',\n\t\t\t\t'#f2f2f2', '#7f7f7f', '#ddd9c3', '#c6d9f0', '#dbe5f1', '#f2dcdb', '#ebf1dd', '#e5e0ec', '#dbeef3', '#fdeada', '#fff2ca',\n\t\t\t\t'#d8d8d8', '#595959', '#c4bd97', '#8db3e2', '#b8cce4', '#e5b9b7', '#d7e3bc', '#ccc1d9', '#b7dde8', '#fbd5b5', '#ffe694',\n\t\t\t\t'#bfbfbf', '#3f3f3f', '#938953', '#548dd4', '#95b3d7', '#d99694', '#c3d69b', '#b2a2c7', '#b7dde8', '#fac08f', '#f2c314',\n\t\t\t\t'#a5a5a5', '#262626', '#494429', '#17365d', '#366092', '#953734', '#76923c', '#5f497a', '#92cddc', '#e36c09', '#c09100',\n\t\t\t\t'#7f7f7f', '#0c0c0c', '#1d1b10', '#0f243e', '#244061', '#632423', '#4f6128', '#3f3151', '#31859b',  '#974806', '#7f6000'\n\t\t\t];\n\n\t\t\tvar buttons = ['fontcolor', 'backcolor'];\n\n\t\t\tfor (var i = 0; i < 2; i++)\n\t\t\t{\n\t\t\t\tvar name = buttons[i];\n\n\t\t\t\tvar button = this.button.add(name, this.lang.get(name));\n\t\t\t\tvar $dropdown = this.button.addDropdown(button);\n\n\t\t\t\t$dropdown.width(242);\n\t\t\t\tthis.fontcolor.buildPicker($dropdown, name, colors);\n\n\t\t\t}\n\t\t},\n\t\tbuildPicker: function($dropdown, name, colors)\n\t\t{\n\t\t\tvar rule = (name == 'backcolor') ? 'background-color' : 'color';\n\n\t\t\tvar len = colors.length;\n\t\t\tvar self = this;\n\t\t\tvar func = function(e)\n\t\t\t{\n\t\t\t\te.preventDefault();\n\t\t\t\tself.fontcolor.set($(this).data('rule'), $(this).attr('rel'));\n\t\t\t};\n\n\t\t\tfor (var z = 0; z < len; z++)\n\t\t\t{\n\t\t\t\tvar color = colors[z];\n\n\t\t\t\tvar $swatch = $('<a rel=\"' + color + '\" data-rule=\"' + rule +'\" href=\"#\" style=\"float: left; font-size: 0; border: 2px solid #fff; padding: 0; margin: 0; width: 22px; height: 22px;\"></a>');\n\t\t\t\t$swatch.css('background-color', color);\n\t\t\t\t$swatch.on('click', func);\n\n\t\t\t\t$dropdown.append($swatch);\n\t\t\t}\n\n\t\t\tvar $elNone = $('<a href=\"#\" style=\"display: block; clear: both; padding: 5px; font-size: 12px; line-height: 1;\"></a>').html(this.lang.get('none'));\n\t\t\t$elNone.on('click', $.proxy(function(e)\n\t\t\t{\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.fontcolor.remove(rule);\n\n\t\t\t}, this));\n\n\t\t\t$dropdown.append($elNone);\n\t\t},\n\t\tset: function(rule, type)\n\t\t{\n\t\t\tthis.inline.format('span', 'style', rule + ': ' + type + ';');\n\t\t},\n\t\tremove: function(rule)\n\t\t{\n\t\t\tthis.inline.removeStyleRule(rule);\n\t\t}\n\t};\n};","if (!RedactorPlugins) var RedactorPlugins = {};\n\nRedactorPlugins.fontfamily = function()\n{\n\treturn {\n\t\tinit: function ()\n\t\t{\n\t\t\tvar fonts = [ 'Arial', 'Helvetica', 'Georgia', 'Times New Roman', 'Monospace' ];\n\t\t\tvar that = this;\n\t\t\tvar dropdown = {};\n\n\t\t\t$.each(fonts, function(i, s)\n\t\t\t{\n\t\t\t\tdropdown['s' + i] = { title: s, func: function() { that.fontfamily.set(s); }};\n\t\t\t});\n\n\t\t\tdropdown.remove = { title: 'Remove Font Family', func: that.fontfamily.reset };\n\n\t\t\tvar button = this.button.add('fontfamily', 'Change Font Family');\n\t\t\tthis.button.addDropdown(button, dropdown);\n\n\t\t},\n\t\tset: function (value)\n\t\t{\n\t\t\tthis.inline.format('span', 'style', 'font-family:' + value + ';');\n\t\t},\n\t\treset: function()\n\t\t{\n\t\t\tthis.inline.removeStyleRule('font-family');\n\t\t}\n\t};\n};","if (!RedactorPlugins) var RedactorPlugins = {};\n\nRedactorPlugins.fontsize = function()\n{\n\treturn {\n\t\tinit: function()\n\t\t{\n\t\t\tvar fonts = [10, 11, 12, 14, 16, 18, 20, 24, 28, 30];\n\t\t\tvar that = this;\n\t\t\tvar dropdown = {};\n\n\t\t\t$.each(fonts, function(i, s)\n\t\t\t{\n\t\t\t\tdropdown['s' + i] = { title: s + 'px', func: function() { that.fontsize.set(s); } };\n\t\t\t});\n\n\t\t\tdropdown.remove = { title: 'Remove Font Size', func: that.fontsize.reset };\n\n\t\t\tvar button = this.button.add('fontsize', 'Change Font Size');\n\t\t\tthis.button.addDropdown(button, dropdown);\n\t\t},\n\t\tset: function(size)\n\t\t{\n\t\t\tthis.inline.format('span', 'style', 'font-size: ' + size + 'px;');\n\t\t},\n\t\treset: function()\n\t\t{\n\t\t\tthis.inline.removeStyleRule('font-size');\n\t\t}\n\t};\n};","if (!RedactorPlugins) var RedactorPlugins = {};\n\nRedactorPlugins.imagemanager = function()\n{\n    return {\n        init: function()\n        {\n            if (!this.opts.imageManagerJson) return;\n\n            this.modal.addCallback('image', this.imagemanager.load);\n        },\n        load: function()\n        {\n            var $modal = this.modal.getModal();\n\n            this.modal.createTabber($modal);\n\n            $('#redactor-modal-image-droparea').hide()\n\n            var $box = $('<div id=\"redactor-image-manager-box\" style=\"overflow: auto; height: 300px;\" class=\"redactor-tab redactor-tab2\">').hide();\n            $modal.append($box);\n\n            $(\"#redactor-image-manager-box\").html('<p class=\"text-center raw-margin-top-48\">Loading your image collection...</p>').show();\n\n            $.ajax({\n                dataType: \"json\",\n                cache: false,\n                headers: {\n                    Siravel: _apiKey,\n                    Authorization: 'Bearer '+_apiToken\n                },\n                url: this.opts.imageManagerJson,\n                success: $.proxy(function(data)\n                {\n                    $('#redactor-image-manager-box').html('');\n                    $.each(data, $.proxy(function(key, val)\n                    {\n                        // title\n                        var thumbtitle = '';\n                        if (typeof val.title_tag != 'undefined') thumbtitle = val.title_tag;\n\n                        var img = $('<div class=\"raw25 pull-left thumbnail-box\"><div class=\"img\" style=\"background-image: url(\\'' + val.js_url + '\\')\" data-img-name=\"'+ val.js_url +'\" src=\"' + val.js_url + '\" rel=\"' + val.js_url + '\" title=\"' + thumbtitle + '\"></div></div>');\n                        $('#redactor-image-manager-box').append(img);\n                        $(img).click($.proxy(this.imagemanager.insert, this));\n\n                    }, this));\n\n                    $(\"#imagemanager-filter\").bind(\"keyup\", function(){\n                        $(\"#redactor-image-manager-box\").find(\"img\").each(function(){\n                            if ($(this).attr(\"data-img-name\").indexOf($(\"#imagemanager-filter\").val()) < 0) {\n                                $(this).hide();\n                            } else {\n                                $(this).show();\n                            }\n                        });\n                    })\n\n                }, this)\n            });\n        },\n        insert: function(e)\n        {\n            console.log(e.target)\n            this.image.insert('<img src=\"' + $(e.target).attr('rel') + '\" alt=\"' + $(e.target).attr('title') + '\" title=\"' + $(e.target).attr('title') + '\">');\n        }\n    };\n};","if (!RedactorPlugins) var RedactorPlugins = {};\n\nRedactorPlugins.stockimagemanager = function()\n{\n    return {\n        getTemplate: function()\n        {\n            return String()\n            + '<section id=\"redactor-modal-stockimagemanager\">'\n            + '<div class=\"input-group stockimagemanager-search-box\">'\n            + '<input id=\"stockimagemanager-filter\" type=\"textbox\" placeholder=\"Search\" class=\"form-control\">'\n            + '<span class=\"input-group-btn\">'\n            + '<button class=\"btn btn-default\" type=\"button\" id=\"stockimagemanager-search\"><span class=\"fa fa-search\"></span></button>'\n            + '</span>'\n            + '</div>'\n            + '<div id=\"stockimagemanager-container\" class=\"raw-block-300 siravel-row raw-margin-top-24 raw-margin-bottom-24\" style=\"overflow: scroll;\"></div>'\n            + '<div id=\"stockimagemanager-links\" class=\"raw-block-20 siravel-row\"><button id=\"stockImgPrevBtn\" class=\"btn btn-default pull-left\">Prev</button><button id=\"stockImgNextBtn\" class=\"pull-right btn btn-default\">Next</button></div>'\n            + '<div><a href=\"https://pixabay.com/\"><img class=\"raw100 raw-margin-top-24\" src=\"https://pixabay.com/static/img/public/leaderboard_a.png\" alt=\"Pixabay\"> </a></div>'\n            + '</section>';\n        },\n        init: function()\n        {\n            var button = this.button.add('stockimagemanager', 'Insert Stock Image');\n            this.button.setAwesome('stockimagemanager', 'fa-camera-retro');\n            this.button.addCallback(button, this.stockimagemanager.show);\n        },\n        show: function()\n        {\n            this.modal.addTemplate('stockimagemanager', this.stockimagemanager.getTemplate());\n\n            this.modal.load('stockimagemanager', 'Insert Stock Images', 600);\n\n            this.modal.show();\n\n            this.stockimagemanager.load();\n        },\n        search: function(_term, _page) {\n            if (typeof _page == 'undefined') {\n                _page = 1;\n            };\n            if (typeof _term != 'undefined' && _term != 'null' && _term != null) {\n                _searchTerm = \"&q=\" + encodeURIComponent(_term);\n            } else {\n                _searchTerm = '';\n            }\n\n            $('#stockimagemanager-container').html('loading...');\n\n            $.ajax({\n                dataType: \"json\",\n                cache: false,\n                url: this.opts.stockImageManagerJson + \"?key=\" + _pixabayKey + _searchTerm + \"&order=popular&page=\" + _page,\n                error: function(data){\n                    console.log(data)\n                },\n                success: $.proxy(function(data)\n                {\n                    if (Math.floor(data.totalHits / 20) == _page) {\n                        $(\"#stockImgNextBtn\").hide();\n                    } else  {\n                        $(\"#stockImgNextBtn\").show();\n                    }\n\n                    if (_page == 1) {\n                        $(\"#stockImgPrevBtn\").hide();\n                    } else  {\n                        $(\"#stockImgPrevBtn\").show();\n                    }\n\n                    $(\"#stockImgNextBtn\").attr('data-page', parseInt(_page) + 1);\n                    $(\"#stockImgPrevBtn\").attr('data-page', parseInt(_page) - 1);\n\n                    $('#stockimagemanager-container').html(\"\");\n                    $.each((data.hits), $.proxy(function(key, val)\n                    {\n                        var img = $('<div class=\"raw25 pull-left thumbnail-box\"><img class=\"img-responsive\" data-img-name=\"'+ val.previewURL +'\" data-url=\"' + val.webformatURL + '\" src=\"' + val.previewURL + '\" rel=\"' + val.previewURL + '\" style=\"cursor: pointer;\" /></div>');\n                        $('#stockimagemanager-container').append(img);\n                        $(img).click($.proxy(this.stockimagemanager.insert, this));\n                    }, this));\n\n                }, this)\n            });\n        },\n        load: function()\n        {\n            if (_pixabayKey == '') {\n                $(\"#stockImgPrevBtn, #stockImgNextBtn, .stockimagemanager-search-box\").hide();\n                $('#stockimagemanager-container').html('<p class=\"text-center\">In order to have an easy supply of stock images visit <a target=\"_blank\" href=\"https://pixabay.com/api/docs/\">Pixabay</a> to get an API key for your application.</p><p class=\"text-center\">Then add the following to your .env file:<br> PIXABAY=yourApiKey</p>');\n            } else {\n                var _module = this.stockimagemanager;\n                _module.search('null');\n                $(\"#stockimagemanager-search\").bind(\"click\", function(){\n                    var _val = $(\"#stockimagemanager-filter\").val();\n                    if (_val == '') {\n                        _val = 'null';\n                    };\n                    _module.search(_val);\n                });\n                $(\"#stockImgPrevBtn, #stockImgNextBtn\").bind(\"click\", function() {\n                    var _val = $(\"#stockimagemanager-filter\").val();\n                    if (_val == '') {\n                        _val = 'null';\n                    };\n                    _module.search(_val, $(this).attr('data-page'));\n                });\n            }\n        },\n        insert: function(e)\n        {\n            var _imageURL = '';\n            var _this = this;\n            $.ajax({\n                type: 'POST',\n                dataType: \"json\",\n                cache: false,\n                headers: {\n                    ApiKey: 'tOJRcQXeCesSMprwbtU5'\n                },\n                data: {\n                    _token: _token,\n                    location: $(e.target).attr('data-url')\n                },\n                url: _url + '/siravel/api/images/store',\n                error: function(data){\n                    console.log(data)\n                },\n                success: $.proxy(function(data) {\n                    e.preventDefault();\n                    _this.insert.html('<img src=\"' + data.data.js_url + '\" />', false);\n                    _this.modal.close();\n                }, this)\n            });\n        }\n    };\n};","if ( ! RedactorPlugins) var RedactorPlugins = {};\n\nRedactorPlugins.specialchar = function()\n{\n    return {\n        init: function()\n        {\n            var dropdown = {};\n\n            /*\n            |--------------------------------------------------------------------------\n            | Punctuation\n            |--------------------------------------------------------------------------\n            */\n\n            dropdown.ndash  = { title: '&ndash;', func: this.specialchar.callbackFunc };\n            dropdown.mdash  = { title: '&mdash;', func: this.specialchar.callbackFunc };\n            dropdown.iexcl  = { title: '&iexcl;', func: this.specialchar.callbackFunc };\n            dropdown.iquest = { title: '&iquest;', func: this.specialchar.callbackFunc };\n            dropdown.laquo  = { title: '&laquo;', func: this.specialchar.callbackFunc };\n            dropdown.raquo  = { title: '&raquo;', func: this.specialchar.callbackFunc };\n\n            /*\n            |--------------------------------------------------------------------------\n            | Symbols\n            |--------------------------------------------------------------------------\n            */\n\n            dropdown.cent   = { title: '&cent;', func: this.specialchar.callbackFunc };\n            dropdown.copy   = { title: '&copy;', func: this.specialchar.callbackFunc };\n            dropdown.divide = { title: '&divide;', func: this.specialchar.callbackFunc };\n            dropdown.gt     = { title: '&gt;', func: this.specialchar.callbackFunc };\n            dropdown.lt     = { title: '&lt;', func: this.specialchar.callbackFunc };\n            dropdown.micro  = { title: '&micro;', func: this.specialchar.callbackFunc };\n            dropdown.middot = { title: '&middot;', func: this.specialchar.callbackFunc };\n            dropdown.para   = { title: '&para;', func: this.specialchar.callbackFunc };\n            dropdown.plusmn = { title: '&plusmn;', func: this.specialchar.callbackFunc };\n            dropdown.euro   = { title: '&euro;', func: this.specialchar.callbackFunc };\n            dropdown.pound  = { title: '&pound;', func: this.specialchar.callbackFunc };\n            dropdown.reg    = { title: '&reg;', func: this.specialchar.callbackFunc };\n            dropdown.sect   = { title: '&sect;', func: this.specialchar.callbackFunc };\n            dropdown.trade  = { title: '&trade;', func: this.specialchar.callbackFunc };\n            dropdown.yen    = { title: '&yen;', func: this.specialchar.callbackFunc };\n            dropdown.deg    = { title: '&deg;', func: this.specialchar.callbackFunc };\n\n            /*\n            |--------------------------------------------------------------------------\n            | Diacritics\n            |--------------------------------------------------------------------------\n            */\n\n            dropdown.aacute  = { title: '&aacute;', func: this.specialchar.callbackFunc };\n            dropdown.Aacute  = { title: '&Aacute;', func: this.specialchar.callbackFunc };\n            dropdown.agrave  = { title: '&agrave;', func: this.specialchar.callbackFunc };\n            dropdown.acirc   = { title: '&acirc;', func: this.specialchar.callbackFunc };\n            dropdown.aring   = { title: '&aring;', func: this.specialchar.callbackFunc };\n            dropdown.atilde  = { title: '&atilde;', func: this.specialchar.callbackFunc };\n            dropdown.auml    = { title: '&auml;', func: this.specialchar.callbackFunc };\n            dropdown.aelig   = { title: '&aelig;', func: this.specialchar.callbackFunc };\n            dropdown.ccedil  = { title: '&ccedil;', func: this.specialchar.callbackFunc };\n            dropdown.eacute  = { title: '&eacute;', func: this.specialchar.callbackFunc };\n            dropdown.egrave  = { title: '&egrave;', func: this.specialchar.callbackFunc };\n            dropdown.ecirc   = { title: '&ecirc;', func: this.specialchar.callbackFunc };\n            dropdown.euml    = { title: '&euml;', func: this.specialchar.callbackFunc };\n            dropdown.iacute  = { title: '&iacute;', func: this.specialchar.callbackFunc };\n            dropdown.igrave  = { title: '&igrave;', func: this.specialchar.callbackFunc };\n            dropdown.icirc   = { title: '&icirc;', func: this.specialchar.callbackFunc };\n            dropdown.iuml    = { title: '&iuml;', func: this.specialchar.callbackFunc };\n            dropdown.ntilde  = { title: '&ntilde;', func: this.specialchar.callbackFunc };\n            dropdown.oacute  = { title: '&oacute;', func: this.specialchar.callbackFunc };\n            dropdown.ograve  = { title: '&ograve;', func: this.specialchar.callbackFunc };\n            dropdown.ocirc   = { title: '&ocirc;', func: this.specialchar.callbackFunc };\n            dropdown.oslash  = { title: '&oslash;', func: this.specialchar.callbackFunc };\n            dropdown.otilde  = { title: '&otilde;', func: this.specialchar.callbackFunc };\n            dropdown.ouml    = { title: '&ouml;', func: this.specialchar.callbackFunc };\n            dropdown.uacute  = { title: '&uacute;', func: this.specialchar.callbackFunc };\n            dropdown.ugrave  = { title: '&ugrave;', func: this.specialchar.callbackFunc };\n            dropdown.ucirc   = { title: '&ucirc;', func: this.specialchar.callbackFunc };\n            dropdown.uuml    = { title: '&uuml;', func: this.specialchar.callbackFunc };\n\n            var button = this.button.add('specialchar', 'Special Characters');\n\n            this.button.setAwesome('specialchar', 'fa-keyboard-o');\n            this.button.addDropdown(button, dropdown);\n        },\n        callbackFunc: function(buttonName)\n        {\n            this.insert.html('&'+buttonName+';', false);\n            this.modal.close();\n        }\n    };\n};","if (!RedactorPlugins) var RedactorPlugins = {};\n\nRedactorPlugins.table = function()\n{\n\treturn {\n\t\tgetTemplate: function()\n\t\t{\n\t\t\treturn String()\n\t\t\t+ '<section id=\"redactor-modal-table-insert\">'\n\t\t\t\t+ '<label>' + this.lang.get('rows') + '</label>'\n\t\t\t\t+ '<input type=\"text\" size=\"5\" value=\"2\" id=\"redactor-table-rows\" />'\n\t\t\t\t+ '<label>' + this.lang.get('columns') + '</label>'\n\t\t\t\t+ '<input type=\"text\" size=\"5\" value=\"3\" id=\"redactor-table-columns\" />'\n\t\t\t+ '</section>';\n\t\t},\n\t\tinit: function()\n\t\t{\n\n\t\t\tvar dropdown = {};\n\n\t\t\tdropdown.insert_table = { title: this.lang.get('insert_table'), func: this.table.show };\n\t\t\tdropdown.insert_row_above = { title: this.lang.get('insert_row_above'), func: this.table.addRowAbove };\n\t\t\tdropdown.insert_row_below = { title: this.lang.get('insert_row_below'), func: this.table.addRowBelow };\n\t\t\tdropdown.insert_column_left = { title: this.lang.get('insert_column_left'), func: this.table.addColumnLeft };\n\t\t\tdropdown.insert_column_right = { title: this.lang.get('insert_column_right'), func: this.table.addColumnRight };\n\t\t\tdropdown.add_head = { title: this.lang.get('add_head'), func: this.table.addHead };\n\t\t\tdropdown.delete_head = { title: this.lang.get('delete_head'), func: this.table.deleteHead };\n\t\t\tdropdown.delete_column = { title: this.lang.get('delete_column'), func: this.table.deleteColumn };\n\t\t\tdropdown.delete_row = { title: this.lang.get('delete_row'), func: this.table.deleteRow };\n\t\t\tdropdown.delete_table = { title: this.lang.get('delete_table'), func: this.table.deleteTable };\n\n\t\t\tthis.observe.addButton('td', 'table');\n\t\t\tthis.observe.addButton('th', 'table');\n\n\t\t\tvar button = this.button.addBefore('link', 'table', this.lang.get('table'));\n\t\t\tthis.button.addDropdown(button, dropdown);\n\t\t},\n\t\tshow: function()\n\t\t{\n\t\t\tthis.modal.addTemplate('table', this.table.getTemplate());\n\n\t\t\tthis.modal.load('table', this.lang.get('insert_table'), 300);\n\t\t\tthis.modal.createCancelButton();\n\n\t\t\tvar button = this.modal.createActionButton(this.lang.get('insert'));\n\t\t\tbutton.on('click', this.table.insert);\n\n\t\t\tthis.selection.save();\n\t\t\tthis.modal.show();\n\n\t\t\t$('#redactor-table-rows').focus();\n\n\t\t},\n\t\tinsert: function()\n\t\t{\n\n\t\t\tvar rows = $('#redactor-table-rows').val(),\n\t\t\t\tcolumns = $('#redactor-table-columns').val(),\n\t\t\t\t$tableBox = $('<div>'),\n\t\t\t\ttableId = Math.floor(Math.random() * 99999),\n\t\t\t\t$table = $('<table id=\"table' + tableId + '\"><tbody></tbody></table>'),\n\t\t\t\ti, $row, z, $column;\n\n\t\t\tfor (i = 0; i < rows; i++)\n\t\t\t{\n\t\t\t\t$row = $('<tr>');\n\n\t\t\t\tfor (z = 0; z < columns; z++)\n\t\t\t\t{\n\t\t\t\t\t$column = $('<td>' + this.opts.invisibleSpace + '</td>');\n\n\t\t\t\t\t// set the focus to the first td\n\t\t\t\t\tif (i === 0 && z === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\t$column.append(this.selection.getMarker());\n\t\t\t\t\t}\n\n\t\t\t\t\t$($row).append($column);\n\t\t\t\t}\n\n\t\t\t\t$table.append($row);\n\t\t\t}\n\n\t\t\t$tableBox.append($table);\n\t\t\tvar html = $tableBox.html();\n\n\n\t\t\tthis.modal.close();\n\t\t\tthis.selection.restore();\n\n\t\t\tif (this.table.getTable()) return;\n\n\t\t\tthis.buffer.set();\n\n\t\t\tvar current = this.selection.getBlock() || this.selection.getCurrent();\n\t\t\tif (current && current.tagName != 'BODY')\n\t\t\t{\n\t\t\t\tif (current.tagName == 'LI') current = $(current).closest('ul, ol');\n\t\t\t\t$(current).after(html);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.insert.html(html);\n\t\t\t}\n\n\t\t\tthis.selection.restore();\n\n\t\t\tvar table = this.$editor.find('#table' + tableId);\n\n\t\t\tif (!this.opts.linebreaks && (this.utils.browser('mozilla') || this.utils.browser('msie')))\n\t\t\t{\n\t\t\t\tvar $next = table.next();\n\t\t\t\tif ($next.length === 0)\n\t\t\t\t{\n\t\t\t\t\t table.after(this.opts.emptyHtml);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.observe.buttons();\n\n\t\t\ttable.find('span.redactor-selection-marker').remove();\n\t\t\ttable.removeAttr('id');\n\n\t\t\tthis.code.sync();\n\t\t\tthis.core.setCallback('insertedTable', table);\n\t\t},\n\t\tgetTable: function()\n\t\t{\n\t\t\tvar $table = $(this.selection.getParent()).closest('table');\n\n\t\t\tif (!this.utils.isRedactorParent($table)) return false;\n\t\t\tif ($table.size() === 0) return false;\n\n\t\t\treturn $table;\n\t\t},\n\t\trestoreAfterDelete: function($table)\n\t\t{\n\t\t\tthis.selection.restore();\n\t\t\t$table.find('span.redactor-selection-marker').remove();\n\t\t\tthis.code.sync();\n\t\t},\n\t\tdeleteTable: function()\n\t\t{\n\t\t\tvar $table = this.table.getTable();\n\t\t\tif (!$table) return;\n\n\t\t\tthis.buffer.set();\n\n\n\t\t\tvar $next = $table.next();\n\t\t\tif (!this.opts.linebreaks && $next.length !== 0)\n\t\t\t{\n\t\t\t\tthis.caret.setStart($next);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.caret.setAfter($table);\n\t\t\t}\n\n\n\t\t\t$table.remove();\n\n\t\t\tthis.code.sync();\n\t\t},\n\t\tdeleteRow: function()\n\t\t{\n\t\t\tvar $table = this.table.getTable();\n\t\t\tif (!$table) return;\n\n\t\t\tvar $current = $(this.selection.getCurrent());\n\n\t\t\tthis.buffer.set();\n\n\t\t\tvar $current_tr = $current.closest('tr');\n\t\t\tvar $focus_tr = $current_tr.prev().length ? $current_tr.prev() : $current_tr.next();\n\t\t\tif ($focus_tr.length)\n\t\t\t{\n\t\t\t\tvar $focus_td = $focus_tr.children('td, th').first();\n\t\t\t\tif ($focus_td.length) $focus_td.prepend(this.selection.getMarker());\n\t\t\t}\n\n\t\t\t$current_tr.remove();\n\t\t\tthis.table.restoreAfterDelete($table);\n\t\t},\n\t\tdeleteColumn: function()\n\t\t{\n\t\t\tvar $table = this.table.getTable();\n\t\t\tif (!$table) return;\n\n\t\t\tthis.buffer.set();\n\n\t\t\tvar $current = $(this.selection.getCurrent());\n\t\t\tvar $current_td = $current.closest('td, th');\n\t\t\tvar index = $current_td[0].cellIndex;\n\n\t\t\t$table.find('tr').each($.proxy(function(i, elem)\n\t\t\t{\n\t\t\t\tvar $elem = $(elem);\n\t\t\t\tvar focusIndex = index - 1 < 0 ? index + 1 : index - 1;\n\t\t\t\tif (i === 0) $elem.find('td, th').eq(focusIndex).prepend(this.selection.getMarker());\n\n\t\t\t\t$elem.find('td, th').eq(index).remove();\n\n\t\t\t}, this));\n\n\t\t\tthis.table.restoreAfterDelete($table);\n\t\t},\n\t\taddHead: function()\n\t\t{\n\t\t\tvar $table = this.table.getTable();\n\t\t\tif (!$table) return;\n\n\t\t\tthis.buffer.set();\n\n\t\t\tif ($table.find('thead').size() !== 0)\n\t\t\t{\n\t\t\t\tthis.table.deleteHead();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar tr = $table.find('tr').first().clone();\n\t\t\ttr.find('td').html(this.opts.invisibleSpace);\n\t\t\t$thead = $('<thead></thead>').append(tr);\n\t\t\t$table.prepend($thead);\n\n\t\t\tthis.code.sync();\n\n\t\t},\n\t\tdeleteHead: function()\n\t\t{\n\t\t\tvar $table = this.table.getTable();\n\t\t\tif (!$table) return;\n\n\t\t\tvar $thead = $table.find('thead');\n\t\t\tif ($thead.size() === 0) return;\n\n\t\t\tthis.buffer.set();\n\n\t\t\t$thead.remove();\n\t\t\tthis.code.sync();\n\t\t},\n\t\taddRowAbove: function()\n\t\t{\n\t\t\tthis.table.addRow('before');\n\t\t},\n\t\taddRowBelow: function()\n\t\t{\n\t\t\tthis.table.addRow('after');\n\t\t},\n\t\taddColumnLeft: function()\n\t\t{\n\t\t\tthis.table.addColumn('before');\n\t\t},\n\t\taddColumnRight: function()\n\t\t{\n\t\t\tthis.table.addColumn('after');\n\t\t},\n\t\taddRow: function(type)\n\t\t{\n\t\t\tvar $table = this.table.getTable();\n\t\t\tif (!$table) return;\n\n\t\t\tthis.buffer.set();\n\n\t\t\tvar $current = $(this.selection.getCurrent());\n\t\t\tvar $current_tr = $current.closest('tr');\n\t\t\tvar new_tr = $current_tr.clone();\n\n\t\t\tnew_tr.find('th').replaceWith(function()\n\t\t\t{\n\t\t\t\tvar $td = $('<td>');\n\t\t\t\t$td[0].attributes = this.attributes;\n\n\t\t\t\treturn $td.append($(this).contents());\n\t\t\t});\n\n\t\t\tnew_tr.find('td').html(this.opts.invisibleSpace);\n\n\t\t\tif (type == 'after')\n\t\t\t{\n\t\t\t\t$current_tr.after(new_tr);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t$current_tr.before(new_tr);\n\t\t\t}\n\n\t\t\tthis.code.sync();\n\t\t},\n\t\taddColumn: function (type)\n\t\t{\n\t\t\tvar $table = this.table.getTable();\n\t\t\tif (!$table) return;\n\n\t\t\tvar index = 0;\n\t\t\tvar current = $(this.selection.getCurrent());\n\n\t\t\tthis.buffer.set();\n\n\t\t\tvar $current_tr = current.closest('tr');\n\t\t\tvar $current_td = current.closest('td, th');\n\n\t\t\t$current_tr.find('td, th').each($.proxy(function(i, elem)\n\t\t\t{\n\t\t\t\tif ($(elem)[0] === $current_td[0]) index = i;\n\n\t\t\t}, this));\n\n\t\t\t$table.find('tr').each($.proxy(function(i, elem)\n\t\t\t{\n\t\t\t\tvar $current = $(elem).find('td, th').eq(index);\n\n\t\t\t\tvar td = $current.clone();\n\t\t\t\ttd.html(this.opts.invisibleSpace);\n\n\t\t\t\tif (type == 'after')\n\t\t\t\t{\n\t\t\t\t\t$current.after(td);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t$current.before(td);\n\t\t\t\t}\n\n\t\t\t}, this));\n\n\t\t\tthis.code.sync();\n\t\t}\n\t};\n};","if (!RedactorPlugins) var RedactorPlugins = {};\n\nRedactorPlugins.video = function()\n{\n\treturn {\n\t\treUrlYoutube: /https?:\\/\\/(?:[0-9A-Z-]+\\.)?(?:youtu\\.be\\/|youtube\\.com\\S*[^\\w\\-\\s])([\\w\\-]{11})(?=[^\\w\\-]|$)(?![?=&+%\\w.-]*(?:['\"][^<>]*>|<\\/a>))[?=&+%\\w.-]*/ig,\n\t\treUrlVimeo: /https?:\\/\\/(www\\.)?vimeo.com\\/(\\d+)($|\\/)/,\n\t\tgetTemplate: function()\n\t\t{\n\t\t\treturn String()\n\t\t\t+ '<section id=\"redactor-modal-video-insert\">'\n\t\t\t\t+ '<label>' + this.lang.get('video_html_code') + '</label>'\n\t\t\t\t+ '<textarea id=\"redactor-insert-video-area\" style=\"height: 160px;\"></textarea>'\n\t\t\t+ '</section>';\n\t\t},\n\t\tinit: function()\n\t\t{\n\t\t\tvar button = this.button.addAfter('image', 'video', this.lang.get('video'));\n\t\t\tthis.button.addCallback(button, this.video.show);\n\t\t},\n\t\tshow: function()\n\t\t{\n\t\t\tthis.modal.addTemplate('video', this.video.getTemplate());\n\n\t\t\tthis.modal.load('video', this.lang.get('video'), 700);\n\t\t\tthis.modal.createCancelButton();\n\n\t\t\tvar button = this.modal.createActionButton(this.lang.get('insert'));\n\t\t\tbutton.on('click', this.video.insert);\n\n\t\t\tthis.selection.save();\n\t\t\tthis.modal.show();\n\n\t\t\t$('#redactor-insert-video-area').focus();\n\n\t\t},\n\t\tinsert: function()\n\t\t{\n\t\t\tvar data = $('#redactor-insert-video-area').val();\n\t\t\tdata = this.clean.stripTags(data);\n\n\t\t\t// parse if it is link on youtube & vimeo\n\t\t\tvar iframeStart = '<iframe style=\"width: 500px; height: 281px;\" src=\"',\n\t\t\t\tiframeEnd = '\" frameborder=\"0\" allowfullscreen></iframe>';\n\n\t\t\tif (data.match(this.video.reUrlYoutube))\n\t\t\t{\n\t\t\t\tdata = data.replace(this.video.reUrlYoutube, iframeStart + '//www.youtube.com/embed/$1' + iframeEnd);\n\t\t\t}\n\t\t\telse if (data.match(this.video.reUrlVimeo))\n\t\t\t{\n\t\t\t\tdata = data.replace(this.video.reUrlVimeo, iframeStart + '//player.vimeo.com/video/$2' + iframeEnd);\n\t\t\t}\n\n\t\t\tthis.selection.restore();\n\t\t\tthis.modal.close();\n\n\t\t\tvar current = this.selection.getBlock() || this.selection.getCurrent();\n\n\t\t\tif (current) $(current).after(data);\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.insert.html(data);\n\t\t\t}\n\n\t\t\tthis.code.sync();\n\t\t}\n\n\t};\n};","/*\n * --------------------------------------------------------------------------\n * Links\n * --------------------------------------------------------------------------\n*/\n\nif ($('#External').is(':checked')) {\n    $('#External_url').parent().show();\n    $('#Page_id').parent().hide();\n} else {\n    $('#External_url').parent().hide();\n    $('#Page_id').parent().show();\n}\n\n$(window).ready(function(){\n    $('#External').bind('click', function() {\n        if ($(this).is(':checked')) {\n            $('#External_url').parent().show();\n            $('#Page_id').parent().hide();\n        } else {\n            $('#External_url').parent().hide();\n            $('#Page_id').parent().show();\n        }\n    });\n});\n\n/*\n * --------------------------------------------------------------------------\n * Files\n * --------------------------------------------------------------------------\n*/\n\n$(function(){\n\n    $('#saveFilesBtn').click(function(e){\n        e.preventDefault();\n        Dropzone.forElement('.dropzone').processQueue();\n    });\n\n});\n\nfunction confirmDelete (url) {\n    $('#deleteBtn').attr('href', url);\n    $('#deleteModal').modal('toggle');\n}\n\n/*\n * --------------------------------------------------------------------------\n * Images\n * --------------------------------------------------------------------------\n*/\n\n$(function(){\n\n    $('#saveImagesBtn').click(function(e){\n        e.preventDefault();\n        Dropzone.forElement('.dropzone').processQueue();\n    });\n\n});\n\n/*\n * --------------------------------------------------------------------------\n * Previews\n * --------------------------------------------------------------------------\n*/\n\n$('.preview-toggle').bind('click', function () {\n    if ($(this).attr('data-platform') == 'desktop') {\n        $('#frame').css({\n            width: '150%'\n        });\n    }\n    if ($(this).attr('data-platform') == 'mobile') {\n        $('#frame').css({\n            width: '320px'\n        });\n    }\n});\n\n$('#frame').load(function () {\n    var frameBody = $('#frame').contents().find('body');\n    $('a', frameBody).click(function(e){\n        e.preventDefault();\n    });\n});\n","Dropzone.options.fileDropzone = {\n    paramName: \"location\",\n    addRemoveLinks: true,\n    autoProcessQueue: false,\n    init: function() {\n        this.on(\"success\", function(file, responseText) {\n            file.serverData = responseText.data;\n            $(['name', 'original', 'mime', 'size']).each(function() {\n                $(\"#fileDetailsForm\").prepend('<input id=\"file_'+file.serverData.name+'\" name=\"location['+file.serverData.name+']['+this+']\" value=\"'+file.serverData[this]+'\" type=\"hidden\" />');\n            });\n            this.options.autoProcessQueue = true;\n        });\n        this.on(\"queuecomplete\", function(){\n            $('#fileDetailsForm').submit();\n        });\n        this.on(\"removedfile\", function(file) {\n            if (! file.serverData) {\n                return;\n            } else {\n                $.get(_url+\"/siravel/files/remove/\"+file.serverData.name);\n                $(\"#file_\"+file.serverData.name).remove();\n            }\n        });\n    },\n    accept: function(file, done) {\n        done();\n    }\n};"]}